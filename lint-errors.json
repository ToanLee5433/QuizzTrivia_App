[{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\scripts\\buildVectorIndex.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'db' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":40,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'storage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":41,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Script to build the vector index for RAG chatbot\r\n * This will:\r\n * 1. Extract data from Firestore (quizzes)\r\n * 2. Generate embeddings for each chunk\r\n * 3. Save the index to data/vector-index.json\r\n * \r\n * Usage: \r\n *   npx tsx scripts/buildVectorIndex.ts\r\n * Or:\r\n *   npm run build:index (add to package.json scripts)\r\n */\r\n\r\nimport { initializeApp, getApps } from 'firebase/app';\r\nimport { getFirestore } from 'firebase/firestore';\r\nimport { getStorage } from 'firebase/storage';\r\nimport { buildIndex, saveIndexToFile } from '../src/lib/genkit/indexing';\r\n\r\n// Firebase config (same as in your app)\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyDtBzTHNPQ5PxKhVb-si89kgr5T_3ppwj8\",\r\n  authDomain: \"datn-quizapp.firebaseapp.com\",\r\n  projectId: \"datn-quizapp\",\r\n  storageBucket: \"datn-quizapp.firebasestorage.app\",\r\n  messagingSenderId: \"741975099365\",\r\n  appId: \"1:741975099365:web:75a1d1eb4b6d89f0f7110c\",\r\n  measurementId: \"G-6Y1VQMBGJ0\",\r\n  databaseURL: \"https://datn-quizapp-default-rtdb.firebaseio.com\"\r\n};\r\n\r\nasync function main() {\r\n  console.log('üöÄ Starting vector index build...\\n');\r\n\r\n  try {\r\n    // Initialize Firebase (avoid duplicate initialization)\r\n    console.log('üì± Initializing Firebase...');\r\n    const app = getApps().length === 0 \r\n      ? initializeApp(firebaseConfig) \r\n      : getApps()[0];\r\n    const db = getFirestore(app);\r\n    const storage = getStorage(app);\r\n    console.log('‚úÖ Firebase initialized\\n');\r\n\r\n    // Build the index\r\n    console.log('üî® Building vector index...');\r\n    console.log('   This may take a few minutes depending on data size...\\n');\r\n    \r\n    const startTime = Date.now();\r\n    const index = await buildIndex();\r\n    const endTime = Date.now();\r\n    \r\n    const duration = ((endTime - startTime) / 1000).toFixed(2);\r\n    \r\n    console.log('\\n‚úÖ Index built successfully!\\n');\r\n    console.log('üìä Index Statistics:');\r\n    console.log(`   Total chunks: ${index.chunks.length}`);\r\n    console.log(`   Quiz chunks: ${index.sources.quiz || 0}`);\r\n    console.log(`   PDF chunks: ${index.sources.pdf || 0}`);\r\n    console.log(`   Web chunks: ${index.sources.web || 0}`);\r\n    console.log(`   Note chunks: ${index.sources.note || 0}`);\r\n    console.log(`   Build time: ${duration}s`);\r\n    console.log(`   Created: ${new Date(index.createdAt).toLocaleString()}\\n`);\r\n\r\n    // Verify embeddings\r\n    if (index.chunks.length > 0) {\r\n      const firstChunk = index.chunks[0];\r\n      console.log('üîç Sample chunk:');\r\n      console.log(`   ID: ${firstChunk.chunkId}`);\r\n      console.log(`   Title: ${firstChunk.title}`);\r\n      console.log(`   Source: ${firstChunk.sourceType}`);\r\n      console.log(`   Visibility: ${firstChunk.visibility}`);\r\n      console.log(`   Text preview: ${firstChunk.text.substring(0, 100)}...`);\r\n      console.log(`   Embedding dimensions: ${firstChunk.embedding.length}`);\r\n      console.log(`   Embedding sample: [${firstChunk.embedding.slice(0, 5).map(v => v.toFixed(4)).join(', ')}...]\\n`);\r\n    }\r\n\r\n    // Save to file\r\n    const outputPath = 'data/vector-index.json';\r\n    console.log(`üíæ Saving index to ${outputPath}...`);\r\n    await saveIndexToFile(index, 'vector-index.json');\r\n    \r\n    // Check file size\r\n    const fs = await import('fs');\r\n    const path = await import('path');\r\n    const fullPath = path.join(process.cwd(), 'data', 'vector-index.json');\r\n    const stats = fs.statSync(fullPath);\r\n    const fileSizeMB = (stats.size / (1024 * 1024)).toFixed(2);\r\n    console.log(`‚úÖ Index saved! File size: ${fileSizeMB} MB\\n`);\r\n\r\n    console.log('üéâ Build complete! The chatbot is ready to use the index.');\r\n    console.log(`üìÇ Index file: ${fullPath}`);\r\n    \r\n    process.exit(0);\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Error building index:', error);\r\n    if (error instanceof Error) {\r\n      console.error(error.stack);\r\n    }\r\n    process.exit(1);\r\n  }\r\n}\r\n\r\nmain();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\scripts\\testRAG.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'signInWithEmailAndPassword' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":45}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * üß™ RAG Chatbot Testing Script\r\n * \r\n * Comprehensive test suite for RAG functionality\r\n * Tests: Permission control, citation accuracy, latency\r\n * \r\n * Usage: npx tsx scripts/testRAG.ts\r\n */\r\n\r\nimport { initializeApp, getApps } from 'firebase/app';\r\nimport { getAuth, signInWithEmailAndPassword } from 'firebase/auth';\r\nimport { askQuestion } from '../src/lib/genkit/ragFlow';\r\nimport type { RAGResponse } from '../src/lib/genkit/types';\r\n\r\n// Firebase config\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyDtBzTHNPQ5PxKhVb-si89kgr5T_3ppwj8\",\r\n  authDomain: \"datn-quizapp.firebaseapp.com\",\r\n  projectId: \"datn-quizapp\",\r\n  storageBucket: \"datn-quizapp.firebasestorage.app\",\r\n  messagingSenderId: \"741975099365\",\r\n  appId: \"1:741975099365:web:75a1d1eb4b6d89f0f7110c\",\r\n};\r\n\r\n// Test cases\r\ninterface TestCase {\r\n  id: string;\r\n  name: string;\r\n  question: string;\r\n  expectedKeywords?: string[];\r\n  shouldHaveContent: boolean;\r\n  minLatency?: number;\r\n  maxLatency?: number;\r\n}\r\n\r\nconst testCases: TestCase[] = [\r\n  {\r\n    id: 'test-1',\r\n    name: 'Public Quiz Question',\r\n    question: 'C√¥ng th·ª©c t√≠nh di·ªán t√≠ch h√¨nh tr√≤n l√† g√¨?',\r\n    expectedKeywords: ['œÄ', 'b√°n k√≠nh', 'r'],\r\n    shouldHaveContent: true,\r\n    maxLatency: 2500,\r\n  },\r\n  {\r\n    id: 'test-2',\r\n    name: 'General Knowledge',\r\n    question: 'Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√† g√¨?',\r\n    expectedKeywords: ['H√† N·ªôi'],\r\n    shouldHaveContent: true,\r\n    maxLatency: 2500,\r\n  },\r\n  {\r\n    id: 'test-3',\r\n    name: 'No Context Available',\r\n    question: 'C√¥ng th·ª©c l∆∞·ª£ng t·ª≠ c∆° b·∫£n l√† g√¨?',\r\n    expectedKeywords: ['kh√¥ng ƒë·ªß d·ªØ li·ªáu', 'kh√¥ng t√¨m th·∫•y'],\r\n    shouldHaveContent: false,\r\n    maxLatency: 2500,\r\n  },\r\n  {\r\n    id: 'test-4',\r\n    name: 'Multi-aspect Question',\r\n    question: 'Gi·∫£i th√≠ch v·ªÅ h√†m s·ªë b·∫≠c hai',\r\n    shouldHaveContent: true,\r\n    maxLatency: 2500,\r\n  },\r\n];\r\n\r\n// Test statistics\r\ninterface TestStats {\r\n  total: number;\r\n  passed: number;\r\n  failed: number;\r\n  averageLatency: number;\r\n  citationAccuracy: number;\r\n}\r\n\r\n/**\r\n * Run a single test case\r\n */\r\nasync function runTest(testCase: TestCase, userId: string): Promise<{ passed: boolean; result: RAGResponse }> {\r\n  console.log(`\\nüß™ Testing: ${testCase.name}`);\r\n  console.log(`   Question: \"${testCase.question}\"`);\r\n\r\n  const startTime = Date.now();\r\n  let result: RAGResponse;\r\n\r\n  try {\r\n    result = await askQuestion({\r\n      userId,\r\n      question: testCase.question,\r\n      targetLang: 'vi',\r\n    });\r\n\r\n    const latency = Date.now() - startTime;\r\n    console.log(`   ‚è±Ô∏è  Latency: ${latency}ms`);\r\n\r\n    // Check latency\r\n    if (testCase.maxLatency && latency > testCase.maxLatency) {\r\n      console.log(`   ‚ùå Latency exceeded (max: ${testCase.maxLatency}ms)`);\r\n      return { passed: false, result };\r\n    }\r\n\r\n    // Check if should have content\r\n    const hasContent = result.usedChunks > 0;\r\n    if (testCase.shouldHaveContent && !hasContent) {\r\n      console.log(`   ‚ùå Expected content but got none`);\r\n      return { passed: false, result };\r\n    }\r\n\r\n    if (!testCase.shouldHaveContent && hasContent) {\r\n      console.log(`   ‚ùå Expected no content but got some`);\r\n      return { passed: false, result };\r\n    }\r\n\r\n    // Check keywords\r\n    if (testCase.expectedKeywords) {\r\n      const answerLower = result.answer.toLowerCase();\r\n      const hasAllKeywords = testCase.expectedKeywords.some(keyword =>\r\n        answerLower.includes(keyword.toLowerCase())\r\n      );\r\n\r\n      if (!hasAllKeywords) {\r\n        console.log(`   ‚ö†Ô∏è  Missing expected keywords: ${testCase.expectedKeywords.join(', ')}`);\r\n      }\r\n    }\r\n\r\n    // Check citations\r\n    console.log(`   üìö Citations: ${result.citations.length}`);\r\n    console.log(`   üìÑ Chunks used: ${result.usedChunks}`);\r\n\r\n    console.log(`   ‚úÖ Test passed`);\r\n    return { passed: true, result };\r\n\r\n  } catch (error) {\r\n    console.log(`   ‚ùå Test failed with error:`, error);\r\n    return {\r\n      passed: false,\r\n      result: {\r\n        answer: '',\r\n        citations: [],\r\n        usedChunks: 0,\r\n        processingTime: 0,\r\n      },\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate citation accuracy\r\n */\r\nfunction calculateCitationAccuracy(results: RAGResponse[]): number {\r\n  let totalCitations = 0;\r\n  let validCitations = 0;\r\n\r\n  results.forEach(result => {\r\n    totalCitations += result.citations.length;\r\n    \r\n    // Check if citations are valid (have title and either quizId or url)\r\n    result.citations.forEach(citation => {\r\n      if (citation.title && (citation.quizId || citation.url)) {\r\n        validCitations++;\r\n      }\r\n    });\r\n  });\r\n\r\n  if (totalCitations === 0) return 0;\r\n  return (validCitations / totalCitations) * 100;\r\n}\r\n\r\n/**\r\n * Main test runner\r\n */\r\nasync function main() {\r\n  console.log('üöÄ Starting RAG Chatbot Test Suite\\n');\r\n  console.log('=' .repeat(60));\r\n\r\n  try {\r\n    // Initialize Firebase\r\n    console.log('üì± Initializing Firebase...');\r\n    const app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\r\n    const auth = getAuth(app);\r\n\r\n    // Sign in (use test account or admin account)\r\n    // For testing, you may need to create a test account first\r\n    console.log('üîê Authenticating...');\r\n    console.log('‚ö†Ô∏è  Note: Using current Firebase auth state');\r\n    console.log('   If not authenticated, some tests may fail\\n');\r\n\r\n    const userId = auth.currentUser?.uid || 'test-user-id';\r\n    if (!auth.currentUser) {\r\n      console.log('‚ö†Ô∏è  Warning: No authenticated user. Tests may not work correctly.\\n');\r\n    }\r\n\r\n    // Run tests\r\n    console.log('=' .repeat(60));\r\n    console.log('Running tests...\\n');\r\n\r\n    const results: Array<{ passed: boolean; result: RAGResponse }> = [];\r\n\r\n    for (const testCase of testCases) {\r\n      const result = await runTest(testCase, userId);\r\n      results.push(result);\r\n      \r\n      // Wait between tests to avoid rate limiting\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n    }\r\n\r\n    // Calculate statistics\r\n    console.log('\\n' + '='.repeat(60));\r\n    console.log('üìä Test Results Summary\\n');\r\n\r\n    const stats: TestStats = {\r\n      total: results.length,\r\n      passed: results.filter(r => r.passed).length,\r\n      failed: results.filter(r => !r.passed).length,\r\n      averageLatency: results.reduce((sum, r) => sum + r.result.processingTime, 0) / results.length,\r\n      citationAccuracy: calculateCitationAccuracy(results.map(r => r.result)),\r\n    };\r\n\r\n    console.log(`Total Tests: ${stats.total}`);\r\n    console.log(`‚úÖ Passed: ${stats.passed}`);\r\n    console.log(`‚ùå Failed: ${stats.failed}`);\r\n    console.log(`‚è±Ô∏è  Average Latency: ${stats.averageLatency.toFixed(0)}ms`);\r\n    console.log(`üìö Citation Accuracy: ${stats.citationAccuracy.toFixed(1)}%`);\r\n    console.log();\r\n\r\n    // Performance evaluation\r\n    console.log('üéØ Performance Evaluation:');\r\n    \r\n    const latencyTarget = 2500;\r\n    const citationTarget = 90;\r\n\r\n    if (stats.averageLatency <= latencyTarget) {\r\n      console.log(`   ‚úÖ Latency: PASS (target: < ${latencyTarget}ms)`);\r\n    } else {\r\n      console.log(`   ‚ùå Latency: FAIL (target: < ${latencyTarget}ms)`);\r\n    }\r\n\r\n    if (stats.citationAccuracy >= citationTarget) {\r\n      console.log(`   ‚úÖ Citation Accuracy: PASS (target: ‚â• ${citationTarget}%)`);\r\n    } else {\r\n      console.log(`   ‚ö†Ô∏è  Citation Accuracy: NEEDS IMPROVEMENT (target: ‚â• ${citationTarget}%)`);\r\n    }\r\n\r\n    console.log('\\n' + '='.repeat(60));\r\n\r\n    // Exit with appropriate code\r\n    if (stats.failed === 0 && stats.averageLatency <= latencyTarget && stats.citationAccuracy >= citationTarget) {\r\n      console.log('üéâ All tests passed! RAG chatbot is production-ready.\\n');\r\n      process.exit(0);\r\n    } else {\r\n      console.log('‚ö†Ô∏è  Some tests failed or performance targets not met. Review the results above.\\n');\r\n      process.exit(1);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Test suite failed:', error);\r\n    process.exit(1);\r\n  }\r\n}\r\n\r\nmain();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\App.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Suspense' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslation' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":75},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Router' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":125,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":131},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Routes' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":133,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":139},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Route' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":141,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":146},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Navigate' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":148,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":156},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Provider' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":192,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":200},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSelector' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":202,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":213},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useDispatch' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":215,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":226},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'store' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":257,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":262},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RootState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":264,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":273},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onAuthStateChanged' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":304,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":322},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'auth' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":355,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":359},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'db' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":361,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":363},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'doc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":404,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":407},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":409,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":415},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":417,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":423},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'serverTimestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":425,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":440},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loginSuccess' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":478,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":490},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logout' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":492,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":498},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'authCheckComplete' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":500,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":517},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'I18nProvider' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":556,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":568}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":24,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useEffect, Suspense } from 'react';import { useTranslation } from 'react-i18next';import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';import { Provider, useSelector, useDispatch } from 'react-redux';import { store, RootState } from './lib/store';import { onAuthStateChanged } from 'firebase/auth';import { auth, db } from './lib/firebase/config';import { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';import { loginSuccess, logout, authCheckComplete } from './features/auth/store';import I18nProvider from './shared/components/I18nProvider';// Stage 1: Basic Landing & Authenticationimport { LandingPage } from './shared/pages/LandingPage';// Stage 2: Authentication Pagesimport AuthPageNew from './features/auth/pages/AuthPageNew';// Removed RegisterPage import as the file has been deleted// Stage 2: Basic User Features - Lazy loadedconst Dashboard = React.lazy(() => import('./shared/pages/Dashboard'));const QuizList = React.lazy(() => import('./features/quiz/pages/QuizList'));const QuizPage = React.lazy(() => import('./features/quiz/pages/QuizPage'));const QuizPreviewPage = React.lazy(() => import('./features/quiz/pages/QuizPreviewPage'));const QuizReviewsPage = React.lazy(() => import('./features/quiz/pages/QuizReviewsPage'));const RealQuizListPage = React.lazy(() => import('./features/quiz/pages/RealQuizListPage'));const QuizResultViewer = React.lazy(() => import('./features/quiz/pages/QuizResultViewer'));const LearningMaterialsPage = React.lazy(() => import('./features/quiz/pages/LearningMaterialsPage'));const Profile = React.lazy(() => import('./features/auth/pages/Profile'));const FavoritesPage = React.lazy(() => import('./features/quiz/pages/FavoritesPage'));const LeaderboardPage = React.lazy(() => import('./features/quiz/pages/LeaderboardPage'));// Stage 3: Creator Features (REMOVED - Creator role eliminated)const CreateQuizPage = React.lazy(() => import('./features/quiz/pages/CreateQuizPage'));// Offline Management// const OfflineSettingsPage = React.lazy(() => import('./pages/OfflineSettingsPage'));// import { OfflineStatusIndicator } from './components/OfflineStatusIndicator';const EditQuizPageAdvanced = React.lazy(() => import('./features/quiz/pages/EditQuizPageAdvanced'));const CreatorLayout = React.lazy(() => import('./features/creator/layouts/CreatorLayout'));// Stage 4: New Features - Offline & Multiplayer// const OfflineQuizManager = React.lazy(() => import('./features/offline/components/OfflineQuizManager'));const MultiplayerLobby = React.lazy(() => import('./features/multiplayer/pages/MultiplayerLobby'));const MultiplayerPage = React.lazy(() => import('./features/multiplayer/pages/MultiplayerPage'));const MyQuizzesPage = React.lazy(() => import('./features/quiz/pages/MyQuizzesPage'));const QuizDetailedStats = React.lazy(() => import('./features/quiz/pages/QuizDetailedStats'));// Stage 4: Admin Features - All lazy loaded for better performanceconst Admin = React.lazy(() => import('./features/admin/pages/Admin'));const AdminQuizManagement = React.lazy(() => import('./features/admin/pages/AdminQuizManagement'));const AdminUserManagement = React.lazy(() => import('./features/admin/pages/AdminUserManagement'));const BuildIndexPage = React.lazy(() => import('./features/admin/pages/BuildIndexPage'));// RAG Chatbotimport { ChatbotButton } from './components/rag';const StatsDashboard = React.lazy(() => import('./features/admin/pages/StatsDashboard'));const CategoryManagement = React.lazy(() => import('./features/admin/pages/CategoryManagement'));const AdminStats = React.lazy(() => import('./features/admin/components/AdminStats'));const AdminUtilities = React.lazy(() => import('./features/admin/components/AdminUtilities'));// Stage 5: Advanced Componentsimport { Layout } from './shared/components/layout/Layout';import { NotFound } from './shared/components/layout/NotFound';import ErrorBoundary from './shared/components/ErrorBoundary';import RoleSelection from './features/auth/components/RoleSelection';import ProtectedRoute from './features/auth/components/ProtectedRoute';import AutoLogoutOnBan from './features/auth/components/AutoLogoutOnBan';import AdminProtectedRoute from './features/admin/components/AdminProtectedRoute';import NotificationBanner from './shared/components/NotificationBanner';import RoleBasedRedirect from './shared/components/RoleBasedRedirect';import ScrollToTop from './shared/components/ScrollToTop';import { ToastContainer } from 'react-toastify';import 'react-toastify/dist/ReactToastify.css';const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {  const dispatch = useDispatch();  useEffect(() => {    const mounted = true;    // Set timeout ƒë·ªÉ tr√°nh loading v√¥ h·∫°n    const timeout = setTimeout(() => {      if (mounted) {        dispatch(authCheckComplete());      }    }, 5000); // TƒÉng l√™n 5 gi√¢y ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªß th·ªùi gian    const unsubscribe = onAuthStateChanged(auth, async (user) => {      if (!mounted) return;      clearTimeout(timeout); // Clear timeout n·∫øu auth check th√†nh c√¥ng            console.log('üîê Auth state changed:', {        user: user ? {          uid: user.uid,          email: user.email,          displayName: user.displayName,          emailVerified: user.emailVerified        } : null,        timestamp: new Date().toISOString()      });            if (user) {        try {          // Get role from Firestore tr∆∞·ªõc khi check email verification          const userDocRef = doc(db, 'users', user.uid);          const userDoc = await getDoc(userDocRef);                    let role: 'admin' | 'creator' | 'user' = 'user';          let userData = null;                    if (userDoc.exists()) {            userData = userDoc.data();                        // Check if user is deleted or inactive            if (userData.isDeleted || userData.isActive === false) {              console.log('üö´ User account is deleted/inactive, logging out');              await auth.signOut();              dispatch(logout());              dispatch(authCheckComplete());              return;            }                        role = userData.role || 'user';            console.log('‚úÖ Found user document:', { uid: user.uid, role, userData });                        // Ch·ªâ check email verification cho user th∆∞·ªùng, kh√¥ng ph·∫£i admin            if (!user.emailVerified && user.email !== 'admin123@gmail.com' && role !== 'admin') {              console.log('üìß Email not verified for regular user, redirecting to verification');              // Kh√¥ng sign out ngay, ƒë·ªÉ user c√≥ c∆° h·ªôi verify email              // await auth.signOut();              // dispatch(logout());              // dispatch(authCheckComplete());              // return;            }          } else if (user.email === 'admin123@gmail.com') {            role = 'admin';            console.log('üëë Creating admin user document');            // Create admin document if it doesn't exist            try {              await setDoc(userDocRef, {                email: user.email,                displayName: user.displayName || 'Admin',                role: 'admin',                createdAt: serverTimestamp(), // S·ª≠ d·ª•ng serverTimestamp thay v√¨ Date                isActive: true,                emailVerified: true              });            } catch (createError) {              console.error('Error creating admin document:', createError);            }          } else {            // User m·ªõi ch∆∞a c√≥ document trong Firestore - c√≥ th·ªÉ l√† user v·ª´a ƒëƒÉng k√Ω            console.log('üÜï User document not found for:', user.email);                        // Kh√¥ng t·ª± ƒë·ªông t·∫°o document n·ªØa, ƒë·ªÉ LoginPage x·ª≠ l√Ω            // Ch·ªâ fallback n·∫øu l√† admin email ƒë·∫∑c bi·ªát            if (user.email === 'admin123@gmail.com') {              console.log('üëë Creating admin user document');              try {                await setDoc(userDocRef, {                  email: user.email,                  displayName: user.displayName || 'Admin',                  role: 'admin',                  createdAt: serverTimestamp(), // S·ª≠ d·ª•ng serverTimestamp thay v√¨ Date                  isActive: true                });                role = 'admin';              } catch (createError) {                console.error('Error creating admin document:', createError);              }            } else {              // User th∆∞·ªùng kh√¥ng c√≥ document - c√≥ th·ªÉ ch∆∞a ho√†n th√†nh ƒëƒÉng k√Ω              console.log('‚ö†Ô∏è Regular user without document, might need role selection');              // Kh√¥ng set role, ƒë·ªÉ component x·ª≠ l√Ω              role = undefined as any;            }          }          const authUser = {            uid: user.uid,            email: user.email,            displayName: user.displayName,            photoURL: user.photoURL,            emailVerified: user.emailVerified,            role: role,            needsRoleSelection: userData?.needsRoleSelection || (!role && role !== 'admin'), // Admin kh√¥ng c·∫ßn ch·ªçn role            createdAt: userData?.createdAt ?               (userData.createdAt.toDate ? userData.createdAt.toDate().toISOString() :                userData.createdAt instanceof Date ? userData.createdAt.toISOString() :                userData.createdAt) :               new Date().toISOString(), // Convert Date to ISO string          };                    console.log('üìù Dispatching loginSuccess with:', authUser);          dispatch(loginSuccess(authUser));                    // Force re-render ƒë·ªÉ c·∫≠p nh·∫≠t UI ngay l·∫≠p t·ª©c          setTimeout(() => {            console.log('üîÑ Force state refresh for UI update');            dispatch(loginSuccess(authUser));          }, 100);        } catch (error) {          console.error('Error getting user role:', error);          // Fallback role v·ªõi check admin email ch√≠nh x√°c h∆°n          const fallbackRole: 'admin' | 'user' = user.email === 'admin123@gmail.com' ? 'admin' : 'user';          const authUser = {            uid: user.uid,            email: user.email,            displayName: user.displayName,            photoURL: user.photoURL,            emailVerified: user.emailVerified,            role: fallbackRole,            createdAt: new Date().toISOString(), // Convert Date to ISO string          };                    console.log('üìù Dispatching fallback loginSuccess with:', authUser);          dispatch(loginSuccess(authUser));                    // Force re-render cho fallback c≈©ng c·∫ßn          setTimeout(() => {            console.log('üîÑ Force state refresh for fallback user');            dispatch(loginSuccess(authUser));          }, 100);        }      } else {        dispatch(logout());      }      dispatch(authCheckComplete());    });        return () => {      clearTimeout(timeout);      unsubscribe();    };  }, [dispatch]);  return <>{children}</>;};// Th√™m LoadingFallback component n·∫øu ch∆∞a c√≥const LoadingFallback = () => {  const { t } = useTranslation();  return (    <div className=\"flex items-center justify-center min-h-screen\">      <div className=\"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>      <span className=\"ml-3 text-lg font-medium text-gray-700\">{t('loading', 'ƒêang t·∫£i...')}</span>    </div>  );};// C·∫≠p nh·∫≠t AppContent ƒë·ªÉ ƒë·∫£m b·∫£o m·ªçi lazy component ƒë·ªÅu ƒë∆∞·ª£c b·ªçc trong Suspenseconst AppContent: React.FC = () => {  const { t } = useTranslation();  const { user, isLoading, authChecked, isAuthenticated, needsRoleSelection } = useSelector((state: RootState) => state.auth);  console.log('üì± AppContent render:', {    user: user ? { uid: user.uid, email: user.email, role: user.role } : null,    isLoading,    authChecked,    isAuthenticated,    needsRoleSelection  });  // Show loading while checking authentication  if (isLoading || !authChecked) {    console.log('üì± App: Showing loading screen', { isLoading, authChecked });    return (      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mb-4\"></div>          <div className=\"text-xl font-semibold text-gray-700\">{t('loadingData', 'ƒêang t·∫£i d·ªØ li·ªáu...')}</div>          <div className=\"text-sm text-gray-500 mt-2\">{t('pleaseWait', 'Vui l√≤ng ƒë·ª£i m·ªôt ch√∫t')}</div>          {isLoading && <div className=\"text-xs text-gray-400 mt-1\">{t('checkingAuth', 'ƒêang ki·ªÉm tra x√°c th·ª±c...')}</div>}        </div>      </div>    );  }  // Show role selection if user needs to choose a role  if (isAuthenticated && user && needsRoleSelection) {    console.log('üì± App: Showing role selection screen');        const handleRoleSelected = (role: 'user' | 'creator') => {      console.log('üéØ Role selected:', role);            // Navigate theo role v·ªõi proper redirect      setTimeout(() => {        if (role === 'creator') {          window.location.href = '/creator';        } else if (role === 'user') {          window.location.href = '/dashboard';        }      }, 1500); // Increase delay ƒë·ªÉ user th·∫•y ƒë∆∞·ª£c toast message    };        return <RoleSelection user={user} onRoleSelected={handleRoleSelected} />;  }  return (    <div>      {/* <OfflineStatusIndicator /> */}      <Routes>        {/* Stage 1: Landing Routes */}        <Route path=\"/landing\" element={<LandingPage />} />                {/* Stage 2: Authentication Routes */}        <Route path=\"/login\" element={!isAuthenticated ? <AuthPageNew /> : <Navigate to=\"/dashboard\" replace />} />                {/* Stage 2: Basic User Routes - Wrap with Suspense */}        <Route path=\"/dashboard\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <Dashboard />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/profile\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <Profile />            </Suspense>          </ProtectedRoute>        } />                {/* <Route path=\"/offline\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <OfflineSettingsPage />            </Suspense>          </ProtectedRoute>        } /> */}                <Route path=\"/quizzes\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizList />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz/:id\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizPage />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz/:id/learn\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <LearningMaterialsPage />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz/:id/preview\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizPreviewPage />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz/:id/reviews\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizReviewsPage />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/real-quizzes\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <RealQuizListPage />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz/:id/edit\" element={          <ProtectedRoute requiredRole=\"admin\">            <Suspense fallback={<LoadingFallback />}>              <EditQuizPageAdvanced />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/quiz-result/:resultId\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizResultViewer />            </Suspense>          </ProtectedRoute>        } />                {/* Stage 3: Creator Routes - NEW NESTED STRUCTURE */}                <Route path=\"/creator\" element={          <Suspense fallback={<LoadingFallback />}>            <CreatorLayout />          </Suspense>        }>          {/* Index route redirects to my-quizzes */}          <Route index element={<Navigate to=\"my\" replace />} />                    {/* My Quizzes sub-route */}          <Route path=\"my\" element={            <Suspense fallback={<LoadingFallback />}>              <MyQuizzesPage />            </Suspense>          } />                    {/* Create New Quiz sub-route */}          <Route path=\"new\" element={            <Suspense fallback={<LoadingFallback />}>              <CreateQuizPage />            </Suspense>          } />        </Route>        {/* Legacy route redirects for backward compatibility */}        <Route path=\"/create-quiz\" element={<Navigate to=\"/creator/new\" replace />} />        <Route path=\"/my-quizzes\" element={<Navigate to=\"/creator/my\" replace />} />        <Route path=\"/quiz-stats/:id\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <QuizDetailedStats />            </Suspense>          </ProtectedRoute>        } />                {/* Stage 4: Admin Routes - Wrap with Suspense */}        <Route path=\"/admin\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <Admin />            </Suspense>          </AdminProtectedRoute>        } />                {/* Redirect old admin/dashboard to admin/quiz-management */}        <Route path=\"/admin/dashboard\" element={<Navigate to=\"/admin/quiz-management\" replace />} />                <Route path=\"/admin/quiz-management\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <AdminQuizManagement />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/users\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <AdminUserManagement />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/roles\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <AdminUserManagement />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/quiz-stats\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <StatsDashboard />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/categories\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <CategoryManagement />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/stats-test\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <AdminStats />            </Suspense>          </AdminProtectedRoute>        } />        <Route path=\"/admin/utilities\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <AdminUtilities />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/edit-quiz/:id\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <EditQuizPageAdvanced />            </Suspense>          </AdminProtectedRoute>        } />                <Route path=\"/admin/build-index\" element={          <AdminProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <BuildIndexPage />            </Suspense>          </AdminProtectedRoute>        } />                {/* Admin/creators route REMOVED - Creator Management eliminated */}                <Route path=\"/real-quizzes\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <RealQuizListPage />            </Suspense>          </ProtectedRoute>        } />                {/* Stage 4: New Features - Offline & Multiplayer */}        <Route path=\"/offline\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              {/* <OfflineQuizManager /> */}              // eslint-disable-next-line i18next/no-literal-string              <div>Offline feature coming soon</div>            </Suspense>          </ProtectedRoute>        } />                {/* Multiplayer Routes - Use MultiplayerLobby for quiz selection */}        <Route path=\"/multiplayer\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <MultiplayerLobby />            </Suspense>          </ProtectedRoute>        } />                <Route path=\"/multiplayer/game\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <MultiplayerPage />            </Suspense>          </ProtectedRoute>        } />                {/* Stage 5: Utility & Error Routes */}        <Route path=\"/role-selection\" element={          <ProtectedRoute>            {user && (              <RoleSelection                 user={user}                 onRoleSelected={(role) => {                  if (role === 'creator') {                    window.location.href = '/creator';                  } else if (role === 'user') {                    window.location.href = '/dashboard';                  }                }}               />            )}          </ProtectedRoute>        } />                <Route path=\"/favorites\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <FavoritesPage />            </Suspense>          </ProtectedRoute>        } />        <Route path=\"/leaderboard\" element={          <ProtectedRoute>            <Suspense fallback={<LoadingFallback />}>              <LeaderboardPage />            </Suspense>          </ProtectedRoute>        } />                {/* Default route - role-based redirect */}        <Route path=\"/\" element={<RoleBasedRedirect />} />        <Route path=\"*\" element={<NotFound />} />      </Routes>    </div>  );};function App() {  return (    <Router>      <Provider store={store}>        <I18nProvider>          <AuthProvider>            <ErrorBoundary>              <div className=\"app-container\">                <NotificationBanner />                {/* <OfflineStatusIndicator /> */}                <ScrollToTop />                <Layout>                  <AutoLogoutOnBan />                  <AppContent />                  <ToastContainer position=\"top-right\" autoClose={3000} hideProgressBar newestOnTop closeOnClick pauseOnFocusLoss draggable pauseOnHover aria-label=\"notification\" />                </Layout>                {/* AI Chatbot - Floating button at bottom-right */}                <ChatbotButton />              </div>            </ErrorBoundary>          </AuthProvider>        </I18nProvider>      </Provider>    </Router>  );}export default App;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\ClientSideAIGenerator.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":15032,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { toast } from 'react-toastify';import { FirebaseAIService } from '../features/quiz/services/firebaseAIService';import { FileProcessor } from '../services/fileProcessor';import { Sparkles, Wand2, CheckCircle, XCircle, RefreshCw, Upload, File, Image, FileText } from 'lucide-react';import { useTranslation } from 'react-i18next';interface Question {  text: string;  answers: Array<{    text: string;    isCorrect: boolean;  }>;}interface AIGeneratorProps {  onQuestionsGenerated: (questions: Question[]) => void;}const ClientSideAIGenerator: React.FC<AIGeneratorProps> = ({ onQuestionsGenerated }) => {  const { t } = useTranslation();  const [isGenerating, setIsGenerating] = useState(false);  const [isTesting, setIsTesting] = useState(false);  const [isProcessingFile, setIsProcessingFile] = useState(false);  const [connectionStatus, setConnectionStatus] = useState<'idle' | 'connected' | 'failed'>('idle');  const [uploadedFile, setUploadedFile] = useState<File | null>(null);  const [fileContent, setFileContent] = useState<string>('');  const [formData, setFormData] = useState({    topic: '',    difficulty: 'easy' as 'easy' | 'medium' | 'hard',    numQuestions: 5,    useFileContent: false  });  const testConnection = async () => {    setIsTesting(true);    try {      // Test b·∫±ng c√°ch g·ªçi Cloud Function testAI      const available = await FirebaseAIService.checkAvailability();      if (available) {        setConnectionStatus('connected');        toast.success(t('aiGenerator.cloudConnectionSuccess'));      } else {        setConnectionStatus('failed');        toast.error(t('aiGenerator.cloudConnectionFailed'));      }    } catch (error) {      setConnectionStatus('failed');      toast.error(t('aiGenerator.cloudConnectionError'));      console.error('Test connection error:', error);    } finally {      setIsTesting(false);    }  };  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {    const file = event.target.files?.[0];    if (!file) return;    // Validate file extension    const fileName = file.name.toLowerCase();    const allowedExtensions = ['.jpg', '.jpeg', '.png', '.pdf', '.doc', '.docx', '.txt'];    const hasValidExtension = allowedExtensions.some(ext => fileName.endsWith(ext));        if (!hasValidExtension) {      toast.error(t('aiGenerator.invalidFile', { extensions: allowedExtensions.join(', ') }));      event.target.value = ''; // Clear input      return;    }    // Validate file size (max 10MB)    const maxSize = 10 * 1024 * 1024; // 10MB    if (file.size > maxSize) {      toast.error(t('aiGenerator.fileTooLarge'));      event.target.value = ''; // Clear input      return;    }    setIsProcessingFile(true);    try {      const apiKey = import.meta.env.VITE_GEMINI_API_KEY;      if (!apiKey) {        toast.error(t('aiGenerator.apiKeyNotConfigured'));        return;      }      const fileProcessor = new FileProcessor(apiKey);      const result = await fileProcessor.processFile(file);            if (result.content && !result.error) {        setUploadedFile(file);        setFileContent(result.content);        setFormData(prev => ({           ...prev,           topic: result.content?.substring(0, 100) + '...' || prev.topic,          useFileContent: true         }));        toast.success(t('aiGenerator.fileProcessedSuccess', { fileName: file.name }));      } else {        toast.error(result.error || t('aiGenerator.fileProcessFailed'));      }    } catch (error) {      console.error('File processing error:', error);      toast.error(t('aiGenerator.fileProcessingError'));    } finally {      setIsProcessingFile(false);    }  };  const removeUploadedFile = () => {    setUploadedFile(null);    setFileContent('');    setFormData(prev => ({ ...prev, useFileContent: false }));  };  const generateQuestions = async () => {    const topicToUse = formData.useFileContent && fileContent       ? t('aiGenerator.topicFromFile', { content: fileContent, topic: formData.topic })      : formData.topic;    if (!topicToUse.trim()) {      toast.error(t('aiGenerator.topicOrFileRequiredShort'));      return;    }    setIsGenerating(true);    try {      // G·ªçi Firebase Cloud Function ƒë·ªÉ generate c√¢u h·ªèi      const questions = await FirebaseAIService.generateQuestions(        {           model: 'gemini-2.0-flash-exp',          temperature: 0.7         },        {          content: topicToUse,          numQuestions: formData.numQuestions,          difficulty: formData.difficulty,          language: 'vi'        }      );      if (questions && questions.length > 0) {        // Convert to simple format        const simpleQuestions = questions.map(q => ({          text: q.text,          answers: q.answers.map(a => ({            text: a.text,            isCorrect: a.isCorrect          }))        }));        onQuestionsGenerated(simpleQuestions);        toast.success(t('aiGenerator.generateSuccess', { count: questions.length }));                // Reset form        setFormData({          topic: '',          difficulty: 'easy',          numQuestions: 5,          useFileContent: false        });                // Reset file state        setUploadedFile(null);        setFileContent('');      } else {        toast.error(t('aiGenerator.generateEmpty'));      }    } catch (error) {      console.error('Generation error:', error);      const errorMsg = error instanceof Error ? error.message : t('aiGenerator.unknownError');      toast.error(t('aiGenerator.generateErrorDetailed', { message: errorMsg }));    } finally {      setIsGenerating(false);    }  };  const getDifficultyLabel = (difficulty: string) => {    switch (difficulty) {      case 'easy': return t('aiGenerator.difficulty.easy');      case 'medium': return t('aiGenerator.difficulty.medium');      case 'hard': return t('aiGenerator.difficulty.hard');      default: return difficulty;    }  };  const getConnectionIcon = () => {    switch (connectionStatus) {      case 'connected': return <CheckCircle className=\"w-4 h-4 text-green-500\" />;      case 'failed': return <XCircle className=\"w-4 h-4 text-red-500\" />;      default: return <Sparkles className=\"w-4 h-4 text-gray-400\" />;    }  };  return (    <div className=\"bg-gradient-to-br from-purple-50 to-blue-50 border border-purple-200 rounded-xl p-6\">      <div className=\"flex items-center justify-between mb-6\">        <div className=\"flex items-center gap-3\">          <div className=\"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">            <Wand2 className=\"w-5 h-5 text-white\" />          </div>          <div>            <h3 className=\"text-lg font-bold text-gray-900\">ü§ñ {t('aiGenerator.title')}</h3>            <p className=\"text-sm text-gray-600\">{t('aiGenerator.subtitle')}</p>          </div>        </div>                <div className=\"flex items-center gap-2\">          {getConnectionIcon()}          <button            onClick={testConnection}            disabled={isTesting}            className=\"px-3 py-1.5 text-xs bg-white border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 flex items-center gap-2\"          >            {isTesting ? (              <RefreshCw className=\"w-3 h-3 animate-spin\" />            ) : (              <Sparkles className=\"w-3 h-3\" />            )}            {t('aiGenerator.testConnection')}          </button>        </div>      </div>      <div className=\"space-y-4\">        {/* Topic Input */}        <div>          <label className=\"block text-sm font-medium text-gray-700 mb-2\">            üìö {t('aiGenerator.topic')}          </label>          <input            type=\"text\"            value={formData.topic}            onChange={(e) => setFormData({ ...formData, topic: e.target.value })}            placeholder={t('aiGenerator.topicPlaceholder')}            className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"          />        </div>        {/* File Upload Section */}        <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-purple-400 transition-colors\">          <div className=\"text-center\">            <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />            <div className=\"mt-4\">              <label htmlFor=\"file-upload\" className=\"cursor-pointer\">                <span className=\"mt-2 block text-sm font-medium text-gray-900\">                  üìé {t('aiGenerator.uploadFile')}                </span>                <span className=\"mt-1 block text-xs text-gray-500\">                  {t('aiGenerator.supportedFormats')}                </span>                <span className=\"mt-2 inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\">                  <Upload className=\"w-4 h-4 mr-2\" />                  {t('aiGenerator.chooseFile')}                </span>              </label>              <input                id=\"file-upload\"                type=\"file\"                className=\"sr-only\"                accept=\".jpg,.jpeg,.png,.pdf,.doc,.docx,.txt\"                onChange={handleFileUpload}                disabled={isProcessingFile}              />            </div>          </div>          {/* Display uploaded file */}          {uploadedFile && (            <div className=\"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg\">              <div className=\"flex items-center justify-between\">                <div className=\"flex items-center space-x-2\">                  {uploadedFile.type.startsWith('image/') ? (                    <Image className=\"w-5 h-5 text-green-600\" />                  ) : uploadedFile.type === 'application/pdf' ? (                    <FileText className=\"w-5 h-5 text-red-600\" />                  ) : uploadedFile.type.includes('document') || uploadedFile.type.includes('word') ? (                    <File className=\"w-5 h-5 text-blue-600\" />                  ) : (                    <FileText className=\"w-5 h-5 text-gray-600\" />                  )}                  <div>                    <p className=\"text-sm font-medium text-green-800\">{uploadedFile.name}</p>                    <p className=\"text-xs text-green-600\">                      // eslint-disable-next-line i18next/no-literal-string                      {(uploadedFile.size / 1024 / 1024).toFixed(2)} MB - {t('aiGenerator.processedSuccess')}                    </p>                  </div>                </div>                <button                  onClick={removeUploadedFile}                  className=\"text-green-600 hover:text-green-800\"                >                  <XCircle className=\"w-5 h-5\" />                </button>              </div>            </div>          )}          {/* Processing indicator */}          {isProcessingFile && (            <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">              <div className=\"flex items-center space-x-2\">                <RefreshCw className=\"w-5 h-5 text-blue-600 animate-spin\" />                <span className=\"text-sm text-blue-700\">{t('aiGenerator.processingFile')}</span>              </div>            </div>          )}        </div>        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">          {/* Difficulty Select */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              üéØ {t('aiGenerator.difficulty')}            </label>            <select              value={formData.difficulty}              onChange={(e) => setFormData({ ...formData, difficulty: e.target.value as any })}              className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"            >              <option value=\"easy\">üü¢ {t('aiGenerator.difficultyEasy')}</option>              <option value=\"medium\">üü° {t('aiGenerator.difficultyMedium')}</option>              <option value=\"hard\">üî¥ {t('aiGenerator.difficultyHard')}</option>            </select>          </div>          {/* Number of Questions */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              üî¢ {t('aiGenerator.numQuestions')}            </label>            <select              value={formData.numQuestions}              onChange={(e) => setFormData({ ...formData, numQuestions: parseInt(e.target.value) })}              className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"            >              <option value={3}>3 {t('aiGenerator.questions')}</option>              <option value={5}>5 {t('aiGenerator.questions')}</option>              <option value={10}>10 {t('aiGenerator.questions')}</option>              <option value={15}>15 {t('aiGenerator.questions')}</option>              <option value={20}>20 {t('aiGenerator.questions')}</option>            </select>          </div>        </div>        {/* Generate Button */}        <button          onClick={generateQuestions}          disabled={isGenerating || (!formData.topic.trim() && !fileContent)}          className=\"w-full px-6 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold rounded-lg hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center gap-3\"        >          {isGenerating ? (            <>              <RefreshCw className=\"w-5 h-5 animate-spin\" />              ƒêang t·∫°o c√¢u h·ªèi...            </>          ) : (            <>              // eslint-disable-next-line i18next/no-literal-string              <Wand2 className=\"w-5 h-5\" />              // eslint-disable-next-line i18next/no-literal-string              T·∫°o {formData.numQuestions} c√¢u h·ªèi {getDifficultyLabel(formData.difficulty)}              {formData.useFileContent && ' t·ª´ file'}            </>          )}        </button>        {/* Info */}        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">          // eslint-disable-next-line i18next/no-literal-string          <h4 className=\"text-sm font-medium text-blue-800 mb-2\">üí° Th√¥ng tin:</h4>          <ul className=\"text-sm text-blue-700 space-y-1\">            // eslint-disable-next-line i18next/no-literal-string            <li>‚Ä¢ S·ª≠ d·ª•ng Firebase Cloud Functions + Google Gemini AI</li>            // eslint-disable-next-line i18next/no-literal-string            <li>‚Ä¢ Model: gemini-2.0-flash-exp (m·ªõi nh·∫•t)</li>            // eslint-disable-next-line i18next/no-literal-string            <li>‚Ä¢ X·ª≠ l√Ω th√¥ng qua server (b·∫£o m·∫≠t API key)</li>            // eslint-disable-next-line i18next/no-literal-string            <li>‚Ä¢ <strong>M·ªõi:</strong> H·ªó tr·ª£ ƒë·ªçc file ·∫£nh, PDF, Word, Text</li>            // eslint-disable-next-line i18next/no-literal-string            <li>‚Ä¢ Kh√¥ng gi·ªõi h·∫°n quota client-side</li>          </ul>        </div>      </div>    </div>  );};export default ClientSideAIGenerator;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\ImageUploader.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":12051,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø/** * Image Uploader Component v·ªõi Preview v√† Progress Bar * T√≠ch h·ª£p v·ªõi Resize Images Extension */import React, { useState, useRef } from 'react';import { Upload, X, CheckCircle, Loader } from 'lucide-react';import { uploadImage, compressImage, instantUploadImage, UploadProgress, ImageUploadOptions, ImageUploadResult } from '../services/imageUploadService';import { toast } from 'react-toastify';import { useTranslation } from 'react-i18next';interface ImageUploaderProps {  onUploadSuccess: (result: ImageUploadResult) => void;  onUploadError?: (error: string) => void;  options?: ImageUploadOptions;  previewUrl?: string;  className?: string;  label?: string;  showThumbnails?: boolean;  compressBeforeUpload?: boolean;  instantUpload?: boolean; // üöÄ Upload ngay 1-3s (kh√¥ng compress, kh√¥ng ƒë·ª£i)  ultraFast?: boolean; // ‚ö° Upload nhanh nh·∫•t c√≥ th·ªÉ}export const ImageUploader: React.FC<ImageUploaderProps> = ({  onUploadSuccess,  onUploadError,  options = {},  previewUrl,  className = '',  label = 'T·∫£i ·∫£nh l√™n',  showThumbnails = false,  compressBeforeUpload = true,  instantUpload = false, // M·∫∑c ƒë·ªãnh false  ultraFast = false // ‚ö° Mode c·ª±c nhanh}) => {  const { t } = useTranslation();  const [preview, setPreview] = useState<string | undefined>(previewUrl);  const [uploading, setUploading] = useState(false);  const [progress, setProgress] = useState<UploadProgress | null>(null);  const [selectedFile, setSelectedFile] = useState<File | null>(null);  const [thumbnails, setThumbnails] = useState<{ small?: string; medium?: string; large?: string }>({});  const fileInputRef = useRef<HTMLInputElement>(null);  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {    const file = e.target.files?.[0];    if (!file) return;    // Validate file type    const allowedTypes = options.allowedTypes || ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];    if (!allowedTypes.includes(file.type)) {      toast.error(`Ch·ªâ ch·∫•p nh·∫≠n: ${allowedTypes.map(t => t.split('/')[1]).join(', ')}`);      return;    }    // Validate file size    const maxSizeKB = options.maxSizeKB || 5120;    const fileSizeKB = file.size / 1024;    if (fileSizeKB > maxSizeKB) {      toast.error(`K√≠ch th∆∞·ªõc file v∆∞·ª£t qu√° ${maxSizeKB}KB`);      return;    }    setSelectedFile(file);    // Show preview    const reader = new FileReader();    reader.onload = (event) => {      setPreview(event.target?.result as string);    };    reader.readAsDataURL(file);    // ‚ö° ULTRA FAST MODE: Upload ngay l·∫≠p t·ª©c (1-3s)    if (ultraFast || instantUpload) {      handleInstantUpload(file);    }  };  const handleInstantUpload = async (file: File) => {    setUploading(true);    setProgress(null);    setThumbnails({});    try {      toast.info(t('imageUploader.uploading'), { autoClose: 1000 });      // üöÄ Upload ngay - KH√îNG compress, KH√îNG ƒë·ª£i      const result = await instantUploadImage(        file,        options,        (uploadProgress: UploadProgress) => {          setProgress(uploadProgress);        }      );      if (result.success) {        toast.success(t('imageUploader.uploadFast'), { autoClose: 2000 });                if (result.thumbnailUrls && Object.keys(result.thumbnailUrls).length > 0) {          setThumbnails(result.thumbnailUrls);          toast.info(t('imageUploader.thumbnailsReady'), { autoClose: 1500 });        }                onUploadSuccess(result);      } else {        toast.error(result.error || 'Upload th·∫•t b·∫°i');        if (onUploadError) {          onUploadError(result.error || 'Upload failed');        }      }    } catch (error: any) {      console.error('Instant upload error:', error);      toast.error(t('imageUploader.uploadError'));      if (onUploadError) {        onUploadError(error.message);      }    } finally {      setUploading(false);      setProgress(null);    }  };  const handleUpload = async () => {    if (!selectedFile) {      toast.error(t('imageUploader.selectImageFirst'));      return;    }    setUploading(true);    setProgress(null);    setThumbnails({});    try {      let fileToUpload = selectedFile;      // Compress image if enabled      if (compressBeforeUpload && selectedFile.type !== 'image/gif') {        toast.info(t('imageUploader.compressing'), { autoClose: 1000 });        fileToUpload = await compressImage(selectedFile, 1920, 1080, 0.85, true); // WebP        toast.success(`ƒê√£ n√©n: ${Math.round(selectedFile.size / 1024)}KB ‚Üí ${Math.round(fileToUpload.size / 1024)}KB`, { autoClose: 1500 });      }      // Upload with progress callback      const result = await uploadImage(        fileToUpload,        options,        (uploadProgress) => {          setProgress(uploadProgress);        }      );      if (result.success) {        toast.success(t('imageUploader.uploadSuccess'));                if (result.thumbnailUrls && Object.keys(result.thumbnailUrls).length > 0) {          setThumbnails(result.thumbnailUrls);          toast.info(t('imageUploader.thumbnailsGenerated'), { autoClose: 2000 });        }                onUploadSuccess(result);      } else {        toast.error(result.error || 'Upload th·∫•t b·∫°i');        if (onUploadError) {          onUploadError(result.error || 'Upload failed');        }      }    } catch (error: any) {      console.error('Upload error:', error);      toast.error(t('imageUploader.uploadErrorDetailed'));      if (onUploadError) {        onUploadError(error.message);      }    } finally {      setUploading(false);      setProgress(null);    }  };  const handleRemove = () => {    setPreview(undefined);    setSelectedFile(null);    setProgress(null);    setThumbnails({});    if (fileInputRef.current) {      fileInputRef.current.value = '';    }  };  const handleDragOver = (e: React.DragEvent) => {    e.preventDefault();    e.stopPropagation();  };  const handleDrop = async (e: React.DragEvent) => {    e.preventDefault();    e.stopPropagation();    const file = e.dataTransfer.files?.[0];    if (file && file.type.startsWith('image/')) {      // Simulate file input change      const dataTransfer = new DataTransfer();      dataTransfer.items.add(file);      if (fileInputRef.current) {        fileInputRef.current.files = dataTransfer.files;        handleFileSelect({ target: { files: dataTransfer.files } } as any);      }    } else {      toast.error('Vui l√≤ng ch·ªçn file ·∫£nh');    }  };  return (    <div className={`image-uploader ${className}`}>      {/* Label */}      {label && (        <label className=\"block text-sm font-medium text-gray-700 mb-2\">          {label}        </label>      )}      {/* Upload Area */}      <div        className={`relative border-2 border-dashed rounded-lg transition-colors ${          preview ? 'border-blue-500 bg-blue-50' : 'border-gray-300 hover:border-blue-400'        }`}        onDragOver={handleDragOver}        onDrop={handleDrop}      >        {/* Preview */}        {preview ? (          <div className=\"relative\">            <img              src={preview}              alt=\"Preview\"              className=\"w-full h-64 object-cover rounded-lg\"            />            {!uploading && (              <button                onClick={handleRemove}                className=\"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors\"              >                <X className=\"w-4 h-4\" />              </button>            )}                        {/* Progress Overlay */}            {uploading && progress && (              <div className=\"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg\">                <div className=\"text-white text-center\">                  <Loader className=\"w-8 h-8 animate-spin mx-auto mb-2\" />                  <p className=\"text-lg font-semibold\">{progress.progress}%</p>                  <p className=\"text-sm\">                    // eslint-disable-next-line i18next/no-literal-string                    {Math.round(progress.bytesTransferred / 1024)}KB / {Math.round(progress.totalBytes / 1024)}KB                  </p>                </div>              </div>            )}          </div>        ) : (          // Upload Prompt          <div className=\"p-8 text-center\">            <Upload className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600 mb-2\">K√©o th·∫£ ·∫£nh v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</p>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-500\">              K√≠ch th∆∞·ªõc t·ªëi ƒëa: {options.maxSizeKB || 5120}KB            </p>            <input              ref={fileInputRef}              type=\"file\"              accept={options.allowedTypes?.join(',') || 'image/*'}              onChange={handleFileSelect}              className=\"hidden\"            />            <button              onClick={() => fileInputRef.current?.click()}              className=\"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"            // eslint-disable-next-line i18next/no-literal-string            >              Ch·ªçn ·∫£nh            </button>          </div>        )}      </div>      {/* Upload Button */}      {selectedFile && !uploading && (        <button          onClick={handleUpload}          disabled={uploading}          className=\"mt-4 w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center\"        >          {uploading ? (            <>              <Loader className=\"w-5 h-5 animate-spin mr-2\" />              ƒêang upload...            </>          ) : (            <>              // eslint-disable-next-line i18next/no-literal-string              <Upload className=\"w-5 h-5 mr-2\" />              Upload ·∫£nh            </>          )}        </button>      )}      {/* Thumbnails Preview */}      {showThumbnails && Object.keys(thumbnails).length > 0 && (        <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">          <div className=\"flex items-center mb-2\">            <CheckCircle className=\"w-5 h-5 text-green-600 mr-2\" />            // eslint-disable-next-line i18next/no-literal-string            <h4 className=\"font-semibold text-green-800\">Thumbnails ƒë√£ t·∫°o</h4>          </div>          <div className=\"grid grid-cols-3 gap-2\">            {thumbnails.small && (              <div className=\"text-center\">                <img src={thumbnails.small} alt=\"Small\" className=\"w-full h-20 object-cover rounded border\" />                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xs text-gray-600 mt-1\">200x200</p>              </div>            )}            {thumbnails.medium && (              <div className=\"text-center\">                <img src={thumbnails.medium} alt=\"Medium\" className=\"w-full h-20 object-cover rounded border\" />                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xs text-gray-600 mt-1\">400x400</p>              </div>            )}            {thumbnails.large && (              <div className=\"text-center\">                <img src={thumbnails.large} alt=\"Large\" className=\"w-full h-20 object-cover rounded border\" />                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xs text-gray-600 mt-1\">800x800</p>              </div>            )}          </div>        </div>      )}      {/* File Info */}      {selectedFile && (        <div className=\"mt-2 text-sm text-gray-600\">          // eslint-disable-next-line i18next/no-literal-string          <p>File: {selectedFile.name}</p>          // eslint-disable-next-line i18next/no-literal-string          <p>K√≠ch th∆∞·ªõc: {Math.round(selectedFile.size / 1024)}KB</p>          // eslint-disable-next-line i18next/no-literal-string          <p>Lo·∫°i: {selectedFile.type}</p>        </div>      )}    </div>  );};export default ImageUploader;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\ChatbotButton.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":3159,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø/** * üéØ Floating Chatbot Button *  * Floating action button to open the AI chatbot * Positioned in bottom-right corner * Only visible for authenticated users */import { useState } from 'react';import { motion } from 'framer-motion';import { MessageCircle, X, Sparkles } from 'lucide-react';import { ChatbotModal } from './ChatbotModal';import { useSelector } from 'react-redux';import { RootState } from '../../lib/store';export function ChatbotButton() {  const { user } = useSelector((state: RootState) => state.auth);  const [isOpen, setIsOpen] = useState(false);  const [isHovered, setIsHovered] = useState(false);  // Don't render if user is not authenticated  if (!user) {    return null;  }  return (    <>      {/* Floating Button - Positioned at bottom-left of scroll button */}      <motion.button        initial={{ scale: 0 }}        animate={{ scale: 1 }}        transition={{ type: 'spring', stiffness: 260, damping: 20 }}        onClick={() => setIsOpen(!isOpen)}        onMouseEnter={() => setIsHovered(true)}        onMouseLeave={() => setIsHovered(false)}        className=\"fixed bottom-6 right-24 z-40 w-14 h-14 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full shadow-2xl hover:shadow-purple-500/50 transition-all flex items-center justify-center group\"        aria-label=\"Open AI Chatbot\"        style={{           position: 'fixed',          bottom: '24px',          right: '96px', // 24px (right) + 56px (scroll button width) + 16px (gap) = 96px        }}      >        <motion.div          animate={{ rotate: isOpen ? 90 : 0 }}          transition={{ duration: 0.3 }}        >          {isOpen ? (            <X className=\"w-6 h-6 text-white\" />          ) : (            <MessageCircle className=\"w-6 h-6 text-white\" />          )}        </motion.div>        {/* Sparkle effect on hover */}        {isHovered && !isOpen && (          <motion.div            initial={{ opacity: 0, scale: 0.5 }}            animate={{ opacity: 1, scale: 1 }}            exit={{ opacity: 0, scale: 0.5 }}            className=\"absolute -top-1 -right-1\"          >            <Sparkles className=\"w-4 h-4 text-yellow-400\" />          </motion.div>        )}        {/* Pulse animation */}        {!isOpen && (          <span className=\"absolute inset-0 rounded-full bg-purple-600 animate-ping opacity-20\" />        )}      </motion.button>      {/* Tooltip */}      {isHovered && !isOpen && (        <motion.div          initial={{ opacity: 0, x: 10 }}          animate={{ opacity: 1, x: 0 }}          className=\"fixed bottom-6 z-40 px-4 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg whitespace-nowrap\"          style={{            position: 'fixed',            bottom: '24px',            right: '168px', // 96px (button right) + 56px (button width) + 16px (gap)          }}        // eslint-disable-next-line i18next/no-literal-string        >          H·ªèi AI Learning Assistant          <div className=\"absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2 rotate-45 w-2 h-2 bg-gray-900\" />        </motion.div>      )}      {/* Chatbot Modal */}      <ChatbotModal isOpen={isOpen} onClose={() => setIsOpen(false)} />    </>  );}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\ChatbotModal.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":15338,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø/** * ü§ñ AI Chatbot Modal Component *  * Modern full-screen chatbot interface similar to ChatGPT * Features: * - Full-screen overlay * - Message history * - Streaming-style typing animation * - Citation badges * - Mobile responsive * - Dark mode support */import React, { useState, useRef, useEffect } from 'react';import { motion, AnimatePresence } from 'framer-motion';import { X, Send, Sparkles, Book, AlertCircle } from 'lucide-react';import { useTranslation } from 'react-i18next';import { auth } from '../../lib/firebase/config';import { MessageList } from './MessageList';import { TypingIndicator } from './TypingIndicator';import type { RAGResponse, QuizRecommendation } from '../../lib/genkit/types';interface Message {  id: string;  role: 'user' | 'assistant';  content: string;  citations?: RAGResponse['citations'];  quizRecommendations?: QuizRecommendation[];  timestamp: number;  usedChunks?: number;  processingTime?: number;}interface ChatbotModalProps {  isOpen: boolean;  onClose: () => void;}export function ChatbotModal({ isOpen, onClose }: ChatbotModalProps) {  const { t } = useTranslation();  const currentUser = auth.currentUser;  const [messages, setMessages] = useState<Message[]>([]);  const [input, setInput] = useState('');  const [isLoading, setIsLoading] = useState(false);  const [error, setError] = useState<string | null>(null);  const inputRef = useRef<HTMLTextAreaElement>(null);  const messagesEndRef = useRef<HTMLDivElement>(null);  // Auto-scroll to bottom when new messages arrive  useEffect(() => {    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });  }, [messages]);  // Focus input when modal opens  useEffect(() => {    if (isOpen) {      setTimeout(() => inputRef.current?.focus(), 100);    }  }, [isOpen]);  // Handle send message  const handleSendMessage = async () => {    if (!input.trim() || isLoading || !currentUser) return;    const userMessage: Message = {      id: Date.now().toString(),      role: 'user',      content: input.trim(),      timestamp: Date.now(),    };    setMessages(prev => [...prev, userMessage]);    setInput('');    setIsLoading(true);    setError(null);    try {      // Call Cloud Function      const { getFunctions, httpsCallable } = await import('firebase/functions');      const functions = getFunctions();      const askRAG = httpsCallable(functions, 'askRAG');            const result = await askRAG({        question: userMessage.content,        topK: 4,        targetLang: 'vi'      });            const responseData = result.data as { success: boolean; data: any };            if (!responseData.success) {        throw new Error('Failed to get response from AI');      }            const aiResponse = responseData.data;            // Debug logging      console.log('ü§ñ AI Response:', aiResponse);      console.log('üìä Quiz Recommendations:', aiResponse.quizRecommendations);            const assistantMessage: Message = {        id: (Date.now() + 1).toString(),        role: 'assistant',        content: aiResponse.answer,        citations: aiResponse.citations || [],        quizRecommendations: aiResponse.quizRecommendations || [],        timestamp: Date.now(),        usedChunks: aiResponse.usedChunks || 0,        processingTime: aiResponse.processingTime || 0,      };      setMessages(prev => [...prev, assistantMessage]);    } catch (err) {      console.error('Error sending message:', err);      setError('ƒê√£ x·∫£y ra l·ªói. Vui l√≤ng th·ª≠ l·∫°i sau.');    } finally {      setIsLoading(false);    }  };  // Handle Enter key  const handleKeyDown = (e: React.KeyboardEvent) => {    if (e.key === 'Enter' && !e.shiftKey) {      e.preventDefault();      handleSendMessage();    }  };  if (!isOpen) return null;  return (    <AnimatePresence>      <motion.div        initial={{ opacity: 0 }}        animate={{ opacity: 1 }}        exit={{ opacity: 0 }}        className=\"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm\"        onClick={onClose}      >        <motion.div          initial={{ scale: 0.95, opacity: 0 }}          animate={{ scale: 1, opacity: 1 }}          exit={{ scale: 0.95, opacity: 0 }}          transition={{ type: 'spring', duration: 0.3 }}          className=\"fixed inset-4 md:inset-8 lg:inset-16 bg-white dark:bg-gray-900 rounded-2xl shadow-2xl flex flex-col overflow-hidden\"          onClick={(e) => e.stopPropagation()}        >          {/* Header */}          <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 relative overflow-hidden\">            {/* Animated background pattern */}            <div className=\"absolute inset-0 opacity-10\">              <div className=\"absolute inset-0\" style={{                backgroundImage: `url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")`,              }} />            </div>                        <div className=\"flex items-center gap-3 relative z-10\">              <motion.div                animate={{ rotate: 360 }}                transition={{ duration: 20, repeat: Infinity, ease: \"linear\" }}                className=\"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center border border-white/30\"              >                <Sparkles className=\"w-6 h-6 text-white\" />              </motion.div>              <div>                // eslint-disable-next-line i18next/no-literal-string                <h2 className=\"text-lg font-bold text-white flex items-center gap-2\">                  AI Learning Assistant                  // eslint-disable-next-line i18next/no-literal-string                  <span className=\"px-2 py-0.5 bg-white/20 backdrop-blur-sm rounded-full text-xs font-normal border border-white/30\">                    Beta                  </span>                </h2>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xs text-white/90\">Tr·ª£ l√Ω h·ªçc t·∫≠p th√¥ng minh ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi Google AI</p>              </div>            </div>            <button              onClick={onClose}              className=\"p-2 hover:bg-white/20 rounded-lg transition-colors backdrop-blur-sm relative z-10\"            >              <X className=\"w-6 h-6 text-white\" />            </button>          </div>          {/* Messages Area */}          <div className=\"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800\">            {messages.length === 0 && (              <div className=\"flex flex-col items-center justify-center h-full text-center space-y-6\">                <motion.div                  initial={{ scale: 0 }}                  animate={{ scale: 1 }}                  transition={{ type: 'spring', duration: 0.6 }}                  className=\"w-24 h-24 bg-gradient-to-br from-purple-500 via-blue-500 to-indigo-500 rounded-3xl flex items-center justify-center shadow-2xl\"                >                  <Book className=\"w-12 h-12 text-white\" />                </motion.div>                <motion.div                  initial={{ opacity: 0, y: 20 }}                  animate={{ opacity: 1, y: 0 }}                  transition={{ delay: 0.2 }}                >                  // eslint-disable-next-line i18next/no-literal-string                  <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">                    Ch√†o m·ª´ng ƒë·∫øn v·ªõi AI Learning Assistant! üëã                  </h3>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-gray-600 dark:text-gray-400 max-w-md mb-6\">                    H·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨ v·ªÅ c√°c quiz b·∫°n ƒë√£ h·ªçc.                    T√¥i s·∫Ω tr·∫£ l·ªùi chi ti·∫øt v√† g·ª£i √Ω quiz ph√π h·ª£p cho b·∫°n.                  </p>                </motion.div>                <motion.div                  initial={{ opacity: 0, y: 20 }}                  animate={{ opacity: 1, y: 0 }}                  transition={{ delay: 0.3 }}                  className=\"grid grid-cols-1 md:grid-cols-2 gap-3 w-full max-w-2xl\"                >                  <button                    onClick={() => setInput('Gi·∫£i th√≠ch cho t√¥i v·ªÅ ch·ªß ƒë·ªÅ n√†y')}                    className=\"group px-4 py-3 bg-white dark:bg-gray-800 rounded-xl hover:shadow-lg transition-all text-left border border-gray-200 dark:border-gray-700 hover:border-purple-500 dark:hover:border-purple-500\"                  >                    <div className=\"flex items-start gap-3\">                      <div className=\"text-2xl\">üí°</div>                      <div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"font-medium text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400\">                          Gi·∫£i th√≠ch kh√°i ni·ªám                        </div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">                          T√¨m hi·ªÉu chi ti·∫øt v·ªÅ ch·ªß ƒë·ªÅ b·∫°n quan t√¢m                        </div>                      </div>                    </div>                  </button>                                    <button                    onClick={() => setInput('T√≥m t·∫Øt n·ªôi dung v·ªÅ ch·ªß ƒë·ªÅ n√†y')}                    className=\"group px-4 py-3 bg-white dark:bg-gray-800 rounded-xl hover:shadow-lg transition-all text-left border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-500\"                  >                    <div className=\"flex items-start gap-3\">                      <div className=\"text-2xl\">üìù</div>                      <div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400\">                          T√≥m t·∫Øt n·ªôi dung                        </div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">                          Xem t·ªïng quan ki·∫øn th·ª©c quan tr·ªçng                        </div>                      </div>                    </div>                  </button>                                    <button                    onClick={() => setInput('Cho t√¥i v√≠ d·ª• th·ª±c t·∫ø v·ªÅ ch·ªß ƒë·ªÅ n√†y')}                    className=\"group px-4 py-3 bg-white dark:bg-gray-800 rounded-xl hover:shadow-lg transition-all text-left border border-gray-200 dark:border-gray-700 hover:border-green-500 dark:hover:border-green-500\"                  >                    <div className=\"flex items-start gap-3\">                      <div className=\"text-2xl\">üéØ</div>                      <div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"font-medium text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400\">                          V√≠ d·ª• th·ª±c t·∫ø                        </div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">                          H·ªçc qua c√°c tr∆∞·ªùng h·ª£p c·ª• th·ªÉ                        </div>                      </div>                    </div>                  </button>                                    <button                    onClick={() => setInput('G·ª£i √Ω quiz ƒë·ªÉ t√¥i luy·ªán t·∫≠p')}                    className=\"group px-4 py-3 bg-white dark:bg-gray-800 rounded-xl hover:shadow-lg transition-all text-left border border-gray-200 dark:border-gray-700 hover:border-indigo-500 dark:hover:border-indigo-500\"                  >                    <div className=\"flex items-start gap-3\">                      <div className=\"text-2xl\">üéì</div>                      <div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"font-medium text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400\">                          G·ª£i √Ω quiz                        </div>                        // eslint-disable-next-line i18next/no-literal-string                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">                          T√¨m quiz ph√π h·ª£p ƒë·ªÉ th·ª±c h√†nh                        </div>                      </div>                    </div>                  </button>                </motion.div>              </div>            )}            <MessageList messages={messages} onQuizClick={onClose} />            {isLoading && <TypingIndicator />}            {error && (              <div className=\"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\">                <AlertCircle className=\"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5\" />                <div>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-sm font-medium text-red-900 dark:text-red-200\">                    ƒê√£ x·∫£y ra l·ªói                  </p>                  <p className=\"text-sm text-red-700 dark:text-red-300 mt-1\">                    {error}                  </p>                </div>              </div>            )}            <div ref={messagesEndRef} />          </div>          {/* Input Area */}          <div className=\"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">            <div className=\"flex gap-3\">              <textarea                ref={inputRef}                value={input}                onChange={(e) => setInput(e.target.value)}                onKeyDown={handleKeyDown}                placeholder={t('placeholders.askQuestion')}                className=\"flex-1 resize-none px-4 py-3 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 dark:text-white\"                rows={1}                style={{ maxHeight: '120px' }}              />              <button                onClick={handleSendMessage}                disabled={!input.trim() || isLoading}                className=\"px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium\"              >                // eslint-disable-next-line i18next/no-literal-string                <Send className=\"w-5 h-5\" />                G·ª≠i              </button>            </div>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">              üí° Tip: H·ªèi v·ªÅ n·ªôi dung b·∫°n ƒë√£ h·ªçc trong c√°c quiz ƒë√£ m·ªü kh√≥a            </p>          </div>        </motion.div>      </motion.div>    </AnimatePresence>  );}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\CitationBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\MessageList.tsx","messages":[{"ruleId":"i18next/no-literal-string/** * üí¨ Message List Component *  * Displays chat messages with citations and quiz recommendations */import { motion } from 'framer-motion';import { User","message":"Definition for rule 'i18next/no-literal-string/** * üí¨ Message List Component *  * Displays chat messages with citations and quiz recommendations */import { motion } from 'framer-motion';import { User' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"Sparkles","message":"Definition for rule 'Sparkles' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"BookOpen } from 'lucide-react';import { CitationBadge } from './CitationBadge';import { QuizRecommendationCard } from './QuizRecommendationCard';import type { Citation","message":"Definition for rule 'BookOpen } from 'lucide-react';import { CitationBadge } from './CitationBadge';import { QuizRecommendationCard } from './QuizRecommendationCard';import type { Citation' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"QuizRecommendation } from '../../lib/genkit/types';interface Message {  id: string;  role: 'user' | 'assistant';  content: string;  citations?: Citation[];  quizRecommendations?: QuizRecommendation[];  timestamp: number;  usedChunks?: number;  processingTime?: number;}interface MessageListProps {  messages: Message[];  onQuizClick?: () => void;}export function MessageList({ messages","message":"Definition for rule 'QuizRecommendation } from '../../lib/genkit/types';interface Message {  id: string;  role: 'user' | 'assistant';  content: string;  citations?: Citation[];  quizRecommendations?: QuizRecommendation[];  timestamp: number;  usedChunks?: number;  processingTime?: number;}interface MessageListProps {  messages: Message[];  onQuizClick?: () => void;}export function MessageList({ messages' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"onQuizClick }: MessageListProps) {  return (    <>      {messages.map((message","message":"Definition for rule 'onQuizClick }: MessageListProps) {  return (    <>      {messages.map((message' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"index) => (        <motion.div          key={message.id}          initial={{ opacity: 0","message":"Definition for rule 'index) => (        <motion.div          key={message.id}          initial={{ opacity: 0' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"y: 20 }}          animate={{ opacity: 1","message":"Definition for rule 'y: 20 }}          animate={{ opacity: 1' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"y: 0 }}          transition={{ delay: index * 0.05 }}          className={`flex gap-3 ${            message.role === 'user' ? 'justify-end' : 'justify-start'          }`}        >          {message.role === 'assistant' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1","message":"Definition for rule 'y: 0 }}          transition={{ delay: index * 0.05 }}          className={`flex gap-3 ${            message.role === 'user' ? 'justify-end' : 'justify-start'          }`}        >          {message.role === 'assistant' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-indigo-500 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <Sparkles className=\"w-5 h-5 text-white\" />            </motion.div>          )}          <div            className={`max-w-[85%] ${              message.role === 'user'                ? 'bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white shadow-lg rounded-2xl px-4 py-3'                : ''            }`}          >            {/* AI Message Answer */}            {message.role === 'assistant' && (              <div className=\"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-850 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700 shadow-md rounded-2xl px-4 py-3\">                <div className=\"prose prose-sm dark:prose-invert max-w-none\">                  <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>                </div>                {/* Citations */}                {message.citations && message.citations.length > 0 && (                  <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700\">                    // eslint-disable-next-line i18next/no-literal-string                    <p className=\"text-xs font-medium mb-2 text-gray-600 dark:text-gray-400\">                      üìö Ngu·ªìn tham kh·∫£o:                    </p>                    <div className=\"flex flex-wrap gap-2\">                      {message.citations.map((citation","message":"Definition for rule 'type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-indigo-500 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <Sparkles className=\"w-5 h-5 text-white\" />            </motion.div>          )}          <div            className={`max-w-[85%] ${              message.role === 'user'                ? 'bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white shadow-lg rounded-2xl px-4 py-3'                : ''            }`}          >            {/* AI Message Answer */}            {message.role === 'assistant' && (              <div className=\"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-850 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700 shadow-md rounded-2xl px-4 py-3\">                <div className=\"prose prose-sm dark:prose-invert max-w-none\">                  <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>                </div>                {/* Citations */}                {message.citations && message.citations.length > 0 && (                  <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700\">                    // eslint-disable-next-line i18next/no-literal-string                    <p className=\"text-xs font-medium mb-2 text-gray-600 dark:text-gray-400\">                      üìö Ngu·ªìn tham kh·∫£o:                    </p>                    <div className=\"flex flex-wrap gap-2\">                      {message.citations.map((citation' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"i) => (                        <CitationBadge key={i} citation={citation} index={i + 1} />                      ))}                    </div>                  </div>                )}                {/* Metadata */}                {message.processingTime && (                  <div className=\"mt-2 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">                    // eslint-disable-next-line i18next/no-literal-string                    <span>‚ö° {message.processingTime}ms</span>                    {message.usedChunks && message.usedChunks > 0 && (                      <>                        <span>‚Ä¢</span>                        // eslint-disable-next-line i18next/no-literal-string                        <span>üìÑ {message.usedChunks} chunks</span>                      </>                    )}                  </div>                )}              </div>            )}            {/* User Message */}            {message.role === 'user' && (              <div className=\"prose prose-sm dark:prose-invert max-w-none\">                <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>              </div>            )}          </div>          {/* Quiz Recommendations - Separate Block */}          {message.role === 'assistant' && message.quizRecommendations && message.quizRecommendations.length > 0 && (            <motion.div              initial={{ opacity: 0","message":"Definition for rule 'i) => (                        <CitationBadge key={i} citation={citation} index={i + 1} />                      ))}                    </div>                  </div>                )}                {/* Metadata */}                {message.processingTime && (                  <div className=\"mt-2 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">                    // eslint-disable-next-line i18next/no-literal-string                    <span>‚ö° {message.processingTime}ms</span>                    {message.usedChunks && message.usedChunks > 0 && (                      <>                        <span>‚Ä¢</span>                        // eslint-disable-next-line i18next/no-literal-string                        <span>üìÑ {message.usedChunks} chunks</span>                      </>                    )}                  </div>                )}              </div>            )}            {/* User Message */}            {message.role === 'user' && (              <div className=\"prose prose-sm dark:prose-invert max-w-none\">                <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>              </div>            )}          </div>          {/* Quiz Recommendations - Separate Block */}          {message.role === 'assistant' && message.quizRecommendations && message.quizRecommendations.length > 0 && (            <motion.div              initial={{ opacity: 0' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"y: 10 }}              animate={{ opacity: 1","message":"Definition for rule 'y: 10 }}              animate={{ opacity: 1' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"y: 0 }}              transition={{ delay: 0.3 }}              className=\"max-w-[85%] mt-3\"            >              <div className=\"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border-2 border-purple-200 dark:border-purple-800 rounded-2xl p-4\">                <div className=\"flex items-center gap-2 mb-3\">                  <div className=\"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">                    <BookOpen className=\"w-5 h-5 text-white\" />                  </div>                  // eslint-disable-next-line i18next/no-literal-string                  <h4 className=\"font-bold text-purple-900 dark:text-purple-100\">                    üéØ Quiz g·ª£i √Ω cho b·∫°n                  </h4>                </div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm text-purple-700 dark:text-purple-300 mb-4\">                  Click v√†o quiz ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i ngay! üëá                </p>                <div className=\"space-y-3\">                  {message.quizRecommendations.map((quiz","message":"Definition for rule 'y: 0 }}              transition={{ delay: 0.3 }}              className=\"max-w-[85%] mt-3\"            >              <div className=\"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border-2 border-purple-200 dark:border-purple-800 rounded-2xl p-4\">                <div className=\"flex items-center gap-2 mb-3\">                  <div className=\"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">                    <BookOpen className=\"w-5 h-5 text-white\" />                  </div>                  // eslint-disable-next-line i18next/no-literal-string                  <h4 className=\"font-bold text-purple-900 dark:text-purple-100\">                    üéØ Quiz g·ª£i √Ω cho b·∫°n                  </h4>                </div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm text-purple-700 dark:text-purple-300 mb-4\">                  Click v√†o quiz ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i ngay! üëá                </p>                <div className=\"space-y-3\">                  {message.quizRecommendations.map((quiz' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"i) => (                    <QuizRecommendationCard                       key={quiz.quizId}                       quiz={quiz}                       index={i}                       onNavigate={onQuizClick}                    />                  ))}                </div>              </div>            </motion.div>          )}          {message.role === 'user' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1","message":"Definition for rule 'i) => (                    <QuizRecommendationCard                       key={quiz.quizId}                       quiz={quiz}                       index={i}                       onNavigate={onQuizClick}                    />                  ))}                </div>              </div>            </motion.div>          )}          {message.role === 'user' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null},{"ruleId":"type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <User className=\"w-5 h-5 text-white\" />            </motion.div>          )}        </motion.div>      ))}    </>  );}","message":"Definition for rule 'type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <User className=\"w-5 h-5 text-white\" />            </motion.div>          )}        </motion.div>      ))}    </>  );}' was not found.","line":1,"column":1,"endLine":1,"endColumn":6390,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-string/** * üí¨ Message List Component *  * Displays chat messages with citations and quiz recommendations */import { motion } from 'framer-motion';import { User, Sparkles, BookOpen } from 'lucide-react';import { CitationBadge } from './CitationBadge';import { QuizRecommendationCard } from './QuizRecommendationCard';import type { Citation, QuizRecommendation } from '../../lib/genkit/types';interface Message {  id: string;  role: 'user' | 'assistant';  content: string;  citations?: Citation[];  quizRecommendations?: QuizRecommendation[];  timestamp: number;  usedChunks?: number;  processingTime?: number;}interface MessageListProps {  messages: Message[];  onQuizClick?: () => void;}export function MessageList({ messages, onQuizClick }: MessageListProps) {  return (    <>      {messages.map((message, index) => (        <motion.div          key={message.id}          initial={{ opacity: 0, y: 20 }}          animate={{ opacity: 1, y: 0 }}          transition={{ delay: index * 0.05 }}          className={`flex gap-3 ${            message.role === 'user' ? 'justify-end' : 'justify-start'          }`}        >          {message.role === 'assistant' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1, type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-indigo-500 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <Sparkles className=\"w-5 h-5 text-white\" />            </motion.div>          )}          <div            className={`max-w-[85%] ${              message.role === 'user'                ? 'bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white shadow-lg rounded-2xl px-4 py-3'                : ''            }`}          >            {/* AI Message Answer */}            {message.role === 'assistant' && (              <div className=\"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-850 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700 shadow-md rounded-2xl px-4 py-3\">                <div className=\"prose prose-sm dark:prose-invert max-w-none\">                  <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>                </div>                {/* Citations */}                {message.citations && message.citations.length > 0 && (                  <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700\">                    // eslint-disable-next-line i18next/no-literal-string                    <p className=\"text-xs font-medium mb-2 text-gray-600 dark:text-gray-400\">                      üìö Ngu·ªìn tham kh·∫£o:                    </p>                    <div className=\"flex flex-wrap gap-2\">                      {message.citations.map((citation, i) => (                        <CitationBadge key={i} citation={citation} index={i + 1} />                      ))}                    </div>                  </div>                )}                {/* Metadata */}                {message.processingTime && (                  <div className=\"mt-2 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">                    // eslint-disable-next-line i18next/no-literal-string                    <span>‚ö° {message.processingTime}ms</span>                    {message.usedChunks && message.usedChunks > 0 && (                      <>                        <span>‚Ä¢</span>                        // eslint-disable-next-line i18next/no-literal-string                        <span>üìÑ {message.usedChunks} chunks</span>                      </>                    )}                  </div>                )}              </div>            )}            {/* User Message */}            {message.role === 'user' && (              <div className=\"prose prose-sm dark:prose-invert max-w-none\">                <p className=\"whitespace-pre-wrap leading-relaxed\">{message.content}</p>              </div>            )}          </div>          {/* Quiz Recommendations - Separate Block */}          {message.role === 'assistant' && message.quizRecommendations && message.quizRecommendations.length > 0 && (            <motion.div              initial={{ opacity: 0, y: 10 }}              animate={{ opacity: 1, y: 0 }}              transition={{ delay: 0.3 }}              className=\"max-w-[85%] mt-3\"            >              <div className=\"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border-2 border-purple-200 dark:border-purple-800 rounded-2xl p-4\">                <div className=\"flex items-center gap-2 mb-3\">                  <div className=\"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">                    <BookOpen className=\"w-5 h-5 text-white\" />                  </div>                  // eslint-disable-next-line i18next/no-literal-string                  <h4 className=\"font-bold text-purple-900 dark:text-purple-100\">                    üéØ Quiz g·ª£i √Ω cho b·∫°n                  </h4>                </div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm text-purple-700 dark:text-purple-300 mb-4\">                  Click v√†o quiz ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i ngay! üëá                </p>                <div className=\"space-y-3\">                  {message.quizRecommendations.map((quiz, i) => (                    <QuizRecommendationCard                       key={quiz.quizId}                       quiz={quiz}                       index={i}                       onNavigate={onQuizClick}                    />                  ))}                </div>              </div>            </motion.div>          )}          {message.role === 'user' && (            <motion.div              initial={{ scale: 0 }}              animate={{ scale: 1 }}              transition={{ delay: index * 0.05 + 0.1, type: 'spring' }}              className=\"w-8 h-8 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 flex items-center justify-center flex-shrink-0 shadow-lg\"            >              <User className=\"w-5 h-5 text-white\" />            </motion.div>          )}        </motion.div>      ))}    </>  );}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\QuizRecommendationCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\TypingIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\components\\rag\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\config\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\config\\gemini.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\config\\routes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminLogin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminSetup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminSidebar.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';import { Link","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';import { Link' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"useLocation } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { useTranslation } from 'react-i18next';const AdminSidebar: React.FC = () => {  const location = useLocation();  const { user } = useSelector((state: RootState) => state.auth);  const { t } = useTranslation();  if (user?.role !== 'admin') {    return null;  }  const navigation = [    {      name: t('admin.sidebar.nav.dashboard')","message":"Definition for rule 'useLocation } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { useTranslation } from 'react-i18next';const AdminSidebar: React.FC = () => {  const location = useLocation();  const { user } = useSelector((state: RootState) => state.auth);  const { t } = useTranslation();  if (user?.role !== 'admin') {    return null;  }  const navigation = [    {      name: t('admin.sidebar.nav.dashboard')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin'","message":"Definition for rule 'href: '/admin'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'üè†'","message":"Definition for rule 'icon: 'üè†'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin'    }","message":"Definition for rule 'current: location.pathname === '/admin'    }' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"{      name: t('admin.sidebar.nav.quizManagement')","message":"Definition for rule '{      name: t('admin.sidebar.nav.quizManagement')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin/quiz-management'","message":"Definition for rule 'href: '/admin/quiz-management'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'üìù'","message":"Definition for rule 'icon: 'üìù'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin/quiz-management'    }","message":"Definition for rule 'current: location.pathname === '/admin/quiz-management'    }' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"{      name: t('admin.sidebar.nav.categories')","message":"Definition for rule '{      name: t('admin.sidebar.nav.categories')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin/categories'","message":"Definition for rule 'href: '/admin/categories'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'üè∑Ô∏è'","message":"Definition for rule 'icon: 'üè∑Ô∏è'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin/categories'    }","message":"Definition for rule 'current: location.pathname === '/admin/categories'    }' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"{      name: t('admin.sidebar.nav.users')","message":"Definition for rule '{      name: t('admin.sidebar.nav.users')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin/users'","message":"Definition for rule 'href: '/admin/users'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'üë•'","message":"Definition for rule 'icon: 'üë•'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin/users'    }","message":"Definition for rule 'current: location.pathname === '/admin/users'    }' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"{      name: t('admin.sidebar.nav.utilities')","message":"Definition for rule '{      name: t('admin.sidebar.nav.utilities')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin/utilities'","message":"Definition for rule 'href: '/admin/utilities'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'ÔøΩÔ∏è'","message":"Definition for rule 'icon: 'ÔøΩÔ∏è'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin/utilities'    }","message":"Definition for rule 'current: location.pathname === '/admin/utilities'    }' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"{      name: t('admin.sidebar.nav.roles')","message":"Definition for rule '{      name: t('admin.sidebar.nav.roles')' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"href: '/admin/roles'","message":"Definition for rule 'href: '/admin/roles'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"icon: 'üîê'","message":"Definition for rule 'icon: 'üîê'' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null},{"ruleId":"current: location.pathname === '/admin/roles'    }  ];  return (    <div className=\"fixed inset-y-0 left-0 z-50 w-64 bg-gray-900 transform transition-transform duration-300 ease-in-out lg:translate-x-0\">      <div className=\"flex items-center justify-center h-16 bg-gray-800\">        <h1 className=\"text-white text-xl font-bold\">{t('admin.sidebar.title')}</h1>      </div>            <nav className=\"mt-8\">        <div className=\"px-3 mb-6\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold\">            {t('admin.sidebar.sectionAdmin')}          </p>        </div>                <div className=\"space-y-1\">          {navigation.map((item) => (            <Link              key={item.name}              to={item.href}              className={`group flex items-center px-3 py-2 mx-3 text-sm font-medium rounded-md transition-colors ${                item.current                  ? 'bg-gray-800 text-white'                  : 'text-gray-300 hover:bg-gray-700 hover:text-white'              }`}            >              <span className=\"mr-3 text-lg\">{item.icon}</span>              {item.name}            </Link>          ))}        </div>                <div className=\"mt-8 px-3\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold mb-4\">            {t('admin.sidebar.quickActions')}          </p>          <div className=\"space-y-2\">            <Link              to=\"/creator\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              // eslint-disable-next-line i18next/no-literal-string              <span className=\"mr-3\">‚úèÔ∏è</span>              {t('admin.sidebar.createQuiz')}            </Link>            <Link              to=\"/dashboard\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              <span className=\"mr-3\">üè†</span>              {t('admin.sidebar.backToDashboard')}            </Link>          </div>        </div>      </nav>            <div className=\"absolute bottom-0 w-full p-4\">        <div className=\"bg-gray-800 rounded-lg p-3\">          <div className=\"flex items-center\">            <div className=\"flex-shrink-0\">              <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center\">                <span className=\"text-white text-sm font-medium\">                  {user?.displayName?.charAt(0) || user?.email?.charAt(0) || 'A'}                </span>              </div>            </div>            <div className=\"ml-3\">              <p className=\"text-white text-sm font-medium\">                {user?.displayName || t('ui.admin')}              </p>              <p className=\"text-gray-400 text-xs\">{t('ui.admin')}</p>            </div>          </div>        </div>      </div>    </div>  );};export default AdminSidebar;","message":"Definition for rule 'current: location.pathname === '/admin/roles'    }  ];  return (    <div className=\"fixed inset-y-0 left-0 z-50 w-64 bg-gray-900 transform transition-transform duration-300 ease-in-out lg:translate-x-0\">      <div className=\"flex items-center justify-center h-16 bg-gray-800\">        <h1 className=\"text-white text-xl font-bold\">{t('admin.sidebar.title')}</h1>      </div>            <nav className=\"mt-8\">        <div className=\"px-3 mb-6\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold\">            {t('admin.sidebar.sectionAdmin')}          </p>        </div>                <div className=\"space-y-1\">          {navigation.map((item) => (            <Link              key={item.name}              to={item.href}              className={`group flex items-center px-3 py-2 mx-3 text-sm font-medium rounded-md transition-colors ${                item.current                  ? 'bg-gray-800 text-white'                  : 'text-gray-300 hover:bg-gray-700 hover:text-white'              }`}            >              <span className=\"mr-3 text-lg\">{item.icon}</span>              {item.name}            </Link>          ))}        </div>                <div className=\"mt-8 px-3\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold mb-4\">            {t('admin.sidebar.quickActions')}          </p>          <div className=\"space-y-2\">            <Link              to=\"/creator\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              // eslint-disable-next-line i18next/no-literal-string              <span className=\"mr-3\">‚úèÔ∏è</span>              {t('admin.sidebar.createQuiz')}            </Link>            <Link              to=\"/dashboard\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              <span className=\"mr-3\">üè†</span>              {t('admin.sidebar.backToDashboard')}            </Link>          </div>        </div>      </nav>            <div className=\"absolute bottom-0 w-full p-4\">        <div className=\"bg-gray-800 rounded-lg p-3\">          <div className=\"flex items-center\">            <div className=\"flex-shrink-0\">              <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center\">                <span className=\"text-white text-sm font-medium\">                  {user?.displayName?.charAt(0) || user?.email?.charAt(0) || 'A'}                </span>              </div>            </div>            <div className=\"ml-3\">              <p className=\"text-white text-sm font-medium\">                {user?.displayName || t('ui.admin')}              </p>              <p className=\"text-gray-400 text-xs\">{t('ui.admin')}</p>            </div>          </div>        </div>      </div>    </div>  );};export default AdminSidebar;' was not found.","line":1,"column":1,"endLine":1,"endColumn":4364,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';import { Link, useLocation } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { useTranslation } from 'react-i18next';const AdminSidebar: React.FC = () => {  const location = useLocation();  const { user } = useSelector((state: RootState) => state.auth);  const { t } = useTranslation();  if (user?.role !== 'admin') {    return null;  }  const navigation = [    {      name: t('admin.sidebar.nav.dashboard'),      href: '/admin',      icon: 'üè†',      current: location.pathname === '/admin'    },    {      name: t('admin.sidebar.nav.quizManagement'),      href: '/admin/quiz-management',      icon: 'üìù',      current: location.pathname === '/admin/quiz-management'    },    {      name: t('admin.sidebar.nav.categories'),      href: '/admin/categories',      icon: 'üè∑Ô∏è',      current: location.pathname === '/admin/categories'    },    {      name: t('admin.sidebar.nav.users'),      href: '/admin/users',      icon: 'üë•',      current: location.pathname === '/admin/users'    },    {      name: t('admin.sidebar.nav.utilities'),      href: '/admin/utilities',      icon: 'ÔøΩÔ∏è',      current: location.pathname === '/admin/utilities'    },    {      name: t('admin.sidebar.nav.roles'),      href: '/admin/roles',      icon: 'üîê',      current: location.pathname === '/admin/roles'    }  ];  return (    <div className=\"fixed inset-y-0 left-0 z-50 w-64 bg-gray-900 transform transition-transform duration-300 ease-in-out lg:translate-x-0\">      <div className=\"flex items-center justify-center h-16 bg-gray-800\">        <h1 className=\"text-white text-xl font-bold\">{t('admin.sidebar.title')}</h1>      </div>            <nav className=\"mt-8\">        <div className=\"px-3 mb-6\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold\">            {t('admin.sidebar.sectionAdmin')}          </p>        </div>                <div className=\"space-y-1\">          {navigation.map((item) => (            <Link              key={item.name}              to={item.href}              className={`group flex items-center px-3 py-2 mx-3 text-sm font-medium rounded-md transition-colors ${                item.current                  ? 'bg-gray-800 text-white'                  : 'text-gray-300 hover:bg-gray-700 hover:text-white'              }`}            >              <span className=\"mr-3 text-lg\">{item.icon}</span>              {item.name}            </Link>          ))}        </div>                <div className=\"mt-8 px-3\">          <p className=\"text-gray-400 text-xs uppercase tracking-wider font-semibold mb-4\">            {t('admin.sidebar.quickActions')}          </p>          <div className=\"space-y-2\">            <Link              to=\"/creator\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              // eslint-disable-next-line i18next/no-literal-string              <span className=\"mr-3\">‚úèÔ∏è</span>              {t('admin.sidebar.createQuiz')}            </Link>            <Link              to=\"/dashboard\"              className=\"group flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-md\"            >              <span className=\"mr-3\">üè†</span>              {t('admin.sidebar.backToDashboard')}            </Link>          </div>        </div>      </nav>            <div className=\"absolute bottom-0 w-full p-4\">        <div className=\"bg-gray-800 rounded-lg p-3\">          <div className=\"flex items-center\">            <div className=\"flex-shrink-0\">              <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center\">                <span className=\"text-white text-sm font-medium\">                  {user?.displayName?.charAt(0) || user?.email?.charAt(0) || 'A'}                </span>              </div>            </div>            <div className=\"ml-3\">              <p className=\"text-white text-sm font-medium\">                {user?.displayName || t('ui.admin')}              </p>              <p className=\"text-gray-400 text-xs\">{t('ui.admin')}</p>            </div>          </div>        </div>      </div>    </div>  );};export default AdminSidebar;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminStats.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[807,810],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[807,810],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2268,2271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2268,2271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2380,2383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2380,2383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":71,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2492,2495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2492,2495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3512,3515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3512,3515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7081,7084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7081,7084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11951,11954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11951,11954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":275,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":275,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12344,12347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12344,12347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":324,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":324,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15188,15191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15188,15191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":367,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":367,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17445,17448],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17445,17448],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":531,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":531,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24559,24562],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24559,24562],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { \r\n  BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, \r\n  PieChart, Pie, Cell, Legend, LineChart, Line, AreaChart, Area \r\n} from 'recharts';\r\nimport { \r\n  TrendingUp, TrendingDown, Users, BookOpen, Target, Award, RefreshCw, \r\n  Eye, MessageSquare, Edit, Download\r\n} from 'lucide-react';\r\nimport { getRealQuizData, getRealUserData, getRealReviewData, getRealCategoryData } from '../../quiz/services/realDataService';\r\nimport { toast } from 'react-toastify';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AdminStats: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [realData, setRealData] = useState<any>(null);\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'users' | 'quizzes' | 'performance'>('overview');\r\n  const [timeRange, setTimeRange] = useState<'7d' | '30d' | '90d' | '1y'>('30d');\r\n  const navigate = useNavigate();\r\n\r\n  const loadRealData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [quizzes, users, reviews, categories] = await Promise.all([\r\n        getRealQuizData(),\r\n        getRealUserData(), \r\n        getRealReviewData(),\r\n        getRealCategoryData()\r\n      ]);\r\n\r\n      setRealData({\r\n        quizzes: quizzes || [],\r\n        users: users || [],\r\n        reviews: reviews || [],\r\n        categories: categories || []\r\n      });\r\n\r\n      toast.success(t('admin.dataLoadSuccess'));\r\n    } catch (error) {\r\n      console.error('Error loading real data:', error);\r\n      toast.error(t('admin.realDataLoadError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [t]);\r\n\r\n  useEffect(() => {\r\n    loadRealData();\r\n  }, [loadRealData]);\r\n\r\n  const refreshData = () => {\r\n    loadRealData();\r\n  };\r\n\r\n  const exportData = () => {\r\n    console.log('Exporting data...');\r\n    toast.info(t('admin.exportDataDevelopment'));\r\n  };\r\n\r\n  // Calculate enhanced stats from real data\r\n  const getEnhancedStats = () => {\r\n    if (!realData) return null;\r\n\r\n    const { quizzes, users, reviews } = realData;\r\n    \r\n    // Calculate more accurate statistics\r\n    const publishedQuizzes = quizzes.filter((q: any) => q.status === 'published' || q.status === 'approved').length;\r\n    const creatorUsers = users.filter((u: any) => u.role === 'creator' || u.role === 'admin').length;\r\n    const quizCreatorIds = new Set(quizzes.map((q: any) => q.createdBy).filter(Boolean));\r\n    const totalCreators = Math.max(creatorUsers, quizCreatorIds.size);\r\n    \r\n    // More realistic completion estimates based on actual quiz count\r\n    const estimatedCompletions = Math.floor(publishedQuizzes * 2.5); // Average 2.5 attempts per published quiz\r\n    \r\n    return {\r\n      totalUsers: users.length,\r\n      activeUsers: Math.floor(users.length * 0.65), // More conservative estimate\r\n      totalQuizzes: quizzes.length,\r\n      publishedQuizzes: publishedQuizzes, // Quizzes available to users\r\n      totalCreators: totalCreators, // Users who have created quizzes\r\n      completedQuizzes: estimatedCompletions, // Quiz completion attempts\r\n      averageScore: 78.5, // Keep mock for now\r\n      completionRate: 85.2, // Keep mock for now  \r\n      userGrowthRate: 12.5, // Keep mock for now\r\n      quizCompletionGrowth: 8.3, // Keep mock for now\r\n      totalReviews: reviews.length,\r\n      averageRating: reviews.length > 0 ? \r\n        reviews.reduce((sum: number, r: any) => sum + (r.rating || 0), 0) / reviews.length : 0\r\n    };\r\n  };\r\n\r\n  const enhancedStats = getEnhancedStats();\r\n\r\n  const StatCard: React.FC<{\r\n    title: string;\r\n    value: string | number;\r\n    icon: React.ReactNode;\r\n    change: number;\r\n    color: string;\r\n    onClick?: () => void;\r\n  }> = ({ title, value, icon, change, color, onClick }) => (\r\n    <div \r\n      className={`bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all duration-200 ${onClick ? 'cursor-pointer' : ''}`}\r\n      onClick={onClick}\r\n    >\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <p className=\"text-sm font-medium text-gray-600\">{title}</p>\r\n          <p className=\"text-2xl font-bold text-gray-900 mt-1\">{value}</p>\r\n        </div>\r\n        <div className={`p-3 rounded-full bg-${color}-100`}>\r\n          {icon}\r\n        </div>\r\n      </div>\r\n      <div className=\"mt-4 flex items-center\">\r\n        {change >= 0 ? (\r\n          <TrendingUp className=\"w-4 h-4 text-green-500 mr-1\" />\r\n        ) : (\r\n          <TrendingDown className=\"w-4 h-4 text-red-500 mr-1\" />\r\n        )}\r\n        <span className={`text-sm font-medium ${change >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n          {change >= 0 ? '+' : ''}{change}%\r\n        </span>\r\n        <span className=\"text-sm text-gray-500 ml-1\">{t('admin.vsLastMonth')}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderOverview = () => {\r\n    if (!enhancedStats) return <div>{t('loading')}</div>;\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {/* Main Stats Grid */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <StatCard\r\n            title={t('admin.stats.totalUsers')}\r\n            value={enhancedStats.totalUsers.toLocaleString()}\r\n            icon={<Users className=\"w-6 h-6 text-blue-600\" />}\r\n            change={enhancedStats.userGrowthRate}\r\n            color=\"blue\"\r\n            onClick={() => setActiveTab('users')}\r\n          />\r\n          <StatCard\r\n            title={t('admin.stats.publishedQuizzes')}\r\n            value={enhancedStats.publishedQuizzes.toLocaleString()}\r\n            icon={<BookOpen className=\"w-6 h-6 text-green-600\" />}\r\n            change={15.3}\r\n            color=\"green\"\r\n            onClick={() => setActiveTab('quizzes')}\r\n          />\r\n          <StatCard\r\n            title={t('admin.stats.completionAttempts')}\r\n            value={enhancedStats.completedQuizzes.toLocaleString()}\r\n            icon={<Target className=\"w-6 h-6 text-purple-600\" />}\r\n            change={enhancedStats.quizCompletionGrowth}\r\n            color=\"purple\"\r\n          />\r\n          <StatCard\r\n            title={t('admin.stats.totalCreators')}\r\n            value={enhancedStats.totalCreators.toLocaleString()}\r\n            icon={<Award className=\"w-6 h-6 text-orange-600\" />}\r\n            change={8.2}\r\n            color=\"orange\"\r\n          />\r\n        </div>\r\n\r\n        {/* Charts Row */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          {/* User Growth Chart */}\r\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">{t('admin.stats.userGrowth')}</h3>\r\n              <div className=\"flex space-x-2\">\r\n                {['7d', '30d', '90d', '1y'].map((range) => (\r\n                  <button\r\n                    key={range}\r\n                    onClick={() => setTimeRange(range as any)}\r\n                    className={`px-3 py-1 text-xs rounded-full ${\r\n                      timeRange === range\r\n                        ? 'bg-blue-100 text-blue-600'\r\n                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                  >\r\n                    {range}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <AreaChart data={[\r\n                { date: 'T1', users: Math.floor(enhancedStats.totalUsers * 0.7) },\r\n                { date: 'T2', users: Math.floor(enhancedStats.totalUsers * 0.8) },\r\n                { date: 'T3', users: Math.floor(enhancedStats.totalUsers * 0.9) },\r\n                { date: 'T4', users: enhancedStats.totalUsers }\r\n              ]}>\r\n                <defs>\r\n                  <linearGradient id=\"colorUsers\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                    <stop offset=\"5%\" stopColor=\"#3B82F6\" stopOpacity={0.3}/>\r\n                    <stop offset=\"95%\" stopColor=\"#3B82F6\" stopOpacity={0}/>\r\n                  </linearGradient>\r\n                </defs>\r\n                <XAxis dataKey=\"date\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Area \r\n                  type=\"monotone\" \r\n                  dataKey=\"users\" \r\n                  stroke=\"#3B82F6\" \r\n                  fillOpacity={1} \r\n                  fill=\"url(#colorUsers)\" \r\n                />\r\n              </AreaChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Quiz Activity Chart */}\r\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">{t('admin.stats.quizActivity')}</h3>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={[\r\n                { date: 'T1', created: Math.floor(enhancedStats.totalQuizzes * 0.2), completed: Math.floor(enhancedStats.completedQuizzes * 0.2) },\r\n                { date: 'T2', created: Math.floor(enhancedStats.totalQuizzes * 0.3), completed: Math.floor(enhancedStats.completedQuizzes * 0.3) },\r\n                { date: 'T3', created: Math.floor(enhancedStats.totalQuizzes * 0.4), completed: Math.floor(enhancedStats.completedQuizzes * 0.5) },\r\n                { date: 'T4', created: Math.floor(enhancedStats.totalQuizzes * 0.1), completed: Math.floor(enhancedStats.completedQuizzes * 0.3) }\r\n              ]}>\r\n                <XAxis dataKey=\"date\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Legend />\r\n                <Bar dataKey=\"created\" fill=\"#10B981\" name={t('admin.stats.createdQuizzes')} />\r\n                <Bar dataKey=\"completed\" fill=\"#3B82F6\" name={t('admin.stats.completedAttempts')} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Additional Stats Row */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          {/* Performance Overview */}\r\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.stats.performanceOverview')}</h3>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-gray-600\">{t('admin.stats.averageScore')}</span>\r\n                <span className=\"font-semibold text-green-600\">{enhancedStats.averageScore}%</span>\r\n              </div>\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-gray-600\">{t('admin.stats.completionRate')}</span>\r\n                <span className=\"font-semibold text-blue-600\">{enhancedStats.completionRate}%</span>\r\n              </div>\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-gray-600\">{t('admin.stats.totalReviews')}</span>\r\n                <span className=\"font-semibold text-purple-600\">{enhancedStats.totalReviews}</span>\r\n              </div>\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-gray-600\">{t('admin.stats.averageRating')}</span>\r\n                <span className=\"font-semibold text-yellow-600\">\r\n                  {enhancedStats.averageRating.toFixed(1)} ‚≠ê\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Top Categories */}\r\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.stats.topCategories')}</h3>\r\n            <div className=\"space-y-3\">\r\n              {realData?.categories?.slice(0, 5).map((category: any, index: number) => (\r\n                <div key={category.id} className=\"flex items-center justify-between\">\r\n                  <span className=\"text-gray-600\">{category.name || t('admin.stats.unnamedCategory', {n: index + 1, defaultValue: `Category ${index + 1}`})}</span>\r\n                  <span className=\"font-semibold text-blue-600\">\r\n                    {realData.quizzes.filter((q: any) => q.category === category.id).length}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Recent Activity */}\r\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.stats.recentActivity')}</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                <span className=\"text-sm text-gray-600\">{t('admin.stats.availableQuizzes', {count: enhancedStats.totalQuizzes, defaultValue: `${enhancedStats.totalQuizzes} quizzes available`})}</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                <span className=\"text-sm text-gray-600\">{t('admin.stats.registeredUsers', {count: enhancedStats.totalUsers, defaultValue: `${enhancedStats.totalUsers} users registered`})}</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                <span className=\"text-sm text-gray-600\">{t('admin.stats.reviews', {count: enhancedStats.totalReviews, defaultValue: `${enhancedStats.totalReviews} reviews`})}</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-2 h-2 bg-orange-500 rounded-full\"></div>\r\n                <span className=\"text-sm text-gray-600\">{t('admin.stats.completions', {count: enhancedStats.completedQuizzes, defaultValue: `${enhancedStats.completedQuizzes} completions`})}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderUsers = () => (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.userManagement')}</h3>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full\">\r\n            <thead>\r\n              <tr className=\"border-b border-gray-200\">\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">ID</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t(\"auth.email\")}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('ui.user')}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('status.active')}</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {realData?.users?.slice(0, 10).map((user: any) => (\r\n                <tr key={user.id} className=\"border-b border-gray-100\">\r\n                  <td className=\"py-3 px-4 text-sm text-gray-900\">{user.id}</td>\r\n                  <td className=\"py-3 px-4 text-sm text-gray-600\">{user.email || 'N/A'}</td>\r\n                  <td className=\"py-3 px-4 text-sm text-gray-600\">{user.role || 'user'}</td>\r\n                  <td className=\"py-3 px-4\">\r\n                    <span className=\"inline-flex px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full\">\r\n                      {t('status.active')}\r\n                    </span>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderQuizzes = () => (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900\">{t('admin.quizManagement.label')}</h3>\r\n          <button\r\n            onClick={() => navigate('/admin/quiz-management')}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n          >\r\n            {t('viewDetails')}\r\n          </button>\r\n        </div>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full\">\r\n            <thead>\r\n              <tr className=\"border-b border-gray-200\">\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('admin.quizManagement.table.title')}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('admin.quizManagement.table.category')}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('admin.quizManagement.table.creator')}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('admin.quizManagement.table.createdAt')}</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-600\">{t('admin.quizManagement.table.actions')}</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {realData?.quizzes?.slice(0, 10).map((quiz: any) => (\r\n                <tr key={quiz.id} className=\"border-b border-gray-100\">\r\n                  <td className=\"py-3 px-4 text-sm font-medium text-gray-900\">\r\n                    {quiz.title || t('quiz.untitled')}\r\n                  </td>\r\n                  <td className=\"py-3 px-4 text-sm text-gray-600\">\r\n                    {quiz.category || t('admin.quizManagement.table.uncategorized')}\r\n                  </td>\r\n                  <td className=\"py-3 px-4 text-sm text-gray-600\">\r\n                    {quiz.createdBy || 'N/A'}\r\n                  </td>\r\n                  <td className=\"py-3 px-4 text-sm text-gray-600\">\r\n                    {quiz.createdAt ? new Date(quiz.createdAt.seconds * 1000).toLocaleDateString() : 'N/A'}\r\n                  </td>\r\n                  <td className=\"py-3 px-4\">\r\n                    <div className=\"flex space-x-2\">\r\n                      <button\r\n                        onClick={() => navigate(`/quiz/${quiz.id}`)}\r\n                        className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\r\n                        title={t('admin.quizManagement.tooltips.preview')}\r\n                      >\r\n                        <Eye className=\"w-4 h-4\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => navigate(`/admin/edit-quiz/${quiz.id}`)}\r\n                        className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors\"\r\n                        title={t('admin.quizManagement.tooltips.edit')}\r\n                      >\r\n                        <Edit className=\"w-4 h-4\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => navigate(`/quiz/${quiz.id}/reviews`)}\r\n                        className=\"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors\"\r\n                        title={t('admin.quizManagement.tooltips.viewReviews')}\r\n                      >\r\n                        <MessageSquare className=\"w-4 h-4\" />\r\n                      </button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderPerformance = () => (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Performance Metrics */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.stats.performanceMetrics')}</h3>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <LineChart data={[\r\n              { month: 'T1', score: 75, completion: 80 },\r\n              { month: 'T2', score: 78, completion: 82 },\r\n              { month: 'T3', score: 76, completion: 85 },\r\n              { month: 'T4', score: 79, completion: 87 }\r\n            ]}>\r\n              <XAxis dataKey=\"month\" />\r\n              <YAxis />\r\n              <Tooltip />\r\n              <Legend />\r\n              <Line type=\"monotone\" dataKey=\"score\" stroke=\"#10B981\" name={t('admin.stats.averageScore')} />\r\n              <Line type=\"monotone\" dataKey=\"completion\" stroke=\"#3B82F6\" name={t('admin.stats.completionRate')} />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        {/* Quiz Rating Distribution */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('admin.stats.ratingDistribution')}</h3>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <PieChart>\r\n              <Pie\r\n                data={[\r\n                  { name: '5‚òÖ', value: 35, color: '#10B981' },\r\n                  { name: '4‚òÖ', value: 28, color: '#3B82F6' },\r\n                  { name: '3‚òÖ', value: 20, color: '#F59E0B' },\r\n                  { name: '2‚òÖ', value: 12, color: '#EF4444' },\r\n                  { name: '1‚òÖ', value: 5, color: '#6B7280' }\r\n                ]}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                outerRadius={100}\r\n                dataKey=\"value\"\r\n              >\r\n                {[\r\n                  { color: '#10B981' },\r\n                  { color: '#3B82F6' },\r\n                  { color: '#F59E0B' },\r\n                  { color: '#EF4444' },\r\n                  { color: '#6B7280' }\r\n                ].map((entry, index) => (\r\n                  <Cell key={`cell-${index}`} fill={entry.color} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip />\r\n              <Legend />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">{t('admin.loadingRealData')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const tabs = [\r\n    { id: 'overview', label: t('admin.tabs.overview'), icon: Target },\r\n    { id: 'users', label: t('admin.tabs.users'), icon: Users },\r\n    { id: 'quizzes', label: t('admin.tabs.quizzes'), icon: BookOpen },\r\n    { id: 'performance', label: t('admin.tabs.performance'), icon: Award }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-7xl mx-auto px-4\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">üìä {t('admin.header.title')}</h1>\r\n              <p className=\"text-gray-600\">{t('admin.header.subtitle')}</p>\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                onClick={refreshData}\r\n                disabled={loading}\r\n                className=\"flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\r\n              >\r\n                <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />\r\n                {t('refresh')}\r\n              </button>\r\n              <button\r\n                onClick={exportData}\r\n                className=\"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n              >\r\n                <Download className=\"w-4 h-4 mr-2\" />\r\n                {t('admin.exportData')}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Navigation Tabs */}\r\n        <div className=\"mb-8\">\r\n          <nav className=\"flex space-x-1 bg-white rounded-lg p-1 shadow-sm border border-gray-200\">\r\n            {tabs.map((tab) => {\r\n              const Icon = tab.icon;\r\n              return (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id as any)}\r\n                  className={`flex items-center px-6 py-3 rounded-md font-medium transition-all duration-200 ${\r\n                    activeTab === tab.id\r\n                      ? 'bg-blue-600 text-white shadow-sm'\r\n                      : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'\r\n                  }`}\r\n                >\r\n                  <Icon className=\"w-5 h-5 mr-2\" />\r\n                   {tab.label}\r\n                </button>\r\n              );\r\n            })}\r\n          </nav>\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        <div className=\"mb-8\">\r\n          {activeTab === 'overview' && renderOverview()}\r\n          {activeTab === 'users' && renderUsers()}\r\n          {activeTab === 'quizzes' && renderQuizzes()}\r\n          {activeTab === 'performance' && renderPerformance()}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminStats;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\AdminUtilities.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\BulkActions.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"{ useState } from 'react';import { toast } from 'react-toastify';import { doc","message":"Definition for rule '{ useState } from 'react';import { toast } from 'react-toastify';import { doc' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"updateDoc","message":"Definition for rule 'updateDoc' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"deleteDoc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { useTranslation } from 'react-i18next';interface BulkActionsProps {  selectedItems: string[];  itemType: 'users' | 'quizzes';  onClearSelection: () => void;  onRefresh: () => void;}const BulkActions: React.FC<BulkActionsProps> = ({   selectedItems","message":"Definition for rule 'deleteDoc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { useTranslation } from 'react-i18next';interface BulkActionsProps {  selectedItems: string[];  itemType: 'users' | 'quizzes';  onClearSelection: () => void;  onRefresh: () => void;}const BulkActions: React.FC<BulkActionsProps> = ({   selectedItems' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"itemType","message":"Definition for rule 'itemType' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"onClearSelection","message":"Definition for rule 'onClearSelection' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"onRefresh }) => {  const { t } = useTranslation();  const [loading","message":"Definition for rule 'onRefresh }) => {  const { t } = useTranslation();  const [loading' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"setLoading] = useState(false);  if (selectedItems.length === 0) return null;  const bulkDelete = async () => {    if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ${selectedItems.length} ${itemType}?`)) return;        setLoading(true);    try {      const promises = selectedItems.map(id =>         deleteDoc(doc(db","message":"Definition for rule 'setLoading] = useState(false);  if (selectedItems.length === 0) return null;  const bulkDelete = async () => {    if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ${selectedItems.length} ${itemType}?`)) return;        setLoading(true);    try {      const promises = selectedItems.map(id =>         deleteDoc(doc(db' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"id))      );      await Promise.all(promises);            toast.success(`ƒê√£ x√≥a ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi x√≥a h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  const bulkUpdateStatus = async (status: any) => {    setLoading(true);    try {      const field = itemType === 'users' ? 'isActive' : 'status';      const promises = selectedItems.map(id =>         updateDoc(doc(db","message":"Definition for rule 'id))      );      await Promise.all(promises);            toast.success(`ƒê√£ x√≥a ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi x√≥a h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  const bulkUpdateStatus = async (status: any) => {    setLoading(true);    try {      const field = itemType === 'users' ? 'isActive' : 'status';      const promises = selectedItems.map(id =>         updateDoc(doc(db' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"id)","message":"Definition for rule 'id)' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null},{"ruleId":"{ [field]: status })      );      await Promise.all(promises);            toast.success(`ƒê√£ c·∫≠p nh·∫≠t ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi c·∫≠p nh·∫≠t h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  return (    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">      <div className=\"flex items-center justify-between\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-blue-800 font-medium\">          ƒê√£ ch·ªçn {selectedItems.length} {itemType}        </span>                <div className=\"flex gap-2\">          {itemType === 'users' && (            <>              <button                onClick={() => bulkUpdateStatus(true)}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"action.activate\")}              </button>              <button                onClick={() => bulkUpdateStatus(false)}                disabled={loading}                className=\"px-3 py-1 bg-yellow-600 text-white rounded text-sm hover:bg-yellow-700\"              >{t(\"action.deactivate\")}              </button>            </>          )}                    {itemType === 'quizzes' && (            <>              <button                onClick={() => bulkUpdateStatus('approved')}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"admin.editRequests.approve\")}              </button>              <button                onClick={() => bulkUpdateStatus('rejected')}                disabled={loading}                className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"              >{t(\"admin.editRequests.reject\")}              </button>            </>          )}                    <button            onClick={bulkDelete}            disabled={loading}            className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"          >{t(\"action.clear\")}          </button>                    <button            onClick={onClearSelection}            className=\"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700\"          >{t(\"common.cancel\")}          </button>        </div>      </div>    </div>  );};export default BulkActions;","message":"Definition for rule '{ [field]: status })      );      await Promise.all(promises);            toast.success(`ƒê√£ c·∫≠p nh·∫≠t ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi c·∫≠p nh·∫≠t h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  return (    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">      <div className=\"flex items-center justify-between\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-blue-800 font-medium\">          ƒê√£ ch·ªçn {selectedItems.length} {itemType}        </span>                <div className=\"flex gap-2\">          {itemType === 'users' && (            <>              <button                onClick={() => bulkUpdateStatus(true)}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"action.activate\")}              </button>              <button                onClick={() => bulkUpdateStatus(false)}                disabled={loading}                className=\"px-3 py-1 bg-yellow-600 text-white rounded text-sm hover:bg-yellow-700\"              >{t(\"action.deactivate\")}              </button>            </>          )}                    {itemType === 'quizzes' && (            <>              <button                onClick={() => bulkUpdateStatus('approved')}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"admin.editRequests.approve\")}              </button>              <button                onClick={() => bulkUpdateStatus('rejected')}                disabled={loading}                className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"              >{t(\"admin.editRequests.reject\")}              </button>            </>          )}                    <button            onClick={bulkDelete}            disabled={loading}            className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"          >{t(\"action.clear\")}          </button>                    <button            onClick={onClearSelection}            className=\"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700\"          >{t(\"common.cancel\")}          </button>        </div>      </div>    </div>  );};export default BulkActions;' was not found.","line":1,"column":1,"endLine":1,"endColumn":3853,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState } from 'react';import { toast } from 'react-toastify';import { doc, updateDoc, deleteDoc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { useTranslation } from 'react-i18next';interface BulkActionsProps {  selectedItems: string[];  itemType: 'users' | 'quizzes';  onClearSelection: () => void;  onRefresh: () => void;}const BulkActions: React.FC<BulkActionsProps> = ({   selectedItems,   itemType,   onClearSelection,   onRefresh }) => {  const { t } = useTranslation();  const [loading, setLoading] = useState(false);  if (selectedItems.length === 0) return null;  const bulkDelete = async () => {    if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ${selectedItems.length} ${itemType}?`)) return;        setLoading(true);    try {      const promises = selectedItems.map(id =>         deleteDoc(doc(db, itemType, id))      );      await Promise.all(promises);            toast.success(`ƒê√£ x√≥a ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi x√≥a h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  const bulkUpdateStatus = async (status: any) => {    setLoading(true);    try {      const field = itemType === 'users' ? 'isActive' : 'status';      const promises = selectedItems.map(id =>         updateDoc(doc(db, itemType, id), { [field]: status })      );      await Promise.all(promises);            toast.success(`ƒê√£ c·∫≠p nh·∫≠t ${selectedItems.length} ${itemType}!`);      onClearSelection();      onRefresh();    } catch (error) {      toast.error('L·ªói khi c·∫≠p nh·∫≠t h√†ng lo·∫°t!');    } finally {      setLoading(false);    }  };  return (    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">      <div className=\"flex items-center justify-between\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-blue-800 font-medium\">          ƒê√£ ch·ªçn {selectedItems.length} {itemType}        </span>                <div className=\"flex gap-2\">          {itemType === 'users' && (            <>              <button                onClick={() => bulkUpdateStatus(true)}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"action.activate\")}              </button>              <button                onClick={() => bulkUpdateStatus(false)}                disabled={loading}                className=\"px-3 py-1 bg-yellow-600 text-white rounded text-sm hover:bg-yellow-700\"              >{t(\"action.deactivate\")}              </button>            </>          )}                    {itemType === 'quizzes' && (            <>              <button                onClick={() => bulkUpdateStatus('approved')}                disabled={loading}                className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"              >{t(\"admin.editRequests.approve\")}              </button>              <button                onClick={() => bulkUpdateStatus('rejected')}                disabled={loading}                className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"              >{t(\"admin.editRequests.reject\")}              </button>            </>          )}                    <button            onClick={bulkDelete}            disabled={loading}            className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"          >{t(\"action.clear\")}          </button>                    <button            onClick={onClearSelection}            className=\"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700\"          >{t(\"common.cancel\")}          </button>        </div>      </div>    </div>  );};export default BulkActions;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\QuickActions.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2498,2501],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2498,2501],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":280,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":280,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11045,11048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11045,11048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":297,"column":106,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":109,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12062,12065],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12062,12065],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { toast } from 'react-toastify';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { collection, addDoc, getDocs, updateDoc, doc } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\n\r\ninterface QuickActionsProps {\r\n  onRefreshData: () => void;\r\n  stats: {\r\n    totalUsers: number;\r\n    totalQuizzes: number;\r\n    completedQuizzes: number;\r\n    totalCreators: number;\r\n  };\r\n}\r\n\r\nconst QuickActions: React.FC<QuickActionsProps> = ({ onRefreshData, stats }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [showNotificationModal, setShowNotificationModal] = useState(false);\r\n  const [notificationData, setNotificationData] = useState({\r\n    message: '',\r\n    type: 'info' as 'info' | 'warning' | 'success' | 'error',\r\n    targetRole: 'all' as 'all' | 'user' | 'creator'\r\n  });\r\n  const [showBanner, setShowBanner] = useState(false);\r\n  const [bannerData, setBannerData] = useState<{message:string,type:string}|null>(null);\r\n\r\n  const { t } = useTranslation();\r\n\r\n  // 1. T·∫°o th√¥ng b√°o h·ªá th·ªëng\r\n  const createSystemNotification = async () => {\r\n    if (!notificationData.message.trim()) {\r\n      toast.error(t('admin.quickActions.toasts.enterMessage'));\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      await addDoc(collection(db, 'system_notifications'), {\r\n        message: notificationData.message,\r\n        type: notificationData.type,\r\n        createdAt: new Date(),\r\n        isActive: true,\r\n        targetRole: notificationData.targetRole\r\n      });\r\n      \r\n      // Reset form\r\n      setNotificationData({\r\n        message: '',\r\n        type: 'info',\r\n        targetRole: 'all'\r\n      });\r\n      setShowNotificationModal(false);\r\n      setBannerData({ message: notificationData.message, type: notificationData.type });\r\n      setShowBanner(true);\r\n      setTimeout(() => setShowBanner(false), 5000);\r\n      \r\n      toast.success(t('admin.quickActions.toasts.createSuccess'));\r\n    } catch (error) {\r\n      console.error('Error creating notification:', error);\r\n      toast.error(t('admin.quickActions.toasts.createError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const openNotificationModal = () => {\r\n    setShowNotificationModal(true);\r\n  };\r\n\r\n  // 2. Backup d·ªØ li·ªáu\r\n  const backupData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const collections = ['users', 'quizzes', 'categories', 'quiz_results'];\r\n      const backup: any = {};\r\n      \r\n      for (const collectionName of collections) {\r\n        const snapshot = await getDocs(collection(db, collectionName));\r\n        backup[collectionName] = snapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data()\r\n        }));\r\n      }\r\n\r\n      // T·∫°o file backup\r\n      const dataStr = JSON.stringify(backup, null, 2);\r\n      const dataBlob = new Blob([dataStr], { type: 'application/json' });\r\n      const url = URL.createObjectURL(dataBlob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `quiz-app-backup-${new Date().toISOString().split('T')[0]}.json`;\r\n      link.click();\r\n      \r\n      toast.success(t('admin.quickActions.toasts.backupSuccess'));\r\n    } catch (error) {\r\n      toast.error(t('admin.quickActions.toasts.backupError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // 3. X√≥a th√¥ng b√°o h·ªá th·ªëng\r\n  const deleteNotifications = async () => {\r\n    if (!confirm(t('admin.quickActions.toasts.confirmDeleteAll'))) return;\r\n    \r\n    setLoading(true);\r\n    try {\r\n      // L·∫•y t·∫•t c·∫£ th√¥ng b√°o ƒëang active\r\n      const notificationsSnapshot = await getDocs(collection(db, 'system_notifications'));\r\n      const deletePromises = notificationsSnapshot.docs.map(doc => \r\n        updateDoc(doc.ref, { isActive: false })\r\n      );\r\n      \r\n      await Promise.all(deletePromises);\r\n      toast.success(t('admin.quickActions.toasts.deleteSuccess'));\r\n      onRefreshData();\r\n    } catch (error) {\r\n      console.error('Error deleting notifications:', error);\r\n      toast.error(t('admin.quickActions.toasts.deleteError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // 4. D·ªçn d·∫πp d·ªØ li·ªáu ƒë√£ x√≥a\r\n  const cleanupDeletedData = async () => {\r\n    if (!confirm(t('admin.quickActions.toasts.confirmCleanup'))) return;\r\n    setLoading(true);\r\n    try {\r\n      // X√≥a quiz ƒë√£ b·ªã ƒë√°nh d·∫•u deleted=true\r\n      const quizzesSnapshot = await getDocs(collection(db, 'quizzes'));\r\n      const deletedQuizzes = quizzesSnapshot.docs.filter(doc => doc.data().deleted === true);\r\n      const quizDeletePromises = deletedQuizzes.map(q => updateDoc(doc(db, 'quizzes', q.id), { isPurged: true }));\r\n\r\n      // X√≥a user ƒë√£ b·ªã ƒë√°nh d·∫•u deleted=true\r\n      const usersSnapshot = await getDocs(collection(db, 'users'));\r\n      const deletedUsers = usersSnapshot.docs.filter(doc => doc.data().deleted === true);\r\n      const userDeletePromises = deletedUsers.map(u => updateDoc(doc(db, 'users', u.id), { isPurged: true }));\r\n\r\n      await Promise.all([...quizDeletePromises, ...userDeletePromises]);\r\n      toast.success(t('admin.quickActions.toasts.cleanupSuccess'));\r\n      onRefreshData();\r\n    } catch (error) {\r\n      toast.error(t('admin.quickActions.toasts.cleanupError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const quickActions = [\r\n    // Updated actions as requested\r\n    {\r\n      icon: 'üì¢',\r\n      title: t('admin.quickActions.items.notify.title'),\r\n      description: t('admin.quickActions.items.notify.desc'),\r\n      action: openNotificationModal,\r\n      color: 'blue'\r\n    },\r\n    {\r\n      icon: '‚ùå',\r\n      title: t('admin.quickActions.items.deleteNotifications.title'),\r\n      description: t('admin.quickActions.items.deleteNotifications.desc'),\r\n      action: deleteNotifications,\r\n      color: 'red'\r\n    },\r\n    {\r\n      icon: 'üóÇÔ∏è',\r\n      title: t('admin.quickActions.items.backup.title'),\r\n      description: t('admin.quickActions.items.backup.desc'),\r\n      action: backupData,\r\n      color: 'green'\r\n    },\r\n    {\r\n      icon: 'üóëÔ∏è',\r\n      title: t('admin.quickActions.items.cleanup.title'),\r\n      description: t('admin.quickActions.items.cleanup.desc'),\r\n      action: cleanupDeletedData,\r\n      color: 'orange'\r\n    }\r\n  ];\r\n\r\n  // Banner notification UI\r\n  useEffect(() => {\r\n    if (showBanner && bannerData) {\r\n      document.body.classList.add('overflow-x-hidden');\r\n    } else {\r\n      document.body.classList.remove('overflow-x-hidden');\r\n    }\r\n  }, [showBanner, bannerData]);\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow relative\">\r\n      {/* Banner notification */}\r\n      {showBanner && bannerData && (\r\n        <div className={`fixed top-4 left-1/2 transform -translate-x-1/2 z-[9999] px-6 py-4 rounded-full shadow-lg flex items-center gap-4 animate-slide-in\r\n          ${bannerData.type === 'info' ? 'bg-blue-500 text-white' : ''}\r\n          ${bannerData.type === 'success' ? 'bg-green-500 text-white' : ''}\r\n          ${bannerData.type === 'warning' ? 'bg-yellow-400 text-gray-900' : ''}\r\n          ${bannerData.type === 'error' ? 'bg-red-500 text-white' : ''}\r\n        `} style={{ minWidth: 320, maxWidth: '90vw' }}>\r\n          <span className=\"font-semibold text-lg truncate flex-1\">{bannerData.message}</span>\r\n          <button onClick={()=>setShowBanner(false)} className=\"ml-4 text-xl font-bold focus:outline-none\">√ó</button>\r\n        </div>\r\n      )}\r\n      <h3 className=\"text-lg font-semibold mb-4 flex items-center\">\r\n        <span className=\"text-2xl mr-2\">‚ö°</span>\r\n        {t('admin.quickActions.title')}\r\n      </h3>\r\n      \r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        {quickActions.map((action, index) => (\r\n          <button\r\n            key={index}\r\n            onClick={action.action}\r\n            disabled={loading}\r\n            className={`p-4 border-2 rounded-lg transition-all duration-200 text-left\r\n              border-${action.color}-200 hover:border-${action.color}-500 hover:bg-${action.color}-50\r\n              ${loading ? 'opacity-50 cursor-wait' : ''}\r\n            `}\r\n          >\r\n            <div className=\"text-3xl mb-2\">{action.icon}</div>\r\n            <div className=\"font-medium mb-1\">{action.title}</div>\r\n            <div className=\"text-sm text-gray-600\">{action.description}</div>\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Th·ªëng k√™ nhanh hi·ªÉn th·ªã */}\r\n      <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\r\n        <h4 className=\"font-medium mb-2\">üìä {t('admin.quickActions.systemStatus')}</h4>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n          <div>\r\n            <div className=\"text-gray-600\">{t('admin.quickActions.stats.users')}</div>\r\n            <div className=\"font-bold text-blue-600\">{stats.totalUsers}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-gray-600\">{t('admin.quickActions.stats.totalQuizzes')}</div>\r\n            <div className=\"font-bold text-yellow-600\">{stats.totalQuizzes}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-gray-600\">{t('admin.quickActions.stats.completions')}</div>\r\n            <div className=\"font-bold text-green-600\">{stats.completedQuizzes}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-gray-600\">{t('admin.quickActions.stats.creators')}</div>\r\n            <div className=\"font-bold text-purple-600\">{stats.totalCreators}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal g·ª≠i th√¥ng b√°o */}\r\n      {showNotificationModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">{t('admin.quickActions.modal.title')}</h2>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {/* N·ªôi dung th√¥ng b√°o */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  {t('admin.quickActions.modal.contentLabel')}\r\n                </label>\r\n                <textarea\r\n                  value={notificationData.message}\r\n                  onChange={(e) => setNotificationData(prev => ({ ...prev, message: e.target.value }))}\r\n                  placeholder={t('admin.quickActions.modal.contentPlaceholder')}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  rows={4}\r\n                />\r\n              </div>\r\n\r\n              {/* Lo·∫°i th√¥ng b√°o */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  {t('admin.quickActions.modal.typeLabel')}\r\n                </label>\r\n                <select\r\n                  value={notificationData.type}\r\n                  onChange={(e) => setNotificationData(prev => ({ ...prev, type: e.target.value as any }))}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                >\r\n                  <option value=\"info\">{t('admin.quickActions.modal.type.info')}</option>\r\n                  <option value=\"warning\">{t('admin.quickActions.modal.type.warning')}</option>\r\n                  <option value=\"success\">{t('admin.quickActions.modal.type.success')}</option>\r\n                  <option value=\"error\">{t('admin.quickActions.modal.type.error')}</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* ƒê·ªëi t∆∞·ª£ng nh·∫≠n th√¥ng b√°o */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  {t('admin.quickActions.modal.targetLabel')}\r\n                </label>\r\n                <select\r\n                  value={notificationData.targetRole}\r\n                  onChange={(e) => setNotificationData(prev => ({ ...prev, targetRole: e.target.value as any }))}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                >\r\n                  <option value=\"all\">{t('admin.quickActions.modal.target.all')}</option>\r\n                  <option value=\"user\">{t('admin.quickActions.modal.target.user')}</option>\r\n                  <option value=\"creator\">{t('admin.quickActions.modal.target.creator')}</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex justify-end space-x-3 pt-4\">\r\n                <button\r\n                  onClick={() => setShowNotificationModal(false)}\r\n                  className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors\"\r\n                  disabled={loading}\r\n                >\r\n                  {t('cancel')}\r\n                </button>\r\n                <button\r\n                  onClick={createSystemNotification}\r\n                  disabled={loading || !notificationData.message.trim()}\r\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {loading ? t('admin.quickActions.modal.sending') : t('admin.quickActions.modal.send')}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuickActions;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\components\\QuizPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Question' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RichTextViewer' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":98},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslation' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":160,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":174},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SafeHTML' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":205,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":213},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'QuizPreviewProps' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":270,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":286}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { Quiz, Question } from '../../quiz/types';import RichTextViewer from '../../../shared/components/ui/RichTextViewer';import { useTranslation } from 'react-i18next';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface QuizPreviewProps {  quiz: Quiz | null;  isOpen: boolean;  onClose: () => void;}// Modal component v·ªõi kh·∫£ nƒÉng cu·ªôn t·ªët h∆°nconst Modal: React.FC<{ isOpen: boolean; onClose: () => void; children: React.ReactNode }> = ({ isOpen, children }) => {  if (!isOpen) return null;  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-lg max-w-5xl w-full max-h-[95vh] overflow-y-auto shadow-2xl\">        {children}      </div>    </div>  );};const QuizPreview: React.FC<QuizPreviewProps> = ({ quiz, isOpen, onClose }) => {  const { t } = useTranslation();  // Guard clause to prevent null quiz errors  if (!quiz) {    return null;  }  return (    <Modal isOpen={isOpen} onClose={onClose}>      {/* Header - Sticky */}      <div className=\"sticky top-0 bg-white z-10 p-6 border-b border-gray-200 rounded-t-lg\">        <div className=\"flex justify-between items-start\">          <div className=\"flex-1 pr-4\">            <h2 className=\"text-2xl font-bold text-gray-900\">{quiz.title}</h2>            <RichTextViewer content={quiz.description || ''} className=\"text-gray-600 mt-2\" />          </div>          <button            onClick={onClose}            className=\"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0\"          >            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />            </svg>          </button>        </div>      </div>      {/* Quiz Info - Sticky */}      <div className=\"sticky top-[120px] bg-gray-50 p-6 border-b border-gray-200 z-10\">        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">          <div className=\"text-center\">            <div className=\"text-2xl font-bold text-blue-600\">{quiz.questions.length}</div>            <div className=\"text-sm text-gray-600\">{t('quiz.questions')}</div>          </div>          <div className=\"text-center\">            <div className=\"text-2xl font-bold text-green-600\">{quiz.duration}</div>            <div className=\"text-sm text-gray-600\">{t('minutes')}</div>          </div>          <div className=\"text-center\">            <div className=\"text-2xl font-bold text-purple-600\">{quiz.difficulty}</div>            <div className=\"text-sm text-gray-600\">{t('quiz.difficulty')}</div>          </div>          <div className=\"text-center\">            <div className={`text-2xl font-bold ${              quiz.status === 'approved' ? 'text-green-600' :               quiz.status === 'rejected' ? 'text-red-600' : 'text-yellow-600'            }`}>              {quiz.status === 'approved' ? t('status.approved') :                quiz.status === 'rejected' ? t('status.rejected') : t('status.pending')}            </div>            <div className=\"text-sm text-gray-600\">{t('status.label')}</div>          </div>        </div>      </div>      {/* Scrollable Content */}      <div className=\"p-6\">        <h3 className=\"text-lg font-semibold mb-6 text-gray-900\">{t('admin.preview.questionList')}</h3>                <div className=\"space-y-6\">          {quiz.questions.map((question: Question, index: number) => (            <div key={index} className=\"border border-gray-200 rounded-lg p-6 bg-white shadow-sm\">              <div className=\"flex justify-between items-start mb-4\">                <h4 className=\"font-semibold text-gray-900 text-lg\">                  {t('quiz.question')} {index + 1}: {question.text}                </h4>                <span className={`px-3 py-1 rounded-full text-xs font-medium ${                  question.type === 'multiple' ? 'bg-blue-100 text-blue-800' :                  question.type === 'checkbox' ? 'bg-green-100 text-green-800' :                  question.type === 'boolean' ? 'bg-purple-100 text-purple-800' :                  'bg-yellow-100 text-yellow-800'                }`}>                  {question.type === 'multiple' ? t('quiz.questionTypes.multiple') :                   question.type === 'checkbox' ? t('quiz.questionTypes.checkbox') :                   question.type === 'boolean' ? t('quiz.questionTypes.boolean') :                   question.type === 'short_answer' ? t('quiz.questionTypes.short_answer') :                   t('quiz.questionTypes.image')}                </span>              </div>              {/* Answers */}              <div className=\"space-y-3\">                {question.type === 'short_answer' ? (                    <div className=\"p-4 bg-green-50 border-2 border-green-300 rounded-lg\">                    <div className=\"flex items-center\">                        <span className=\"font-medium text-green-800\">{t('quiz.correctAnswer')}: </span>                      <span className=\"ml-2 text-green-700 font-semibold\">{question.correctAnswer}</span>                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"ml-2 text-green-600 text-xl\">‚úì</span>                    </div>                  </div>                ) : (                  question.answers?.map((answer: any, answerIndex: number) => (                    <div                      key={answerIndex}                      className={`p-4 rounded-lg border-2 ${                        answer.isCorrect                          ? 'bg-green-50 border-green-300 text-green-800'                          : 'bg-gray-50 border-gray-200 text-gray-700'                      }`}                    >                      <div className=\"flex items-center justify-between\">                        <span className=\"font-medium\">                          {String.fromCharCode(65 + answerIndex)}. {answer.text}                        </span>                        {answer.isCorrect && (                          // eslint-disable-next-line i18next/no-literal-string                          <span className=\"text-green-600 text-xl\">‚úì</span>                        )}                      </div>                    </div>                  ))                )}              </div>              {/* Question Details */}              <div className=\"mt-4 pt-4 border-t border-gray-200\">                <div className=\"flex justify-between items-center text-sm\">                  <span className=\"text-gray-600\">                    <span className=\"font-medium\">{t('common.points')}: </span>                    <span className=\"text-blue-600 font-semibold\">{question.points}</span>                  </span>                  {question.explanation && (                    <span className=\"text-gray-600\">                      <span className=\"font-medium\">{t('quiz.explanation')}: </span>                      <SafeHTML content={question.explanation} className=\"text-gray-700\" />                    </span>                  )}                </div>              </div>            </div>          ))}        </div>        {/* Footer Actions */}        <div className=\"mt-8 pt-6 border-t border-gray-200 bg-gray-50 -mx-6 px-6 pb-6\">          <div className=\"flex justify-between items-center\">            <div className=\"text-sm text-gray-600\">              {t('quiz.questions')}: <span className=\"font-semibold\">{quiz.questions.length}</span> -               <span className=\"font-semibold ml-1\">{t('quiz.points', {points: quiz.questions.reduce((sum, q) => sum + (q.points || 0), 0),                defaultValue: `Points: ${quiz.questions.reduce((sum, q) => sum + (q.points || 0), 0)}`})}</span>            </div>            <button              onClick={onClose}              className=\"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium\"            >              {t('close')}            </button>          </div>        </div>      </div>    </Modal>  );};export default QuizPreview;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\Admin.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":18022,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';import { useSelector } from 'react-redux';import { Link } from 'react-router-dom';import { useTranslation } from 'react-i18next';import { RootState } from '../../../lib/store';import AdminLayout from '../components/AdminLayout';import { toast } from 'react-toastify';import { collection, addDoc, getDocs, updateDoc, doc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';const Admin: React.FC = () => {  const { t } = useTranslation();  // State cho th·ªëng k√™  const [stats, setStats] = useState({    totalQuizzes: 0,    totalUsers: 0,    completedQuizzes: 0,    totalCreators: 0,  });  useEffect(() => {    const fetchStats = async () => {      try {        // ƒê·ªìng b·ªô logic v·ªõi /home: d√πng d·ªØ li·ªáu th·ª±c, ƒë·∫øm to√†n b·ªô quiz v√† ng∆∞·ªùi d√πng ƒëang ho·∫°t ƒë·ªông        const [quizzesSnap, usersSnap] = await Promise.all([          getDocs(collection(db, 'quizzes')),          getDocs(collection(db, 'users'))        ]);        // T·ªïng s·ªë quiz = t·∫•t c·∫£ document trong 'quizzes'        const totalQuizzes = quizzesSnap.size;        // Ch·ªâ ƒë·∫øm ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông (isActive !== false v√† isDeleted !== true)        const users = usersSnap.docs.map(doc => doc.data() as any);        const activeUsers = users.filter(u => u?.isActive !== false && u?.isDeleted !== true);        const totalUsers = activeUsers.length;        // Ng∆∞·ªùi t·∫°o: role 'creator' ho·∫∑c 'admin' trong nh√≥m active        const totalCreators = activeUsers.filter(u => u?.role === 'creator' || u?.role === 'admin').length;        // Ch∆∞a c√≥ d·ªØ li·ªáu quiz results => ƒë·ªÉ 0 cho kh·ªõp v·ªõi /home        const completedQuizzes = 0;        setStats({          totalQuizzes,          totalUsers,          completedQuizzes,          totalCreators,        });      } catch (_) {        // silent      }    };    fetchStats();  }, []);  const { user } = useSelector((state: RootState) => state.auth);  const [showNotificationModal, setShowNotificationModal] = useState(false);  const [loading, setLoading] = useState(false);  const [notificationData, setNotificationData] = useState({    message: '',    type: 'info' as 'info' | 'warning' | 'success' | 'error',    targetRole: 'all' as 'all' | 'user' | 'creator'  });  const createSystemNotification = async () => {    if (!notificationData.message.trim()) {      toast.error(t('admin.quickActions.toasts.enterMessage'));      return;    }    setLoading(true);    try {      await addDoc(collection(db, 'system_notifications'), {        message: notificationData.message,        type: notificationData.type,        createdAt: new Date(),        isActive: true,        targetRole: notificationData.targetRole      });            // Reset form      setNotificationData({        message: '',        type: 'info',        targetRole: 'all'      });      setShowNotificationModal(false);            toast.success(t('admin.quickActions.toasts.createSuccess'));    } catch (error) {      console.error('Error creating notification:', error);      toast.error(t('admin.quickActions.toasts.createError'));    } finally {      setLoading(false);    }  };  // Backup d·ªØ li·ªáu  const backupData = async () => {    setLoading(true);    try {      const collections = ['users', 'quizzes', 'categories', 'quiz_results'];      const backup: any = {};            for (const collectionName of collections) {        const snapshot = await getDocs(collection(db, collectionName));        backup[collectionName] = snapshot.docs.map(doc => ({          id: doc.id,          ...doc.data()        }));      }      // T·∫°o file backup      const dataStr = JSON.stringify(backup, null, 2);      const dataBlob = new Blob([dataStr], { type: 'application/json' });      const url = URL.createObjectURL(dataBlob);      const link = document.createElement('a');      link.href = url;      link.download = `quiz-app-backup-${new Date().toISOString().split('T')[0]}.json`;      link.click();            toast.success(t('admin.quickActions.toasts.backupSuccess'));    } catch (error) {      toast.error(t('admin.quickActions.toasts.backupError'));    } finally {      setLoading(false);    }  };  // X√≥a th√¥ng b√°o h·ªá th·ªëng  const deleteNotifications = async () => {    if (!confirm(t('admin.quickActions.toasts.confirmDeleteAll'))) return;        setLoading(true);    try {      const notificationsSnapshot = await getDocs(collection(db, 'system_notifications'));      const deletePromises = notificationsSnapshot.docs.map(doc =>         updateDoc(doc.ref, { isActive: false })      );            await Promise.all(deletePromises);      toast.success(t('admin.quickActions.toasts.deleteSuccess'));    } catch (error) {      console.error('Error deleting notifications:', error);      toast.error(t('admin.quickActions.toasts.deleteError'));    } finally {      setLoading(false);    }  };  // D·ªçn d·∫πp d·ªØ li·ªáu ƒë√£ x√≥a  const cleanupDeletedData = async () => {    if (!confirm(t('admin.quickActions.toasts.confirmCleanup'))) return;    setLoading(true);    try {      const quizzesSnapshot = await getDocs(collection(db, 'quizzes'));      const deletedQuizzes = quizzesSnapshot.docs.filter(doc => doc.data().deleted === true);      const quizDeletePromises = deletedQuizzes.map(q => updateDoc(doc(db, 'quizzes', q.id), { isPurged: true }));      const usersSnapshot = await getDocs(collection(db, 'users'));      const deletedUsers = usersSnapshot.docs.filter(doc => doc.data().deleted === true);      const userDeletePromises = deletedUsers.map(u => updateDoc(doc(db, 'users', u.id), { isPurged: true }));      await Promise.all([...quizDeletePromises, ...userDeletePromises]);      toast.success(t('admin.quickActions.toasts.cleanupSuccess'));    } catch (error) {      toast.error(t('admin.quickActions.toasts.cleanupError'));    } finally {      setLoading(false);    }  };  if (user?.role !== 'admin') {    return (      <div className=\"text-center py-12\">        <p className=\"text-gray-600\">{t('admin.loginAsAdmin')}</p>      </div>    );  }  return (    <AdminLayout title={t(\"admin.sidebar.nav.dashboard\")}>      {/* Welcome Section */}      <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg shadow-lg p-6 mb-8 text-white\">        <h1 className=\"text-2xl md:text-3xl font-bold mb-2\">{t('admin.greeting')}</h1>        <p className=\"text-blue-100\">{t('admin.dashboardSubtitle')}</p>      </div>      {/* Stats Grid - Responsive */}      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8\">        <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200\">          <div className=\"flex items-center\">            <div className=\"p-2 bg-blue-100 rounded-lg\">              <span className=\"text-2xl\">üìö</span>            </div>            <div className=\"ml-4\">              <h3 className=\"text-sm md:text-base font-semibold text-gray-900\">{t('dashboard.totalQuizzes')}</h3>              <div className=\"text-xl md:text-3xl font-bold text-blue-600\">{stats.totalQuizzes}</div>            </div>          </div>        </div>                <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200\">          <div className=\"flex items-center\">            <div className=\"p-2 bg-green-100 rounded-lg\">              <span className=\"text-2xl\">üë•</span>            </div>            <div className=\"ml-4\">              <h3 className=\"text-sm md:text-base font-semibold text-gray-900\">{t('dashboard.totalUsers')}</h3>              <div className=\"text-xl md:text-3xl font-bold text-green-600\">{stats.totalUsers}</div>            </div>          </div>        </div>                <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200\">          <div className=\"flex items-center\">            <div className=\"p-2 bg-purple-100 rounded-lg\">              <span className=\"text-2xl\">‚úÖ</span>            </div>            <div className=\"ml-4\">              <h3 className=\"text-sm md:text-base font-semibold text-gray-900\">{t('dashboard.completedQuizzes')}</h3>              <div className=\"text-xl md:text-3xl font-bold text-purple-600\">{stats.completedQuizzes}</div>            </div>          </div>        </div>                <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200\">          <div className=\"flex items-center\">            <div className=\"p-2 bg-orange-100 rounded-lg\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"text-2xl\">‚úèÔ∏è</span>            </div>            <div className=\"ml-4\">              <h3 className=\"text-sm md:text-base font-semibold text-gray-900\">{t('dashboard.totalCreators')}</h3>              <div className=\"text-xl md:text-3xl font-bold text-orange-600\">{stats.totalCreators}</div>            </div>          </div>        </div>      </div>      {/* Management Grid - Responsive */}      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6\">        <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6\">          <h3 className=\"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4\">{t('admin.tabs.quizManagement')}</h3>          <div className=\"space-y-2\">            <Link               to=\"/admin/quiz-management\"               className=\"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base\"            // eslint-disable-next-line i18next/no-literal-string            >              ‚óÜ {t('admin.tabs.quizManagement')}            </Link>            <Link               to=\"/admin/categories\"               className=\"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base\"            >              üìÇ {t('admin.tabs.categoryManagement')}            </Link>            <Link               to=\"/admin/quiz-stats\"               className=\"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base\"            >              üìä {t('admin.stats.quizActivity')}            </Link>          </div>        </div>                <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6\">          <h3 className=\"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4\">{t('admin.tabs.userManagement')}</h3>          <div className=\"space-y-2\">            <Link               to=\"/admin/users\"               className=\"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base\"            >              üë• {t('admin.tabs.users')}            </Link>            <Link               to=\"/admin/roles\"               className=\"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base\"            >              üîê {t('admin.roles')}            </Link>          </div>        </div>      </div>            {/* Quick Actions - Enhanced Design */}      <div className=\"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200\">        <div className=\"flex items-center justify-between mb-4\">            <h2 className=\"text-lg md:text-xl font-semibold text-gray-900 flex items-center\">            <span className=\"bg-blue-100 p-2 rounded-lg mr-3\">‚ö°</span>              {t('admin.quickActions.title')}          </h2>          <span className=\"text-sm text-gray-500\">{t('admin.quickActions.important')}</span>        </div>                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4\">          <button             onClick={() => setShowNotificationModal(true)}            className=\"group bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg\"            disabled={loading}          >            <div className=\"flex flex-col items-center space-y-2\">              <span className=\"text-2xl group-hover:scale-110 transition-transform\">üì¢</span>              <span className=\"text-sm font-medium\">{t('admin.quickActions.items.notify.title')}</span>            </div>          </button>                    <button             onClick={deleteNotifications}            className=\"group bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg\"            disabled={loading}          >            <div className=\"flex flex-col items-center space-y-2\">              <span className=\"text-2xl group-hover:scale-110 transition-transform\">‚ùå</span>              <span className=\"text-sm font-medium\">{t('admin.quickActions.items.deleteNotifications.title')}</span>            </div>          </button>                    <button             onClick={backupData}            className=\"group bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg\"            disabled={loading}          >            <div className=\"flex flex-col items-center space-y-2\">              <span className=\"text-2xl group-hover:scale-110 transition-transform\">üíæ</span>              <span className=\"text-sm font-medium\">{t('admin.quickActions.items.backup.title')}</span>            </div>          </button>                    <button             onClick={cleanupDeletedData}            className=\"group bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg\"            disabled={loading}          >            <div className=\"flex flex-col items-center space-y-2\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"text-2xl group-hover:scale-110 transition-transform\">üóëÔ∏è</span>              <span className=\"text-sm font-medium\">{t('admin.quickActions.items.cleanup.title')}</span>            </div>          </button>        </div>      </div>      {/* Modal g·ª≠i th√¥ng b√°o - Responsive */}      {showNotificationModal && (        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">          <div className=\"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4\">            <h2 className=\"text-lg md:text-xl font-semibold mb-4\">{t('admin.quickActions.modal.title')}</h2>                        <div className=\"space-y-4\">              {/* N·ªôi dung th√¥ng b√°o */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t('admin.quickActions.modal.contentLabel')}</label>                <textarea                  value={notificationData.message}                  onChange={(e) => setNotificationData(prev => ({ ...prev, message: e.target.value }))}                  placeholder={t('admin.quickActions.modal.contentPlaceholder')}                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base\"                  rows={4}                />              </div>              {/* Lo·∫°i th√¥ng b√°o */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t('admin.quickActions.modal.typeLabel')}</label>                <select                  value={notificationData.type}                  onChange={(e) => setNotificationData(prev => ({ ...prev, type: e.target.value as any }))}                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base\"                >                  <option value=\"info\">{t('admin.quickActions.modal.type.info')}</option>                  <option value=\"warning\">{t('admin.quickActions.modal.type.warning')}</option>                  <option value=\"success\">{t('admin.quickActions.modal.type.success')}</option>                  <option value=\"error\">{t('admin.quickActions.modal.type.error')}</option>                </select>              </div>              {/* ƒê·ªëi t∆∞·ª£ng nh·∫≠n th√¥ng b√°o */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t('admin.quickActions.modal.targetLabel')}</label>                <select                  value={notificationData.targetRole}                  onChange={(e) => setNotificationData(prev => ({ ...prev, targetRole: e.target.value as any }))}                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base\"                >                  <option value=\"all\">{t('admin.quickActions.modal.target.all')}</option>                  <option value=\"user\">{t('admin.quickActions.modal.target.user')}</option>                  <option value=\"creator\">{t('admin.quickActions.modal.target.creator')}</option>                </select>              </div>              {/* Buttons */}              <div className=\"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 pt-4\">                <button                  onClick={() => setShowNotificationModal(false)}                  className=\"w-full sm:w-auto px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm md:text-base\"                  disabled={loading}                >                  {t('cancel')}                </button>                <button                  onClick={createSystemNotification}                  disabled={loading || !notificationData.message.trim()}                  className=\"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base\"                >                  {loading ? t('admin.quickActions.modal.sending') : t('admin.quickActions.modal.send')}                </button>              </div>            </div>          </div>        </div>      )}    </AdminLayout>  );};export default Admin;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\AdminDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';// import { useSelector, useDispatch } from 'react-redux';import { useTranslation } from 'react-i18next';// import { RootState } from '../../../lib/store';// import { logout } from '../../auth/store';// import { signOut } from 'firebase/auth';import { db } from '../../../lib/firebase/config';import {   collection,   getDocs,   doc,   updateDoc,   deleteDoc,   addDoc,  query,  orderBy} from 'firebase/firestore';import Modal from '../../../shared/components/ui/Modal';import QuickActions from '../components/QuickActions';import AdminStats from '../components/AdminStats';import { toast } from 'react-toastify';interface User {  id: string;  email: string;  displayName: string;  role: 'user' | 'admin' | 'creator';  createdAt: any;  isActive: boolean;}interface Quiz {  id: string;  title: string;  description: string;  createdBy: string;  status: 'pending' | 'approved' | 'rejected' | 'draft' | 'published';  createdAt: any;  category: string;  learningResources?: any[]; // T√†i li·ªáu h·ªçc t·∫≠p}interface Category {  id: string;  name: string;  description: string;  quizCount: number;}const AdminDashboard: React.FC = () => {  const { t } = useTranslation();  // const navigate = useNavigate();  // const { user } = useSelector((state: RootState) => state.auth);  // const dispatch = useDispatch();    // States  const [activeTab, setActiveTab] = useState('dashboard');  const [users, setUsers] = useState<User[]>([]);  const [quizzes, setQuizzes] = useState<Quiz[]>([]);  const [categories, setCategories] = useState<Category[]>([]);  const [loading, setLoading] = useState(true);  const [stats, setStats] = useState<any>(null);  // Function to calculate and update stats from actual data  const updateStatsFromData = (users: User[], quizzes: Quiz[]) => {    // Count ALL users (including admins for admin dashboard)    const totalUsers = users.length;        // Count ALL quizzes regardless of status    const totalQuizzes = quizzes.length;        // Count quizzes by status for meaningful metrics    const approvedQuizzes = quizzes.filter(q => q.status === 'approved').length;    const publishedQuizzes = quizzes.filter(q => q.status === 'published').length;    const pendingQuizzes = quizzes.filter(q => q.status === 'pending').length;    const completedQuizzes = approvedQuizzes + publishedQuizzes; // Available for users        // Calculate creators more accurately    const creatorRoleUsers = users.filter(u => u.role === 'creator').length;    const quizCreatorIds = new Set(quizzes.map(q => q.createdBy).filter(Boolean));    const totalCreators = Math.max(creatorRoleUsers, quizCreatorIds.size);        const newStats = {      totalUsers: totalUsers,      totalQuizzes: totalQuizzes,      completedQuizzes: completedQuizzes,      totalCreators: totalCreators    };        setStats(newStats);        console.log('üìä DETAILED Stats calculation:', {      totalUsersInDB: users.length,      adminUsers: users.filter(u => u.role === 'admin').length,      creatorUsers: users.filter(u => u.role === 'creator').length,      normalUsers: users.filter(u => u.role === 'user').length,      totalQuizzesInDB: quizzes.length,      approvedQuizzes: approvedQuizzes,      publishedQuizzes: publishedQuizzes,      pendingQuizzes: pendingQuizzes,      creatorRoleUsers: creatorRoleUsers,      quizCreatorIds: quizCreatorIds.size,      finalStats: newStats    });  };  // New category form  const [newCategory, setNewCategory] = useState({ name: '', description: '' });  const [showAddCategory, setShowAddCategory] = useState(false);  // State cho modal x√°c nh·∫≠n  const [confirmModal, setConfirmModal] = useState<{    open: boolean;    type: null | 'deleteUser' | 'deleteQuiz' | 'deleteCategory' | 'toggleUserStatus';    payload?: any;    message?: string;  }>({ open: false, type: null });  // State for last update time  const [lastUpdate, setLastUpdate] = useState<Date | null>(null);  useEffect(() => {    const loadRealData = async () => {      setLoading(true);      try {        const [usersData, quizzesData, categoriesData] = await Promise.all([          loadUsersData(),          loadQuizzesData(),          loadCategoriesData(),        ]);        setUsers(usersData);        setQuizzes(quizzesData);        setCategories(categoriesData);        updateStatsFromData(usersData, quizzesData);        setLastUpdate(new Date());      } catch (error) {        console.error('Error loading data:', error);        toast.error(t('admin.dataLoadError'));      } finally {        setLoading(false);      }    };    loadRealData();    const interval = setInterval(loadRealData, 30000);    return () => clearInterval(interval);  }, [t]);  // Data loading functions that return data instead of updating state  const loadUsersData = async (): Promise<User[]> => {    try {      const usersQuery = query(collection(db, 'users'), orderBy('createdAt', 'desc'));      const snapshot = await getDocs(usersQuery);      const usersData = snapshot.docs.map(doc => ({        id: doc.id,        ...doc.data()      } as User));      console.log('Loaded users:', usersData.length);      return usersData;    } catch (error) {      console.error('Error loading users:', error);      return []; // Return empty array on error    }  };  const loadQuizzesData = async (): Promise<Quiz[]> => {    try {      const quizzesQuery = query(collection(db, 'quizzes'), orderBy('createdAt', 'desc'));      const snapshot = await getDocs(quizzesQuery);      const quizzesData = snapshot.docs.map(doc => ({        id: doc.id,        ...doc.data()      } as Quiz));      console.log('Loaded quizzes:', quizzesData.length);      return quizzesData;    } catch (error) {      console.error('Error loading quizzes:', error);      return []; // Return empty array on error    }  };  const loadCategoriesData = async (): Promise<Category[]> => {    try {      const categoriesQuery = query(collection(db, 'categories'), orderBy('name'));      const snapshot = await getDocs(categoriesQuery);      const categoriesData = snapshot.docs.map(doc => ({        id: doc.id,        ...doc.data()      } as Category));      console.log('Loaded categories:', categoriesData.length);      return categoriesData;    } catch (error) {      console.error('Error loading categories:', error);      return []; // Return empty array on error    }  };  const loadData = async () => {    setLoading(true);    try {      // Load all data concurrently      const [usersData, quizzesData, categoriesData] = await Promise.all([        loadUsersData(),        loadQuizzesData(),        loadCategoriesData()      ]);            // Update state with actual data      setUsers(usersData);      setQuizzes(quizzesData);      setCategories(categoriesData);            // Update stats from actual data      updateStatsFromData(usersData, quizzesData);            setLastUpdate(new Date());      console.log('Data refreshed at:', new Date().toLocaleTimeString());    } catch (error) {      console.error('Error loading data:', error);      toast.error(t('admin.dataLoadError'));    } finally {      setLoading(false);    }  };  const updateUserRole = async (userId: string, newRole: 'user' | 'admin') => {    try {      await updateDoc(doc(db, 'users', userId), { role: newRole });      await loadData();      toast.success(t('admin.roleUpdateSuccess'));    } catch (error) {      console.error('Error updating user role:', error);      toast.error(t('admin.roleUpdateError'));    }  };  const toggleUserStatus = async (userId: string, currentStatus: boolean) => {    setLoading(true);    try {      await updateDoc(doc(db, 'users', userId), { isActive: !currentStatus });      await loadData();      toast.success(t('admin.userStatusUpdateSuccess', {action: !currentStatus ? t('admin.activated') : t('admin.deactivated')}));    } catch (error) {      console.error('Error updating user status:', error);      toast.error(t('admin.statusUpdateError'));    } finally {      setLoading(false);    }  };  const deleteUser = async (userId: string) => {    setLoading(true);    try {      await deleteDoc(doc(db, 'users', userId));      await loadData();      toast.success(t('admin.userDeleteSuccess'));    } catch (error) {      console.error('Error deleting user:', error);      toast.error(t('admin.userDeleteError'));    } finally {      setLoading(false);    }  };  const approveQuiz = async (quizId: string) => {    setLoading(true);    try {      await updateDoc(doc(db, 'quizzes', quizId), { status: 'approved' });      await loadData();      toast.success(t('admin.quizApproved'));    } catch (error) {      console.error('Error approving quiz:', error);      toast.error(t('admin.quizApprovalError'));    } finally {      setLoading(false);    }  };  const rejectQuiz = async (quizId: string) => {    setLoading(true);    try {      await updateDoc(doc(db, 'quizzes', quizId), { status: 'rejected' });      await loadData();      toast.success(t('admin.quizRejected'));    } catch (error) {      console.error('Error rejecting quiz:', error);      toast.error(t('admin.quizRejectionError'));    } finally {      setLoading(false);    }  };  const reopenQuiz = async (quizId: string) => {    setLoading(true);    try {      await updateDoc(doc(db, 'quizzes', quizId), { status: 'pending' });      await loadData();      toast.success(t('admin.quizReopened'));    } catch (error) {      console.error('Error reopening quiz:', error);      toast.error(t('admin.quizReopenError'));    } finally {      setLoading(false);    }  };  const deleteQuiz = async (quizId: string) => {    setLoading(true);    try {      await deleteDoc(doc(db, 'quizzes', quizId));      await loadData();      toast.success(t('quiz.deleteSuccess'));    } catch (error) {      console.error('Error deleting quiz:', error);      toast.error(t('quiz.deleteError'));    } finally {      setLoading(false);    }  };  const addCategory = async () => {    if (!newCategory.name.trim()) {      toast.error(t('admin.categories.enterName'));      return;    }    setLoading(true);    try {      await addDoc(collection(db, 'categories'), {        name: newCategory.name,        description: newCategory.description,        createdAt: new Date()      });            setNewCategory({ name: '', description: '' });      setShowAddCategory(false);      await loadData();      toast.success(t('admin.categories.addSuccess'));    } catch (error) {      console.error('Error adding category:', error);      toast.error(t('admin.categories.addError'));    } finally {      setLoading(false);    }  };  const deleteCategory = async (categoryId: string) => {    setLoading(true);    try {      await deleteDoc(doc(db, 'categories', categoryId));      await loadData();      toast.success(t('admin.categories.deleteSuccess'));    } catch (error) {      console.error('Error deleting category:', error);      toast.error(t('admin.categories.deleteError'));    } finally {      setLoading(false);    }  };  const renderDashboard = () => {    console.log('Rendering dashboard with stats:', stats);    return (      <div className=\"space-y-6\">        {/* Alert */}        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">          <div className=\"flex items-center\">            <span className=\"text-2xl mr-3\">‚úÖ</span>            <div>              <h3 className=\"font-semibold text-green-800\">{t('admin.viewingStatsSection')}</h3>              <p className=\"text-green-700 text-sm\">{t('admin.advancedStatsDescription')}</p>            </div>          </div>        </div>        {/* Advanced Stats synced with real data */}        <AdminStats key={lastUpdate?.getTime() || 'initial'} />                {/* Quick Actions */}        <QuickActions           onRefreshData={loadData}          stats={stats}        />      </div>    );  };  const renderUsers = () => (    <div className=\"bg-white rounded-lg shadow overflow-hidden\">      <div className=\"px-6 py-4 border-b border-gray-200\">        <h3 className=\"text-lg font-semibold\">{t('admin.userManagement')}</h3>      </div>            <div className=\"overflow-x-auto\">        <table className=\"min-w-full divide-y divide-gray-200\">          <thead className=\"bg-gray-50\">            <tr>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">{t(\"admin.tabs.users\")}              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">{t(\"auth.email\")}              </th>              // eslint-disable-next-line i18next/no-literal-string              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                Role              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">{t(\"admin.preview.status\")}              </th>              // eslint-disable-next-line i18next/no-literal-string              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                Thao t√°c              </th>            </tr>          </thead>          <tbody className=\"bg-white divide-y divide-gray-200\">            {users.map((user) => (              <tr key={user.id}>                <td className=\"px-6 py-4 whitespace-nowrap\">                  <div className=\"font-medium text-gray-900\">                    {user.displayName || 'Ch∆∞a c√≥ t√™n'}                  </div>                </td>                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600\">                  {user.email}                </td>                <td className=\"px-6 py-4 whitespace-nowrap\">                  <select                    value={user.role}                    onChange={(e) => updateUserRole(user.id, e.target.value as any)}                    className=\"border border-gray-300 rounded px-2 py-1 text-sm\"                  >                    // eslint-disable-next-line i18next/no-literal-string                    <option value=\"user\">User</option>                    <option value=\"admin\">{t(\"admin.quizManagement.adminBadge\")}</option>                  </select>                </td>                <td className=\"px-6 py-4 whitespace-nowrap\">                  <span className={`px-2 py-1 text-xs rounded-full ${                    user.isActive !== false ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'                  }`}>                    {user.isActive !== false ? t('admin.userStatus.active') : t('admin.userStatus.blocked')}                  </span>                </td>                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2\">                  <button                    onClick={() => setConfirmModal({ open: true, type: 'toggleUserStatus', payload: { userId: user.id, currentStatus: user.isActive !== false }, message: user.isActive !== false ? t('admin.confirmations.lockUser') : t('admin.confirmations.unlockUser') })}                    className={`px-3 py-1 rounded text-xs ${user.isActive !== false ? 'bg-red-100 text-red-600 hover:bg-red-200' : 'bg-green-100 text-green-600 hover:bg-green-200'}`}                  >                    {user.isActive !== false ? t('admin.userStatus.lockButton') : t('admin.userStatus.unlockButton')}                  </button>                                    {user.email !== 'admin123@gmail.com' && (                    <button                      onClick={() => setConfirmModal({ open: true, type: 'deleteUser', payload: { userId: user.id }, message: t('admin.confirmations.deleteUser') })}                      className=\"px-3 py-1 bg-red-100 text-red-600 rounded text-xs hover:bg-red-200\"                    >{t(\"action.clear\")}                    </button>                  )}                </td>              </tr>            ))}          </tbody>        </table>      </div>    </div>  );  const renderQuizzes = () => (    <div className=\"space-y-6\" data-testid=\"quiz-review-system\">        {/* Alert */}      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">        <div className=\"flex items-center\">          <span className=\"text-2xl mr-3\">üìù</span>          <div>            <h3 className=\"font-semibold text-yellow-800\">{t('admin.quizManagement.label')}</h3>            <p className=\"text-yellow-700 text-sm\">{t('admin.tabs.quizzes')}</p>          </div>        </div>      </div>      <div className=\"bg-white rounded-lg shadow overflow-hidden\">        <div className=\"px-6 py-4 border-b border-gray-200\">          <h3 className=\"text-lg font-semibold\">{t('admin.quizManagement.label')}</h3>        </div>                <div className=\"overflow-x-auto\">          <table className=\"min-w-full divide-y divide-gray-200\">            <thead className=\"bg-gray-50\">              <tr>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('admin.quizManagement.table.title')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('quiz.description')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('status.pending')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('action.action')}                </th>              </tr>            </thead>            <tbody className=\"bg-white divide-y divide-gray-200\">              {quizzes.map((quiz) => (                <tr key={quiz.id}>                  <td className=\"px-6 py-4 font-medium text-gray-900\">                    <div>                      <div className=\"font-medium\">{quiz.title}</div>                      {quiz.learningResources && quiz.learningResources.length > 0 && (                        <div className=\"flex items-center gap-1.5 mt-1 text-xs text-emerald-600\">                          <span className=\"inline-flex items-center gap-1 px-1.5 py-0.5 bg-emerald-50 rounded\">                            // eslint-disable-next-line i18next/no-literal-string                            üìö {quiz.learningResources.length} t√†i li·ªáu                          </span>                          {quiz.learningResources.some((r: any) => r.required) && (                            // eslint-disable-next-line i18next/no-literal-string                            <span className=\"text-red-600\">‚ö†Ô∏è</span>                          )}                        </div>                      )}                    </div>                  </td>                  <td className=\"px-6 py-4 text-sm text-gray-600 max-w-xs truncate\">                    {quiz.description}                  </td>                  <td className=\"px-6 py-4 whitespace-nowrap\">                    <span className={`px-2 py-1 text-xs rounded-full ${                      quiz.status === 'approved' ? 'bg-green-100 text-green-800' :                      quiz.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :                      'bg-red-100 text-red-800'                    }`}>                       {quiz.status === 'approved' ? t('status.approved') :                        quiz.status === 'pending' ? t('status.pending') : t('status.rejected')}                    </span>                  </td>                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2\">                    {quiz.status === 'pending' && (                      <>                        <button                          onClick={() => approveQuiz(quiz.id)}                          className=\"px-3 py-1 bg-green-100 text-green-600 rounded text-xs hover:bg-green-200\"                        >                          {t('action.approve')}                        </button>                        <button                          onClick={() => rejectQuiz(quiz.id)}                          className=\"px-3 py-1 bg-yellow-100 text-yellow-600 rounded text-xs hover:bg-yellow-200\"                        >                          {t('action.reject')}                        </button>                      </>                    )}                                        {quiz.status === 'rejected' && (                      <button                        onClick={() => reopenQuiz(quiz.id)}                        className=\"px-3 py-1 bg-blue-100 text-blue-600 rounded text-xs hover:bg-blue-200\"                      >                         {t('admin.quizManagement.tooltips.reopen')}                      </button>                    )}                                        <button                       onClick={() => setConfirmModal({ open: true, type: 'deleteQuiz', payload: { quizId: quiz.id }, message: t('quiz.confirmDelete') })}                      className=\"px-3 py-1 bg-red-100 text-red-600 rounded text-xs hover:bg-red-200\"                    >                      {t('delete')}                    </button>                  </td>                </tr>              ))}            </tbody>          </table>        </div>      </div>    </div>  );  const renderCategories = () => (    <div className=\"space-y-6\">      {/* Add Category Button */}      <div className=\"bg-white p-6 rounded-lg shadow\">        <div className=\"flex justify-between items-center mb-4\">          <h3 className=\"text-lg font-semibold\">{t('admin.categoryManagement')}</h3>          <button            onClick={() => setShowAddCategory(!showAddCategory)}            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"          >            {t('categories.add')}          </button>        </div>        {/* Add Category Form */}        {showAddCategory && (          <div className=\"border-t pt-4\">            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">              <input                type=\"text\"                placeholder={t('categories.name')}                value={newCategory.name}                onChange={(e) => setNewCategory(prev => ({ ...prev, name: e.target.value }))}                className=\"border border-gray-300 rounded px-3 py-2\"              />              <input                type=\"text\"                placeholder={t('categories.description')}                value={newCategory.description}                onChange={(e) => setNewCategory(prev => ({ ...prev, description: e.target.value }))}                className=\"border border-gray-300 rounded px-3 py-2\"              />            </div>            <div className=\"mt-4 space-x-2\">              <button                onClick={addCategory}                className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"              >                {t('save')}              </button>              <button                onClick={() => {                  setShowAddCategory(false);                  setNewCategory({ name: '', description: '' });                }}                className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700\"              >                {t('cancel')}              </button>            </div>          </div>        )}      </div>      {/* Categories List */}      <div className=\"bg-white rounded-lg shadow overflow-hidden\">        <div className=\"overflow-x-auto\">          <table className=\"min-w-full divide-y divide-gray-200\">            <thead className=\"bg-gray-50\">              <tr>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('categories.name')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('categories.description')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('categories.quizCount')}                </th>                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                  {t('action.action')}                </th>              </tr>            </thead>            <tbody className=\"bg-white divide-y divide-gray-200\">              {categories.map((category) => (                <tr key={category.id}>                  <td className=\"px-6 py-4 whitespace-nowrap font-medium text-gray-900\">                    {category.name}                  </td>                  <td className=\"px-6 py-4 text-sm text-gray-600\">                    {category.description}                  </td>                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600\">                    {category.quizCount || 0}                  </td>                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">                    <button                       onClick={() => setConfirmModal({ open: true, type: 'deleteCategory', payload: { categoryId: category.id }, message: t('categories.confirmDelete') })}                      className=\"px-3 py-1 bg-red-100 text-red-600 rounded text-xs hover:bg-red-200\"                    >                      {t('delete')}                    </button>                  </td>                </tr>              ))}            </tbody>          </table>        </div>      </div>    </div>  );  /*  const handleLogout = async () => {    try {      await auth.signOut();      navigate('/admin/login');    } catch (err)      console.error(\"Logout failed\", err);    }  };  */  if (loading) {    return (      <div className=\"flex justify-center items-center h-screen\">        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-red-600\"></div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50\">{/* Notice Banner */}      <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-4\">        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">            <div className=\"flex items-center gap-3\">              <span className=\"text-2xl\">üìä</span>              <div>                <h3 className=\"font-bold\">{t('admin.dashboard.viewStatsChart')}</h3>                <p className=\"text-blue-100 text-sm\">                  {t('admin.dashboard.clickOverviewTab')}{' '}                  // eslint-disable-next-line i18next/no-literal-string                  <a href=\"/admin/quiz-stats\" className=\"underline font-bold ml-1 hover:text-white\">                    ‚û§ {t('admin.dashboard.viewSeparateStatsPage')}                  </a>                </p>              </div>            </div>          <div className=\"text-right\">            <p className=\"text-sm text-blue-100\">{t('admin.currentTab')}: <span className=\"font-bold text-white\">{activeTab}</span></p>          </div>        </div>      </div>      {/* Header */}      <header className=\"bg-white shadow-sm border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">          <div className=\"flex justify-between items-center h-16\">            <div className=\"flex items-center\">              <div className=\"h-8 w-8 bg-gradient-to-r from-red-500 to-red-600 rounded-lg flex items-center justify-center mr-3\">                <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />                </svg>              </div>              // eslint-disable-next-line i18next/no-literal-string              <h1 className=\"text-xl font-bold text-gray-900\">Admin Dashboard</h1>            </div>                        <div className=\"flex items-center space-x-4\">              <a                href=\"/admin/quiz-stats\"                className=\"bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors duration-200 flex items-center space-x-2\"                title={t('admin.dashboard.viewSeparateStatsPageTitle')}              >                <span>üìä</span>                <span>{t('admin.dashboard.separateStats')}</span>              </a>              <button                onClick={() => {                  console.log('Force switching to dashboard');                  setActiveTab('dashboard');                }}                className=\"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2\"                title={t('admin.dashboard.forceOverviewTab')}              >                <span>üìä</span>                <span>{t(\"admin.tabs.overview\")}</span>              </button>              <button                onClick={loadData}                disabled={loading}                className=\"bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors duration-200 disabled:opacity-50 flex items-center space-x-2\"                title=\"C·∫≠p nh·∫≠t d·ªØ li·ªáu\"              >                <svg className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />                </svg>                <span>{t(\"refresh\")}</span>              </button>              {lastUpdate && (                // eslint-disable-next-line i18next/no-literal-string                <div className=\"text-xs text-gray-500\">                  C·∫≠p nh·∫≠t: {lastUpdate.toLocaleTimeString()}                </div>              )}              <div className=\"text-sm text-gray-600\">                {t('admin.greeting')}              </div>            </div>          </div>        </div>      </header>      {/* Navigation Tabs */}      <div className=\"bg-white border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">          {/* Debug Panel */}          // eslint-disable-next-line i18next/no-literal-string          <div className=\"bg-blue-100 p-2 text-xs text-blue-800 border-b\">            // eslint-disable-next-line i18next/no-literal-string            üîß Debug: activeTab = \"{activeTab}\" | T·∫•t c·∫£ tabs: dashboard, users, quizzes, categories          </div>                    <nav className=\"flex space-x-8\">            {[              { id: 'dashboard', label: t('admin.tabs.overview'), icon: 'üìä' },              { id: 'users', label: t('admin.tabs.users'), icon: 'üë•' },              { id: 'quizzes', label: t('admin.tabs.quizzes'), icon: 'üìù' },              { id: 'categories', label: t('admin.tabs.categories'), icon: 'üìÇ' }            ].map((tab) => (              <button                key={tab.id}                onClick={() => {                  setActiveTab(tab.id);                }}                className={`py-4 px-3 border-b-2 font-medium text-sm transition-colors duration-200 ${                  activeTab === tab.id                    ? 'border-red-500 text-red-600 bg-red-50'                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50'                } ${tab.id === 'dashboard' ? 'ring-2 ring-blue-300' : ''}`}                title={`Chuy·ªÉn ƒë·∫øn tab ${tab.label}`}              >                <span className=\"mr-2 text-lg\">{tab.icon}</span>                <span className=\"font-semibold\">{tab.label}</span>              </button>            ))}          </nav>        </div>      </div>      {/* Main Content */}      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        {/* Tab Banner */}        <div className=\"mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\">          <div className=\"flex items-center justify-between\">            <h2 className=\"text-xl font-semibold text-blue-900\">              {activeTab === 'dashboard' && `üìä ${t('admin.tabs.overviewStats')}`}              {activeTab === 'users' && `üë• ${t('admin.tabs.userManagement')}`}              {activeTab === 'quizzes' && `üìù ${t('admin.tabs.quizManagement')}`}              {activeTab === 'categories' && `üìÇ ${t('admin.tabs.categoryManagement')}`}            </h2>            <div className=\"flex items-center gap-3\">              <span className=\"text-sm text-blue-600 bg-blue-100 px-3 py-1 rounded-full\">                {t('admin.currentTab')}              </span>              {activeTab !== 'dashboard' && (                <button                  onClick={() => setActiveTab('dashboard')}                  className=\"text-sm bg-blue-600 text-white px-3 py-1 rounded-full hover:bg-blue-700\"                >                  {t('admin.backToOverview')}                </button>              )}            </div>          </div>        </div>        {loading ? (          <div className=\"flex justify-center items-center h-64\">            <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-red-600\"></div>          </div>        ) : (          <>            {console.log('Current active tab:', activeTab)}            {activeTab === 'dashboard' && renderDashboard()}            {activeTab === 'users' && renderUsers()}            {activeTab === 'quizzes' && renderQuizzes()}            {activeTab === 'categories' && renderCategories()}          </>        )}      </main>      {/* Modal x√°c nh·∫≠n thao t√°c */}      <Modal        isOpen={confirmModal.open}        onClose={() => setConfirmModal({ open: false, type: null })}        title={t('action.confirm')}      >        <div className=\"mb-4\">{confirmModal.message}</div>        <div className=\"flex justify-end space-x-2\">          <button            onClick={() => setConfirmModal({ open: false, type: null })}            className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400\"            disabled={loading}          >            {t('cancel')}          </button>          <button            onClick={async () => {              if (confirmModal.type === 'deleteUser') await deleteUser(confirmModal.payload.userId);              if (confirmModal.type === 'deleteQuiz') await deleteQuiz(confirmModal.payload.quizId);              if (confirmModal.type === 'deleteCategory') await deleteCategory(confirmModal.payload.categoryId);              if (confirmModal.type === 'toggleUserStatus') await toggleUserStatus(confirmModal.payload.userId, confirmModal.payload.currentStatus);              setConfirmModal({ open: false, type: null });            }}            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"            disabled={loading}          >            {t('action.confirm')}          </button>        </div>      </Modal>    </div>  );};export default AdminDashboard;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\AdminQuizManagement.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":46402,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { toast } from 'react-toastify';import { useSelector } from 'react-redux';import { useNavigate } from 'react-router-dom';import { useTranslation } from 'react-i18next';import { ROUTES } from '../../../config/routes';import {   collection,   getDocs,   doc,   updateDoc,   deleteDoc,   addDoc,  query,   orderBy,  where,  serverTimestamp} from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { RootState } from '../../../lib/store';import {   Search,   Eye,   Check,   X,   Trash2,   User,  BookOpen,  Clock,  BarChart3,  RotateCcw,  Edit3,  AlertCircle,  FileText,  Video,  Image as ImageIcon,  Music,  Link as LinkIcon,  Presentation} from 'lucide-react';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface Quiz {  id: string;  title: string;  description: string;  status: 'pending' | 'approved' | 'rejected';  createdBy: string;  createdAt: Date;  questions: any[];  difficulty: 'easy' | 'medium' | 'hard';  category: string;  isPublic: boolean;  isPublished?: boolean;  editRequests?: EditRequest[];  learningResources?: any[]; // T√†i li·ªáu h·ªçc t·∫≠p}interface EditRequest {  id: string;  requestedBy: string;  requestedAt: Date;  reason: string;  status: 'pending' | 'approved' | 'rejected';  reviewedBy?: string;  reviewedAt?: Date;}const AdminQuizManagement: React.FC = () => {  const { user } = useSelector((state: RootState) => state.auth);  const navigate = useNavigate();  const { t } = useTranslation();  const [quizzes, setQuizzes] = useState<Quiz[]>([]);  const [editRequests, setEditRequests] = useState<any[]>([]);  const [loading, setLoading] = useState(true);  const [error, setError] = useState<string | null>(null);  const [filterStatus, setFilterStatus] = useState<'all' | 'pending' | 'approved' | 'rejected'>('all');  const [activeTab, setActiveTab] = useState<'quizzes' | 'editRequests'>('quizzes');  const [showPreview, setShowPreview] = useState(false);  const [previewQuiz, setPreviewQuiz] = useState<Quiz | null>(null);  const [searchTerm, setSearchTerm] = useState('');  // Helper function ƒë·ªÉ x·ª≠ l√Ω date t·ª´ Firestore  const parseFirestoreDate = (dateValue: any): Date => {    if (!dateValue) {      return new Date();    }        // N·∫øu l√† Firestore Timestamp    if (dateValue && typeof dateValue.toDate === 'function') {      return dateValue.toDate();    }        // N·∫øu l√† Date object    if (dateValue instanceof Date) {      return dateValue;    }        // N·∫øu l√† string ho·∫∑c number    if (typeof dateValue === 'string' || typeof dateValue === 'number') {      const date = new Date(dateValue);      return isNaN(date.getTime()) ? new Date() : date;    }        // N·∫øu l√† object c√≥ seconds (Firestore server timestamp)    if (dateValue && typeof dateValue === 'object' && dateValue.seconds) {      return new Date(dateValue.seconds * 1000);    }        // Fallback    console.warn('Unknown date format:', dateValue);    return new Date();  };  const loadQuizzes = useCallback(async () => {    try {      setLoading(true);      setError(null);            console.log('üîç Loading quizzes from Firestore (excluding drafts)...');      // üìù Filter out drafts - Admin should only see pending/approved/rejected quizzes      const q = query(        collection(db, 'quizzes'),        where('status', 'in', ['pending', 'approved', 'rejected']),        orderBy('createdAt', 'desc')      );      const querySnapshot = await getDocs(q);            console.log('üìä Firestore response:', {        empty: querySnapshot.empty,        size: querySnapshot.size,        docs: querySnapshot.docs.length      });            const loadedQuizzes: Quiz[] = [];      querySnapshot.forEach((doc) => {        const data = doc.data();        console.log('üìù Quiz data raw:', {           id: doc.id,           title: data.title,           status: data.status,           createdAt: data.createdAt,          createdAtType: typeof data.createdAt         });                try {          loadedQuizzes.push({            id: doc.id,            title: data.title || 'Untitled Quiz',            description: data.description || '',            status: data.status || 'pending',            createdBy: data.createdBy || 'unknown',            createdAt: parseFirestoreDate(data.createdAt),            questions: data.questions || [],            difficulty: data.difficulty || 'easy',            category: data.category || 'general',            isPublic: data.isPublic || false,            isPublished: data.isPublished || false          });        } catch (error) {          console.error('Error parsing quiz:', doc.id, error);          // Skip invalid quiz        }      });            console.log('‚úÖ Loaded quizzes:', loadedQuizzes.length);      setQuizzes(loadedQuizzes);            // N·∫øu kh√¥ng c√≥ quiz, hi·ªÉn th·ªã empty state      if (loadedQuizzes.length === 0) {        console.log('‚ö†Ô∏è No quizzes found, showing empty state');        toast.info(t('admin.quizManagement.empty.noQuizzesInSystem'));      }          } catch (error) {      console.error('‚ùå Error loading quizzes:', error);      setError(t('admin.quizManagement.errors.loadFailed'));      toast.error(t('admin.quizManagement.errors.loadFailed') + ': ' + error);    } finally {      setLoading(false);    }  }, [t]);  const loadEditRequests = useCallback(async () => {    try {      console.log('üîç Loading edit requests...');            // First approach: Try with simple query and client-side filtering/sorting      const q = query(        collection(db, 'editRequests'),        where('status', '==', 'pending')      );      const querySnapshot = await getDocs(q);            const loadedRequests: any[] = [];      querySnapshot.forEach((doc) => {        const data = doc.data();        loadedRequests.push({          id: doc.id,          ...data,          requestedAt: parseFirestoreDate(data.requestedAt)        });      });            // Sort by requestedAt descending on client side      loadedRequests.sort((a, b) => {        const aTime = a.requestedAt ? new Date(a.requestedAt).getTime() : 0;        const bTime = b.requestedAt ? new Date(b.requestedAt).getTime() : 0;        return bTime - aTime;      });            console.log('‚úÖ Loaded edit requests:', loadedRequests.length);      setEditRequests(loadedRequests);          } catch (error) {      console.error('‚ùå Error loading edit requests:', error);            // Fallback: Load all edit requests and filter client-side      try {        console.log('üîÑ Trying fallback approach...');        const fallbackQ = query(collection(db, 'editRequests'));        const fallbackSnapshot = await getDocs(fallbackQ);                const allRequests: any[] = [];        fallbackSnapshot.forEach((doc) => {          const data = doc.data();          if (data.status === 'pending') {            allRequests.push({              id: doc.id,              ...data,              requestedAt: parseFirestoreDate(data.requestedAt)            });          }        });                // Sort by requestedAt descending        allRequests.sort((a, b) => {          const aTime = a.requestedAt ? new Date(a.requestedAt).getTime() : 0;          const bTime = b.requestedAt ? new Date(b.requestedAt).getTime() : 0;          return bTime - aTime;        });                console.log('‚úÖ Fallback loaded edit requests:', allRequests.length);        setEditRequests(allRequests);              } catch (fallbackError) {        console.error('‚ùå Fallback also failed:', fallbackError);        setEditRequests([]);      }    }  }, []);  useEffect(() => {    loadQuizzes();    loadEditRequests();  }, [loadQuizzes, loadEditRequests]);  const handleEdit = (quizId: string) => {    navigate(`/admin/edit-quiz/${quizId}`);  };  const handlePreview = (quiz: Quiz) => {    setPreviewQuiz(quiz);    setShowPreview(true);  };  const handleApprove = async (quizId: string) => {    try {      const quizRef = doc(db, 'quizzes', quizId);      await updateDoc(quizRef, {        status: 'approved',        isPublished: true,        approvedAt: new Date(),        approvedBy: user?.uid      });            setQuizzes(prev => prev.map(quiz =>         quiz.id === quizId           ? { ...quiz, status: 'approved' as const, isPublished: true }          : quiz      ));            toast.success(t('admin.quizManagement.success.approved'));    } catch (error) {      console.error('Error approving quiz:', error);      toast.error(t('admin.quizManagement.errors.approveFailed'));    }  };  const handleReject = async (quizId: string) => {    try {      const quizRef = doc(db, 'quizzes', quizId);      await updateDoc(quizRef, {        status: 'rejected',        isPublished: false,        rejectedAt: new Date(),        rejectedBy: user?.uid      });            setQuizzes(prev => prev.map(quiz =>         quiz.id === quizId           ? { ...quiz, status: 'rejected' as const, isPublished: false }          : quiz      ));            toast.success(t('admin.quizManagement.success.rejected'));    } catch (error) {      console.error('Error rejecting quiz:', error);      toast.error(t('admin.quizManagement.errors.rejectFailed'));    }  };  const handleApproveEditRequest = async (requestId: string, quizId: string) => {    try {      const editRequest = editRequests.find(req => req.id === requestId);      if (!editRequest) {        toast.error(t('admin.editRequests.errors.notFound'));        return;      }      // Update edit request status      const requestRef = doc(db, 'editRequests', requestId);      await updateDoc(requestRef, {        status: 'approved',        reviewedBy: user?.uid,        reviewedByName: user?.displayName || 'Admin',        reviewedAt: new Date()      });      // G·ª† QUIZ XU·ªêNG ƒê·ªÇ S·ª¨A: Set quiz status to draft v√† allow edit      const quizRef = doc(db, 'quizzes', quizId);      await updateDoc(quizRef, {        status: 'draft', // G·ª° quiz xu·ªëng draft ƒë·ªÉ s·ª≠a        isApproved: false, // B·ªè approved status        canEdit: true, // Cho ph√©p creator edit        editRequestApproved: true,        lastEditRequestApproved: new Date(),        approvedBy: user?.uid,        needsReApproval: true // Flag ƒë·ªÉ bi·∫øt quiz n√†y c·∫ßn ƒë∆∞·ª£c duy·ªát l·∫°i sau khi s·ª≠a      });      // Create notification for the creator      await addDoc(collection(db, 'notifications'), {        userId: editRequest.requestedBy,        type: 'edit_request_approved',        title: t('admin.editRequests.notifications.approvedTitle'),        message: t('admin.editRequests.notifications.approvedMessage', {           quizTitle: editRequest.quizTitle         }),        quizId: quizId,        createdAt: serverTimestamp(),        read: false      });      // Remove from edit requests list      setEditRequests(prev => prev.filter(req => req.id !== requestId));            toast.success(t('admin.editRequests.success.approved', {         userName: editRequest.requestedByName || editRequest.requestedByEmail       }));    } catch (error) {      console.error('Error approving edit request:', error);      toast.error(t('admin.editRequests.errors.approveFailed'));    }  };  const handleRejectEditRequest = async (requestId: string) => {    try {      const editRequest = editRequests.find(req => req.id === requestId);      if (!editRequest) {        toast.error(t('admin.editRequests.errors.notFound'));        return;      }      const requestRef = doc(db, 'editRequests', requestId);      await updateDoc(requestRef, {        status: 'rejected',        reviewedBy: user?.uid,        reviewedByName: user?.displayName || 'Admin',        reviewedAt: new Date()      });      // Create notification for the creator      await addDoc(collection(db, 'notifications'), {        userId: editRequest.requestedBy,        type: 'edit_request_rejected',         title: t('admin.editRequests.notifications.rejectedTitle'),        message: t('admin.editRequests.notifications.rejectedMessage', {           quizTitle: editRequest.quizTitle         }),        quizId: editRequest.quizId,        createdAt: serverTimestamp(),        read: false      });      // Remove from edit requests list      setEditRequests(prev => prev.filter(req => req.id !== requestId));            toast.success(t('admin.editRequests.success.rejected', {         userName: editRequest.requestedByName || editRequest.requestedByEmail       }));    } catch (error) {      console.error('Error rejecting edit request:', error);      toast.error(t('admin.editRequests.errors.rejectFailed'));    }  };  const handleReopen = async (quizId: string) => {    try {      const quizRef = doc(db, 'quizzes', quizId);      await updateDoc(quizRef, {        status: 'pending',        isPublished: false,        reopenedAt: new Date(),        reopenedBy: user?.uid      });            setQuizzes(prev => prev.map(quiz =>         quiz.id === quizId           ? { ...quiz, status: 'pending' as const, isPublished: false }          : quiz      ));            toast.success(t('admin.quizManagement.success.reopened'));    } catch (error) {      console.error('Error reopening quiz:', error);      toast.error(t('admin.quizManagement.errors.reopenFailed'));    }  };  const handleDelete = async (quizId: string) => {    if (!window.confirm(t('admin.quizManagement.confirmDelete'))) {      return;    }    try {      console.log('üóëÔ∏è Deleting quiz from database:', quizId);      await deleteDoc(doc(db, 'quizzes', quizId));      console.log('‚úÖ Quiz deleted from database successfully');            setQuizzes(prev => prev.filter(quiz => quiz.id !== quizId));      toast.success(t('admin.quizManagement.success.deleted'));    } catch (error) {      console.error('‚ùå Error deleting quiz:', error);      toast.error(t('admin.quizManagement.errors.deleteFailed') + ': ' + error);    }  };  const filteredQuizzes = quizzes.filter(quiz => {    const matchesFilter = filterStatus === 'all' || quiz.status === filterStatus;    const matchesSearch = quiz.title.toLowerCase().includes(searchTerm.toLowerCase()) ||                         quiz.description.toLowerCase().includes(searchTerm.toLowerCase());    return matchesFilter && matchesSearch;  });  const getStatusCounts = () => {    return {      all: quizzes.length,      pending: quizzes.filter(q => q.status === 'pending').length,      approved: quizzes.filter(q => q.status === 'approved').length,      rejected: quizzes.filter(q => q.status === 'rejected').length    };  };  const statusCounts = getStatusCounts();  const getStatusBadge = (status: string) => {    switch (status) {      case 'approved':        return <span className=\"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium\">‚úÖ {t('status.approved')}</span>;      case 'rejected':        return <span className=\"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium\">‚ùå {t('status.rejected')}</span>;      default:        return <span className=\"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-medium\">‚è≥ {t('status.pending')}</span>;    }  };  const getDifficultyBadge = (difficulty: string) => {    switch (difficulty) {      case 'easy':        return <span className=\"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs\">üü¢ {t('quiz.difficulty.easy')}</span>;      case 'hard':        return <span className=\"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs\">üî¥ {t('quiz.difficulty.hard')}</span>;      default:        return <span className=\"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs\">üü° {t('quiz.difficulty.medium')}</span>;    }  };  // Helper ƒë·ªÉ l·∫•y icon theo lo·∫°i t√†i li·ªáu  const getResourceIcon = (type: string) => {    switch (type) {      case 'video': return <Video className=\"w-4 h-4\" />;      case 'pdf': return <FileText className=\"w-4 h-4\" />;      case 'image': return <ImageIcon className=\"w-4 h-4\" />;      case 'audio': return <Music className=\"w-4 h-4\" />;      case 'link': return <LinkIcon className=\"w-4 h-4\" />;      case 'slides': return <Presentation className=\"w-4 h-4\" />;      default: return <FileText className=\"w-4 h-4\" />;    }  };  // Helper ƒë·ªÉ l·∫•y m√†u badge theo lo·∫°i t√†i li·ªáu  const getResourceBadgeColor = (type: string) => {    switch (type) {      case 'video': return 'bg-blue-100 text-blue-700 border-blue-200';      case 'pdf': return 'bg-red-100 text-red-700 border-red-200';      case 'image': return 'bg-purple-100 text-purple-700 border-purple-200';      case 'audio': return 'bg-green-100 text-green-700 border-green-200';      case 'link': return 'bg-indigo-100 text-indigo-700 border-indigo-200';      case 'slides': return 'bg-orange-100 text-orange-700 border-orange-200';      default: return 'bg-gray-100 text-gray-700 border-gray-200';    }  };  if (!user || user.role !== 'admin') {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">‚õî {t('errors.unauthorized')}</h1>          <p className=\"text-gray-600\">{t('admin.loginAsAdmin')}</p>        </div>      </div>    );  }  if (loading) {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>          <p className=\"mt-4 text-gray-600\">{t('loadingData')}</p>        </div>      </div>    );  }  if (error) {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">‚ùå {t('error')}</h1>          <p className=\"text-gray-600 mb-4\">{error}</p>          <button             onClick={loadQuizzes}            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"          >            {t('tryAgain')}          </button>        </div>      </div>    );  }  return (    <>    <div className=\"bg-gradient-to-br from-gray-50 to-blue-50\">      {/* Modern Responsive Header */}      <div className=\"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 shadow-xl\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8\">          <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">            {/* Title Section */}            <div className=\"flex items-center space-x-4\">              <div className=\"w-12 h-12 lg:w-14 lg:h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center ring-2 ring-white/30 shadow-lg\">                <BookOpen className=\"w-6 h-6 lg:w-7 lg:h-7 text-white drop-shadow-sm\" />              </div>              <div>                <h1 className=\"text-2xl lg:text-3xl font-bold text-white drop-shadow-sm\">{t('admin.quizManagement.label')}</h1>                <p className=\"text-blue-100 text-sm lg:text-base mt-1\">{t('admin.quizManagement.description')}</p>              </div>            </div>                        {/* Actions & User Info */}            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 lg:gap-4\">              <button                onClick={() => {loadQuizzes(); loadEditRequests();}}                className=\"w-full sm:w-auto px-4 py-2.5 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white rounded-xl transition-all duration-200 flex items-center justify-center gap-2 border border-white/20 hover:border-white/40 shadow-lg hover:shadow-xl\"                title=\"L√†m m·ªõi danh s√°ch\"              >                <RotateCcw className=\"w-4 h-4\" />                <span className=\"font-medium\">{t('refresh')}</span>              </button>                            {/* User Badge */}              <div className=\"flex items-center space-x-3 bg-white/10 backdrop-blur-sm rounded-xl px-4 py-2.5 border border-white/20 shadow-lg\">                  <User className=\"w-4 h-4 text-white\" />                </div>                <div className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3\">                  <span className=\"text-white text-sm font-medium truncate max-w-32 lg:max-w-none\">{user?.email}</span>                  <span className=\"px-2 py-1 bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900 rounded-full text-xs font-bold shadow-sm\">                    {t('admin.quizManagement.adminBadge')}                  </span>                </div>              </div>            </div>          </div>        </div>      </div>      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">        {/* Stats Overview */}        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6\">          <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('admin.quizManagement.cards.totalQuizzes')}</p>                <p className=\"text-2xl font-bold text-gray-900\">{statusCounts.all}</p>              </div>              <div className=\"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center\">                <BarChart3 className=\"w-6 h-6 text-blue-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('status.pending')}</p>                <p className=\"text-2xl font-bold text-orange-600\">{statusCounts.pending}</p>              </div>              <div className=\"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center\">                <Clock className=\"w-6 h-6 text-orange-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('status.approved')}</p>                <p className=\"text-2xl font-bold text-green-600\">{statusCounts.approved}</p>              </div>              <div className=\"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center\">                <Check className=\"w-6 h-6 text-green-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('status.rejected')}</p>                <p className=\"text-2xl font-bold text-red-600\">{statusCounts.rejected}</p>              </div>              <div className=\"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center\">                <X className=\"w-6 h-6 text-red-600\" />              </div>            </div>          </div>        </div>        {/* Tabs */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 mb-8\">          <div className=\"flex border-b border-gray-200\">            <button              onClick={() => setActiveTab('quizzes')}              className={`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${                activeTab === 'quizzes'                  ? 'border-blue-500 text-blue-600 bg-blue-50'                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'              }`}            >              <div className=\"flex items-center gap-2\">                <BookOpen className=\"w-4 h-4\" />                {t('admin.quizManagement.tab.quizzes')}                <span className=\"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs\">                  {quizzes.length}                </span>              </div>            </button>            <button              onClick={() => setActiveTab('editRequests')}              className={`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${                activeTab === 'editRequests'                  ? 'border-blue-500 text-blue-600 bg-blue-50'                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'              }`}            >              <div className=\"flex items-center gap-2\">                <AlertCircle className=\"w-4 h-4\" />                {t('admin.quizManagement.tab.editRequests')}                <span className=\"bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs\">                  {editRequests.length}                </span>              </div>            </button>          </div>        </div>        {activeTab === 'quizzes' && (          <>        {/* Search and Filter */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">          <div className=\"flex flex-col lg:flex-row gap-4\">            {/* Search */}            <div className=\"flex-1\">              <div className=\"relative\">                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />                <input                  type=\"text\"                  placeholder={t('admin.quizManagement.searchPlaceholder')}                  value={searchTerm}                  onChange={(e) => setSearchTerm(e.target.value)}                  className=\"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                />              </div>            </div>            {/* Filter Tabs */}            <div className=\"flex space-x-1 bg-gray-100 p-1 rounded-lg\">              <button                onClick={() => setFilterStatus('all')}                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${                  filterStatus === 'all'                    ? 'bg-blue-600 text-white shadow-sm'                    : 'text-gray-700 hover:text-gray-900'                }`}              >                {t('common.all')}              </button>              <button                onClick={() => setFilterStatus('pending')}                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${                  filterStatus === 'pending'                    ? 'bg-orange-600 text-white shadow-sm'                    : 'text-gray-700 hover:text-gray-900'                }`}              >                {t('status.pending')}              </button>              <button                onClick={() => setFilterStatus('approved')}                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${                  filterStatus === 'approved'                    ? 'bg-green-600 text-white shadow-sm'                    : 'text-gray-700 hover:text-gray-900'                }`}              >                {t('status.approved')}              </button>              <button                onClick={() => setFilterStatus('rejected')}                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${                  filterStatus === 'rejected'                    ? 'bg-red-600 text-white shadow-sm'                    : 'text-gray-700 hover:text-gray-900'                }`}              >                {t('status.rejected')}              </button>            </div>          </div>        </div>        {/* Quiz List */}        {filteredQuizzes.length === 0 ? (          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center\">            <div className=\"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6\">              <BookOpen className=\"w-10 h-10 text-gray-400\" />            </div>            <h3 className=\"text-xl font-semibold text-gray-900 mb-3\">              {searchTerm ? t('admin.quizManagement.empty.noMatchTitle') : t('admin.quizManagement.empty.noQuizzesTitle')}            </h3>            <p className=\"text-gray-600 mb-8 max-w-md mx-auto\">              {searchTerm                 ? t('admin.quizManagement.empty.noMatchDesc')                : t('admin.quizManagement.empty.noQuizzesDesc')              }            </p>            {!searchTerm && (              <div className=\"flex justify-center\">                <button                  onClick={() => window.open(ROUTES.CREATOR, '_blank')}                  className=\"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2\"                >                  <BookOpen className=\"w-5 h-5\" />                  {t('admin.quizManagement.empty.goToCreator')}                </button>              </div>            )}          </div>        ) : (          <div className=\"grid gap-6\">            {filteredQuizzes.map((quiz) => (              <div key={quiz.id} className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow\">                <div className=\"flex items-start justify-between\">                  <div className=\"flex-1\">                    <div className=\"flex items-center gap-3 mb-3\">                      <h3 className=\"text-xl font-bold text-gray-900\">{quiz.title}</h3>                      {getStatusBadge(quiz.status)}                      {getDifficultyBadge(quiz.difficulty)}                    </div>                                        <SafeHTML content={quiz.description} className=\"text-gray-600 mb-4 line-clamp-2\" />                                        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-3\">                      <div>                        <span className=\"font-medium\">{t('admin.quizManagement.table.category')}:</span> {quiz.category}                      </div>                      <div>                        <span className=\"font-medium\">{t('quiz.questions')}:</span> {quiz.questions.length}                      </div>                      <div>                        <span className=\"font-medium\">{t('admin.quizManagement.table.createdAt')}:</span> {quiz.createdAt.toLocaleDateString()}                      </div>                    </div>                    {/* Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng t√†i li·ªáu h·ªçc t·∫≠p */}                    {quiz.learningResources && quiz.learningResources.length > 0 && (                      <div className=\"flex items-center gap-2 mt-2\">                        <div className=\"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg\">                          <FileText className=\"w-4 h-4 text-emerald-600\" />                          <span className=\"text-xs font-medium text-emerald-700\">                            {t('admin.quizManagement.learningResourcesCount', { count: quiz.learningResources.length })}                          </span>                        </div>                        {quiz.learningResources.some((r: any) => r.required) && (                          // eslint-disable-next-line i18next/no-literal-string                          <span className=\"text-xs px-2 py-1 bg-red-100 text-red-700 rounded-full font-medium\">                            ‚ö†Ô∏è {t('admin.quizManagement.hasRequiredResources')}                          </span>                        )}                      </div>                    )}                  </div>                                    {/* Actions - 6 ch·ª©c nƒÉng: View, Edit, Approve, Reject, Reopen, Delete */}                  <div className=\"flex items-center gap-2 ml-6\">                    {/* 1. Xem tr∆∞·ªõc (lu√¥n hi·ªÉn th·ªã) */}                      <button                      onClick={() => handlePreview(quiz)}                      className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"                        title={t('admin.quizManagement.tooltips.preview')}                    >                      <Eye className=\"w-5 h-5\" />                    </button>                    {/* 2. Ch·ªânh s·ª≠a (lu√¥n hi·ªÉn th·ªã) */}                      <button                      onClick={() => handleEdit(quiz.id)}                      className=\"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors\"                        title={t('admin.quizManagement.tooltips.edit')}                    >                      <Edit3 className=\"w-5 h-5\" />                    </button>                                        {/* 3 & 4. Duy·ªát & T·ª´ ch·ªëi (ch·ªâ hi·ªÉn th·ªã khi pending) */}                    {quiz.status === 'pending' && (                      <>                          <button                          onClick={() => handleApprove(quiz.id)}                          className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors\"                            title={t('admin.quizManagement.tooltips.approve')}                        >                          <Check className=\"w-5 h-5\" />                        </button>                          <button                          onClick={() => handleReject(quiz.id)}                          className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"                            title={t('admin.quizManagement.tooltips.reject')}                        >                          <X className=\"w-5 h-5\" />                        </button>                      </>                    )}                    {/* 5. M·ªü l·∫°i (hi·ªÉn th·ªã khi ƒë√£ duy·ªát ho·∫∑c t·ª´ ch·ªëi) */}                      {(quiz.status === 'approved' || quiz.status === 'rejected') && (                      <button                        onClick={() => handleReopen(quiz.id)}                        className=\"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors\"                          title={t('admin.quizManagement.tooltips.reopen')}                      >                        <RotateCcw className=\"w-5 h-5\" />                      </button>                    )}                                        {/* 6. X√≥a (lu√¥n hi·ªÉn th·ªã) */}                      <button                      onClick={() => handleDelete(quiz.id)}                      className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"                        title={t('admin.quizManagement.tooltips.delete')}                    >                      <Trash2 className=\"w-5 h-5\" />                    </button>                  </div>                </div>              </div>            ))}          </div>        )}        </>        )}        {activeTab === 'editRequests' && (          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">            <div className=\"flex justify-between items-center mb-6\">              <h3 className=\"text-lg font-semibold flex items-center gap-2\">                <AlertCircle className=\"w-5 h-5 text-orange-500\" />                {t('admin.quizManagement.editRequestsTitle', { count: editRequests.length })}              </h3>            </div>                        {editRequests.length === 0 ? (              <div className=\"text-center py-12\">                <AlertCircle className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />                <p className=\"text-gray-500 mb-4\">{t(\"admin.editRequests.emptyTitle\")}</p>                <p className=\"text-sm text-gray-400\">{t(\"admin.editRequests.emptyDesc\")}</p>              </div>            ) : (              <div className=\"space-y-4\">                {editRequests.map((request) => (                  <div key={request.id} className=\"border border-gray-200 rounded-lg p-6 bg-white shadow-sm\">                    <div className=\"flex items-start justify-between\">                      <div className=\"flex-1\">                        <div className=\"flex items-center gap-3 mb-3\">                          <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">                            <User className=\"w-5 h-5 text-blue-600\" />                          </div>                          <div>                            <h4 className=\"font-semibold text-gray-900\">                              {request.requestedByName || request.requestedByEmail || t('admin.quizManagement.unknownUser')}                            </h4>                            <p className=\"text-sm text-gray-500\">                              {request.requestedByEmail || request.requestedBy || t('admin.quizManagement.unknownEmail')}                            </p>                          </div>                        </div>                                                <div className=\"bg-gray-50 rounded-lg p-4 mb-3\">                          // eslint-disable-next-line i18next/no-literal-string                          <h5 className=\"font-medium text-gray-900 mb-2\">                            üìù Quiz: {request.quizTitle || t('admin.quizManagement.unknownQuiz')}                          </h5>                          <p className=\"text-sm text-gray-700 mb-2\">                            <strong>{t('admin.quizManagement.requestReason')}:</strong> {request.reason || t('admin.quizManagement.noReason')}                          </p>                          {request.description && (                            <p className=\"text-sm text-gray-600\">                              <strong>{t('admin.quizManagement.requestDetails')}:</strong> {request.description}                            </p>                          )}                        </div>                                                <div className=\"flex items-center gap-4 text-sm text-gray-500\">                          <span className=\"flex items-center gap-1\">                            <Clock className=\"w-4 h-4\" />                            {request.requestedAt?.toLocaleDateString('vi-VN', {                              day: '2-digit',                              month: '2-digit',                               year: 'numeric',                              hour: '2-digit',                              minute: '2-digit'                            }) || t('admin.quizManagement.unknownTime')}                          </span>                          <span className=\"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-medium\">{t(\"admin.editRequests.pending\")}                          </span>                        </div>                      </div>                      <div className=\"flex gap-2 ml-6\">                        <button                          onClick={() => handleApproveEditRequest(request.id, request.quizId)}                          className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 shadow-sm\"                          title={t(\"admin.editRequests.approveTitle\")}                        >                          <Check className=\"w-4 h-4\" />{t(\"admin.editRequests.approve\")}                        </button>                        <button                          onClick={() => handleRejectEditRequest(request.id)}                          className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2 shadow-sm\"                          title={t(\"admin.editRequests.rejectTitle\")}                        >                          <X className=\"w-4 h-4\" />{t(\"admin.editRequests.reject\")}                        </button>                      </div>                    </div>                  </div>                ))}              </div>            )}          </div>        )}      {/* Preview Modal */}      {showPreview && previewQuiz && (        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">          <div className=\"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">            <div className=\"p-6 border-b border-gray-200\">              <div className=\"flex items-center justify-between\">                <h2 className=\"text-xl font-bold\">{t('admin.preview.title')}: {previewQuiz.title}</h2>                <button                  onClick={() => setShowPreview(false)}                  className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg\"                >                  <X className=\"w-5 h-5\" />                </button>              </div>            </div>                        <div className=\"p-6\">              <div className=\"space-y-6\">                <div>                  <h3 className=\"font-semibold mb-2\">{t('admin.preview.description')}:</h3>                  <SafeHTML content={previewQuiz.description} className=\"text-gray-600\" />                </div>                                <div className=\"grid grid-cols-2 gap-4 text-sm\">                  <div>                    <span className=\"font-semibold\">{t('admin.preview.category')}:</span> {previewQuiz.category}                  </div>                  <div>                    <span className=\"font-semibold\">{t('admin.preview.difficulty')}:</span> {previewQuiz.difficulty}                  </div>                  <div>                    <span className=\"font-semibold\">{t('admin.preview.questions')}:</span> {previewQuiz.questions.length}                  </div>                  <div>                    <span className=\"font-semibold\">{t('admin.preview.status')}:</span> {getStatusBadge(previewQuiz.status || 'pending')}                  </div>                </div>                {/* T√†i li·ªáu h·ªçc t·∫≠p trong Preview */}                {previewQuiz.learningResources && previewQuiz.learningResources.length > 0 && (                  <div className=\"bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-4\">                    <h3 className=\"font-semibold mb-3 flex items-center gap-2 text-emerald-800\">                      <FileText className=\"w-5 h-5\" />                      üìö {t('admin.preview.learningResourcesTitle', { count: previewQuiz.learningResources.length })}                    </h3>                    <div className=\"space-y-2\">                      {previewQuiz.learningResources.map((resource: any, idx: number) => (                        <div                           key={resource.id || idx}                           className=\"bg-white rounded-lg p-3 border border-emerald-100\"                        >                          <div className=\"flex items-start gap-3\">                            {/* Icon & Type Badge */}                            <div className={`flex items-center justify-center w-10 h-10 rounded-lg border ${getResourceBadgeColor(resource.type)}`}>                              {getResourceIcon(resource.type)}                            </div>                                                        {/* Content */}                            <div className=\"flex-1 min-w-0\">                              <div className=\"flex items-start justify-between gap-2\">                                <h4 className=\"font-semibold text-gray-900 text-sm\">{resource.title}</h4>                                <span className={`px-2 py-1 rounded-full text-xs font-medium border flex-shrink-0 ${getResourceBadgeColor(resource.type)}`}>                                  {resource.type.toUpperCase()}                                </span>                              </div>                                                            {resource.description && (                                <SafeHTML content={resource.description} className=\"text-xs text-gray-600 mt-1 line-clamp-2\" />                              )}                                                            <div className=\"flex items-center gap-3 mt-2 text-xs text-gray-500\">                                {resource.required && (                                  // eslint-disable-next-line i18next/no-literal-string                                  <span className=\"px-2 py-0.5 bg-red-100 text-red-700 rounded-full font-medium\">                                    ‚ö†Ô∏è {t('admin.quizManagement.requiredBadge')}                                  </span>                                )}                                {resource.estimatedTime && (                                  // eslint-disable-next-line i18next/no-literal-string                                  <span>‚è±Ô∏è {t('admin.quizManagement.estimatedTime', { time: resource.estimatedTime })}</span>                                )}                                {resource.url && (                                  <a                                     href={resource.url}                                     target=\"_blank\"                                     rel=\"noopener noreferrer\"                                    className=\"text-blue-600 hover:text-blue-800 hover:underline truncate max-w-xs\"                                  >                                    üîó {t('admin.quizManagement.viewResource')}                                  </a>                                )}                              </div>                            </div>                          </div>                        </div>                      ))}                    </div>                  </div>                )}                {previewQuiz.questions.length > 0 && (                  <div>                    <h3 className=\"font-semibold mb-4\">{t('admin.preview.questionList')}</h3>                    <div className=\"space-y-4\">                      {previewQuiz.questions.map((question: any, index: number) => (                        <div key={index} className=\"border rounded-lg p-4\">                          <h4 className=\"font-medium mb-2\">{index + 1}. {question.text}</h4>                          {question.answers && (                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">                              {question.answers.map((answer: any, answerIndex: number) => (                                <div                                   key={answerIndex}                                   className={`p-2 rounded ${answer.isCorrect ? 'bg-green-100 text-green-800' : 'bg-gray-100'}`}                                >                                  {String.fromCharCode(65 + answerIndex)}. {answer.text}                                  {answer.isCorrect && ' ‚úì'}                                </div>                              ))}                            </div>                          )}                        </div>                      ))}                    </div>                  </div>                )}              </div>            </div>          </div>        </div>      )}    </div>    </>  );};export default AdminQuizManagement;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\AdminUserManagement.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":13229,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { collection, getDocs, doc, updateDoc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import AdminLayout from '../components/AdminLayout';import Modal from '../../../shared/components/ui/Modal';import { toast } from 'react-toastify';import { useTranslation } from 'react-i18next';interface User {  id: string;  email: string;  displayName: string;  role: 'user' | 'creator' | 'admin';  createdAt: any;  isActive: boolean;  lastLogin?: any;}const AdminUserManagement: React.FC = () => {  const { user } = useSelector((state: RootState) => state.auth);  const { t } = useTranslation();  const [users, setUsers] = useState<User[]>([]);  const [loading, setLoading] = useState(true);  const [filter, setFilter] = useState<'all' | 'user' | 'creator' | 'admin'>('all');  const [confirmModal, setConfirmModal] = useState<{    open: boolean;    type: null | 'deleteUser' | 'toggleUserStatus' | 'roleChange';    payload?: any;    message?: string;  }>({ open: false, type: null });  useEffect(() => {    fetchUsers();  }, []);  const fetchUsers = async () => {    try {      const querySnapshot = await getDocs(collection(db, 'users'));      const usersData = querySnapshot.docs        .map(doc => ({          id: doc.id,          ...doc.data()        }))        .filter((user: any) => !user.isDeleted) as User[]; // Filter out deleted users      setUsers(usersData);    } catch (error) {      console.error('Error fetching users:', error);    } finally {      setLoading(false);    }  };  const handleRoleChange = async (userId: string, newRole: 'user' | 'creator' | 'admin') => {    if (userId === user?.uid && newRole !== 'admin') {      toast.error(t('admin.users.cannotChangeSelfRole'));      return;    }    setLoading(true);    try {      await updateDoc(doc(db, 'users', userId), { role: newRole });      setUsers(prev => prev.map(u => u.id === userId ? { ...u, role: newRole } : u));      toast.success(t('admin.roleUpdateSuccess'));    } catch (error) {      console.error('Error updating user role:', error);      toast.error(t('messages.error'));    } finally {      setLoading(false);    }  };  const handleStatusToggle = async (userId: string, currentStatus: boolean) => {    if (userId === user?.uid) {      toast.error(t('admin.users.cannotDeactivateSelf'));      return;    }    setLoading(true);    try {      await updateDoc(doc(db, 'users', userId), { isActive: !currentStatus });      setUsers(prev => prev.map(u => u.id === userId ? { ...u, isActive: !currentStatus } : u));      toast.success(t('admin.userStatusUpdateSuccess', {action: t(!currentStatus ? 'admin.activated' : 'admin.deactivated')}));    } catch (error) {      console.error('Error updating user status:', error);      toast.error(t('messages.error'));    } finally {      setLoading(false);    }  };  const handleDeleteUser = async (userId: string) => {    if (userId === user?.uid) {      toast.error(t('admin.users.cannotDeleteSelf'));      return;    }    setLoading(true);    try {      // Instead of deleting, mark user as deleted and inactive      await updateDoc(doc(db, 'users', userId), {        isActive: false,        isDeleted: true,        deletedAt: new Date(),        deletedBy: user?.uid      });            setUsers(prev => prev.filter(u => u.id !== userId));      toast.success(t('admin.userDeleteSuccess'));    } catch (error) {      console.error('Error deleting user:', error);      toast.error(t('admin.userDeleteError'));    } finally {      setLoading(false);    }  };  const filteredUsers = filter === 'all' ? users : users.filter(u => u.role === filter);  if (user?.role !== 'admin') {    return (      <div className=\"text-center py-12\">        <p className=\"text-gray-600\">{t('admin.loginAsAdmin')}</p>      </div>    );  }  if (loading) {    return (      <div className=\"flex items-center justify-center min-h-96\">        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>      </div>    );  }  return (    <AdminLayout title={`üë• ${t('admin.userManagement')}`}>      {/* Filter Tabs */}      <div className=\"mb-6\">        <div className=\"flex space-x-4\">          {[            { key: 'all', label: t('common.all'), count: users.length },            { key: 'admin', label: t('ui.admin'), count: users.filter(u => u.role === 'admin').length },            { key: 'creator', label: t('ui.creator'), count: users.filter(u => u.role === 'creator').length },            { key: 'user', label: t('ui.user'), count: users.filter(u => u.role === 'user').length }          ].map(tab => (            <button              key={tab.key}              onClick={() => setFilter(tab.key as any)}              className={`px-4 py-2 rounded-lg font-medium transition-colors ${                filter === tab.key                  ? 'bg-blue-600 text-white'                  : 'bg-gray-200 text-gray-700 hover:bg-gray-300'              }`}            >              {tab.label} ({tab.count})            </button>          ))}        </div>      </div>      {/* Stats Cards */}      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">        <div className=\"bg-white rounded-lg shadow p-4\">          <h3 className=\"text-lg font-semibold text-gray-900\">{t('admin.userManagementCards.totalUsers')}</h3>          <p className=\"text-3xl font-bold text-blue-600\">{users.length}</p>        </div>        <div className=\"bg-white rounded-lg shadow p-4\">          <h3 className=\"text-lg font-semibold text-gray-900\">{t('admin.userManagementCards.activeUsers')}</h3>          <p className=\"text-3xl font-bold text-green-600\">            {users.filter(u => u.isActive !== false).length}          </p>        </div>        <div className=\"bg-white rounded-lg shadow p-4\">          <h3 className=\"text-lg font-semibold text-gray-900\">{t('ui.creator')}</h3>          <p className=\"text-3xl font-bold text-purple-600\">            {users.filter(u => u.role === 'creator').length}          </p>        </div>        <div className=\"bg-white rounded-lg shadow p-4\">          <h3 className=\"text-lg font-semibold text-gray-900\">{t('ui.admin')}</h3>          <p className=\"text-3xl font-bold text-red-600\">            {users.filter(u => u.role === 'admin').length}          </p>        </div>      </div>      {/* User List */}      <div className=\"bg-white rounded-lg shadow overflow-hidden\">        <table className=\"min-w-full divide-y divide-gray-200\">          <thead className=\"bg-gray-50\">            <tr>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                {t('ui.user')}              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                {t('ui.role')}              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                {t('status.label')}              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                {t('common.createdAt')}              </th>              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">                {t('action.actions')}              </th>            </tr>          </thead>          <tbody className=\"bg-white divide-y divide-gray-200\">            {filteredUsers.map(userData => (              <tr key={userData.id} className={userData.id === user?.uid ? 'bg-blue-50' : ''}>                <td className=\"px-6 py-4 whitespace-nowrap\">                  <div className=\"flex items-center\">                    <div className=\"flex-shrink-0 h-10 w-10\">                      <div className=\"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center\">                        <span className=\"text-sm font-medium text-gray-700\">                          {userData.displayName?.charAt(0) || userData.email?.charAt(0) || 'U'}                        </span>                      </div>                    </div>                    <div className=\"ml-4\">                      <div className=\"text-sm font-medium text-gray-900\">                        {userData.displayName || t('profile.displayName')}                        {userData.id === user?.uid && (                          <span className=\"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\">                            ({t('common.you')})                          </span>                        )}                      </div>                      <div className=\"text-sm text-gray-500\">{userData.email}</div>                    </div>                  </div>                </td>                <td className=\"px-6 py-4 whitespace-nowrap\">                  <select                    value={userData.role}                    onChange={(e) => setConfirmModal({ open: true, type: 'roleChange', payload: { userId: userData.id, newRole: e.target.value }, message: `B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒë·ªïi quy·ªÅn cho ng∆∞·ªùi d√πng n√†y th√†nh ${e.target.value}?` })}                    disabled={userData.id === user?.uid}                    className=\"text-sm border border-gray-300 rounded px-2 py-1\"                  >                    // eslint-disable-next-line i18next/no-literal-string                    <option value=\"user\">User</option>                    <option value=\"creator\">{t(\"nav.creator\")}</option>                    <option value=\"admin\">{t(\"admin.quizManagement.adminBadge\")}</option>                  </select>                </td>                <td className=\"px-6 py-4 whitespace-nowrap\">                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${                    userData.isActive !== false                       ? 'bg-green-100 text-green-800'                       : 'bg-red-100 text-red-800'                  }`}>                      {userData.isActive !== false ? t('status.active') : t('status.inactive')}                  </span>                </td>                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">                  {userData.createdAt?.toDate?.()?.toLocaleDateString() || 'N/A'}                </td>                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">                  <div className=\"flex space-x-2\">                    {userData.id !== user?.uid && (                      <>                        <button                          onClick={() => setConfirmModal({ open: true, type: 'toggleUserStatus', payload: { userId: userData.id, currentStatus: userData.isActive !== false }, message: userData.isActive !== false ? 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën kh√≥a t√†i kho·∫£n n√†y?' : 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën k√≠ch ho·∫°t t√†i kho·∫£n n√†y?' })}                          className={`px-3 py-1 rounded text-xs ${userData.isActive !== false ? 'bg-red-600 text-white hover:bg-red-700' : 'bg-green-600 text-white hover:bg-green-700'}`}                          disabled={loading}                        >                          {userData.isActive !== false ? t('action.deactivate') : t('action.activate')}                        </button>                        <button                          onClick={() => setConfirmModal({ open: true, type: 'deleteUser', payload: { userId: userData.id }, message: t('users.confirmDelete') })}                          className=\"px-3 py-1 bg-red-100 text-red-600 rounded text-xs hover:bg-red-200\"                          disabled={loading}                        >                          {t('delete')}                        </button>                      </>                    )}                  </div>                </td>              </tr>            ))}          </tbody>        </table>      </div>      {/* Modal x√°c nh·∫≠n thao t√°c */}      <Modal        isOpen={confirmModal.open}        onClose={() => setConfirmModal({ open: false, type: null })}        title={t('action.confirm')}      >        <div className=\"mb-4\">{confirmModal.message}</div>        <div className=\"flex justify-end space-x-2\">          <button            onClick={() => setConfirmModal({ open: false, type: null })}            className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400\"            disabled={loading}          >            {t('cancel')}          </button>          <button            onClick={async () => {              if (confirmModal.type === 'deleteUser') await handleDeleteUser(confirmModal.payload.userId);              if (confirmModal.type === 'toggleUserStatus') await handleStatusToggle(confirmModal.payload.userId, confirmModal.payload.currentStatus);              if (confirmModal.type === 'roleChange') await handleRoleChange(confirmModal.payload.userId, confirmModal.payload.newRole);              setConfirmModal({ open: false, type: null });            }}            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"            disabled={loading}          >            {t('action.confirm')}          </button>        </div>      </Modal>    </AdminLayout>  );};export default AdminUserManagement;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\BuildIndexPage.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":13076,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø/** * üî® Build Vector Index - Admin Page *  * Admin tool to build vector index from browser * Uses current user's Firebase Auth for permissions */import { useState } from 'react';import { motion } from 'framer-motion';import { Database, PlayCircle, CheckCircle, XCircle, Loader, AlertTriangle } from 'lucide-react';import { useSelector } from 'react-redux';import type { RootState } from '../../../lib/store';import { buildIndex } from '../../../lib/genkit/indexing';import type { VectorIndex } from '../../../lib/genkit/types';interface BuildStatus {  status: 'idle' | 'building' | 'success' | 'error';  message: string;  index?: VectorIndex;  error?: string;  startTime?: number;  endTime?: number;}export function BuildIndexPage() {  const { user } = useSelector((state: RootState) => state.auth);  const [buildStatus, setBuildStatus] = useState<BuildStatus>({    status: 'idle',    message: 'S·∫µn s√†ng build vector index',  });  // Check if user is admin  if (!user || user.role !== 'admin') {    return (      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 p-6\">        <div className=\"max-w-4xl mx-auto\">          <motion.div            initial={{ opacity: 0, y: 20 }}            animate={{ opacity: 1, y: 0 }}            className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6\"          >            <div className=\"flex items-center gap-3\">              <AlertTriangle className=\"w-6 h-6 text-red-600\" />              <div>                // eslint-disable-next-line i18next/no-literal-string                <h2 className=\"text-lg font-semibold text-red-900 dark:text-red-100\">                  Access Denied                </h2>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-red-700 dark:text-red-300 mt-1\">                  B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n admin ƒë·ªÉ truy c·∫≠p trang n√†y.                </p>              </div>            </div>          </motion.div>        </div>      </div>    );  }  const handleBuildIndex = async () => {    setBuildStatus({      status: 'building',      message: 'ƒêang build vector index...',      startTime: Date.now(),    });    try {      // Build index using current user's auth      const index = await buildIndex();      // Save to localStorage first      localStorage.setItem('vector-index', JSON.stringify(index));      console.log('‚úÖ Index saved to localStorage');            // Save to Firestore for Cloud Functions      try {        // Remove undefined values to avoid Firestore errors        const sanitizedIndex = JSON.parse(JSON.stringify(index));                const { doc, setDoc } = await import('firebase/firestore');        const { db } = await import('../../../lib/firebase/config');        await setDoc(doc(db, 'system', 'vector-index'), sanitizedIndex);                console.log('‚úÖ Index saved to Firestore successfully');      } catch (firestoreError) {        console.error('‚ùå Failed to save to Firestore:', firestoreError);        throw new Error(          `L·ªói khi l∆∞u v√†o Firestore: ${            firestoreError instanceof Error ? firestoreError.message : 'Unknown error'          }. Vui l√≤ng ki·ªÉm tra:\\n` +          '1. B·∫°n ƒë√£ ƒëƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n admin?\\n' +          '2. Firestore rules ƒë√£ ƒë∆∞·ª£c deploy?\\n' +          '3. T√†i kho·∫£n c√≥ role = \"admin\" trong Firestore?'        );      }      setBuildStatus({        status: 'success',        message: 'Build th√†nh c√¥ng!',        index,        endTime: Date.now(),        startTime: buildStatus.startTime,      });          } catch (error) {      console.error('‚ùå Error building index:', error);      setBuildStatus({        status: 'error',        message: 'L·ªói khi build index',        error: error instanceof Error ? error.message : String(error),        endTime: Date.now(),        startTime: buildStatus.startTime,      });    }  };  const getDuration = () => {    if (buildStatus.startTime && buildStatus.endTime) {      return ((buildStatus.endTime - buildStatus.startTime) / 1000).toFixed(2);    }    return null;  };  return (    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 p-6\">      <div className=\"max-w-4xl mx-auto\">        {/* Header */}        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\">          <div className=\"flex items-center gap-4\">            <div className=\"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">              <Database className=\"w-6 h-6 text-white\" />            </div>            <div>              // eslint-disable-next-line i18next/no-literal-string              <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">                Build Vector Index              </h1>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-gray-600 dark:text-gray-400\">                T·∫°o vector index t·ª´ quiz data cho RAG Chatbot              </p>            </div>          </div>        </div>        {/* Build Button */}        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\">          <motion.button            whileHover={{ scale: 1.02 }}            whileTap={{ scale: 0.98 }}            onClick={handleBuildIndex}            disabled={buildStatus.status === 'building'}            className=\"w-full py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-semibold flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transition-all\"          >            {buildStatus.status === 'building' ? (              <>                <Loader className=\"w-5 h-5 animate-spin\" />                ƒêang build...              </>            ) : (              <>                // eslint-disable-next-line i18next/no-literal-string                <PlayCircle className=\"w-5 h-5\" />                Build Vector Index              </>            )}          </motion.button>        </div>        {/* Status Card */}        <motion.div          initial={{ opacity: 0, y: 20 }}          animate={{ opacity: 1, y: 0 }}          className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\"        >          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">            Status          </h2>          <div className=\"space-y-4\">            {/* Status Message */}            <div className=\"flex items-start gap-3\">              {buildStatus.status === 'idle' && (                <Database className=\"w-6 h-6 text-gray-400 flex-shrink-0 mt-0.5\" />              )}              {buildStatus.status === 'building' && (                <Loader className=\"w-6 h-6 text-blue-500 animate-spin flex-shrink-0 mt-0.5\" />              )}              {buildStatus.status === 'success' && (                <CheckCircle className=\"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5\" />              )}              {buildStatus.status === 'error' && (                <XCircle className=\"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5\" />              )}                            <div className=\"flex-1\">                <p className=\"font-medium text-gray-900 dark:text-white\">                  {buildStatus.message}                </p>                {buildStatus.error && (                  <p className=\"text-sm text-red-600 dark:text-red-400 mt-1\">                    {buildStatus.error}                  </p>                )}              </div>            </div>            {/* Success Details */}            {buildStatus.status === 'success' && buildStatus.index && (              <motion.div                initial={{ opacity: 0 }}                animate={{ opacity: 1 }}                className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 space-y-2\"              >                // eslint-disable-next-line i18next/no-literal-string                <h3 className=\"font-semibold text-green-900 dark:text-green-100\">                  üìä Index Statistics                </h3>                <div className=\"grid grid-cols-2 gap-4 text-sm\">                  <div>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-gray-600 dark:text-gray-400\">Total Chunks:</span>                    <span className=\"ml-2 font-semibold text-gray-900 dark:text-white\">                      {buildStatus.index.totalChunks}                    </span>                  </div>                  <div>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-gray-600 dark:text-gray-400\">Quiz Chunks:</span>                    <span className=\"ml-2 font-semibold text-gray-900 dark:text-white\">                      {buildStatus.index.sources.quiz || 0}                    </span>                  </div>                  <div>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-gray-600 dark:text-gray-400\">PDF Chunks:</span>                    <span className=\"ml-2 font-semibold text-gray-900 dark:text-white\">                      {buildStatus.index.sources.pdf || 0}                    </span>                  </div>                  <div>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-gray-600 dark:text-gray-400\">Build Time:</span>                    <span className=\"ml-2 font-semibold text-gray-900 dark:text-white\">                      // eslint-disable-next-line i18next/no-literal-string                      {getDuration()}s                    </span>                  </div>                </div>                <div className=\"pt-2 border-t border-green-200 dark:border-green-800\">                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-xs text-green-700 dark:text-green-300\">                    ‚úÖ Index ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o localStorage v√† Firestore                  </p>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-xs text-green-700 dark:text-green-300\">                    üìÇ Firestore: system/vector-index                  </p>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-xs text-green-700 dark:text-green-300\">                    ü§ñ AI chatbot c√≥ th·ªÉ s·ª≠ d·ª•ng ngay!                  </p>                </div>              </motion.div>            )}          </div>        </motion.div>        {/* Instructions */}        <div className=\"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-6\">          // eslint-disable-next-line i18next/no-literal-string          <h3 className=\"font-semibold text-blue-900 dark:text-blue-100 mb-2\">            üìù H∆∞·ªõng d·∫´n          </h3>          <ol className=\"text-sm text-blue-800 dark:text-blue-200 space-y-2 list-decimal list-inside\">            // eslint-disable-next-line i18next/no-literal-string            <li>Click \"Build Vector Index\" ƒë·ªÉ b·∫Øt ƒë·∫ßu</li>            // eslint-disable-next-line i18next/no-literal-string            <li>Ch·ªù h·ªá th·ªëng extract quiz data v√† generate embeddings</li>            // eslint-disable-next-line i18next/no-literal-string            <li>Index s·∫Ω ƒë∆∞·ª£c l∆∞u v√†o localStorage</li>            // eslint-disable-next-line i18next/no-literal-string            <li>S·ª≠ d·ª•ng index n√†y ƒë·ªÉ test RAG chatbot</li>            // eslint-disable-next-line i18next/no-literal-string            <li>Trong production, deploy Cloud Function ƒë·ªÉ build index t·ª± ƒë·ªông</li>          </ol>        </div>        {/* Next Steps */}        {buildStatus.status === 'success' && (          <motion.div            initial={{ opacity: 0, y: 20 }}            animate={{ opacity: 1, y: 0 }}            className=\"mt-6 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-6\"          >            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"font-semibold text-purple-900 dark:text-purple-100 mb-2\">              üéâ Next Steps            </h3>            <ul className=\"text-sm text-purple-800 dark:text-purple-200 space-y-2 list-disc list-inside\">              // eslint-disable-next-line i18next/no-literal-string              <li>Test RAG chatbot v·ªõi vector index v·ª´a build</li>              // eslint-disable-next-line i18next/no-literal-string              <li>Deploy Cloud Functions: <code className=\"bg-purple-100 dark:bg-purple-900 px-2 py-0.5 rounded\">firebase deploy --only functions:askRAG</code></li>              // eslint-disable-next-line i18next/no-literal-string              <li>Update ChatbotModal ƒë·ªÉ connect v·ªõi backend</li>              // eslint-disable-next-line i18next/no-literal-string              <li>Test end-to-end v·ªõi real questions</li>            </ul>          </motion.div>        )}      </div>    </div>  );}export default BuildIndexPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\CategoryManagement.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":20606,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { toast } from 'react-toastify';import { useTranslation } from 'react-i18next';import {   collection,   getDocs,   addDoc,   updateDoc,   deleteDoc,   doc,  query,  where} from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { initializeCategories } from '../../../utils/initializeCategories';import {  Plus,  Search,  Edit,  Trash2,  Save,  X,  FolderOpen,  BookOpen,  User,  BarChart3,  Eye} from 'lucide-react';interface Category {  id: string;  name: string;  description: string;  icon: string;  color: string;  createdAt: Date;  quizCount?: number;}const CategoryManagement: React.FC = () => {  const { user } = useSelector((state: RootState) => state.auth);  const { t } = useTranslation();  const [categories, setCategories] = useState<Category[]>([]);  const [loading, setLoading] = useState(true);  const [showAddForm, setShowAddForm] = useState(false);  const [editingCategory, setEditingCategory] = useState<Category | null>(null);  const [searchTerm, setSearchTerm] = useState('');    const [formData, setFormData] = useState({    name: '',    description: '',    icon: 'üìö',    color: 'blue'  });  const colors = [    { value: 'blue', label: t('categories.colors.blue'), class: 'bg-blue-500' },    { value: 'green', label: t('categories.colors.green'), class: 'bg-green-500' },    { value: 'purple', label: t('categories.colors.purple'), class: 'bg-purple-500' },    { value: 'red', label: t('categories.colors.red'), class: 'bg-red-500' },    { value: 'yellow', label: t('categories.colors.yellow'), class: 'bg-yellow-500' },    { value: 'pink', label: t('categories.colors.pink'), class: 'bg-pink-500' },    { value: 'indigo', label: t('categories.colors.indigo'), class: 'bg-indigo-500' },    { value: 'gray', label: t('categories.colors.gray'), class: 'bg-gray-500' }  ];  const icons = ['üìö', 'üî¨', 'üíª', 'üé®', 'üìä', 'üåç', 'üèÉ‚Äç‚ôÇÔ∏è', 'üéµ', 'üç≥', 'üìà', 'üßÆ', 'üìù'];  const loadCategories = useCallback(async () => {    try {      setLoading(true);      console.log('üîç Loading categories from Firebase...');            // Initialize default categories if none exist      await initializeCategories();            const categoriesRef = collection(db, 'categories');      const snapshot = await getDocs(categoriesRef);            console.log('üìä Found categories in DB:', snapshot.size);      const loadedCategories: Category[] = [];            for (const doc of snapshot.docs) {        const data = doc.data();        console.log('üìù Category data:', { id: doc.id, ...data });                // ƒê·∫øm s·ªë quiz trong danh m·ª•c n√†y        const quizzesRef = collection(db, 'quizzes');        const quizzesSnapshot = await getDocs(query(quizzesRef, where('category', '==', data.name)));                loadedCategories.push({          id: doc.id,          name: data.name,          description: data.description,          icon: data.icon,          color: data.color,          createdAt: data.createdAt?.toDate() || new Date(),          quizCount: quizzesSnapshot.size        });      }            console.log('‚úÖ Loaded categories:', loadedCategories);      setCategories(loadedCategories.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime()));    } catch (error) {      console.error('‚ùå Error loading categories:', error);      toast.error(t('categories.loadError'));    } finally {      setLoading(false);    }  }, [t]);  // Move useEffect before conditional return - Fix React Hooks rules  useEffect(() => {    if (!user || user.role !== 'admin') return;    loadCategories();  }, [user, loadCategories]);  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();        if (!formData.name.trim()) {      toast.error(t('categories.enterName'));      return;    }    try {      if (editingCategory) {        // Update existing category        const categoryRef = doc(db, 'categories', editingCategory.id);        await updateDoc(categoryRef, {          name: formData.name.trim(),          description: formData.description.trim(),          icon: formData.icon,          color: formData.color,          updatedAt: new Date()        });                setCategories(prev => prev.map(cat =>           cat.id === editingCategory.id             ? { ...cat, ...formData, name: formData.name.trim(), description: formData.description.trim() }            : cat        ));                toast.success(t('categories.updateSuccess'));      } else {        // Add new category        const docRef = await addDoc(collection(db, 'categories'), {          name: formData.name.trim(),          description: formData.description.trim(),          icon: formData.icon,          color: formData.color,          createdAt: new Date()        });                const newCategory: Category = {          id: docRef.id,          name: formData.name.trim(),          description: formData.description.trim(),          icon: formData.icon,          color: formData.color,          createdAt: new Date(),          quizCount: 0        };                setCategories(prev => [newCategory, ...prev]);        toast.success(t('categories.addSuccess'));      }            // Reset form      setFormData({ name: '', description: '', icon: 'üìö', color: 'blue' });      setShowAddForm(false);      setEditingCategory(null);    } catch (error) {      console.error('Error saving category:', error);      toast.error(t('categories.saveError'));    }  };  const handleEdit = (category: Category) => {    setEditingCategory(category);    setFormData({      name: category.name,      description: category.description,      icon: category.icon,      color: category.color    });    setShowAddForm(true);  };  const handleDelete = async (categoryId: string, categoryName: string) => {    if (!confirm(t('categories.confirmDeleteName', {name: categoryName, defaultValue: `Are you sure you want to delete category \"${categoryName}\"?`}))) {      return;    }    try {      await deleteDoc(doc(db, 'categories', categoryId));      setCategories(prev => prev.filter(cat => cat.id !== categoryId));      toast.success(t('categories.deleteSuccess'));    } catch (error) {      console.error('Error deleting category:', error);      toast.error(t('categories.deleteError'));    }  };  const filteredCategories = categories.filter(category =>    category.name.toLowerCase().includes(searchTerm.toLowerCase()) ||    category.description.toLowerCase().includes(searchTerm.toLowerCase())  );  const getColorClass = (color: string) => {    const colorMap: { [key: string]: string } = {      blue: 'bg-blue-500',      green: 'bg-green-500',      purple: 'bg-purple-500',      red: 'bg-red-500',      yellow: 'bg-yellow-500',      pink: 'bg-pink-500',      indigo: 'bg-indigo-500',      gray: 'bg-gray-500'    };    return colorMap[color] || 'bg-blue-500';  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto\"></div>          <p className=\"mt-4 text-gray-600\">{t('loadingData')}</p>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50\">      {/* Modern Header */}      <div className=\"bg-white border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">          <div className=\"flex items-center justify-between\">            <div className=\"flex items-center space-x-4\">              <div className=\"w-12 h-12 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center\">                <FolderOpen className=\"w-6 h-6 text-white\" />              </div>              <div>                <h1 className=\"text-2xl font-bold text-gray-900\">{t('admin.categoryManagement')}</h1>                <p className=\"text-gray-600\">{t('admin.categories.headerDesc')}</p>              </div>            </div>            <div className=\"flex items-center space-x-4\">              <button                onClick={() => {                  setShowAddForm(true);                  setEditingCategory(null);                  setFormData({ name: '', description: '', icon: 'üìö', color: 'blue' });                }}                className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors\"              >                <Plus className=\"w-5 h-5\" />                {t('categories.add')}              </button>              <div className=\"flex items-center space-x-2 text-sm text-gray-600\">                <User className=\"w-4 h-4\" />                <span>{user?.email}</span>                <span className=\"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium\">{t('ui.admin')}</span>              </div>            </div>          </div>        </div>      </div>      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        {/* Stats Overview */}        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">          <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('categories.total')}</p>                <p className=\"text-2xl font-bold text-gray-900\">{categories.length}</p>              </div>              <div className=\"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center\">                <FolderOpen className=\"w-6 h-6 text-purple-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('categories.withQuizzes')}</p>                <p className=\"text-2xl font-bold text-green-600\">{categories.filter(c => c.quizCount && c.quizCount > 0).length}</p>              </div>              <div className=\"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center\">                <BookOpen className=\"w-6 h-6 text-green-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('categories.totalQuizzes')}</p>                <p className=\"text-2xl font-bold text-blue-600\">{categories.reduce((sum, c) => sum + (c.quizCount || 0), 0)}</p>              </div>              <div className=\"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center\">                <BarChart3 className=\"w-6 h-6 text-blue-600\" />              </div>            </div>          </div>                    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">            <div className=\"flex items-center justify-between\">              <div>                <p className=\"text-sm font-medium text-gray-600\">{t('categories.empty')}</p>                <p className=\"text-2xl font-bold text-orange-600\">{categories.filter(c => !c.quizCount || c.quizCount === 0).length}</p>              </div>              <div className=\"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center\">                <Eye className=\"w-6 h-6 text-orange-600\" />              </div>            </div>          </div>        </div>        {/* Search */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">          <div className=\"relative\">            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />              <input              type=\"text\"                placeholder={t('categories.searchPlaceholder')}              value={searchTerm}              onChange={(e) => setSearchTerm(e.target.value)}              className=\"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"            />          </div>        </div>        {/* Categories Grid */}        {filteredCategories.length === 0 ? (          <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center\">            <FolderOpen className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">{t('categories.noCategories')}</h3>            <p className=\"text-gray-600 mb-4\">              {searchTerm ? t('categories.noSearchMatch') : t('categories.noneCreated')}            </p>            <button              onClick={() => {                setShowAddForm(true);                setEditingCategory(null);                setFormData({ name: '', description: '', icon: 'üìö', color: 'blue' });              }}              className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto\"            >              <Plus className=\"w-5 h-5\" />              {t('categories.createFirst')}            </button>          </div>        ) : (          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">            {filteredCategories.map((category) => (              <div key={category.id} className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow\">                <div className=\"flex items-start justify-between mb-4\">                  <div className=\"flex items-center space-x-3\">                    <div className={`w-12 h-12 ${getColorClass(category.color)} rounded-xl flex items-center justify-center text-2xl`}>                      {category.icon}                    </div>                    <div>                      <h3 className=\"text-lg font-bold text-gray-900\">{category.name}</h3>                      <p className=\"text-sm text-gray-600\">{category.quizCount || 0} {t('categories.quizSuffix')}</p>                    </div>                  </div>                  <div className=\"flex items-center gap-2\">                    <button                      onClick={() => handleEdit(category)}                      className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"                      title={t('edit')}                    >                      <Edit className=\"w-4 h-4\" />                    </button>                    <button                      onClick={() => handleDelete(category.id, category.name)}                      className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"                      title={t('delete')}                    >                      <Trash2 className=\"w-4 h-4\" />                    </button>                  </div>                </div>                                <p className=\"text-gray-600 text-sm mb-4\">{category.description}</p>                                <div className=\"flex items-center justify-between text-xs text-gray-500\">                  <span>{t('categories.createdAtLabel')}: {category.createdAt.toLocaleDateString()}</span>                  <span className={`px-2 py-1 rounded-full text-white ${getColorClass(category.color)}`}>                    {category.color}                  </span>                </div>              </div>            ))}          </div>        )}      </div>      {/* Add/Edit Form Modal */}      {showAddForm && (        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">          <div className=\"bg-white rounded-2xl max-w-md w-full p-6\">            <div className=\"flex items-center justify-between mb-6\">              <h2 className=\"text-xl font-bold\">                {editingCategory ? t('categories.editTitle') : t('categories.addTitle')}              </h2>              <button                onClick={() => {                  setShowAddForm(false);                  setEditingCategory(null);                  setFormData({ name: '', description: '', icon: 'üìö', color: 'blue' });                }}                className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg\"              >                <X className=\"w-5 h-5\" />              </button>            </div>                        <form onSubmit={handleSubmit} className=\"space-y-4\">              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('categories.name')} *                </label>                <input                  type=\"text\"                  value={formData.name}                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}                  className=\"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"                  placeholder={t('categories.namePlaceholder')}                  required                />              </div>                            <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('categories.description')}                </label>                <textarea                  value={formData.description}                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}                  className=\"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none\"                  rows={3}                  placeholder={t('categories.descriptionPlaceholder')}                />              </div>                            <div>                // eslint-disable-next-line i18next/no-literal-string                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  Icon                </label>                <div className=\"grid grid-cols-6 gap-2\">                  {icons.map((icon) => (                    <button                      key={icon}                      type=\"button\"                      onClick={() => setFormData({ ...formData, icon })}                      className={`p-3 text-2xl border-2 rounded-lg hover:bg-gray-50 transition-colors ${                        formData.icon === icon ? 'border-purple-500 bg-purple-50' : 'border-gray-200'                      }`}                    >                      {icon}                    </button>                  ))}                </div>              </div>                            <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('categories.color')}                </label>                <div className=\"grid grid-cols-4 gap-2\">                  {colors.map((color) => (                    <button                      key={color.value}                      type=\"button\"                      onClick={() => setFormData({ ...formData, color: color.value })}                      className={`p-3 border-2 rounded-lg hover:bg-gray-50 transition-colors ${                        formData.color === color.value ? 'border-purple-500 bg-purple-50' : 'border-gray-200'                      }`}                    >                      <div className={`w-6 h-6 ${color.class} rounded-full mx-auto mb-1`}></div>                      <span className=\"text-xs\">{color.label}</span>                    </button>                  ))}                </div>              </div>                            <div className=\"flex gap-3 pt-4\">                <button                  type=\"button\"                  onClick={() => {                    setShowAddForm(false);                    setEditingCategory(null);                    setFormData({ name: '', description: '', icon: 'üìö', color: 'blue' });                  }}                  className=\"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"                >                  {t('cancel')}                </button>                <button                  type=\"submit\"                  className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors\"                >                  <Save className=\"w-4 h-4\" />                  {editingCategory ? t('update') : t('categories.create')}                </button>              </div>            </form>          </div>        </div>      )}    </div>  );};export default CategoryManagement;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\CreatorManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\MyQuizzesPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\admin\\pages\\StatsDashboard.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';import { useTranslation } from 'react-i18next';import AdminStats from '../components/AdminStats';const StatsDashboard: React.FC = () => {  const { t } = useTranslation();    return (    <div className=\"min-h-screen bg-gray-50\">      {/* Header */}      <header className=\"bg-white shadow-sm border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">          <div className=\"flex justify-between items-center h-16\">            <div className=\"flex items-center\">              <div className=\"h-8 w-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-3\">                <span className=\"text-white text-xl\">üìä</span>              </div>              <h1 className=\"text-xl font-bold text-gray-900\">{t('admin.stats.title')}</h1>            </div>                        <div className=\"flex items-center space-x-4\">              <a                href=\"/admin\"                className=\"bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors duration-200\"              >                ‚Üê {t('admin.sidebar.backToDashboard')}              </a>            </div>          </div>        </div>      </header>      {/* Success Banner */}      <div className=\"bg-green-50 border-l-4 border-green-400 p-4\">        <div className=\"flex\">          <div className=\"flex-shrink-0\">            <span className=\"text-green-400 text-xl\">‚úÖ</span>          </div>          <div className=\"ml-3\">            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-sm font-medium text-green-800\">              Th√†nh c√¥ng! B·∫°n ƒëang xem trang th·ªëng k√™ v·ªõi bi·ªÉu ƒë·ªì            </h3>            <div className=\"mt-2 text-sm text-green-700\">              // eslint-disable-next-line i18next/no-literal-string              <p>Trang n√†y hi·ªÉn th·ªã:</p>              <ul className=\"list-disc list-inside mt-1\">                // eslint-disable-next-line i18next/no-literal-string                <li>üìä Bi·ªÉu ƒë·ªì c·ªôt - Danh m·ª•c ph·ªï bi·∫øn</li>                // eslint-disable-next-line i18next/no-literal-string                <li>ü•ß Bi·ªÉu ƒë·ªì tr√≤n - T·ª∑ l·ªá quiz ƒë√£ duy·ªát/ch·ªù duy·ªát</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üìà 8 Cards th·ªëng k√™ chi ti·∫øt</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üéØ D·ªØ li·ªáu m·∫´u ƒë·ªÉ demo</li>              </ul>            </div>          </div>        </div>      </div>      {/* Main Content */}      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        <AdminStats />      </main>    </div>  );};export default StatsDashboard;","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';import { useTranslation } from 'react-i18next';import AdminStats from '../components/AdminStats';const StatsDashboard: React.FC = () => {  const { t } = useTranslation();    return (    <div className=\"min-h-screen bg-gray-50\">      {/* Header */}      <header className=\"bg-white shadow-sm border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">          <div className=\"flex justify-between items-center h-16\">            <div className=\"flex items-center\">              <div className=\"h-8 w-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-3\">                <span className=\"text-white text-xl\">üìä</span>              </div>              <h1 className=\"text-xl font-bold text-gray-900\">{t('admin.stats.title')}</h1>            </div>                        <div className=\"flex items-center space-x-4\">              <a                href=\"/admin\"                className=\"bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors duration-200\"              >                ‚Üê {t('admin.sidebar.backToDashboard')}              </a>            </div>          </div>        </div>      </header>      {/* Success Banner */}      <div className=\"bg-green-50 border-l-4 border-green-400 p-4\">        <div className=\"flex\">          <div className=\"flex-shrink-0\">            <span className=\"text-green-400 text-xl\">‚úÖ</span>          </div>          <div className=\"ml-3\">            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-sm font-medium text-green-800\">              Th√†nh c√¥ng! B·∫°n ƒëang xem trang th·ªëng k√™ v·ªõi bi·ªÉu ƒë·ªì            </h3>            <div className=\"mt-2 text-sm text-green-700\">              // eslint-disable-next-line i18next/no-literal-string              <p>Trang n√†y hi·ªÉn th·ªã:</p>              <ul className=\"list-disc list-inside mt-1\">                // eslint-disable-next-line i18next/no-literal-string                <li>üìä Bi·ªÉu ƒë·ªì c·ªôt - Danh m·ª•c ph·ªï bi·∫øn</li>                // eslint-disable-next-line i18next/no-literal-string                <li>ü•ß Bi·ªÉu ƒë·ªì tr√≤n - T·ª∑ l·ªá quiz ƒë√£ duy·ªát/ch·ªù duy·ªát</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üìà 8 Cards th·ªëng k√™ chi ti·∫øt</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üéØ D·ªØ li·ªáu m·∫´u ƒë·ªÉ demo</li>              </ul>            </div>          </div>        </div>      </div>      {/* Main Content */}      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        <AdminStats />      </main>    </div>  );};export default StatsDashboard;' was not found.","line":1,"column":1,"endLine":1,"endColumn":2767,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';import { useTranslation } from 'react-i18next';import AdminStats from '../components/AdminStats';const StatsDashboard: React.FC = () => {  const { t } = useTranslation();    return (    <div className=\"min-h-screen bg-gray-50\">      {/* Header */}      <header className=\"bg-white shadow-sm border-b border-gray-200\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">          <div className=\"flex justify-between items-center h-16\">            <div className=\"flex items-center\">              <div className=\"h-8 w-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-3\">                <span className=\"text-white text-xl\">üìä</span>              </div>              <h1 className=\"text-xl font-bold text-gray-900\">{t('admin.stats.title')}</h1>            </div>                        <div className=\"flex items-center space-x-4\">              <a                href=\"/admin\"                className=\"bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors duration-200\"              >                ‚Üê {t('admin.sidebar.backToDashboard')}              </a>            </div>          </div>        </div>      </header>      {/* Success Banner */}      <div className=\"bg-green-50 border-l-4 border-green-400 p-4\">        <div className=\"flex\">          <div className=\"flex-shrink-0\">            <span className=\"text-green-400 text-xl\">‚úÖ</span>          </div>          <div className=\"ml-3\">            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-sm font-medium text-green-800\">              Th√†nh c√¥ng! B·∫°n ƒëang xem trang th·ªëng k√™ v·ªõi bi·ªÉu ƒë·ªì            </h3>            <div className=\"mt-2 text-sm text-green-700\">              // eslint-disable-next-line i18next/no-literal-string              <p>Trang n√†y hi·ªÉn th·ªã:</p>              <ul className=\"list-disc list-inside mt-1\">                // eslint-disable-next-line i18next/no-literal-string                <li>üìä Bi·ªÉu ƒë·ªì c·ªôt - Danh m·ª•c ph·ªï bi·∫øn</li>                // eslint-disable-next-line i18next/no-literal-string                <li>ü•ß Bi·ªÉu ƒë·ªì tr√≤n - T·ª∑ l·ªá quiz ƒë√£ duy·ªát/ch·ªù duy·ªát</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üìà 8 Cards th·ªëng k√™ chi ti·∫øt</li>                // eslint-disable-next-line i18next/no-literal-string                <li>üéØ D·ªØ li·ªáu m·∫´u ƒë·ªÉ demo</li>              </ul>            </div>          </div>        </div>      </div>      {/* Main Content */}      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        <AdminStats />      </main>    </div>  );};export default StatsDashboard;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\components\\AutoLogoutOnBan.tsx","messages":[{"ruleId":"prefer-const","severity":1,"message":"'interval' is never reassigned. Use 'const' instead.","line":38,"column":5,"nodeType":"Identifier","messageId":"useConst","endLine":38,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { RootState } from '../../../lib/store';\r\nimport { doc, getDoc } from 'firebase/firestore';\r\nimport { db, auth } from '../../../lib/firebase/config';\r\nimport { logout } from '../store';\r\nimport { toast } from 'react-toastify';\r\n\r\n/**\r\n * Component n√†y s·∫Ω t·ª± ƒë·ªông ki·ªÉm tra tr·∫°ng th√°i isActive c·ªßa user m·ªói 5s.\r\n * N·∫øu user b·ªã kho√°, s·∫Ω t·ª± ƒë·ªông logout v√† hi·ªÉn th·ªã th√¥ng b√°o.\r\n */\r\nconst AutoLogoutOnBan = () => {\r\n  const user = useSelector((state: RootState) => state.auth.user);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    if (!user?.uid) return;\r\n    let interval: NodeJS.Timeout;\r\n    let isUnmounted = false;\r\n\r\n    const checkActive = async () => {\r\n      try {\r\n        const userDoc = await getDoc(doc(db, 'users', user.uid));\r\n        const userData = userDoc.data();\r\n        if (userData && userData.isActive === false) {\r\n          if (!isUnmounted) {\r\n            dispatch(logout());\r\n            toast.error('T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ b·ªã kho√°. Vui l√≤ng li√™n h·ªá qu·∫£n tr·ªã vi√™n.');\r\n            if (auth.currentUser) await auth.signOut();\r\n          }\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    };\r\n    checkActive();\r\n    interval = setInterval(checkActive, 5000);\r\n    return () => {\r\n      isUnmounted = true;\r\n      clearInterval(interval);\r\n    };\r\n  }, [user?.uid, dispatch]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default AutoLogoutOnBan;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\components\\ForgotPassword.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":5046,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { sendPasswordResetEmail } from 'firebase/auth';import { auth } from '../../../lib/firebase/config';import { toast } from 'react-toastify';import { ArrowLeft, Mail } from 'lucide-react';import { useTranslation } from 'react-i18next';interface ForgotPasswordProps {  onBack: () => void;}export const ForgotPassword: React.FC<ForgotPasswordProps> = ({ onBack }) => {  const { t } = useTranslation();  const [email, setEmail] = useState('');  const [loading, setLoading] = useState(false);  const [sent, setSent] = useState(false);  const handleResetPassword = async (e: React.FormEvent) => {    e.preventDefault();        if (!email) {      toast.error('Vui l√≤ng nh·∫≠p email');      return;    }    setLoading(true);    try {      // S·ª≠ d·ª•ng Firebase sendPasswordResetEmail      await sendPasswordResetEmail(auth, email);      toast.success('Email ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c g·ª≠i! H√£y ki·ªÉm tra h·ªôp th∆∞ c·ªßa b·∫°n.');      setSent(true);    } catch (error: any) {      console.error('Error resetting password:', error);      if (error.code === 'auth/user-not-found') {        toast.error('Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n v·ªõi email n√†y');      } else if (error.code === 'auth/invalid-email') {        toast.error('Email kh√¥ng h·ª£p l·ªá');      } else {        toast.error('C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i.');      }    } finally {      setLoading(false);    }  };  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4\">      <div className=\"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md\">        <div className=\"flex items-center mb-6\">          <button            onClick={onBack}            className=\"mr-3 p-2 text-gray-400 hover:text-gray-600 transition-colors\"          >            <ArrowLeft className=\"w-5 h-5\" />          </button>          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-2xl font-bold text-gray-800\">Qu√™n m·∫≠t kh·∫©u</h2>        </div>        {!sent ? (          <form onSubmit={handleResetPassword} className=\"space-y-4\">            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                {t(\"auth.email\")}              </label>              <div className=\"relative\">                <Mail className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />                <input                  type=\"email\"                  value={email}                  onChange={(e) => setEmail(e.target.value)}                  className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                  placeholder={t(\"auth.emailPlaceholder\")}                  disabled={loading}                />              </div>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-sm text-gray-500 mt-2\">                Ch√∫ng t√¥i s·∫Ω g·ª≠i link ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u ƒë·∫øn email n√†y.              </p>            </div>            <button              type=\"submit\"              disabled={loading}              className={`w-full py-3 px-4 rounded-lg font-medium transition-colors ${                loading                  ? 'bg-gray-400 cursor-not-allowed'                  : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white'              }`}            >              {loading ? 'ƒêang g·ª≠i...' : 'G·ª≠i email ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u'}            </button>            <button              type=\"button\"              onClick={onBack}              className=\"w-full py-2 px-4 text-gray-600 hover:text-gray-800 transition-colors\"            >              {t(\"common.back\")}            </button>          </form>        ) : (          <div className=\"text-center space-y-4\">            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3\">              <Mail className=\"w-8 h-8 text-green-600\" />            </div>            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-lg font-semibold text-gray-800\">Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-600\">              Ch√∫ng t√¥i ƒë√£ g·ª≠i link ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u ƒë·∫øn<br />              <strong>{email}</strong>            </p>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-500\">              Ki·ªÉm tra h·ªôp th∆∞ c·ªßa b·∫°n v√† click v√†o link ƒë·ªÉ ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.            </p>            <button              type=\"button\"              onClick={onBack}              className=\"w-full py-3 px-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg font-medium transition-colors\"            // eslint-disable-next-line i18next/no-literal-string            >              Quay l·∫°i ƒëƒÉng nh·∫≠p            </button>          </div>        )}      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\components\\OTPVerification.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\components\\ProtectedRoute.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';import { Navigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { Loading } from '../../../shared/components/layout/Loading';import { useTranslation } from 'react-i18next';interface ProtectedRouteProps {  children: React.ReactNode;  requiredRole?: 'admin' | 'creator' | ('admin' | 'creator')[];}const ProtectedRoute: React.FC<ProtectedRouteProps> = ({   children","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';import { Navigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { Loading } from '../../../shared/components/layout/Loading';import { useTranslation } from 'react-i18next';interface ProtectedRouteProps {  children: React.ReactNode;  requiredRole?: 'admin' | 'creator' | ('admin' | 'creator')[];}const ProtectedRoute: React.FC<ProtectedRouteProps> = ({   children' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"requiredRole }) => {  const { t } = useTranslation();  const { user","message":"Definition for rule 'requiredRole }) => {  const { t } = useTranslation();  const { user' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"isLoading } = useSelector((state: RootState) => state.auth);  console.log('üõ°Ô∏è ProtectedRoute check:'","message":"Definition for rule 'isLoading } = useSelector((state: RootState) => state.auth);  console.log('üõ°Ô∏è ProtectedRoute check:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"{    hasUser: !!user","message":"Definition for rule '{    hasUser: !!user' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"isLoading","message":"Definition for rule 'isLoading' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"userRole: user?.role","message":"Definition for rule 'userRole: user?.role' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"requiredRole","message":"Definition for rule 'requiredRole' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"userEmail: user?.email  });  if (isLoading) {    console.log('üõ°Ô∏è ProtectedRoute: Showing loading...');    return <Loading message=\"ƒêang x√°c th·ª±c...\" />;  }  if (!user) {    console.log('üõ°Ô∏è ProtectedRoute: No user","message":"Definition for rule 'userEmail: user?.email  });  if (isLoading) {    console.log('üõ°Ô∏è ProtectedRoute: Showing loading...');    return <Loading message=\"ƒêang x√°c th·ª±c...\" />;  }  if (!user) {    console.log('üõ°Ô∏è ProtectedRoute: No user' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"redirecting to login');    return <Navigate to=\"/login\" replace />;  }  if (requiredRole) {    const allowedRoles = Array.isArray(requiredRole) ? requiredRole : [requiredRole];    const hasRequiredRole = allowedRoles.includes(user.role as 'admin' | 'creator') || user.role === 'admin';        if (!hasRequiredRole) {      console.log('üõ°Ô∏è ProtectedRoute: Role mismatch","message":"Definition for rule 'redirecting to login');    return <Navigate to=\"/login\" replace />;  }  if (requiredRole) {    const allowedRoles = Array.isArray(requiredRole) ? requiredRole : [requiredRole];    const hasRequiredRole = allowedRoles.includes(user.role as 'admin' | 'creator') || user.role === 'admin';        if (!hasRequiredRole) {      console.log('üõ°Ô∏è ProtectedRoute: Role mismatch' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"showing unauthorized');      return (        <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">          <div className=\"text-center\">            <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100\">              <svg className=\"h-6 w-6 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />              </svg>            </div>            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">{t(\"messages.unauthorized\")}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"mt-1 text-sm text-gray-500\">              B·∫°n c·∫ßn c√≥ vai tr√≤ Creator ho·∫∑c Admin ƒë·ªÉ truy c·∫≠p trang n√†y.            </p>            <div className=\"mt-6\">              <button                onClick={() => window.history.back()}                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700\"              >{t(\"common.back\")}              </button>            </div>          </div>        </div>      );    }  }  console.log('üõ°Ô∏è ProtectedRoute: Access granted","message":"Definition for rule 'showing unauthorized');      return (        <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">          <div className=\"text-center\">            <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100\">              <svg className=\"h-6 w-6 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />              </svg>            </div>            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">{t(\"messages.unauthorized\")}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"mt-1 text-sm text-gray-500\">              B·∫°n c·∫ßn c√≥ vai tr√≤ Creator ho·∫∑c Admin ƒë·ªÉ truy c·∫≠p trang n√†y.            </p>            <div className=\"mt-6\">              <button                onClick={() => window.history.back()}                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700\"              >{t(\"common.back\")}              </button>            </div>          </div>        </div>      );    }  }  console.log('üõ°Ô∏è ProtectedRoute: Access granted' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null},{"ruleId":"rendering children');  return <>{children}</>;};export default ProtectedRoute;","message":"Definition for rule 'rendering children');  return <>{children}</>;};export default ProtectedRoute;' was not found.","line":1,"column":1,"endLine":1,"endColumn":2831,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';import { Navigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { Loading } from '../../../shared/components/layout/Loading';import { useTranslation } from 'react-i18next';interface ProtectedRouteProps {  children: React.ReactNode;  requiredRole?: 'admin' | 'creator' | ('admin' | 'creator')[];}const ProtectedRoute: React.FC<ProtectedRouteProps> = ({   children,   requiredRole }) => {  const { t } = useTranslation();  const { user, isLoading } = useSelector((state: RootState) => state.auth);  console.log('üõ°Ô∏è ProtectedRoute check:', {    hasUser: !!user,    isLoading,    userRole: user?.role,    requiredRole,    userEmail: user?.email  });  if (isLoading) {    console.log('üõ°Ô∏è ProtectedRoute: Showing loading...');    return <Loading message=\"ƒêang x√°c th·ª±c...\" />;  }  if (!user) {    console.log('üõ°Ô∏è ProtectedRoute: No user, redirecting to login');    return <Navigate to=\"/login\" replace />;  }  if (requiredRole) {    const allowedRoles = Array.isArray(requiredRole) ? requiredRole : [requiredRole];    const hasRequiredRole = allowedRoles.includes(user.role as 'admin' | 'creator') || user.role === 'admin';        if (!hasRequiredRole) {      console.log('üõ°Ô∏è ProtectedRoute: Role mismatch, showing unauthorized');      return (        <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">          <div className=\"text-center\">            <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100\">              <svg className=\"h-6 w-6 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />              </svg>            </div>            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">{t(\"messages.unauthorized\")}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"mt-1 text-sm text-gray-500\">              B·∫°n c·∫ßn c√≥ vai tr√≤ Creator ho·∫∑c Admin ƒë·ªÉ truy c·∫≠p trang n√†y.            </p>            <div className=\"mt-6\">              <button                onClick={() => window.history.back()}                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700\"              >{t(\"common.back\")}              </button>            </div>          </div>        </div>      );    }  }  console.log('üõ°Ô∏è ProtectedRoute: Access granted, rendering children');  return <>{children}</>;};export default ProtectedRoute;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\components\\RoleSelection.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":8729,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { useDispatch } from 'react-redux';import { setRole } from '../../auth/store';import { AuthUser } from '../../auth/types';import { doc, setDoc } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import { toast } from 'react-toastify';interface RoleSelectionProps {  user: AuthUser;  onRoleSelected: (role: 'user' | 'creator') => void;}const RoleSelection: React.FC<RoleSelectionProps> = ({ user, onRoleSelected }) => {  const [selectedRole, setSelectedRole] = useState<'user' | 'creator' | null>(null);  const [isLoading, setIsLoading] = useState(false);  const dispatch = useDispatch();  const handleRoleSelection = async (role: 'user' | 'creator') => {    setIsLoading(true);        try {      // Th·ª≠ c·∫≠p nh·∫≠t Firestore tr∆∞·ªõc      const userDocRef = doc(db, 'users', user.uid);      await setDoc(userDocRef, {         role: role,        roleSelectedAt: new Date(),        needsRoleSelection: false, // Clear the flag        status: 'active',        email: user.email,        displayName: user.displayName,        updatedAt: new Date()      }, { merge: true });      // C·∫≠p nh·∫≠t Redux store      dispatch(setRole(role));      console.log('Role updated in Redux:', role);            // L∆∞u v√†o localStorage nh∆∞ backup      localStorage.setItem(`user_role_${user.uid}`, role);            // Call callback v·ªõi role ƒë·ªÉ parent c√≥ th·ªÉ navigate      toast.success(`Ch√†o m·ª´ng b·∫°n v·ªõi vai tr√≤ ${role === 'user' ? 'Ng∆∞·ªùi d√πng' : 'Ng∆∞·ªùi t·∫°o'}!`);            // G·ªçi callback ngay l·∫≠p t·ª©c, kh√¥ng delay      onRoleSelected(role);          } catch (error: any) {      console.error('Error updating user role:', error);            // N·∫øu Firestore fail, v·∫´n l∆∞u role v√†o localStorage v√† Redux      console.warn('Firestore update failed, using localStorage fallback');            // C·∫≠p nh·∫≠t Redux store      dispatch(setRole(role));      console.log('Role updated in Redux (fallback):', role);            // L∆∞u v√†o localStorage       localStorage.setItem(`user_role_${user.uid}`, role);            // Call callback v·ªõi role ƒë·ªÉ parent c√≥ th·ªÉ navigate      toast.success(`Ch√†o m·ª´ng b·∫°n v·ªõi vai tr√≤ ${role === 'user' ? 'Ng∆∞·ªùi d√πng' : 'Ng∆∞·ªùi t·∫°o'}!`);            // G·ªçi callback ngay l·∫≠p t·ª©c, kh√¥ng delay      onRoleSelected(role);            // Hi·ªÉn th·ªã th√¥ng b√°o nh·∫π nh√†ng      toast.info('Vai tr√≤ ƒë√£ ƒë∆∞·ª£c ch·ªçn. D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ƒë·ªìng b·ªô khi k·∫øt n·ªëi ·ªïn ƒë·ªãnh.');          } finally {      setIsLoading(false);    }  };  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">      <div className=\"bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl\">        <div className=\"text-center mb-6\">          <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4\">            <svg className=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />            </svg>          </div>          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Ch·ªçn vai tr√≤ c·ªßa b·∫°n</h2>          // eslint-disable-next-line i18next/no-literal-string          <p className=\"text-gray-600\">H√£y ch·ªçn vai tr√≤ ph√π h·ª£p ƒë·ªÉ b·∫Øt ƒë·∫ßu s·ª≠ d·ª•ng Quiz Trivia</p>        </div>        <div className=\"space-y-4\">          {/* User Role */}          <div             className={`p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 ${              selectedRole === 'user'                 ? 'border-blue-500 bg-blue-50'                 : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'            }`}            onClick={() => setSelectedRole('user')}          >            <div className=\"flex items-start space-x-3\">              <div className=\"flex-shrink-0\">                <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">                  <svg className=\"w-6 h-6 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />                  </svg>                </div>              </div>              <div className=\"flex-1\">                // eslint-disable-next-line i18next/no-literal-string                <h3 className=\"font-semibold text-gray-800 mb-1\">User (Ng∆∞·ªùi d√πng)</h3>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm text-gray-600\">                  Tham gia l√†m quiz, xem k·∫øt qu·∫£ v√† theo d√µi ti·∫øn ƒë·ªô h·ªçc t·∫≠p c·ªßa b·∫°n                </p>                <ul className=\"mt-2 text-xs text-gray-500 space-y-1\">                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ L√†m c√°c quiz c√≥ s·∫µn</li>                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ Xem l·ªãch s·ª≠ k·∫øt qu·∫£</li>                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ Theo d√µi ti·∫øn ƒë·ªô h·ªçc t·∫≠p</li>                </ul>              </div>            </div>          </div>          {/* Creator Role */}          <div             className={`p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 ${              selectedRole === 'creator'                 ? 'border-purple-500 bg-purple-50'                 : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'            }`}            onClick={() => setSelectedRole('creator')}          >            <div className=\"flex items-start space-x-3\">              <div className=\"flex-shrink-0\">                <div className=\"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center\">                  <svg className=\"w-6 h-6 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />                  </svg>                </div>              </div>              <div className=\"flex-1\">                // eslint-disable-next-line i18next/no-literal-string                <h3 className=\"font-semibold text-gray-800 mb-1\">Creator (Ng∆∞·ªùi t·∫°o)</h3>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm text-gray-600\">                  T·∫°o quiz cho c·ªông ƒë·ªìng, bao g·ªìm t·∫•t c·∫£ quy·ªÅn c·ªßa User                </p>                <ul className=\"mt-2 text-xs text-gray-500 space-y-1\">                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ T·∫•t c·∫£ quy·ªÅn c·ªßa User</li>                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ T·∫°o quiz m·ªõi</li>                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ Qu·∫£n l√Ω quiz ƒë√£ t·∫°o</li>                  // eslint-disable-next-line i18next/no-literal-string                  <li>‚Ä¢ Quiz c·∫ßn admin ph√™ duy·ªát</li>                </ul>              </div>            </div>          </div>        </div>        <div className=\"mt-6 flex space-x-3\">          <button            onClick={() => selectedRole && handleRoleSelection(selectedRole)}            disabled={!selectedRole || isLoading}            className={`flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 ${              selectedRole && !isLoading                ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700'                : 'bg-gray-200 text-gray-400 cursor-not-allowed'            }`}          >            {isLoading ? (              <div className=\"flex items-center justify-center\">                <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\"></div>                ƒêang thi·∫øt l·∫≠p vai tr√≤...              </div>            ) : (              'X√°c nh·∫≠n vai tr√≤'            )}          </button>        </div>        <div className=\"mt-4 text-center\">          // eslint-disable-next-line i18next/no-literal-string          <p className=\"text-xs text-gray-500\">            B·∫°n c√≥ th·ªÉ thay ƒë·ªïi vai tr√≤ sau trong ph·∫ßn c√†i ƒë·∫∑t t√†i kho·∫£n          </p>        </div>      </div>    </div>  );};export default RoleSelection;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\pages\\AuthPageNew.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3073,3076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3073,3076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4617,4620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4617,4620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6080,6083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6080,6083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6499,6502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6499,6502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":254,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":254,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7615,7618],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7615,7618],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { \r\n  createUserWithEmailAndPassword, \r\n  signInWithEmailAndPassword, \r\n  signInWithPopup,\r\n  GoogleAuthProvider,\r\n  User\r\n} from 'firebase/auth';\r\nimport { doc, setDoc, getDoc } from 'firebase/firestore';\r\nimport { auth, db } from '../../../lib/firebase/config';\r\nimport { toast } from 'react-toastify';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Eye, EyeOff, Mail, Lock, User as UserIcon, Chrome } from 'lucide-react';\r\nimport { ForgotPassword } from '../components/ForgotPassword';\r\nimport OTPVerification from '../components/OTPVerification';\r\nimport { generateAndSendOTP } from '../services/otpService';\r\n\r\ninterface FormData {\r\n  email: string;\r\n  password: string;\r\n  confirmPassword: string;\r\n  displayName: string;\r\n  acceptTerms: boolean;\r\n}\r\n\r\nconst AuthPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation();\r\n  const [isLogin, setIsLogin] = useState(true);\r\n  const [loading, setLoading] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n  const [showForgotPassword, setShowForgotPassword] = useState(false);\r\n  const [showOTPVerification, setShowOTPVerification] = useState(false);\r\n  const [pendingUserData, setPendingUserData] = useState<{\r\n    email: string;\r\n    password: string;\r\n    displayName: string;\r\n  } | null>(null);\r\n  const [formData, setFormData] = useState<FormData>({\r\n    email: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n    displayName: '',\r\n    acceptTerms: false\r\n  });\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value, type, checked } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: type === 'checkbox' ? checked : value\r\n    }));\r\n  };\r\n\r\n  const validateForm = (): boolean => {\r\n    if (!formData.email.trim()) {\r\n      toast.error(t('auth.validation.emailRequired'));\r\n      return false;\r\n    }\r\n\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(formData.email.trim())) {\r\n      toast.error(t('auth.validation.emailInvalid'));\r\n      return false;\r\n    }\r\n\r\n    if (!formData.password) {\r\n      toast.error(t('auth.validation.passwordRequired'));\r\n      return false;\r\n    }\r\n\r\n    if (!isLogin) {\r\n      if (!formData.displayName.trim()) {\r\n        toast.error(t('auth.validation.displayNameRequired'));\r\n        return false;\r\n      }\r\n\r\n      if (formData.password !== formData.confirmPassword) {\r\n        toast.error(t('auth.validation.passwordMismatch'));\r\n        return false;\r\n      }\r\n\r\n      if (formData.password.length < 6) {\r\n        toast.error(t('auth.validation.passwordTooShort'));\r\n        return false;\r\n      }\r\n\r\n      if (!formData.acceptTerms) {\r\n        toast.error(t('auth.validation.termsRequired'));\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const createUserDocument = async (user: User, additionalData: any = {}) => {\r\n    if (!user) return;\r\n\r\n    const userDocRef = doc(db, 'users', user.uid);\r\n    const userSnapshot = await getDoc(userDocRef);\r\n\r\n    if (!userSnapshot.exists()) {\r\n      await setDoc(userDocRef, {\r\n        uid: user.uid,\r\n        email: user.email,\r\n        role: 'user',\r\n        createdAt: new Date(),\r\n        isActive: true,\r\n        emailVerified: true, // OTP ƒë√£ verify r·ªìi\r\n        needsRoleSelection: true,\r\n        ...additionalData\r\n      });\r\n    }\r\n  };\r\n\r\n  // Complete registration sau khi OTP verify th√†nh c√¥ng\r\n  const completeRegistrationAfterOTP = async () => {\r\n    if (!pendingUserData) {\r\n      toast.error(t('auth.errors.pendingRegistrationNotFound'));\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // T·∫°o Firebase account\r\n      const userCredential = await createUserWithEmailAndPassword(\r\n        auth,\r\n        pendingUserData.email,\r\n        pendingUserData.password\r\n      );\r\n\r\n      // T·∫°o user document\r\n      await createUserDocument(userCredential.user, {\r\n        displayName: pendingUserData.displayName,\r\n        verificationMethod: 'otp'\r\n      });\r\n\r\n      toast.success(t('auth.registerSuccess'));\r\n      \r\n      // Reset states\r\n      setFormData({ \r\n        email: '', \r\n        password: '', \r\n        confirmPassword: '', \r\n        displayName: '', \r\n        acceptTerms: false \r\n      });\r\n      setPendingUserData(null);\r\n      setShowOTPVerification(false);\r\n      \r\n      // Navigate to role selection\r\n      navigate('/role-selection');\r\n    } catch (error: any) {\r\n      console.error('Registration error:', error);\r\n      switch (error.code) {\r\n        case 'auth/email-already-in-use':\r\n          toast.error(t('auth.errors.emailAlreadyInUse'));\r\n          break;\r\n        case 'auth/weak-password':\r\n          toast.error(t('auth.errors.weakPassword'));\r\n          break;\r\n        case 'auth/invalid-email':\r\n          toast.error(t('auth.errors.invalidEmail'));\r\n          break;\r\n        default:\r\n          toast.error(t('auth.errors.registerError'));\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRegister = async () => {\r\n    if (!validateForm()) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      // G·ª≠i OTP tr∆∞·ªõc\r\n      const normalizedEmail = formData.email.trim().toLowerCase();\r\n      const result = await generateAndSendOTP(normalizedEmail);\r\n      \r\n      if (result.success) {\r\n        // L∆∞u data t·∫°m\r\n        setPendingUserData({\r\n          email: normalizedEmail,\r\n          password: formData.password,\r\n          displayName: formData.displayName.trim()\r\n        });\r\n        \r\n        // Hi·ªán m√†n h√¨nh nh·∫≠p OTP\r\n        setShowOTPVerification(true);\r\n        toast.success(t('auth.otp.sent', { email: normalizedEmail }));\r\n      } else {\r\n        const errorKey =\r\n          result.code === 'otp.emailFailed'\r\n            ? 'auth.otp.errors.emailFailed'\r\n            : 'auth.errors.genericError';\r\n        toast.error(t(errorKey));\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Registration error:', error);\r\n      toast.error(t('auth.errors.genericError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleGoogleLogin = async () => {\r\n    try {\r\n      const provider = new GoogleAuthProvider();\r\n      await signInWithPopup(auth, provider);\r\n      // toast.success(t('auth.loginSuccess'));\r\n      navigate('/dashboard');\r\n    } catch (error: any) {\r\n      console.error('Google login error:', error);\r\n      toast.error(t('auth.errors.googleLoginError'));\r\n    }\r\n  };\r\n\r\n  const handleLogin = async () => {\r\n    if (!validateForm()) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const userCredential = await signInWithEmailAndPassword(\r\n        auth, \r\n        formData.email.trim().toLowerCase(),\r\n        formData.password\r\n      );\r\n\r\n      const userDocRef = doc(db, 'users', userCredential.user.uid);\r\n      const userDoc = await getDoc(userDocRef);\r\n      let redirectPath = '/dashboard';\r\n\r\n      if (userDoc.exists()) {\r\n        const userData = userDoc.data();\r\n        const userRole = userData.role;\r\n        switch (userRole) {\r\n          case 'admin':\r\n          case 'creator':\r\n          case 'user':\r\n          default:\r\n            redirectPath = '/dashboard';\r\n            break;\r\n        }\r\n        await setDoc(userDocRef, { lastLoginAt: new Date(), emailVerified: userCredential.user.emailVerified }, { merge: true });\r\n      }\r\n\r\n      // toast.success(t('auth.loginSuccess'));\r\n      navigate(redirectPath);\r\n    } catch (error: any) {\r\n      console.error('‚ùå Login error:', error.code, error.message);\r\n      switch (error.code) {\r\n        case 'auth/user-not-found':\r\n          toast.error(t('auth.errors.userNotFound'));\r\n          break;\r\n        case 'auth/wrong-password':\r\n          toast.error(t('auth.errors.wrongPassword'));\r\n          break;\r\n        case 'auth/invalid-credential':\r\n          toast.error(t('auth.errors.invalidCredential'));\r\n          break;\r\n        case 'auth/invalid-email':\r\n          toast.error(t('auth.errors.invalidEmail'));\r\n          break;\r\n        case 'auth/user-disabled':\r\n          toast.error(t('auth.errors.userDisabled'));\r\n          break;\r\n        case 'auth/too-many-requests':\r\n          toast.error(t('auth.errors.tooManyRequests'));\r\n          break;\r\n        default:\r\n          toast.error(t('auth.errors.loginError'));\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleShowForgotPassword = () => setShowForgotPassword(true);\r\n  const handleCloseForgotPassword = () => setShowForgotPassword(false);\r\n  const handleCloseOTP = () => {\r\n    setShowOTPVerification(false);\r\n    setPendingUserData(null);\r\n  };\r\n\r\n  // Show OTP verification screen\r\n  if (showOTPVerification && pendingUserData) {\r\n    return (\r\n      <OTPVerification\r\n        email={pendingUserData.email}\r\n        onVerificationSuccess={completeRegistrationAfterOTP}\r\n        onCancel={handleCloseOTP}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (showForgotPassword) {\r\n    return <ForgotPassword onBack={handleCloseForgotPassword} />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"mt-2 text-3xl font-extrabold text-gray-900\">\r\n            {isLogin ? t('auth.login') : t('auth.register')}\r\n          </h2>\r\n          <p className=\"mt-2 text-sm text-gray-600\">\r\n            {isLogin ? t('auth.welcomeBack') : t('auth.createNewAccount')}\r\n          </p>\r\n        </div>\r\n\r\n        <form className=\"space-y-6\" onSubmit={(e) => e.preventDefault()}>\r\n          {/* Email Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              {t('auth.email')}\r\n            </label>\r\n            <div className=\"relative\">\r\n              <Mail className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n              <input\r\n                type=\"email\"\r\n                name=\"email\"\r\n                value={formData.email}\r\n                onChange={handleInputChange}\r\n                className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                placeholder={t('auth.emailPlaceholder')}\r\n                required\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Display Name - Only for register */}\r\n          {!isLogin && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                {t('auth.displayName')}\r\n              </label>\r\n              <div className=\"relative\">\r\n                <UserIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"displayName\"\r\n                  value={formData.displayName}\r\n                  onChange={handleInputChange}\r\n                  className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  placeholder={t('auth.displayNamePlaceholder')}\r\n                  required={!isLogin}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Password Field */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              {t('auth.password')}\r\n            </label>\r\n            <div className=\"relative\">\r\n              <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n              <input\r\n                type={showPassword ? \"text\" : \"password\"}\r\n                name=\"password\"\r\n                value={formData.password}\r\n                onChange={handleInputChange}\r\n                className=\"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                placeholder={t('auth.passwordPlaceholder')}\r\n                required\r\n              />\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowPassword(!showPassword)}\r\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n              >\r\n                {showPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Confirm Password - Only for register */}\r\n          {!isLogin && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                {t('auth.confirmPassword')}\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n                <input\r\n                  type={showConfirmPassword ? \"text\" : \"password\"}\r\n                  name=\"confirmPassword\"\r\n                  value={formData.confirmPassword}\r\n                  onChange={handleInputChange}\r\n                  className=\"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  placeholder={t('auth.confirmPasswordPlaceholder')}\r\n                  required={!isLogin}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  {showConfirmPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Terms & Conditions - Only for register */}\r\n          {!isLogin && (\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                name=\"acceptTerms\"\r\n                checked={formData.acceptTerms}\r\n                onChange={handleInputChange}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                required={!isLogin}\r\n              />\r\n              <label className=\"ml-2 text-sm text-gray-600\">\r\n                {t('auth.agreeToTerms')}{' '}\r\n                <a href=\"#\" className=\"text-blue-600 hover:text-blue-500\">\r\n                  {t('auth.termsOfService')}\r\n                </a>\r\n              </label>\r\n            </div>\r\n          )}\r\n\r\n          {/* Submit Button */}\r\n          <button\r\n            type=\"button\"\r\n            onClick={isLogin ? handleLogin : handleRegister}\r\n            disabled={loading}\r\n            className=\"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium\"\r\n          >\r\n            {loading ? t('loading') : (isLogin ? t('auth.login') : t('auth.register'))}\r\n          </button>\r\n\r\n          {/* Forgot Password Link - Only show for login */}\r\n          {isLogin && (\r\n            <div className=\"text-center mt-4\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"text-sm text-blue-600 hover:underline\"\r\n                onClick={handleShowForgotPassword}\r\n              >\r\n                {t('auth.forgotPassword')}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Google Login */}\r\n          <div className=\"relative\">\r\n            <div className=\"absolute inset-0 flex items-center\">\r\n              <div className=\"w-full border-t border-gray-300\" />\r\n            </div>\r\n            <div className=\"relative flex justify-center text-sm\">\r\n              <span className=\"px-2 bg-white text-gray-500\">{t('or')}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleGoogleLogin}\r\n            disabled={loading}\r\n            className=\"w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2\"\r\n          >\r\n            <Chrome className=\"w-5 h-5\" />\r\n            {t('auth.loginWithGoogle')}\r\n          </button>\r\n\r\n          {/* Switch between login/register */}\r\n          <div className=\"text-center\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setIsLogin(!isLogin);\r\n                setFormData({\r\n                  email: '',\r\n                  password: '',\r\n                  confirmPassword: '',\r\n                  displayName: '',\r\n                  acceptTerms: false\r\n                });\r\n              }}\r\n              className=\"text-blue-600 hover:text-blue-500 font-medium\"\r\n            >\r\n              {isLogin \r\n                ? t('auth.noAccount')\r\n                : t('auth.hasAccount')\r\n              }\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuthPage;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\pages\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\pages\\Profile.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":33015,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useEffect, useState } from 'react';import { useSelector, useDispatch } from 'react-redux';import { useTranslation } from 'react-i18next';import { RootState } from '../../../lib/store';import { QuizResult } from '../../quiz/types';import { Link } from 'react-router-dom';import { fetchUserQuizResults } from '../../quiz/store';import { updateProfile, updatePassword, reauthenticateWithCredential, EmailAuthProvider } from 'firebase/auth';import { auth } from '../../../lib/firebase/config';import { toast } from 'react-toastify';import { getQuizById } from '../../quiz/api';import {   User,   Trophy,   Clock,   Target,   TrendingUp,   Calendar,  Star,  ChevronRight,  Search,  ArrowUp,  ArrowDown,  Eye,  Edit3,  RotateCcw} from 'lucide-react';import ImageUploader from '../../../components/ImageUploader';import { ImageUploadResult } from '../../../services/imageUploadService';const Profile: React.FC = () => {  const { t, i18n } = useTranslation();  const { user } = useSelector((state: RootState) => state.auth);  const userResults = useSelector((state: RootState) => state.quiz.userResults);  const dispatch = useDispatch();    // State management  const [results, setResults] = useState<QuizResult[]>([]);  const [quizTitles, setQuizTitles] = useState<{[key: string]: string}>({});  // const [loading, setLoading] = useState(true);  const [stats, setStats] = useState<any>(null);  const [tab, setTab] = useState<'overview' | 'history' | 'achievements' | 'settings'>('overview');    // Profile edit states  const [displayName, setDisplayName] = useState(user?.displayName || '');  const [currentPassword, setCurrentPassword] = useState(''); // M·∫≠t kh·∫©u c≈©  const [newPassword, setNewPassword] = useState('');  const [confirmPassword, setConfirmPassword] = useState('');  const [avatarUrl, setAvatarUrl] = useState(user?.photoURL || '');  const [saving, setSaving] = useState(false);    // Enhanced pagination and filtering  const [itemsPerPage, setItemsPerPage] = useState(10);  const [currentPage, ] = useState(1);  const [showAll, setShowAll] = useState(false);  const [sortBy, setSortBy] = useState<'date' | 'score' | 'percentage'>('date');  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');  const [searchTerm, setSearchTerm] = useState('');  const [filterByScore, setFilterByScore] = useState<'all' | 'high' | 'medium' | 'low'>('all');  // Load user data  useEffect(() => {    if (!user) return;    // setLoading(true);    dispatch(fetchUserQuizResults(user.uid) as any);  }, [user, dispatch]);  // Process results and calculate stats  useEffect(() => {    if (!user) return;        const loadQuizTitles = async () => {      const titles: {[key: string]: string} = {};            // Load quiz titles for all results      for (const result of userResults) {        if (!titles[result.quizId]) {          try {            const quiz = await getQuizById(result.quizId);            titles[result.quizId] = quiz?.title || t('quiz.untitled');          } catch (error) {            console.error('Error fetching quiz:', error);            titles[result.quizId] = t('quiz.untitled');          }        }      }            setQuizTitles(titles);      setResults(userResults);    };        if (userResults.length > 0) {      loadQuizTitles();    } else {      setResults([]);      setQuizTitles({});    }        if (userResults.length > 0) {}        // Calculate comprehensive stats with more accurate scoring    const totalQuizzes = userResults.length;        // Calculate scores more accurately - prioritize correctAnswers/totalQuestions    const accurateScores = userResults.map(r => {      // Always prioritize correctAnswers/totalQuestions if available      if (typeof r.correctAnswers === 'number' && typeof r.totalQuestions === 'number' && r.totalQuestions > 0) {        return Math.round((r.correctAnswers / r.totalQuestions) * 100);      }       // Fallback to score field if it exists and is valid      else if (typeof r.score === 'number' && !isNaN(r.score)) {        return r.score <= 1 ? Math.round(r.score * 100) : Math.round(r.score);      }      // Last resort: 0      return 0;    });        const totalScore = accurateScores.reduce((sum, score) => sum + score, 0);    const totalCorrect = userResults.reduce((sum, r) => sum + (r.correctAnswers || 0), 0);    const totalQuestions = userResults.reduce((sum, r) => sum + (r.totalQuestions || 0), 0);    const totalTime = userResults.reduce((sum, r) => sum + (r.timeSpent || 0), 0);        const averageScore = totalQuizzes > 0 ? totalScore / totalQuizzes : 0;    const accuracy = totalQuestions > 0 ? (totalCorrect / totalQuestions) * 100 : 0;    const averageTime = totalQuizzes > 0 ? totalTime / totalQuizzes : 0;        // Performance grades - use accurate scores    const perfectScores = accurateScores.filter(score => score >= 100).length;    const highScores = accurateScores.filter(score => score >= 80).length;        console.log('üìä Calculated Stats:', {      totalQuizzes,      averageScore: averageScore.toFixed(1),      accuracy: accuracy.toFixed(1),      perfectScores,      highScores,      accurateScores: accurateScores.slice(0, 3) // Show first 3 for debugging    });        setStats({      totalQuizzes,      totalScore,      averageScore,      accuracy,      averageTime,      perfectScores,      highScores,      recentActivity: userResults.slice(0, 5)    });        // setLoading(false);  }, [userResults, user, t]);  // Filter and sort results  const filteredResults = results    .filter(result => {      // Search filter      if (searchTerm) {        const quizTitle = quizTitles[result.quizId] || t('quiz.untitled');        return quizTitle.toLowerCase().includes(searchTerm.toLowerCase());      }      return true;    })    .filter(result => {      // Score filter with guard      const percentage = result.totalQuestions > 0 ? (result.correctAnswers / result.totalQuestions) * 100 : 0;      switch (filterByScore) {        case 'high': return percentage >= 80;        case 'medium': return percentage >= 60 && percentage < 80;        case 'low': return percentage < 60;        default: return true;      }    })    .sort((a, b) => {      let comparison = 0;      const percentageA = a.totalQuestions > 0 ? (a.correctAnswers / a.totalQuestions) * 100 : 0;      const percentageB = b.totalQuestions > 0 ? (b.correctAnswers / b.totalQuestions) * 100 : 0;      switch (sortBy) {        case 'date':          comparison = new Date(b.completedAt).getTime() - new Date(a.completedAt).getTime();          break;        case 'score':          comparison = percentageB - percentageA; // Sort by percentage for score          break;        case 'percentage':          comparison = percentageB - percentageA;          break;        default:          comparison = 0;      }      return sortOrder === 'asc' ? -comparison : comparison;    });  // Pagination  // const totalPages = Math.ceil(filteredResults.length / itemsPerPage);  const startIndex = (currentPage - 1) * itemsPerPage;  const paginatedResults = showAll ? filteredResults : filteredResults.slice(startIndex, startIndex + itemsPerPage);  const handleProfileUpdate = async () => {    if (!user || !auth.currentUser) return;        setSaving(true);    try {      await updateProfile(auth.currentUser, {        displayName: displayName,        photoURL: avatarUrl      });      toast.success(t('profile.profileUpdateSuccess'));    } catch (error) {      console.error('Error updating profile:', error);      toast.error(t('profile.profileUpdateError'));    } finally {      setSaving(false);    }  };  const handlePasswordUpdate = async () => {    if (!auth.currentUser || !currentPassword || !newPassword || !confirmPassword) {      toast.error(t('profile.fillAllFields'));      return;    }    if (newPassword !== confirmPassword) {      toast.error(t('profile.passwordMismatch'));      return;    }    if (newPassword.length < 6) {      toast.error(t('profile.passwordTooShort'));      return;    }    if (newPassword === currentPassword) {      toast.error(t('profile.passwordMustDiffer'));      return;    }    if (!auth.currentUser.email) {      toast.error(t('profile.emailNotFound'));      return;    }        setSaving(true);    try {      // T·∫°o credential ƒë·ªÉ reauthenticate      const credential = EmailAuthProvider.credential(auth.currentUser.email, currentPassword);            // X√ÅC TH·ª∞C L·∫†I NG∆Ø·ªúI D√ôNG TR∆Ø·ªöC KHI ƒê·ªîI M·∫¨T KH·∫®U      await reauthenticateWithCredential(auth.currentUser, credential);            // N·∫øu x√°c th·ª±c th√†nh c√¥ng, ƒë·ªïi m·∫≠t kh·∫©u m·ªõi      await updatePassword(auth.currentUser, newPassword);            // Reset form      setCurrentPassword('');      setNewPassword('');      setConfirmPassword('');      toast.success(t('profile.passwordChangeSuccess'));    } catch (error: any) {      console.error('Error updating password:', error);      if (error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {        toast.error(t('profile.wrongPassword'));      } else if (error.code === 'auth/weak-password') {        toast.error(t('profile.weakPassword'));      } else if (error.code === 'auth/requires-recent-login') {        toast.error(t('profile.requiresRecentLogin'));      } else {        toast.error(t('profile.passwordChangeError', {message: error.message}));      }    } finally {      setSaving(false);    }  };  const renderStatCard = (icon: React.ReactNode, title: string, value: string | number, subtitle?: string, color: string = 'bg-blue-500') => (    <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow\">      <div className=\"flex items-center justify-between\">        <div className=\"flex items-center space-x-4\">          <div className={`p-3 rounded-full ${color}`}>            {icon}          </div>          <div>            <p className=\"text-2xl font-bold text-gray-900\">{value}</p>            <p className=\"text-sm text-gray-600\">{title}</p>            {subtitle && <p className=\"text-xs text-gray-500\">{subtitle}</p>}          </div>        </div>      </div>    </div>  );  const renderQuizHistoryItem = (result: QuizResult) => {    console.log('üîç Rendering quiz result (RAW DATA):', {      id: result.id,      correctAnswers: result.correctAnswers,      totalQuestions: result.totalQuestions,      score: result.score,      quizId: result.quizId,      rawResult: result    });        // Calculate percentage using consistent logic    let percentage = 0;    let calculationMethod = 'none';        // Primary: Use correctAnswers/totalQuestions if available    if (typeof result.correctAnswers === 'number' && typeof result.totalQuestions === 'number' && result.totalQuestions > 0) {      percentage = Math.round((result.correctAnswers / result.totalQuestions) * 100);      calculationMethod = 'answers_calculation';    }     // Fallback: Use score field    else if (typeof result.score === 'number' && !isNaN(result.score)) {      percentage = result.score <= 1 ? Math.round(result.score * 100) : Math.round(result.score);      calculationMethod = result.score <= 1 ? 'score_decimal' : 'score_percentage';    }     // Last resort: 0    else {      console.warn('‚ö†Ô∏è No valid score data found for result:', result.id);      calculationMethod = 'fallback_zero';      percentage = 0;    }        console.log('üíØ Score calculation result:', {      method: calculationMethod,      finalPercentage: percentage,      rawScore: result.score,      correctAnswers: result.correctAnswers,      totalQuestions: result.totalQuestions    });        const getScoreColor = (percent: number) => {      if (percent >= 90) return 'text-green-600 bg-green-50';      if (percent >= 70) return 'text-blue-600 bg-blue-50';      if (percent >= 50) return 'text-yellow-600 bg-yellow-50';      return 'text-red-600 bg-red-50';    };    return (      <div key={result.id} className=\"bg-white rounded-lg border border-gray-100 p-4 hover:shadow-md transition-shadow\">        <div className=\"flex items-center justify-between\">          <div className=\"flex-1\">            <h4 className=\"font-semibold text-gray-900 mb-1\">{quizTitles[result.quizId] || t('quiz.untitled')}</h4>            <div className=\"flex items-center space-x-4 text-sm text-gray-600\">              <span className=\"flex items-center space-x-1\">                <Target className=\"w-4 h-4\" />                <span>{result.correctAnswers}/{result.totalQuestions}</span>              </span>              <span className=\"flex items-center space-x-1\">                <Clock className=\"w-4 h-4\" />                <span>{Math.round((result.timeSpent || 0) / 60)} {t('minutes')}</span>              </span>              <span className=\"flex items-center space-x-1\">                <Calendar className=\"w-4 h-4\" />                <span>{new Date(result.completedAt).toLocaleDateString(i18n.language)}</span>              </span>            </div>          </div>                    <div className=\"flex items-center space-x-3\">            <div className={`px-3 py-1 rounded-full text-sm font-medium ${getScoreColor(percentage)}`}>              {percentage}%            </div>            <Link              to={`/quiz/${result.quizId}/reviews`}              className=\"p-2 text-gray-400 hover:text-purple-600 transition-colors\"              title={t('profile.viewAgain')}            >              <RotateCcw className=\"w-4 h-4\" />            </Link>            <Link              to={`/quiz-result/${result.id}`}              className=\"p-2 text-gray-400 hover:text-blue-600 transition-colors\"              title={t('profile.viewDetails')}            >              <Eye className=\"w-4 h-4\" />            </Link>          </div>        </div>      </div>    );  };  if (!user) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          <p className=\"text-gray-600\">{t('profile.loginRequired')}</p>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50\">      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        {/* Header */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">          <div className=\"flex items-center space-x-6\">            <div className=\"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center\">              {user.photoURL ? (                <img src={user.photoURL} alt=\"Avatar\" className=\"w-full h-full rounded-full object-cover\" />              ) : (                <User className=\"w-10 h-10 text-white\" />              )}            </div>            <div className=\"flex-1\">              <h1 className=\"text-2xl font-bold text-gray-900\">{user.displayName || user.email}</h1>              <p className=\"text-gray-600\">{user.email}</p>              <p className=\"text-sm text-gray-500 mt-1\">{t('profile.memberSince')} {new Date().toLocaleDateString(i18n.language)}</p>            </div>            <button              onClick={() => setTab('settings')}              className=\"p-2 text-gray-400 hover:text-blue-600 transition-colors\"            >              <Edit3 className=\"w-5 h-5\" />            </button>          </div>        </div>        {/* Navigation Tabs */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 mb-8\">          <div className=\"flex space-x-8 px-6\">            {[              { id: 'overview', label: t('profile.tabs.overview'), icon: TrendingUp },              { id: 'history', label: t('profile.tabs.history'), icon: Clock },              { id: 'achievements', label: t('profile.tabs.achievements'), icon: Trophy },              { id: 'settings', label: t('profile.tabs.settings'), icon: User }            ].map(({ id, label, icon: Icon }) => (              <button                key={id}                onClick={() => setTab(id as any)}                className={`flex items-center space-x-2 py-4 border-b-2 transition-colors ${                  tab === id                     ? 'border-blue-500 text-blue-600'                     : 'border-transparent text-gray-600 hover:text-gray-900'                }`}              >                <Icon className=\"w-4 h-4\" />                <span>{label}</span>              </button>            ))}          </div>        </div>        {/* Tab Content */}        {tab === 'overview' && stats && (          <div>            {/* Stats Grid */}            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">              {renderStatCard(                <Trophy className=\"w-6 h-6 text-white\" />,                t('profile.stats.completedQuizzes'),                stats.totalQuizzes,                undefined,                'bg-yellow-500'              )}              {renderStatCard(                <Star className=\"w-6 h-6 text-white\" />,                t('profile.stats.averageScore'),                stats.averageScore.toFixed(1),                t('profile.stats.onTotal'),                'bg-blue-500'              )}              {renderStatCard(                <Target className=\"w-6 h-6 text-white\" />,                t('profile.stats.accuracy'),                `${stats.accuracy.toFixed(1)}%`,                t('profile.stats.correctRate'),                'bg-green-500'              )}              {renderStatCard(                <TrendingUp className=\"w-6 h-6 text-white\" />,                t('profile.stats.highScores'),                `${stats.highScores}/${stats.totalQuizzes}`,                t('profile.stats.over80'),                'bg-purple-500'              )}            </div>            {/* Recent Activity */}            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">{t('profile.recentActivity')}</h3>              <div className=\"space-y-4\">                {stats.recentActivity.map((result: QuizResult) => renderQuizHistoryItem(result))}              </div>              {stats.totalQuizzes > 5 && (                <div className=\"mt-6 text-center\">                  <button                    onClick={() => setTab('history')}                    className=\"text-blue-600 hover:text-blue-700 font-medium flex items-center space-x-1 mx-auto\"                  >                    <span>{t('profile.viewAllHistory')}</span>                    <ChevronRight className=\"w-4 h-4\" />                  </button>                </div>              )}            </div>          </div>        )}        {tab === 'history' && (          <div>            {/* Filters and Search */}            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6\">              <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0\">                <div className=\"flex items-center space-x-4\">                  <div className=\"relative\">                    <Search className=\"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />                    <input                      type=\"text\"                      placeholder={t('profile.searchPlaceholder')}                      value={searchTerm}                      onChange={(e) => setSearchTerm(e.target.value)}                      className=\"pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                    />                  </div>                                    <select                    value={filterByScore}                    onChange={(e) => setFilterByScore(e.target.value as any)}                    className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                  >                    <option value=\"all\">{t('profile.filters.score.all')}</option>                    <option value=\"high\">{t('profile.filters.score.high')}</option>                    <option value=\"medium\">{t('profile.filters.score.medium')}</option>                    <option value=\"low\">{t('profile.filters.score.low')}</option>                  </select>                </div>                <div className=\"flex items-center space-x-4\">                  <div className=\"flex items-center space-x-2\">                    <span className=\"text-sm text-gray-600\">{t('profile.sort.label')}:</span>                    <select                      value={sortBy}                      onChange={(e) => setSortBy(e.target.value as any)}                      className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500\"                    >                      <option value=\"date\">{t('profile.sort.date')}</option>                      <option value=\"score\">{t('profile.sort.score')}</option>                      <option value=\"percentage\">{t('profile.sort.percentage')}</option>                    </select>                    <button                      onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}                      className=\"p-1 text-gray-400 hover:text-gray-600\"                    >                      {sortOrder === 'asc' ? <ArrowUp className=\"w-4 h-4\" /> : <ArrowDown className=\"w-4 h-4\" />}                    </button>                  </div>                  <select                    value={itemsPerPage}                    onChange={(e) => setItemsPerPage(Number(e.target.value))}                    className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500\"                  >                    <option value={10}>{t('profile.pagination.perPage10')}</option>                    <option value={25}>{t('profile.pagination.perPage25')}</option>                    <option value={50}>{t('profile.pagination.perPage50')}</option>                    <option value={100}>{t('profile.pagination.perPage100')}</option>                  </select>                  {filteredResults.length > itemsPerPage && (                    <button                      onClick={() => setShowAll(!showAll)}                      className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"                    >                      {showAll ? t('profile.pagination.paginate') : t('profile.viewAllCount')}                    </button>                  )}                </div>              </div>            </div>            <div className=\"space-y-4\">              {paginatedResults.length > 0 ? (                paginatedResults.map(result => renderQuizHistoryItem(result))              ) : (                  <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center\">                    <Trophy className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />                    <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{t('profile.noResults')}</h3>                    <p className=\"text-gray-600 mb-4\">{t('profile.noResultsDesc')}</p>                    <Link                      to=\"/quizzes\"                      className=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"                    >                      {t('quiz.exploreQuizzes')}                    </Link>                  </div>                )}            </div>                        {/* Pagination */}            {!showAll && filteredResults.length > itemsPerPage && (              <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4\">                <div className=\"flex items-center justify-between\">                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-sm text-gray-600\">                    Showing results                  </p>                  <div className=\"flex items-center space-x-2\">                    // eslint-disable-next-line i18next/no-literal-string                    <button className=\"px-3 py-1 border border-gray-300 rounded text-sm\">                      Previous                    </button>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"px-3 py-1 text-sm text-gray-600\">                      Page info                    </span>                  </div>                </div>              </div>            )}        </div>        )}        {tab === 'achievements' && (            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">{t('profile.achievements')}</h3>              <div className=\"text-center py-8\">                <Trophy className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />                <h4 className=\"text-lg font-medium text-gray-900 mb-2\">{t('profile.achievementSystem')}</h4>                <p className=\"text-gray-600\">{t('profile.inDevelopment')}</p>              </div>            </div>        )}        {tab === 'settings' && (          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">            {/* Profile Settings */}            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">{t('profile.settings.title')}</h3>              <div className=\"space-y-4\">                <div>                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">{t('auth.displayName')}</label>                  <input                    type=\"text\"                    value={displayName}                    onChange={(e) => setDisplayName(e.target.value)}                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                  />                </div>                <div>                  // eslint-disable-next-line i18next/no-literal-string                  <label className=\"block text-sm font-medium text-gray-700 mb-3\">Avatar</label>                                    {/* Current Avatar Preview */}                  {avatarUrl && (                    <div className=\"mb-4 flex items-center gap-4\">                      <img                         src={avatarUrl}                         alt=\"Current Avatar\"                         className=\"w-20 h-20 rounded-full object-cover border-2 border-gray-200\"                      />                      <div className=\"text-sm text-gray-600\">                        // eslint-disable-next-line i18next/no-literal-string                        <p className=\"font-medium\">Avatar hi·ªán t·∫°i</p>                        <button                          onClick={() => setAvatarUrl('')}                          className=\"text-red-600 hover:text-red-700 text-xs mt-1\"                        // eslint-disable-next-line i18next/no-literal-string                        >                          X√≥a avatar                        </button>                      </div>                    </div>                  )}                  {/* Image Uploader Component */}                  <ImageUploader                    onUploadSuccess={(result: ImageUploadResult) => {                      if (result.originalUrl) {                        setAvatarUrl(result.originalUrl);                        toast.success('Upload avatar th√†nh c√¥ng! Nh·∫•n \"C·∫≠p nh·∫≠t th√¥ng tin\" ƒë·ªÉ l∆∞u.');                      }                    }}                    onUploadError={(error) => {                      toast.error('L·ªói upload avatar: ' + error);                    }}                    options={{                      folder: 'avatars',                      maxSizeKB: 2048,                      allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],                      generateThumbnails: true                    }}                    previewUrl={avatarUrl}                    label=\"\"                    showThumbnails={true}                    compressBeforeUpload={true}                    className=\"mb-4\"                  />                  {/* Fallback: Nh·∫≠p URL th·ªß c√¥ng */}                  <details className=\"mt-2\">                    // eslint-disable-next-line i18next/no-literal-string                    <summary className=\"text-xs text-gray-500 cursor-pointer hover:text-gray-700\">                      Ho·∫∑c nh·∫≠p URL avatar th·ªß c√¥ng                    </summary>                    <input                      type=\"url\"                      value={avatarUrl}                      onChange={(e) => setAvatarUrl(e.target.value)}                      className=\"w-full mt-2 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                      placeholder={t('placeholders.avatarUrl')}                    />                  </details>                </div>                <button                  onClick={handleProfileUpdate}                  disabled={saving}                  className=\"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors\"                >                  {saving ? t('profile.updating') : t('profile.updateProfile')}                </button>              </div>            </div>            {/* Password Settings */}            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">{t('profile.changePassword')}</h3>              <div className=\"space-y-4\">                <div>                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">{t('profile.currentPassword')}</label>                  <input                    type=\"password\"                    value={currentPassword}                    onChange={(e) => setCurrentPassword(e.target.value)}                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                    placeholder={t('profile.currentPasswordRequired')}                  />                </div>                <div>                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">{t('profile.newPassword')}</label>                  <input                    type=\"password\"                    value={newPassword}                    onChange={(e) => setNewPassword(e.target.value)}                    className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${                      newPassword && newPassword.length < 6 ? 'border-red-300' : 'border-gray-300'                    }`}                    placeholder={t('profile.passwordTooShort')}                  />                  {newPassword && newPassword.length < 6 && (                    <p className=\"text-xs text-red-500 mt-1\">{t('profile.passwordTooShort')}</p>                  )}                </div>                <div>                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">{t('profile.confirmNewPassword')}</label>                  <input                    type=\"password\"                    value={confirmPassword}                    onChange={(e) => setConfirmPassword(e.target.value)}                    className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${                      confirmPassword && newPassword !== confirmPassword ? 'border-red-300' : 'border-gray-300'                    }`}                    placeholder={t('profile.passwordMismatch')}                  />                  {confirmPassword && newPassword !== confirmPassword && (                    <p className=\"text-xs text-red-500 mt-1\">{t('profile.passwordMismatch')}</p>                  )}                </div>                <button                  onClick={handlePasswordUpdate}                  disabled={                    saving ||                     !currentPassword ||                     !newPassword ||                     !confirmPassword ||                    newPassword.length < 6 ||                    newPassword !== confirmPassword ||                    newPassword === currentPassword                  }                  className=\"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors\"                >                  {saving ? t('profile.authenticating') : t('profile.changePassword')}                </button>                  <div className=\"text-xs text-gray-500 space-y-1\">                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚ö†Ô∏è {t('profile.currentPasswordRequired')}</p>                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚úì {t('profile.passwordMinLength')}</p>                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚úì {t('profile.passwordMustDiffer')}</p>                  </div>              </div>            </div>          </div>        )}      </div>    </div>  );}export default Profile;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\services\\authService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\services\\otpService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5372,5375],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5372,5375],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":192,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":192,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6459,6462],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6459,6462],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import CryptoJS from 'crypto-js';\r\nimport { getFirestore, collection, addDoc } from 'firebase/firestore';\r\n\r\n// Initialize Firestore\r\nconst db = getFirestore();\r\n\r\n// Secret key ƒë·ªÉ hash OTP (trong production n√™n l∆∞u trong env)\r\nconst OTP_SECRET = import.meta.env.VITE_OTP_SECRET || 'quiz-app-otp-secret-2025';\r\nconst OTP_EXPIRY_MINUTES = 10;\r\n\r\ntype OTPMetadata = Record<string, unknown> & {\r\n  remaining?: number;\r\n};\r\n\r\nexport interface OTPData {\r\n  email: string;\r\n  hashedOTP: string;\r\n  expiresAt: number;\r\n  attempts: number;\r\n  maxAttempts: number;\r\n}\r\n\r\n/**\r\n * Generate random 6-digit OTP\r\n */\r\nexport const generateOTP = (): string => {\r\n  return Math.floor(100000 + Math.random() * 900000).toString();\r\n};\r\n\r\n/**\r\n * Hash OTP v·ªõi email ƒë·ªÉ b·∫£o m·∫≠t\r\n */\r\nconst hashOTP = (email: string, otp: string): string => {\r\n  return CryptoJS.SHA256(email + otp + OTP_SECRET).toString();\r\n};\r\n\r\n/**\r\n * Store OTP v√†o sessionStorage (kh√¥ng d√πng Firestore ƒë·ªÉ tr√°nh l·ªói permissions)\r\n */\r\nexport const storeOTP = (email: string, otp: string): void => {\r\n  const otpData: OTPData = {\r\n    email: email.toLowerCase().trim(),\r\n    hashedOTP: hashOTP(email, otp),\r\n    expiresAt: Date.now() + OTP_EXPIRY_MINUTES * 60 * 1000,\r\n    attempts: 0,\r\n    maxAttempts: 3\r\n  };\r\n\r\n  // L∆∞u v√†o sessionStorage (ch·ªâ t·ªìn t·∫°i trong tab hi·ªán t·∫°i)\r\n  sessionStorage.setItem(`otp_${email.toLowerCase()}`, JSON.stringify(otpData));\r\n  \r\n  console.log('‚úÖ OTP stored securely (hashed)');\r\n};\r\n\r\n/**\r\n * G·ª≠i OTP qua Firestore Trigger Email Extension\r\n * Extension s·∫Ω t·ª± ƒë·ªông g·ª≠i email khi c√≥ document m·ªõi trong collection 'mail'\r\n */\r\nexport const sendOTPEmail = async (\r\n  email: string,\r\n  otp: string\r\n): Promise<{\r\n  success: boolean;\r\n  code: 'otp.emailQueued' | 'otp.emailQueueFailed';\r\n  errorCode?: string;\r\n  details?: string;\r\n}> => {\r\n  try {\r\n    // T·∫°o HTML template cho email OTP\r\n    const emailHTML = `\r\n      <!DOCTYPE html>\r\n      <html>\r\n      <head>\r\n        <meta charset=\"utf-8\">\r\n        <style>\r\n          body { font-family: Arial, sans-serif; line-height: 1.6; background-color: #f4f4f4; margin: 0; padding: 20px; }\r\n          .container { max-width: 600px; margin: 0 auto; background: white; padding: 40px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\r\n          .header { text-align: center; margin-bottom: 30px; }\r\n          .logo { font-size: 32px; font-weight: bold; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }\r\n          .otp-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; border-radius: 8px; margin: 30px 0; }\r\n          .otp-code { font-size: 48px; font-weight: bold; letter-spacing: 8px; margin: 10px 0; }\r\n          .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; border-radius: 4px; }\r\n          .footer { text-align: center; color: #6b7280; font-size: 14px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <div class=\"container\">\r\n          <div class=\"header\">\r\n            <div class=\"logo\">üß† Quiz App</div>\r\n            <h2 style=\"color: #1f2937; margin-top: 10px;\">M√£ X√°c Th·ª±c OTP</h2>\r\n          </div>\r\n          \r\n          <p style=\"color: #374151;\">Xin ch√†o,</p>\r\n          <p style=\"color: #374151;\">B·∫°n ƒë√£ y√™u c·∫ßu ƒëƒÉng k√Ω t√†i kho·∫£n t·∫°i <strong>Quiz App</strong>.</p>\r\n          <p style=\"color: #374151;\">Vui l√≤ng s·ª≠ d·ª•ng m√£ OTP b√™n d∆∞·ªõi ƒë·ªÉ ho√†n t·∫•t qu√° tr√¨nh ƒëƒÉng k√Ω:</p>\r\n          \r\n          <div class=\"otp-box\">\r\n            <div style=\"font-size: 16px; opacity: 0.9;\">M√É X√ÅC TH·ª∞C C·ª¶A B·∫†N</div>\r\n            <div class=\"otp-code\">${otp}</div>\r\n            <div style=\"font-size: 14px; margin-top: 10px; opacity: 0.9;\">‚è±Ô∏è C√≥ hi·ªáu l·ª±c trong 10 ph√∫t</div>\r\n          </div>\r\n          \r\n          <div class=\"warning\">\r\n            <strong style=\"color: #92400e;\">‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng:</strong>\r\n            <ul style=\"margin: 10px 0; color: #92400e;\">\r\n              <li>M√£ OTP n√†y ch·ªâ c√≥ hi·ªáu l·ª±c trong <strong>10 ph√∫t</strong></li>\r\n              <li><strong>KH√îNG chia s·∫ª</strong> m√£ n√†y v·ªõi b·∫•t k·ª≥ ai</li>\r\n              <li>N·∫øu b·∫°n kh√¥ng y√™u c·∫ßu ƒëƒÉng k√Ω, vui l√≤ng b·ªè qua email n√†y</li>\r\n            </ul>\r\n          </div>\r\n          \r\n          <p style=\"color: #374151;\">Tr√¢n tr·ªçng,<br><strong>Quiz App Team</strong> üéØ</p>\r\n          \r\n          <div class=\"footer\">\r\n            <p>Email n√†y ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông, vui l√≤ng kh√¥ng tr·∫£ l·ªùi.</p>\r\n            <p>¬© 2025 Quiz App. All rights reserved.</p>\r\n          </div>\r\n        </div>\r\n      </body>\r\n      </html>\r\n    `;\r\n\r\n    // T·∫°o document trong collection 'mail' - Extension s·∫Ω t·ª± ƒë·ªông g·ª≠i\r\n    await addDoc(collection(db, 'mail'), {\r\n      to: [email],\r\n      from: 'lequytoanptit0303@gmail.com', // Default FROM address t·ª´ extension config\r\n      replyTo: 'lequytoanptit0303@gmail.com',\r\n      message: {\r\n        subject: 'üîê M√£ x√°c th·ª±c ƒëƒÉng k√Ω Quiz App',\r\n        html: emailHTML,\r\n        text: `M√£ OTP c·ªßa b·∫°n l√†: ${otp}. M√£ n√†y c√≥ hi·ªáu l·ª±c trong 10 ph√∫t.`\r\n      },\r\n      createdAt: new Date()\r\n    });\r\n\r\n    console.log('‚úÖ Email queued successfully via Firestore extension');\r\n\r\n    return {\r\n      success: true,\r\n      code: 'otp.emailQueued'\r\n    };\r\n  } catch (error: any) {\r\n    console.error('Error queuing email:', error);\r\n    return {\r\n      success: false,\r\n      code: 'otp.emailQueueFailed',\r\n      errorCode: error?.code,\r\n      details: error?.message\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Generate v√† g·ª≠i OTP\r\n */\r\nexport const generateAndSendOTP = async (\r\n  email: string\r\n): Promise<{\r\n  success: boolean;\r\n  code: 'otp.sent' | 'otp.emailFailed' | 'otp.genericError';\r\n  metadata?: OTPMetadata;\r\n}> => {\r\n  try {\r\n    // Generate OTP\r\n    const otp = generateOTP();\r\n    \r\n    // Store OTP locally (hashed)\r\n    storeOTP(email, otp);\r\n    \r\n    // Send OTP via Cloud Function\r\n    const result = await sendOTPEmail(email, otp);\r\n    \r\n    if (result.success) {\r\n      return {\r\n        success: true,\r\n        code: 'otp.sent',\r\n        metadata: { email }\r\n      };\r\n    }\r\n\r\n    // Clear stored OTP n·∫øu g·ª≠i th·∫•t b·∫°i\r\n    clearOTP(email);\r\n    return {\r\n      success: false,\r\n      code: 'otp.emailFailed',\r\n      metadata: {\r\n        email,\r\n        errorCode: result.errorCode,\r\n        details: result.details\r\n      }\r\n    };\r\n  } catch (error: any) {\r\n    console.error('Error generating and sending OTP:', error);\r\n    return {\r\n      success: false,\r\n      code: 'otp.genericError',\r\n      metadata: {\r\n        email,\r\n        details: error?.message\r\n      }\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Verify OTP\r\n */\r\nexport const verifyOTP = (\r\n  email: string,\r\n  inputOTP: string\r\n): {\r\n  success: boolean;\r\n  code: 'otp.verifySuccess' | 'otp.notFound' | 'otp.expired' | 'otp.maxAttempts' | 'otp.incorrect' | 'otp.genericError';\r\n  metadata?: OTPMetadata;\r\n} => {\r\n  const storageKey = `otp_${email.toLowerCase()}`;\r\n  const storedData = sessionStorage.getItem(storageKey);\r\n\r\n  if (!storedData) {\r\n    return { success: false, code: 'otp.notFound' };\r\n  }\r\n\r\n  try {\r\n    const otpData: OTPData = JSON.parse(storedData);\r\n\r\n    // Check expiry\r\n    if (Date.now() > otpData.expiresAt) {\r\n      sessionStorage.removeItem(storageKey);\r\n      return { success: false, code: 'otp.expired' };\r\n    }\r\n\r\n    // Check max attempts\r\n    if (otpData.attempts >= otpData.maxAttempts) {\r\n      sessionStorage.removeItem(storageKey);\r\n      return { success: false, code: 'otp.maxAttempts' };\r\n    }\r\n\r\n    // Verify OTP\r\n    const inputHash = hashOTP(email, inputOTP);\r\n    if (inputHash === otpData.hashedOTP) {\r\n      // Success - x√≥a OTP\r\n      sessionStorage.removeItem(storageKey);\r\n      return { success: true, code: 'otp.verifySuccess' };\r\n    } else {\r\n      // Failed - tƒÉng attempts\r\n      otpData.attempts += 1;\r\n      sessionStorage.setItem(storageKey, JSON.stringify(otpData));\r\n      \r\n      const remaining = otpData.maxAttempts - otpData.attempts;\r\n      return { \r\n        success: false, \r\n        code: 'otp.incorrect',\r\n        metadata: { remaining }\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error('Error verifying OTP:', error);\r\n    return { success: false, code: 'otp.genericError' };\r\n  }\r\n};\r\n\r\n/**\r\n * Clear OTP data\r\n */\r\nexport const clearOTP = (email: string): void => {\r\n  sessionStorage.removeItem(`otp_${email.toLowerCase()}`);\r\n};\r\n\r\n/**\r\n * Get OTP expiry time\r\n */\r\nexport const getOTPExpiryTime = (email: string): number | null => {\r\n  const storageKey = `otp_${email.toLowerCase()}`;\r\n  const storedData = sessionStorage.getItem(storageKey);\r\n\r\n  if (!storedData) return null;\r\n\r\n  try {\r\n    const otpData: OTPData = JSON.parse(storedData);\r\n    return otpData.expiresAt;\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\store.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\store\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\auth\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\creator\\components\\CreatorNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\creator\\layouts\\CreatorLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\CreateRoomModal.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":8738,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { useTranslation } from 'react-i18next';import { X, Lock, Users, Clock, Settings } from 'lucide-react';import type { Quiz, RoomConfig } from '../types/index';interface CreateRoomModalProps {  isOpen: boolean;  onClose: () => void;  onCreateRoom: (roomConfig: RoomConfig) => void;  selectedQuiz?: Quiz;  loading?: boolean;}const CreateRoomModal: React.FC<CreateRoomModalProps> = ({  isOpen,  onClose,  onCreateRoom,  selectedQuiz,  loading = false}) => {  const { t } = useTranslation();  const [roomName, setRoomName] = useState('');  const [maxPlayers, setMaxPlayers] = useState(4);  const [timeLimit, setTimeLimit] = useState(30);  const [isPrivate, setIsPrivate] = useState(false);  const [password, setPassword] = useState('');  const [showLeaderboard, setShowLeaderboard] = useState(true);    // Reset password when isPrivate is unchecked  React.useEffect(() => {    if (!isPrivate) {      setPassword('');    }  }, [isPrivate]);  // Constants for validation  const MIN_TIME_LIMIT = 5;  const MAX_TIME_LIMIT = 300; // 5 minutes max for better UX  const MIN_PLAYERS = 2;  const MAX_PLAYERS = 20;  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();        if (!roomName.trim()) {      return;    }    const roomConfig = {      name: roomName.trim(),      maxPlayers,      isPrivate,      password: isPrivate ? password : undefined,      settings: {        timePerQuestion: timeLimit,        showLeaderboard,        allowLateJoin: true      }    };    console.log('üèóÔ∏è CreateRoomModal: Submitting room config', {      isPrivate,      hasPassword: !!password,      roomConfig    });    onCreateRoom(roomConfig);  };  if (!isOpen) return null;  return (    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">        {/* Header */}        <div className=\"flex items-center justify-between p-6 border-b\">          <h2 className=\"text-xl font-bold text-gray-900\">            {t('multiplayer.createRoom')}          </h2>          <button            onClick={onClose}            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"          >            <X className=\"w-5 h-5\" />          </button>        </div>        {/* Content */}        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">          {/* Room Name */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              {t('multiplayer.roomName')}            </label>            <input              type=\"text\"              value={roomName}              onChange={(e) => setRoomName(e.target.value)}              placeholder={t('multiplayer.enterRoomName')}              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"              required              disabled={loading}            />          </div>          {/* Max Players */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              <Users className=\"w-4 h-4 inline mr-2\" />              {t('multiplayer.maxPlayers')} ({MIN_PLAYERS}-{MAX_PLAYERS})            </label>            <input              type=\"number\"              value={maxPlayers}              onChange={(e) => {                const value = parseInt(e.target.value);                if (value >= MIN_PLAYERS && value <= MAX_PLAYERS) {                  setMaxPlayers(value);                }              }}              min={MIN_PLAYERS}              max={MAX_PLAYERS}              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"              required              disabled={loading}            />          </div>          {/* Time Limit */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              <Clock className=\"w-4 h-4 inline mr-2\" />              // eslint-disable-next-line i18next/no-literal-string              {t('multiplayer.timeLimit')} ({MIN_TIME_LIMIT}-{MAX_TIME_LIMIT} gi√¢y)            </label>            <input              type=\"number\"              value={timeLimit}              onChange={(e) => {                const value = parseInt(e.target.value);                if (value >= MIN_TIME_LIMIT && value <= MAX_TIME_LIMIT) {                  setTimeLimit(value);                }              }}              min={MIN_TIME_LIMIT}              max={MAX_TIME_LIMIT}              placeholder={t('placeholders.enterNumber')}              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"              required              disabled={loading}            />            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-xs text-gray-500 mt-1\">              // eslint-disable-next-line i18next/no-literal-string              T·ª´ {MIN_TIME_LIMIT} ƒë·∫øn {MAX_TIME_LIMIT} gi√¢y cho m·ªói c√¢u h·ªèi (t·ªëi ƒëa 5 ph√∫t)            </p>          </div>          {/* Settings */}          <div className=\"space-y-4\">            <h3 className=\"text-sm font-medium text-gray-700 flex items-center\">              <Settings className=\"w-4 h-4 mr-2\" />              {t('multiplayer.roomSettings')}            </h3>            {/* Show Leaderboard */}            <div className=\"flex items-center\">              <input                type=\"checkbox\"                id=\"showLeaderboard\"                checked={showLeaderboard}                onChange={(e) => setShowLeaderboard(e.target.checked)}                className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"                disabled={loading}              />              <label htmlFor=\"showLeaderboard\" className=\"ml-2 text-sm text-gray-700\">                {t('multiplayer.showLeaderboard')}              </label>            </div>            {/* Private Room */}            <div className=\"flex items-center\">              <input                type=\"checkbox\"                id=\"isPrivate\"                checked={isPrivate}                onChange={(e) => setIsPrivate(e.target.checked)}                className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"                disabled={loading}              />              <label htmlFor=\"isPrivate\" className=\"ml-2 text-sm text-gray-700 flex items-center\">                <Lock className=\"w-4 h-4 mr-1\" />                {t('multiplayer.private')}              </label>            </div>            {/* Password */}            {isPrivate && (              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('multiplayer.password')}                </label>                <input                  type=\"password\"                  value={password}                  onChange={(e) => setPassword(e.target.value)}                  placeholder={t('multiplayer.enterPassword')}                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                  required={isPrivate}                  disabled={loading}                />              </div>            )}          </div>          {/* Selected Quiz Info */}          {selectedQuiz && (            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">              <h4 className=\"font-medium text-blue-900 mb-2\">                {t('quiz.selectedQuiz')}              </h4>              <div className=\"text-sm text-blue-800\">                <div className=\"font-medium\">{selectedQuiz.title}</div>                <div className=\"text-blue-600\">                  // eslint-disable-next-line i18next/no-literal-string                  {selectedQuiz.questions?.length || 0} c√¢u h·ªèi                </div>              </div>            </div>          )}          {/* Actions */}          <div className=\"flex gap-3 pt-4\">            <button              type=\"button\"              onClick={onClose}              className=\"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\"              disabled={loading}            >              {t('common.cancel')}            </button>            <button              type=\"submit\"              className=\"flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors font-medium\"              disabled={loading}            >              {loading ? t('common.loading') : t('multiplayer.createRoom')}            </button>          </div>        </form>      </div>    </div>  );};export default CreateRoomModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\GameModeSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\GameResults.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":8145,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useMemo } from 'react';import { useTranslation } from 'react-i18next';import { Trophy, Medal, Award, Users, Clock, Target } from 'lucide-react';interface Player {  id: string;  username: string;  score: number;  correctAnswers: number;  totalAnswers: number;  averageTime: number;  rank: number;}interface GameResultsProps {  players?: Player[];  currentUserId?: string;  gameStats?: {    totalQuestions: number;    totalTime: number;    averageScore: number;  };  onPlayAgain?: () => void;  onBackToLobby?: () => void;  onLeaveRoom?: () => void;}const GameResults: React.FC<GameResultsProps> = ({  players = [],  currentUserId = '',  gameStats = { totalQuestions: 0, totalTime: 0, averageScore: 0 },  onPlayAgain,  onBackToLobby,  onLeaveRoom}) => {  const { t } = useTranslation();  // Memoize expensive computations  const currentPlayer = useMemo(    () => players.find(p => p.id === currentUserId),    [players, currentUserId]  );  const sortedPlayers = useMemo(    () => [...players].sort((a, b) => b.score - a.score),    [players]  );  const getRankIcon = (rank: number) => {    switch (rank) {      case 1:        return <Trophy className=\"w-6 h-6 text-yellow-500\" />;      case 2:        return <Medal className=\"w-6 h-6 text-gray-400\" />;      case 3:        return <Award className=\"w-6 h-6 text-orange-500\" />;      default:        return <div className=\"w-6 h-6 flex items-center justify-center text-gray-500 font-bold\">#{rank}</div>;    }  };  const getRankColor = (rank: number) => {    switch (rank) {      case 1:        return 'bg-gradient-to-r from-yellow-100 to-yellow-200 border-yellow-300';      case 2:        return 'bg-gradient-to-r from-gray-100 to-gray-200 border-gray-300';      case 3:        return 'bg-gradient-to-r from-orange-100 to-orange-200 border-orange-300';      default:        return 'bg-gray-50 border-gray-200';    }  };  return (    <div className=\"max-w-4xl mx-auto p-4 space-y-6\">      {/* Header */}      <div className=\"text-center space-y-4\">        <div className=\"flex items-center justify-center gap-3\">          <Trophy className=\"w-8 h-8 text-yellow-500\" />          <h1 className=\"text-3xl font-bold text-gray-900\">            {t('multiplayer.game.gameOver')}          </h1>        </div>                {currentPlayer && (          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 inline-block\">            <div className=\"text-lg font-semibold text-blue-900\">              {t('multiplayer.yourResult')}            </div>            <div className=\"flex items-center justify-center gap-6 mt-2 text-blue-800\">              <div className=\"text-center\">                <div className=\"text-2xl font-bold\">{currentPlayer.score}</div>                <div className=\"text-sm\">{t('common.points')}</div>              </div>              <div className=\"text-center\">                <div className=\"text-2xl font-bold\">#{currentPlayer.rank}</div>                <div className=\"text-sm\">{t('common.rank')}</div>              </div>              <div className=\"text-center\">                <div className=\"text-2xl font-bold\">                  {Math.round((currentPlayer.correctAnswers / currentPlayer.totalAnswers) * 100)}%                </div>                <div className=\"text-sm\">{t('common.accuracy')}</div>              </div>            </div>          </div>        )}      </div>      {/* Final Leaderboard */}      <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden\">        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4\">          <h2 className=\"text-xl font-bold flex items-center gap-2\">            <Trophy className=\"w-6 h-6\" />            {t('multiplayer.game.finalResults')}          </h2>        </div>                <div className=\"divide-y divide-gray-200\">          {sortedPlayers.map((player, index) => (            <div              key={player.id}              className={`p-4 flex items-center gap-4 ${getRankColor(index + 1)} ${                player.id === currentUserId ? 'ring-2 ring-blue-500' : ''              }`}            >              {/* Rank */}              <div className=\"flex items-center justify-center w-12\">                {getRankIcon(index + 1)}              </div>              {/* Player Info */}              <div className=\"flex-1\">                <div className=\"font-semibold text-gray-900 flex items-center gap-2\">                  {player.username}                  {player.id === currentUserId && (                    <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full\">                      {t('common.you')}                    </span>                  )}                </div>                <div className=\"text-sm text-gray-600\">                  {player.correctAnswers}/{player.totalAnswers} {t('common.correct')} ‚Ä¢                   // eslint-disable-next-line i18next/no-literal-string                  {Math.round(player.averageTime)}s {t('common.avgTime')}                </div>              </div>              {/* Score */}              <div className=\"text-right\">                <div className=\"text-xl font-bold text-gray-900\">                  {player.score}                </div>                <div className=\"text-xs text-gray-500\">                  {t('common.points')}                </div>              </div>              {/* Accuracy */}              <div className=\"text-right w-16\">                <div className=\"text-lg font-semibold text-gray-700\">                  {Math.round((player.correctAnswers / player.totalAnswers) * 100)}%                </div>                <div className=\"text-xs text-gray-500\">                  {t('common.accuracy')}                </div>              </div>            </div>          ))}        </div>      </div>      {/* Game Stats */}      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">        <div className=\"bg-white rounded-lg shadow border border-gray-200 p-4 text-center\">          <Target className=\"w-8 h-8 text-blue-600 mx-auto mb-2\" />          <div className=\"text-2xl font-bold text-gray-900\">            {gameStats.totalQuestions}          </div>          <div className=\"text-sm text-gray-600\">            {t('multiplayer.totalQuestions')}          </div>        </div>        <div className=\"bg-white rounded-lg shadow border border-gray-200 p-4 text-center\">          <Clock className=\"w-8 h-8 text-green-600 mx-auto mb-2\" />          <div className=\"text-2xl font-bold text-gray-900\">            // eslint-disable-next-line i18next/no-literal-string            {Math.round(gameStats.totalTime / 60)}m          </div>          <div className=\"text-sm text-gray-600\">            {t('multiplayer.totalTime')}          </div>        </div>        <div className=\"bg-white rounded-lg shadow border border-gray-200 p-4 text-center\">          <Users className=\"w-8 h-8 text-purple-600 mx-auto mb-2\" />          <div className=\"text-2xl font-bold text-gray-900\">            {Math.round(gameStats.averageScore)}          </div>          <div className=\"text-sm text-gray-600\">            {t('multiplayer.avgScore')}          </div>        </div>      </div>      {/* Actions */}      <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">        {onPlayAgain && (          <button            onClick={onPlayAgain}            className=\"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium\"          >            {t('multiplayer.playAgain')}          </button>        )}                {onBackToLobby && (          <button            onClick={onBackToLobby}            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"          >            {t('multiplayer.backToLobby')}          </button>        )}                {onLeaveRoom && (          <button            onClick={onLeaveRoom}            className=\"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium\"          >            {t('multiplayer.leaveRoom')}          </button>        )}      </div>    </div>  );};export default GameResults;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\JoinRoomModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":92,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3073,3076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3073,3076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has missing dependencies: 'checkingCode' and 'step'. Either include them or remove the dependency array.","line":113,"column":6,"nodeType":"ArrayExpression","endLine":113,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [roomCode, loading, step, checkingCode]","fix":{"range":[3788,3807],"text":"[roomCode, loading, step, checkingCode]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { X, Lock, AlertCircle } from 'lucide-react';\r\nimport { collection, query, where, limit, getDocs } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\n\r\ninterface JoinRoomModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onJoinRoom: (roomCode: string, password?: string) => void;\r\n  loading?: boolean;\r\n  error?: string;\r\n}\r\n\r\nconst JoinRoomModal: React.FC<JoinRoomModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onJoinRoom,\r\n  loading = false,\r\n  error\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const [roomCode, setRoomCode] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [showPasswordField, setShowPasswordField] = useState(false);\r\n  const [step, setStep] = useState<'code' | 'password'>('code');\r\n  const [checkingCode, setCheckingCode] = useState(false);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    console.log('üìù Join room submit:', { step, roomCode, hasPassword: !!password });\r\n    \r\n    if (step === 'code') {\r\n      if (!roomCode.trim()) return;\r\n      \r\n      // Try joining with room code first (no password)\r\n      console.log('üö™ Attempting to join without password');\r\n      onJoinRoom(roomCode.trim().toUpperCase());\r\n    } else if (step === 'password') {\r\n      if (!password.trim()) return;\r\n      \r\n      // Join with password\r\n      console.log('üîë Attempting to join with password');\r\n      onJoinRoom(roomCode.trim().toUpperCase(), password.trim());\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setRoomCode('');\r\n    setPassword('');\r\n    setShowPasswordField(false);\r\n    setStep('code');\r\n    onClose();\r\n  };\r\n\r\n  // Handle specific errors\r\n  React.useEffect(() => {\r\n    if (!error) return;\r\n    \r\n    console.log('‚ùå Join room error received:', error);\r\n    const lower = error.toLowerCase();\r\n    \r\n    // Check for password-related errors in Vietnamese and English\r\n    if (lower.includes('y√™u c·∫ßu m·∫≠t kh·∫©u') || \r\n        lower.includes('password') || \r\n        lower.includes('room_requires_password') ||\r\n        lower.includes('passwordrequired')) {\r\n      console.log('üîí Password required, switching to password step');\r\n      setStep('password');\r\n      setShowPasswordField(true);\r\n    }\r\n  }, [error]);\r\n\r\n  // Auto-check room code to know if password is required without forcing a failed join\r\n  React.useEffect(() => {\r\n    const check = async () => {\r\n      const code = roomCode.trim().toUpperCase();\r\n      \r\n      // Only check when we have a complete code and not already in password step\r\n      if (code.length !== 6 || loading || step === 'password') return;\r\n      \r\n      // Prevent concurrent checks\r\n      if (checkingCode) return;\r\n      \r\n      try {\r\n        setCheckingCode(true);\r\n        const q = query(collection(db, 'multiplayer_rooms'), where('code', '==', code), limit(1));\r\n        const snap = await getDocs(q);\r\n        \r\n        if (!snap.empty) {\r\n          const data = snap.docs[0].data() as any;\r\n          console.log('üîç Room check:', { code, isPrivate: data.isPrivate });\r\n          \r\n          if (data.isPrivate) {\r\n            console.log('üîí Room requires password, showing password field');\r\n            setShowPasswordField(true);\r\n            setStep('password');\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error('Error checking room:', e);\r\n        // Silent fail; will be handled on submit\r\n      } finally {\r\n        setCheckingCode(false);\r\n      }\r\n    };\r\n    \r\n    // Add small delay to avoid checking on every keystroke\r\n    const timer = setTimeout(check, 500);\r\n    return () => clearTimeout(timer);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [roomCode, loading]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b\">\r\n          <h2 className=\"text-xl font-bold text-gray-900\">\r\n            {t('multiplayer.joinRoom')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n          {/* Room Code */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              {t('multiplayer.roomCode')}\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={roomCode}\r\n              onChange={(e) => setRoomCode(e.target.value.toUpperCase())}\r\n              placeholder={t('multiplayer.enterRoomCode')}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg font-mono tracking-wider\"\r\n              maxLength={6}\r\n              required\r\n              disabled={loading || step === 'password'}\r\n            />\r\n            <div className=\"text-xs text-gray-500 mt-1 text-center\">\r\n              {t('multiplayer.roomCodeHint')}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Password Field */}\r\n          {showPasswordField && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                <Lock className=\"w-4 h-4 inline mr-2\" />\r\n                {t('multiplayer.password')}\r\n              </label>\r\n              <input\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                placeholder={t('multiplayer.enterPassword')}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                required={step === 'password'}\r\n                disabled={loading}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Error Display */}\r\n          {error && step !== 'password' && (\r\n            <div className=\"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n              <AlertCircle className=\"w-5 h-5 text-red-600 flex-shrink-0\" />\r\n              <span className=\"text-red-700 text-sm\">\r\n                {error}\r\n              </span>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Wrong Password Error (only shown in password step) */}\r\n          {error && step === 'password' && error.toLowerCase().includes('sai') && (\r\n            <div className=\"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n              <AlertCircle className=\"w-5 h-5 text-red-600 flex-shrink-0\" />\r\n              <span className=\"text-red-700 text-sm\">\r\n                {error}\r\n              </span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Password Required Info */}\r\n          {step === 'password' && (\r\n            <div className=\"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n              <Lock className=\"w-5 h-5 text-yellow-600 flex-shrink-0\" />\r\n              <span className=\"text-yellow-700 text-sm\">\r\n                {t('multiplayer.passwordRequired')}\r\n              </span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-3 pt-4\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              className=\"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\"\r\n              disabled={loading}\r\n            >\r\n              {t('common.cancel')}\r\n            </button>\r\n            \r\n            {step === 'password' && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setStep('code');\r\n                  setShowPasswordField(false);\r\n                  setPassword('');\r\n                }}\r\n                className=\"px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\"\r\n                disabled={loading}\r\n              >\r\n                {t('common.back')}\r\n              </button>\r\n            )}\r\n            \r\n            <button\r\n              type=\"submit\"\r\n              className=\"flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors font-medium disabled:opacity-50\"\r\n              disabled={loading || !roomCode.trim() || (step === 'password' && !password.trim())}\r\n            >\r\n              {loading ? (\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                  {t('common.loading')}\r\n                </div>\r\n              ) : (\r\n                step === 'code' \r\n                  ? t('multiplayer.joinRoom')\r\n                  : t('common.submit')\r\n              )}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JoinRoomModal;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\MobileChatModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\MultiplayerChat.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":6605,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useRef, useEffect } from 'react';import { useTranslation } from 'react-i18next';import { Send, MessageSquare } from 'lucide-react';interface ChatMessage {  id: string;  userId: string;  username: string;  message: string;  timestamp: Date;  type: 'user' | 'system';}interface MultiplayerChatProps {  messages: ChatMessage[];  onSendMessage: (message: string) => void;  currentUserId: string;  disabled?: boolean;}const MultiplayerChat: React.FC<MultiplayerChatProps> = ({  messages,  onSendMessage,  currentUserId,  disabled = false}) => {  const { t } = useTranslation();  const [inputMessage, setInputMessage] = useState('');  const messagesEndRef = useRef<HTMLDivElement>(null);  const inputRef = useRef<HTMLInputElement>(null);  // Auto scroll to bottom when new messages arrive  useEffect(() => {    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });  }, [messages]);  const handleSubmit = (e: React.FormEvent) => {    e.preventDefault();        if (!inputMessage.trim() || disabled) return;        onSendMessage(inputMessage.trim());    setInputMessage('');    inputRef.current?.focus();  };  const formatTime = (date: Date) => {    return new Intl.DateTimeFormat('vi-VN', {      hour: '2-digit',      minute: '2-digit'    }).format(date);  };  return (    <div className=\"flex flex-col h-full bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden\">      {/* Header */}      <div className=\"flex items-center gap-3 p-4 bg-gradient-to-r from-blue-500 to-indigo-500\">        <div className=\"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center\">          <MessageSquare className=\"w-5 h-5 text-white\" />        </div>        <div className=\"flex-1\">          <h3 className=\"font-bold text-white text-lg\">            {t('multiplayer.chat.title')}          </h3>          <span className=\"text-xs text-blue-100\">            // eslint-disable-next-line i18next/no-literal-string            {messages.length} messages          </span>        </div>      </div>      {/* Messages */}      <div className=\"flex-1 overflow-y-auto p-4 space-y-3 bg-gradient-to-b from-gray-50 to-white\" style={{ maxHeight: 'calc(100vh - 300px)' }}>        {messages.length === 0 ? (          <div className=\"flex flex-col items-center justify-center h-full text-center py-8\">            <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-3\">              <MessageSquare className=\"w-8 h-8 text-blue-500\" />            </div>            <p className=\"text-gray-500 text-sm font-medium\">              {t('multiplayer.chat.noMessages')}            </p>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-400 text-xs mt-1\">              Start a conversation with your team!            </p>          </div>        ) : (          messages.map((message) => (            <div              key={message.id}              className={`flex flex-col ${                message.type === 'system'                  ? 'items-center'                  : message.userId === currentUserId                  ? 'items-end'                  : 'items-start'              }`}            >              {message.type === 'system' ? (                <div className=\"bg-gray-200 text-gray-600 text-xs px-4 py-1.5 rounded-full font-medium shadow-sm\">                  {message.message}                </div>              ) : (                <div className=\"flex flex-col max-w-[75%]\">                  {message.userId !== currentUserId && (                    <span className=\"text-xs text-gray-500 font-semibold mb-1 ml-3\">                      {message.username}                    </span>                  )}                  <div                    className={`px-4 py-2.5 rounded-2xl text-sm shadow-sm ${                      message.userId === currentUserId                        ? 'bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-br-sm'                        : 'bg-white border border-gray-200 text-gray-800 rounded-bl-sm'                    }`}                  >                    <div className=\"break-words\">{message.message}</div>                    <div                      className={`text-xs mt-1 ${                        message.userId === currentUserId                          ? 'text-blue-100'                          : 'text-gray-400'                      }`}                    >                      {formatTime(message.timestamp)}                    </div>                  </div>                </div>              )}            </div>          ))        )}        <div ref={messagesEndRef} />      </div>      {/* Input */}      <form onSubmit={handleSubmit} className=\"p-4 bg-white border-t border-gray-100\">        <div className=\"flex gap-2\">          <input            ref={inputRef}            type=\"text\"            value={inputMessage}            onChange={(e) => setInputMessage(e.target.value)}            placeholder={              disabled                ? t('multiplayer.chat.disabled')                : t('multiplayer.chat.placeholder')            }            className=\"flex-1 px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white text-sm transition-all disabled:bg-gray-100 disabled:text-gray-400\"            disabled={disabled}            maxLength={200}          />          <button            type=\"submit\"            disabled={!inputMessage.trim() || disabled}            className=\"px-4 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg disabled:shadow-none\"          >            <Send className=\"w-5 h-5\" />          </button>        </div>                {inputMessage.length > 150 && (          <div className=\"flex items-center justify-end gap-2 mt-2\">            <div className={`w-12 h-1.5 rounded-full overflow-hidden bg-gray-200`}>              <div                 className={`h-full transition-all ${                  inputMessage.length > 180 ? 'bg-red-500' : 'bg-blue-500'                }`}                style={{ width: `${(inputMessage.length / 200) * 100}%` }}              />            </div>            <span className={`text-xs font-medium ${              inputMessage.length > 180 ? 'text-red-500' : 'text-gray-500'            }`}>              {inputMessage.length}/200            </span>          </div>        )}      </form>    </div>  );};export default MultiplayerChat;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\MultiplayerErrorBoundary.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":4544,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport { Component, ErrorInfo, ReactNode } from 'react';import { AlertTriangle, RefreshCw } from 'lucide-react';interface Props {  children: ReactNode;  fallback?: ReactNode;  onError?: (error: Error, errorInfo: ErrorInfo) => void;}interface State {  hasError: boolean;  error: Error | null;  errorInfo: ErrorInfo | null;}class MultiplayerErrorBoundary extends Component<Props, State> {  constructor(props: Props) {    super(props);    this.state = {      hasError: false,      error: null,      errorInfo: null    };  }  static getDerivedStateFromError(error: Error): State {    return {      hasError: true,      error,      errorInfo: null    };  }  componentDidCatch(error: Error, errorInfo: ErrorInfo) {    console.error('Multiplayer Error Boundary caught an error:', error, errorInfo);        this.setState({      error,      errorInfo    });    // Call optional error handler    if (this.props.onError) {      this.props.onError(error, errorInfo);    }  }  handleReset = () => {    this.setState({      hasError: false,      error: null,      errorInfo: null    });  };  handleReload = () => {    window.location.reload();  };  render() {    if (this.state.hasError) {      // Custom fallback UI if provided      if (this.props.fallback) {        return this.props.fallback;      }      // Default error UI      return (        <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-orange-50 p-4\">          <div className=\"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8\">            <div className=\"flex flex-col items-center text-center\">              {/* Error Icon */}              <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4\">                <AlertTriangle className=\"w-8 h-8 text-red-600\" />              </div>              {/* Error Title */}              // eslint-disable-next-line i18next/no-literal-string              <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">                Oops! Something went wrong              </h1>              {/* Error Message */}              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-gray-600 mb-6\">                The multiplayer game encountered an unexpected error. Don't worry, your progress might be saved.              </p>              {/* Error Details (Development only) */}              {process.env.NODE_ENV === 'development' && this.state.error && (                <div className=\"w-full mb-6 p-4 bg-gray-50 rounded-lg text-left\">                  <p className=\"text-xs font-mono text-red-600 break-words\">                    {this.state.error.toString()}                  </p>                  {this.state.errorInfo && (                    <details className=\"mt-2\">                      // eslint-disable-next-line i18next/no-literal-string                      <summary className=\"text-xs text-gray-600 cursor-pointer hover:text-gray-900\">                        Component Stack                      </summary>                      <pre className=\"text-xs text-gray-600 mt-2 overflow-auto max-h-40\">                        {this.state.errorInfo.componentStack}                      </pre>                    </details>                  )}                </div>              )}              {/* Action Buttons */}              <div className=\"flex gap-3 w-full\">                <button                  onClick={this.handleReset}                  className=\"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center gap-2\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <RefreshCw className=\"w-4 h-4\" />                  Try Again                </button>                <button                  onClick={this.handleReload}                  className=\"flex-1 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium\"                // eslint-disable-next-line i18next/no-literal-string                >                  Reload Page                </button>              </div>              {/* Help Text */}              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-xs text-gray-500 mt-4\">                If the problem persists, please contact support or try again later.              </p>            </div>          </div>        </div>      );    }    return this.props.children;  }}export default MultiplayerErrorBoundary;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\MultiplayerManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslation' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":88},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":121,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":126},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":162,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":167},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Wifi' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":171,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":175},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WifiOff' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":178,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":185},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":188,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":199},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logger' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":230,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":236}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { useTranslation } from 'react-i18next';import { toast } from 'react-toastify';import {   Users,   Wifi,  WifiOff,  AlertCircle} from 'lucide-react';import { logger } from '../utils/logger';// Import c√°c components conimport GameModeSelector from './GameModeSelector';import CreateRoomModal from './CreateRoomModal';import JoinRoomModal from './JoinRoomModal';import RoomLobby from './RoomLobby';import MultiplayerQuiz from './MultiplayerQuiz';import GameResults from './GameResults';import RealtimeChat from './RealtimeChat';import MobileChatModal from './MobileChatModal';// Import servicesimport { getMultiplayerService, MultiplayerServiceInterface } from '../services/enhancedMultiplayerService';// Typesimport type { Quiz } from '../types/index';import type { GameResults as GameResultsType } from '../types/index';export interface MultiplayerState {  currentState: 'mode-selection' | 'create-room' | 'join-room' | 'lobby' | 'game' | 'results';  roomId?: string;  roomData?: any; // eslint-disable-line @typescript-eslint/no-explicit-any  gameData?: any; // eslint-disable-line @typescript-eslint/no-explicit-any  results?: GameResultsType;  error?: string;  isConnecting: boolean;  isConnected: boolean;}interface MultiplayerManagerProps {  selectedQuiz?: Quiz;  currentUserId: string;  currentUserName: string;  onBackToLobby: () => void;  onQuizComplete: (results: GameResultsType) => void;  initialRoomId?: string;}const MultiplayerManager: React.FC<MultiplayerManagerProps> = ({  selectedQuiz: initialSelectedQuiz,  currentUserId,  currentUserName,  onBackToLobby,  onQuizComplete,  initialRoomId}) => {  const { t } = useTranslation();  const [selectedQuiz] = useState<Quiz | undefined>(initialSelectedQuiz);  const [state, setState] = useState<MultiplayerState>({    currentState: 'mode-selection', // Lu√¥n b·∫Øt ƒë·∫ßu t·ª´ mode-selection v√¨ quiz ƒë√£ ƒë∆∞·ª£c ch·ªçn t·ª´ MultiplayerLobby    isConnecting: false,    isConnected: false  });    const [multiplayerService, setMultiplayerService] = useState<MultiplayerServiceInterface | null>(null);  const [connectionStatus, setConnectionStatus] = useState<'disconnected' | 'connecting' | 'connected' | 'error'>('disconnected');  const [readyCountdown, setReadyCountdown] = useState<number | null>(null);  const [joinError, setJoinError] = useState<string | undefined>(undefined);\tconst [createLoading, setCreateLoading] = useState<boolean>(false);\tconst [joinLoading, setJoinLoading] = useState<boolean>(false);  const [isMobileChatOpen, setIsMobileChatOpen] = useState<boolean>(false);  // Initialize multiplayer service  useEffect(() => {    const service = getMultiplayerService();    setMultiplayerService(service);        // Connect to service    const connectToService = async () => {      try {        setConnectionStatus('connecting');        await service.connect(currentUserId, currentUserName);        setConnectionStatus('connected');        setState(prev => ({ ...prev, isConnected: true }));                // Set up event listeners        service.on('room:updated', handleRoomUpdate);        service.on('players:updated', handlePlayersUpdate);        // messages:updated listener removed - RealtimeChat handles this directly        service.on('game:start', handleGameStart);        service.on('game:next-question', handleNextQuestion);        service.on('game:finish', handleGameFinish);        service.on('connection:lost', handleConnectionLost);        service.on('connection:restored', handleConnectionRestored);              } catch (error) {        console.error('Failed to connect to multiplayer service:', error);        setConnectionStatus('error');        toast.error(t('multiplayer.errors.connectionFailed'));      }    };    connectToService();    return () => {      service.disconnect();    };  }, [currentUserId, currentUserName, t]); // eslint-disable-line react-hooks/exhaustive-deps  // Handlers are intentionally omitted from dependencies to prevent infinite loop from re-subscription  // Try resuming room from state (if page reload)  useEffect(() => {    const previousRoomId = initialRoomId || state.roomId || (state.roomData?.id as string | undefined);    if (!previousRoomId || !multiplayerService || connectionStatus !== 'connected') return;    // Mark presence online and resume streams    multiplayerService.setPresence(previousRoomId, true).catch(() => {});    multiplayerService.resumeRoom(previousRoomId).catch(() => {});    // Set UI state to lobby immediately while streams resume    setState(prev => ({ ...prev, currentState: 'lobby', roomId: previousRoomId }));  }, [multiplayerService, connectionStatus, initialRoomId, state.roomId, state.roomData?.id]);  // Event handlers  const handleRoomUpdate = useCallback((roomData: any) => {    logger.debug('Room updated', {       roomId: roomData?.id,       status: roomData?.status,      playerCount: roomData?.players?.length     });        setState(prev => {      // Preserve existing players if not in new roomData      const updatedRoomData = {        ...roomData,        players: roomData.players || prev.roomData?.players || []      };            return { ...prev, roomData: updatedRoomData };    });        // Auto-start countdown when all players ready (no host restriction)    try {      const players = roomData?.players || [];      const total = players.length;      const ready = players.filter((p: any) => p.isReady).length;      const allReady = total >= 2 && ready === total;            if (allReady && state.currentState === 'lobby') {        if (readyCountdown === null) {          setReadyCountdown(5);          logger.info('All players ready - starting countdown', { total, ready });        }      } else {        if (readyCountdown !== null) {          setReadyCountdown(null);          logger.debug('Countdown cancelled', { total, ready, allReady });        }      }    } catch (error) {      logger.error('Error in handleRoomUpdate', error);    }  }, [state.currentState, readyCountdown]);  useEffect(() => {    if (readyCountdown === null) return;        if (readyCountdown <= 0) {      // Start game when countdown reaches 0 (any player can trigger)      if (multiplayerService && state.roomId) {        logger.info('Starting game from countdown...');        multiplayerService.startGame(state.roomId).then(() => {          logger.success('Game started successfully');        }).catch((error) => {          logger.error('Failed to start game', error);          toast.error('Failed to start game');        });      }      setReadyCountdown(null);      return;    }        const timer = setTimeout(() => {      setReadyCountdown(prev => prev !== null ? prev - 1 : null);    }, 1000);        return () => clearTimeout(timer);  }, [readyCountdown, multiplayerService, state.roomId]);  const handleGameStart = useCallback((gameData: any) => {    logger.debug('Game Start Event Received', {      hasQuestions: gameData?.questions?.length || 0    });        setState(prev => ({       ...prev,       currentState: 'game',       gameData     }));  }, []);  const handleNextQuestion = useCallback((gameData: any) => {    setState(prev => ({       ...prev,       gameData    }));  }, []);  const handleGameFinish = useCallback((results: GameResultsType) => {    setState(prev => ({       ...prev,       currentState: 'results',       results     }));    onQuizComplete(results);  }, [onQuizComplete]);  const handlePlayersUpdate = useCallback((players: any[]) => {    logger.debug('Players updated', { count: players.length, playerIds: players.map(p => p.id) });    setState(prev => {      // Ensure we merge players into existing roomData      if (!prev.roomData) {        logger.warn('Received players update but no roomData exists');        return prev;      }            return {        ...prev,        roomData: {           ...prev.roomData,           players         }      };    });  }, []);  // Messages are now handled directly by RealtimeChat component via RTDB listeners  // No need for handleMessagesUpdate callback  // const handleChatMessage = useCallback((message: any) => {  //   console.log('MultiplayerManager received chat message:', message);  //   setChatMessages(prev => {  //     const newMessages = [...prev, message];  //     console.log('Updated chat messages count:', newMessages.length);  //     return newMessages;  //   });  // }, []);  const handleConnectionLost = useCallback(() => {    setConnectionStatus('disconnected');    // toast.warning(t('multiplayer.errors.connectionLost'));  }, []);  const handleConnectionRestored = useCallback(() => {    setConnectionStatus('connected');    // toast.success(t('multiplayer.success.connectionRestored'));  }, []);  // Navigation handlers  const handleModeSelection = (mode: 'create' | 'join') => {    if (mode === 'create') {      setState(prev => ({ ...prev, currentState: 'create-room' }));    } else {      setState(prev => ({ ...prev, currentState: 'join-room' }));    }  };  const handleBackToModeSelection = () => {    setState(prev => ({       ...prev,       currentState: 'mode-selection',      roomId: undefined,      roomData: undefined,      gameData: undefined,      results: undefined    }));  };  const handleBackToQuizSelection = () => {    // Navigate back to lobby to select another quiz    onBackToLobby();  };  const handleRoomCreated = (roomId: string, roomData: any) => {    setState(prev => ({       ...prev,       currentState: 'lobby',      roomId,      roomData    }));    // toast.success(t('multiplayer.success.roomCreated')); // Removed - too many notifications  };  const handleRoomJoined = (roomId: string, roomData: any) => {    setState(prev => ({       ...prev,       currentState: 'lobby',      roomId,      roomData    }));    // toast.success(t('multiplayer.success.joinedRoom')); // Removed - too many notifications  };  const handleLeaveRoom = () => {    if (multiplayerService && state.roomId) {      multiplayerService.leaveRoom(state.roomId);    }    setState(prev => ({       ...prev,       currentState: 'mode-selection',      roomId: undefined,      roomData: undefined,      gameData: undefined,      results: undefined    }));    toast.info(t('multiplayer.success.leftRoom'));  };  // Chat message handler - not needed with RealtimeChat component  // Messages are sent directly from RealtimeChat via RTDB  // Render connection status  const renderConnectionStatus = () => {    const statusConfig = {      disconnected: { icon: WifiOff, color: 'text-red-500', text: t('multiplayer.errors.connectionLost') },      connecting: { icon: Wifi, color: 'text-yellow-500', text: t('multiplayer.errors.reconnecting') },      connected: { icon: Wifi, color: 'text-green-500', text: t('multiplayer.success.connectionRestored') },      error: { icon: AlertCircle, color: 'text-red-500', text: t('multiplayer.errors.connectionFailed') }    } as const;    const config = statusConfig[connectionStatus];    const Icon = config.icon;    return (      <div className={`flex items-center gap-2 ${config.color} text-sm`}>        <Icon size={16} />        <span>{config.text}</span>      </div>    );  };  // Render current state  const renderCurrentState = () => {    switch (state.currentState) {      case 'mode-selection':        return (          <GameModeSelector            isOpen={true}            onClose={handleBackToQuizSelection}            onSelectMultiplayer={handleModeSelection}            connectionStatus={connectionStatus}          />        );      case 'create-room':        return (\t\t\t\t<CreateRoomModal            isOpen={true}\t\t\t\tonClose={handleBackToModeSelection}            onCreateRoom={async (roomConfig) => {\t\t\t\t\ttry {\t\t\t\t\t\tsetCreateLoading(true);\t\t\t\t\t\tif (!multiplayerService || connectionStatus !== 'connected') {\t\t\t\t\t\t\ttoast.info(t('multiplayer.errors.reconnecting'));\t\t\t\t\t\t\treturn;\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t// Pass full quiz object instead of just quizId\t\t\t\t\t\tconsole.log('üéÆ Manager: Creating room with quiz', { \t\t\t\t\t\t\tquizId: selectedQuiz?.id, \t\t\t\t\t\t\tquizTitle: selectedQuiz?.title,\t\t\t\t\t\t\thasQuestions: !!selectedQuiz?.questions?.length\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\t\t\t\tconst result = await multiplayerService.createRoom(roomConfig as any, selectedQuiz);\t\t\t\t\t\tif (result) {\t\t\t\t\t\t\thandleRoomCreated(result.room.id, result.room);\t\t\t\t\t\t}\t\t\t\t\t} catch (error: any) {\t\t\t\t\t\tconsole.error('‚ùå Manager: Failed to create room:', error);\t\t\t\t\t\tconst errorMessage = error.message || t('multiplayer.errors.createRoomFailed');\t\t\t\t\t\ttoast.error(errorMessage);\t\t\t\t\t\t} finally {\t\t\t\t\t\t\tsetCreateLoading(false);\t\t\t\t\t\t}            }}            selectedQuiz={selectedQuiz}\t\t\t\t\tloading={createLoading || connectionStatus !== 'connected'}          />        );      case 'join-room':        return (\t\t\t\t<JoinRoomModal            isOpen={true}            onClose={() => {              setJoinError(undefined);              handleBackToModeSelection();            }}            onJoinRoom={async (roomCode, password) => {              try {\t\t\t\t\t\t\tsetJoinError(undefined);\t\t\t\t\t\t\tsetJoinLoading(true);\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('üéÆ Manager: Attempting to join room', { roomCode, hasPassword: !!password });\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!multiplayerService || connectionStatus !== 'connected') {\t\t\t\t\t\t\t\ttoast.info(t('multiplayer.errors.reconnecting'));\t\t\t\t\t\t\t\treturn;\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst result = await multiplayerService.joinRoom(roomCode, password);                if (result) {                  console.log('‚úÖ Manager: Successfully joined room');                  handleRoomJoined(result.room.id, result.room);                }              } catch (error: any) {                console.error('‚ùå Manager: Failed to join room:', error);                console.log('Error details:', { message: error.message, code: error.code });                                // Translate error messages                let errorMessage = t('multiplayer.errors.joinRoomFailed');                const errorCode = error.message || '';                                if (errorCode === 'room_not_found') {                  errorMessage = t('multiplayer.errors.roomNotFound', 'Kh√¥ng t√¨m th·∫•y ph√≤ng');                } else if (errorCode === 'room_requires_password') {                  errorMessage = t('multiplayer.errors.passwordRequired', 'Ph√≤ng n√†y y√™u c·∫ßu m·∫≠t kh·∫©u');                } else if (errorCode === 'wrong_password') {                  errorMessage = t('multiplayer.errors.wrongPassword', 'M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng');                } else if (errorCode === 'room_full') {                  errorMessage = t('multiplayer.errors.roomFull', 'Ph√≤ng ƒë√£ ƒë·∫ßy');                } else if (errorCode === 'game_in_progress') {                  errorMessage = t('multiplayer.errors.gameInProgress', 'Game ƒëang di·ªÖn ra');                } else if (errorCode) {                  errorMessage = errorCode;                }                                console.log('üì® Manager: Setting error message:', errorMessage);                setJoinError(errorMessage);                                // Don't show toast for password required error - let modal handle it                if (errorCode !== 'room_requires_password') {                  toast.error(errorMessage);                }\t\t\t\t\t\t} finally {\t\t\t\t\t\t\tsetJoinLoading(false);\t\t\t\t\t\t}            }}\t\t\t\t\tloading={joinLoading || connectionStatus !== 'connected'}            error={joinError}          />        );      case 'lobby':        return (          <div className=\"flex flex-col lg:flex-row min-h-screen bg-gray-50\">            {/* Main Lobby - Full width on mobile, flex-1 on desktop */}            <div className=\"flex-1 overflow-y-auto\">              <RoomLobby                roomData={state.roomData}                currentUserId={currentUserId}                onLeaveRoom={handleLeaveRoom}                multiplayerService={multiplayerService ?? undefined}              />              {readyCountdown !== null && (                <div className=\"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50\">                  <div className=\"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 animate-pulse\">                    <div className=\"w-3 h-3 bg-white rounded-full animate-ping\"></div>                    <span className=\"font-bold text-lg\">                      // eslint-disable-next-line i18next/no-literal-string                      {t('common.start')}: {readyCountdown}s                    </span>                  </div>                </div>              )}            </div>                        {/* Chat Sidebar - Hidden on mobile, show on lg+ */}            <div className=\"hidden lg:block lg:w-80 xl:w-96 border-l border-gray-200 bg-white\">              <div className=\"h-screen sticky top-0\">                <RealtimeChat                  roomId={state.roomId || ''}                  currentUserId={currentUserId}                  currentUsername={currentUserName}                  isMobile={false}                />              </div>            </div>            {/* Mobile Chat Button - Show only on mobile */}            <button               className=\"lg:hidden fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-full shadow-2xl flex items-center justify-center z-50 hover:scale-110 transition-transform\"              onClick={() => setIsMobileChatOpen(true)}            >              <Users className=\"w-6 h-6\" />            </button>            {/* Mobile Chat Modal */}            <MobileChatModal              isOpen={isMobileChatOpen}              onClose={() => setIsMobileChatOpen(false)}              roomId={state.roomId || ''}              currentUserId={currentUserId}              currentUsername={currentUserName}            />          </div>        );      case 'game':        return (          <div className=\"flex flex-col lg:flex-row min-h-screen bg-gray-50\">            {/* Game Area - Full width on mobile */}            <div className=\"flex-1 overflow-y-auto\">              <MultiplayerQuiz                gameData={state.gameData ?? null}                roomData={state.roomData ?? null}                currentUserId={currentUserId}                currentUserName={currentUserName}                multiplayerService={multiplayerService}              />            </div>                        {/* Chat Sidebar - Hidden on mobile during game */}            <div className=\"hidden lg:block lg:w-80 xl:w-96 border-l border-gray-200 bg-white\">              <div className=\"h-screen sticky top-0\">                <RealtimeChat                  roomId={state.roomId || ''}                  currentUserId={currentUserId}                  currentUsername={currentUserName}                  isMobile={false}                />              </div>            </div>          </div>        );      case 'results':        return (          <GameResults            players={state.results?.players as any || []}            currentUserId={currentUserId}            onPlayAgain={handleBackToModeSelection}            onBackToLobby={onBackToLobby}            onLeaveRoom={handleLeaveRoom}          />        );      default:        return null;    }  };  return (    <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900\">      {/* Header with connection status */}      <div className=\"bg-white/10 backdrop-blur-md border-b border-white/20 p-4\">        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">          <div className=\"flex items-center gap-4\">            <button              onClick={handleBackToQuizSelection}              className=\"text-white hover:text-gray-200 transition-colors\"            >              ‚Üê {t('common.back')}            </button>            <div>              <h1 className=\"text-xl font-bold text-white\">                {t('multiplayer.title')}              </h1>              {selectedQuiz && (                <p className=\"text-sm text-purple-200\">                  // eslint-disable-next-line i18next/no-literal-string                  üéØ {selectedQuiz.title} ‚Ä¢ {selectedQuiz.questions?.length || 0} c√¢u h·ªèi                </p>              )}            </div>          </div>          <div className=\"flex items-center gap-4\">            {renderConnectionStatus()}            {state.roomData && (              <div className=\"flex items-center gap-2 text-white\">                <Users size={16} />                <span>{state.roomData.players?.length || 0}/{state.roomData.settings?.maxPlayers || 10}</span>              </div>            )}          </div>        </div>      </div>      {/* Main content */}      <div className=\"flex-1\">        {renderCurrentState()}      </div>    </div>  );};export default MultiplayerManager;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\MultiplayerQuiz.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":66},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MultiplayerServiceInterface' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":91,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":118},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":176,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":181},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":183,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":188},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":190,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":201},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":203,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":214},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'doc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":246,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":249},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onSnapshot' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":251,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":261},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'collection' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":263,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":273},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'addDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":275,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":281},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'serverTimestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":283,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":298},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'db' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":336,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":338},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSelector' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":382,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":393},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RootState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":424,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":433},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":471,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":476},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SafeHTML' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":508,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":516},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logger' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":572,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":578}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":22,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useMemo, useRef, useState, useEffect, useCallback } from 'react';import { MultiplayerServiceInterface } from '../services/enhancedMultiplayerService';import { Clock, Users, CheckCircle, AlertCircle } from 'lucide-react';import { doc, onSnapshot, collection, addDoc, serverTimestamp } from 'firebase/firestore';import { db } from '../../../firebase/config';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { toast } from 'react-toastify';import SafeHTML from '../../../shared/components/ui/SafeHTML';import { logger } from '../utils/logger';// Type definitionsinterface Answer {  text: string;  isCorrect: boolean;}interface Question {  id: string;  text?: string;  title?: string;  answers?: Answer[];  options?: string[];  type?: string;  points?: number;}interface Player {  id: string;  username: string;  name?: string; // Alias for username  displayName?: string; // Alternative name field  isReady: boolean;  isOnline: boolean;  joinedAt: Date;}interface PlayerAnswer {  questionId?: string;  selectedAnswer: number;  answer?: string;  timeToAnswer: number;  timeSpent?: number;  pointsEarned: number;  points?: number; // Alias for pointsEarned  isCorrect: boolean;  timestamp: number;}interface PlayerResult {  playerId: string;  playerName: string;  isCorrect: boolean;  selectedAnswer: number | null;  points: number;  timeSpent: number;}interface GameData {  currentQuestionIndex: number;  questions: Question[];  timePerQuestion: number;  showingResults?: boolean;  nextQuestionAt?: { seconds: number };  questionEndAt?: { seconds: number };  phase?: 'countdown' | 'question' | 'results' | 'finished';  questionResults?: {    [questionId: string]: PlayerResult[];  };}interface RoomData {  id: string;  status: 'waiting' | 'starting' | 'playing' | 'finished';  gameData?: GameData;  gameStartAt?: { seconds: number };  gameStartDelay?: number;  settings?: {    timePerQuestion?: number;  };  quiz?: {    id?: string;    title?: string;    questions: Question[];  };  players?: Player[];  questionAnswers?: {    [questionIndex: number]: {      [playerId: string]: PlayerAnswer;    };  };}interface ProcessedQuestion {  id: string;  title: string;  options: string[];  correct: number;  type?: string;  points?: number;  explanation?: string;}interface QuestionResults {  isCorrect: boolean;  correctAnswer: number;  selectedAnswer: number | null;  points: number;  explanation: string;}interface MultiplayerQuizProps {  gameData: GameData | null;  roomData: RoomData | null;  currentUserId: string;  currentUserName: string;  multiplayerService: MultiplayerServiceInterface | null;}const MultiplayerQuiz: React.FC<MultiplayerQuizProps> = ({  gameData,  roomData,  currentUserName,  multiplayerService}) => {  const [selectedIndex, setSelectedIndex] = useState<number | null>(null);  const [locked, setLocked] = useState(false);  const [showResults, setShowResults] = useState(false);  const [questionResults, setQuestionResults] = useState<QuestionResults | null>(null);  const [nextQuestionCountdown, setNextQuestionCountdown] = useState<number | null>(null);  const [gameStartCountdown, setGameStartCountdown] = useState<number | null>(null);  const [questionTimeLeft, setQuestionTimeLeft] = useState<number>(0);  const [realtimeGameData, setRealtimeGameData] = useState<GameData | null>(gameData);  const [realtimeRoomData, setRealtimeRoomData] = useState<RoomData | null>(roomData);    // Client-side game state for fast performance  const [playerScores, setPlayerScores] = useState<{[playerId: string]: number}>({});  const [playerAnswers, setPlayerAnswers] = useState<{[playerId: string]: PlayerAnswer[]}>({});  const [currentQuestionAnswers, setCurrentQuestionAnswers] = useState<{[playerId: string]: PlayerAnswer}>({});  const [waitingForOthers, setWaitingForOthers] = useState<boolean>(false);    const timerRef = useRef<number | null>(null);  const countdownRef = useRef<number | null>(null);  const gameStartRef = useRef<number | null>(null);  const previousQuestionIndexRef = useRef<number>(-1);  // Use real-time data consistently  const currentGameData = realtimeGameData || gameData;  const currentRoomData = realtimeRoomData || roomData;    const timePerQuestion = currentGameData?.timePerQuestion ?? currentRoomData?.settings?.timePerQuestion ?? 30;  const [timeLeft, setTimeLeft] = useState<number>(timePerQuestion);    // Get current user from Redux store  const currentUser = useSelector((state: RootState) => state.auth.user);    // Get current game phase  const gamePhase = currentGameData?.phase || 'question';  const roomStatus = currentRoomData?.status || 'waiting';  // Real-time Firestore listener  useEffect(() => {    if (!roomData?.id) return;    const roomRef = doc(db, 'multiplayer_rooms', roomData.id);        const unsubscribe = onSnapshot(roomRef, (doc) => {      if (doc.exists()) {        const data = { id: doc.id, ...doc.data() } as RoomData;                setRealtimeRoomData(data);        if (data.gameData) {          setRealtimeGameData(data.gameData as GameData);        }                // Handle game starting phase        if (data.status === 'starting') {          if (data.gameStartAt && data.gameStartDelay) {            const startTime = new Date(data.gameStartAt.seconds * 1000);            const now = new Date();            const elapsedTime = Math.floor((now.getTime() - startTime.getTime()) / 1000);            const secondsLeft = Math.max(0, Math.floor(data.gameStartDelay / 1000) - elapsedTime);                        setGameStartCountdown(secondsLeft > 0 ? secondsLeft : 0);          } else {            setGameStartCountdown(5);          }        }                // Clear countdown when game actually starts OR countdown reaches 0        if ((data.status === 'playing' && data.gameData?.phase === 'question') ||             (data.status === 'starting' && gameStartCountdown === 0)) {          setGameStartCountdown(null);        }                // Handle question timing        if (data.gameData?.questionEndAt && data.gameData?.phase === 'question') {          const endTime = new Date(data.gameData.questionEndAt.seconds * 1000);          const now = new Date();          const secondsLeft = Math.max(0, Math.ceil((endTime.getTime() - now.getTime()) / 1000));                    if (secondsLeft > 0) {            setQuestionTimeLeft(secondsLeft);            setTimeLeft(secondsLeft);          }        }                // Detect question change        const newIndex = data.gameData?.currentQuestionIndex ?? 0;        if (newIndex !== previousQuestionIndexRef.current) {          previousQuestionIndexRef.current = newIndex;                    // Reset UI state for new question          setSelectedIndex(null);          setLocked(false);          setShowResults(false);          setQuestionResults(null);          setTimeLeft(timePerQuestion);          setWaitingForOthers(false);          setCurrentQuestionAnswers({});                    // Clear existing timers          if (timerRef.current) {            window.clearTimeout(timerRef.current);            timerRef.current = null;          }          if (countdownRef.current) {            window.clearTimeout(countdownRef.current);            countdownRef.current = null;          }        }                // Handle results phase        if (data.gameData?.phase === 'results' && data.gameData?.nextQuestionAt) {          const nextTime = new Date(data.gameData.nextQuestionAt.seconds * 1000);          const now = new Date();          const secondsLeft = Math.max(0, Math.ceil((nextTime.getTime() - now.getTime()) / 1000));                    if (secondsLeft > 0) {            setShowResults(true);            setNextQuestionCountdown(secondsLeft);          }        }                // Handle game finished        if (data.gameData?.phase === 'finished') {          setShowResults(true);          setNextQuestionCountdown(null);        }      }    });    // Cleanup function    return () => {      unsubscribe();      if (timerRef.current) {        window.clearTimeout(timerRef.current);        timerRef.current = null;      }      if (countdownRef.current) {        window.clearTimeout(countdownRef.current);        countdownRef.current = null;      }      if (gameStartRef.current) {        window.clearTimeout(gameStartRef.current);        gameStartRef.current = null;      }    };  }, [roomData?.id, gameStartCountdown, timePerQuestion]);  // Sync all players' scores and answers from server data  useEffect(() => {    if (!currentRoomData?.questionAnswers) return;    const serverPlayerScores: {[playerId: string]: number} = {};    const serverPlayerAnswers: {[playerId: string]: PlayerAnswer[]} = {};    // Calculate scores and answers from server data for ALL players    Object.values(currentRoomData.questionAnswers).forEach(questionData => {      Object.entries(questionData).forEach(([playerId, answerData]: [string, PlayerAnswer]) => {        // Calculate scores        serverPlayerScores[playerId] = (serverPlayerScores[playerId] || 0) + (answerData.pointsEarned || 0);                // Track answer history        if (!serverPlayerAnswers[playerId]) {          serverPlayerAnswers[playerId] = [];        }        serverPlayerAnswers[playerId].push({          questionId: answerData.questionId,          selectedAnswer: answerData.selectedAnswer,          isCorrect: answerData.isCorrect,          timeSpent: answerData.timeToAnswer || answerData.timeSpent,          timeToAnswer: answerData.timeToAnswer || answerData.timeSpent || 0,          pointsEarned: answerData.pointsEarned || 0,          points: answerData.pointsEarned || 0,          timestamp: answerData.timestamp || Date.now()        });      });    });        // Update state with server data for all players    setPlayerScores(serverPlayerScores);    setPlayerAnswers(serverPlayerAnswers);  }, [currentRoomData?.questionAnswers]);  // Game start countdown effect  useEffect(() => {    if (gameStartCountdown !== null && gameStartCountdown > 0) {      gameStartRef.current = window.setTimeout(() => {        setGameStartCountdown(prev => {          const newCount = (prev ?? 0) - 1;          return newCount;        });      }, 1000);    } else if (gameStartCountdown === 0) {      // Countdown finished - game should start      setGameStartCountdown(null);    }        return () => {      if (gameStartRef.current) {        window.clearTimeout(gameStartRef.current);        gameStartRef.current = null;      }    };  }, [gameStartCountdown]);  // Question timer countdown effect  useEffect(() => {    if (questionTimeLeft !== null && questionTimeLeft > 0 && realtimeGameData?.phase === 'question') {      const timer = window.setTimeout(() => {        setQuestionTimeLeft(prev => {          const newTime = (prev ?? 0) - 1;          return newTime;        });      }, 1000);            return () => window.clearTimeout(timer);    }  }, [questionTimeLeft, realtimeGameData?.phase]);  // Get current game phase from room data  const currentGamePhase = realtimeGameData?.phase || gamePhase;  const currentRoomStatus = realtimeRoomData?.status || roomStatus;  // Save final results to server when game finishes  // Convert quiz format from Firestore to multiplayer format (using index-based answers)  const processedQuestions = useMemo((): ProcessedQuestion[] => {    const rawQuestions = currentGameData?.questions || [];        return rawQuestions.map((q: Question): ProcessedQuestion => {      let options: string[] = [];      let correctIndex = 0;      if (q.answers && Array.isArray(q.answers)) {        options = q.answers.map(a => a.text);        correctIndex = q.answers.findIndex(a => a.isCorrect);      } else if (q.options && Array.isArray(q.options)) {        options = q.options;        correctIndex = 0;      }      return {        id: q.id || `q${rawQuestions.indexOf(q)}`,        title: q.text || q.title || '',        options,        correct: correctIndex,        type: q.type || 'multiple',        points: q.points || 10,        explanation: ''      };    });  }, [currentGameData?.questions]);  useEffect(() => {    const saveFinalResults = async () => {      if (currentGamePhase === 'finished' && currentUser?.uid && currentRoomData?.id) {        try {          const myAnswers = playerAnswers[currentUser.uid] || [];          const myScore = playerScores[currentUser.uid] || 0;          const correctAnswers = myAnswers.filter(a => a.isCorrect).length;          const totalQuestions = processedQuestions.length;          const percentage = totalQuestions > 0 ? (correctAnswers / totalQuestions) * 100 : 0;          // Save to quiz_results collection          await addDoc(collection(db, 'quiz_results'), {            userId: currentUser.uid,            quizId: currentRoomData.quiz?.id || currentRoomData.id,            quizTitle: currentRoomData.quiz?.title || 'Multiplayer Quiz',            mode: 'multiplayer',            roomId: currentRoomData.id,            score: myScore,            correctAnswers,            totalQuestions,            percentage: Math.round(percentage * 10) / 10,            timeSpent: myAnswers.reduce<number>((sum, a) => sum + (a.timeSpent || 0), 0),            completedAt: serverTimestamp(),            answers: myAnswers.map((a, index) => ({              questionId: processedQuestions[index]?.id || `q${index}`,              questionText: processedQuestions[index]?.title || '',              selectedAnswer: a.selectedAnswer,              isCorrect: a.isCorrect,              timeSpent: a.timeSpent || 0,              points: a.points || 0            }))          });          logger.success('Multiplayer results saved successfully');        } catch (error) {          logger.error('Failed to save multiplayer results', error);          toast.error('Failed to save your results');        }      }    };        saveFinalResults();  }, [currentGamePhase, currentUser?.uid, currentRoomData?.id, currentRoomData?.quiz, playerAnswers, playerScores, processedQuestions]);  // Get current question  const currentQuestionIndex = currentGameData?.currentQuestionIndex || 0;  const currentQuestion = processedQuestions[currentQuestionIndex];  // Fallback for missing question data  const finalQuestion: ProcessedQuestion = useMemo(() => currentQuestion || {    id: 'error',    title: 'No question available',    options: ['Please wait...'],    correct: 0,    explanation: 'Question loading...'  }, [currentQuestion]);  // Countdown timer (optimized - minimal dependencies)  useEffect(() => {    if (locked || showResults || timeLeft <= 0) return;        timerRef.current = window.setTimeout(() => {      setTimeLeft(prev => prev - 1);    }, 1000);    return () => {      if (timerRef.current) {        window.clearTimeout(timerRef.current);        timerRef.current = null;      }    };  }, [timeLeft, locked, showResults]);  // Submit answer function - defined before useEffect that uses it  const handleSubmit = useCallback(async (answerIndex?: number) => {    const indexToSubmit = answerIndex !== undefined ? answerIndex : selectedIndex;    if (locked) return; // Prevent double submission        setLocked(true);        if (!multiplayerService || !currentRoomData?.id || !finalQuestion?.id || !currentUser?.uid) {      console.warn('Cannot submit answer - missing data:', {         hasService: !!multiplayerService,         roomId: currentRoomData?.id,         questionId: finalQuestion?.id,        userId: currentUser?.uid      });      setLocked(false); // Allow retry      return;    }        try {      const timeSpent = timePerQuestion - timeLeft;      const isCorrect = indexToSubmit !== null ? indexToSubmit === finalQuestion.correct : false;      const points = isCorrect ? Math.max(10, Math.floor(100 - (timeSpent * 2))) : 0; // 10-100 points based on speed            // Update client-side scores immediately for fast UI response      setPlayerScores(prev => ({        ...prev,        [currentUser.uid]: (prev[currentUser.uid] || 0) + points      }));            // Store current question answer for real-time leaderboard during results      setCurrentQuestionAnswers(prev => ({        ...prev,        [currentUser.uid]: {          selectedAnswer: indexToSubmit ?? -1,          answer: `${indexToSubmit ?? -1}`,          timeToAnswer: timeSpent,          timeSpent,          isCorrect,          pointsEarned: points,          points,          timestamp: Date.now()        }      }));            // Update player's answer history      setPlayerAnswers(prev => ({        ...prev,        [currentUser.uid]: [          ...(prev[currentUser.uid] || []),          {            questionId: finalQuestion.id,            selectedAnswer: indexToSubmit ?? -1,            answer: `${indexToSubmit ?? -1}`,            timeToAnswer: timeSpent,            timeSpent,            isCorrect,            pointsEarned: points,            points,            timestamp: Date.now()          }        ]      }));            // Submit to server (for sync with other players) - only if answer was selected      if (indexToSubmit !== null) {        await multiplayerService.submitAnswer(currentRoomData.id, finalQuestion.id, indexToSubmit, timeSpent);      }            // Set waiting state      setWaitingForOthers(true);            // Show results after 1 second      setTimeout(() => {        setQuestionResults({          isCorrect,          correctAnswer: finalQuestion.correct,          selectedAnswer: indexToSubmit ?? -1,          points,          explanation: finalQuestion.explanation || ''        });        setShowResults(true);      }, 1000);          } catch (error) {      console.error('Error submitting answer:', error);      setLocked(false); // Allow retry on error    }  }, [selectedIndex, locked, multiplayerService, currentRoomData, finalQuestion, currentUser, timePerQuestion, timeLeft]);  // Handle time up  useEffect(() => {    if (timeLeft <= 0 && !locked) {      // Auto-submit with selected answer, or undefined if no selection      handleSubmit(selectedIndex ?? undefined);    }  }, [timeLeft, locked, handleSubmit, selectedIndex]);  // Next question countdown (server-controlled)  useEffect(() => {    if (nextQuestionCountdown === null || nextQuestionCountdown <= 0) return;        countdownRef.current = window.setTimeout(() => {      setNextQuestionCountdown(prev => prev !== null ? prev - 1 : null);    }, 1000);    return () => {      if (countdownRef.current) {        window.clearTimeout(countdownRef.current);        countdownRef.current = null;      }    };  }, [nextQuestionCountdown]);  const handleSelect = (answerIndex: number) => {    if (locked) return;    setSelectedIndex(answerIndex);    // Auto-submit immediately after selection (like MultiplayerGameSimple)    setTimeout(() => handleSubmit(answerIndex), 100);  };    // Calculate progress percentage with proper pathLength  const progressPercent = useMemo(() => {    return Math.max(0, Math.min(100, Math.round((timeLeft / timePerQuestion) * 100)));  }, [timeLeft, timePerQuestion]);  // SVG circle properties for accurate progress  const radius = 16;  const circumference = 2 * Math.PI * radius;  const strokeDashoffset = circumference - (progressPercent / 100) * circumference;  return (    <div className=\"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-blue-100 p-2 sm:p-4 lg:p-6\">      <div className=\"max-w-4xl mx-auto\">                {/* Game Start Countdown Phase */}        {currentRoomStatus === 'starting' && gameStartCountdown !== null && gameStartCountdown >= 0 && (          <div className=\"bg-white rounded-2xl shadow-xl p-8 text-center mb-6\">            // eslint-disable-next-line i18next/no-literal-string            <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Game Starting Soon!</h2>            <div className=\"text-6xl font-bold text-purple-600 mb-4\">{gameStartCountdown}</div>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600\">Get ready to answer questions!</p>          </div>        )}        {/* Question Results Phase */}        {currentGamePhase === 'results' && questionResults && (          <div className=\"bg-white rounded-2xl shadow-xl p-6 mb-6\">            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-xl font-bold text-gray-800 mb-4 text-center\">Question Results</h3>                        {/* Your Result */}            <div className=\"mb-6 p-4 bg-blue-50 rounded-xl border border-blue-200\">              <div className=\"text-center\">                <div className={`text-2xl font-bold mb-2 ${questionResults.isCorrect ? 'text-green-600' : 'text-red-600'}`}>                  {questionResults.isCorrect ? '‚úÖ Correct!' : '‚ùå Wrong!'}                </div>                // eslint-disable-next-line i18next/no-literal-string                <div className=\"text-lg text-gray-700 mb-2\">                  // eslint-disable-next-line i18next/no-literal-string                  You earned <span className=\"font-bold text-blue-600\">+{questionResults.points}</span> points                </div>                // eslint-disable-next-line i18next/no-literal-string                <div className=\"text-sm text-gray-600\">                  Correct Answer: <span className=\"font-semibold\">{finalQuestion.options?.[questionResults.correctAnswer] || 'N/A'}</span>                </div>                {questionResults.explanation && (                  <SafeHTML content={questionResults.explanation} className=\"text-xs text-gray-500 mt-2\" />                )}              </div>            </div>            {/* Live Leaderboard */}            <div className=\"mb-4\">              // eslint-disable-next-line i18next/no-literal-string              <h4 className=\"font-semibold text-gray-700 mb-3 text-center\">Current Standings</h4>              <div className=\"space-y-2 max-h-60 overflow-y-auto\">                {(currentRoomData?.players || [])                  .map((player: Player) => ({                    ...player,                    score: playerScores[player.id] || 0                  }))                  .sort((a, b) => b.score - a.score)                  .map((player, index) => {                    const isCurrentUser = player.id === currentUser?.uid;                    const position = index + 1;                    const trophy = position === 1 ? 'üëë' : position === 2 ? 'ü•à' : position === 3 ? 'ü•â' : 'üèÖ';                    const currentAnswer = currentQuestionAnswers[player.id];                    const correctAnswersCount = playerAnswers[player.id]?.filter(a => a.isCorrect).length || 0;                                        return (                      <div                         key={player.id}                         className={`flex items-center justify-between p-3 rounded-lg ${                          isCurrentUser ? 'bg-blue-100 border border-blue-300' : 'bg-gray-50'                        }`}                      >                        <div className=\"flex items-center gap-2\">                          <span className=\"text-lg\">{trophy}</span>                          <div>                            <div className={`font-medium text-sm ${isCurrentUser ? 'text-blue-700' : 'text-gray-800'}`}>                              #{position} {isCurrentUser                                 ? (currentUserName || player?.username || player?.name || 'You')                                : (player?.username || player?.name || player?.displayName || `Player ${position}`)                              }                              // eslint-disable-next-line i18next/no-literal-string                              {isCurrentUser && <span className=\"ml-1 text-xs\">(You)</span>}                            </div>                            <div className=\"text-xs text-gray-500\">                              // eslint-disable-next-line i18next/no-literal-string                              {correctAnswersCount} ƒë√∫ng ‚Ä¢ {player.score} ƒëi·ªÉm                              {currentAnswer && (                                <span className={`ml-2 ${currentAnswer.isCorrect ? 'text-green-600' : 'text-red-600'}`}>                                  {currentAnswer.isCorrect ? '‚úì' : '‚úó'} +{currentAnswer.points}                                </span>                              )}                            </div>                          </div>                        </div>                        <div className={`text-right ${isCurrentUser ? 'text-blue-700' : 'text-gray-700'}`}>                          <div className=\"font-bold text-sm\">{player.score}</div>                          // eslint-disable-next-line i18next/no-literal-string                          <div className=\"text-xs text-gray-500\">pts</div>                        </div>                      </div>                    );                  })}              </div>            </div>                        {nextQuestionCountdown !== null && (              <div className=\"mt-4 text-center\">                {nextQuestionCountdown > 0 ? (                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-gray-600\">C√¢u h·ªèi ti·∫øp theo trong: <span className=\"font-bold text-blue-600\">{nextQuestionCountdown}s</span></p>                ) : (                  <p className=\"text-gray-600\">ƒêang ch·ªù ng∆∞·ªùi ch∆°i kh√°c...</p>                )}              </div>            )}          </div>        )}        {/* Final Results Phase - Ultra Modern Leaderboard */}        {currentGamePhase === 'finished' && (          <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4\">            <div className=\"max-w-4xl mx-auto\">                            {/* Trophy Header */}              <div className=\"text-center mb-8\">                <div className=\"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mb-4 shadow-2xl\">                  <span className=\"text-4xl\">üèÜ</span>                </div>                // eslint-disable-next-line i18next/no-literal-string                <h1 className=\"text-5xl font-black text-white mb-2 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent\">                  GAME COMPLETE!                </h1>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xl text-blue-200\">Amazing performance by all players</p>              </div>              {/* Champion Podium */}              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">                {Object.entries(playerScores)                  .sort(([,a], [,b]) => b - a)                  .slice(0, 3)                  .map(([playerId, score], index) => {                    const player = currentRoomData?.players?.find((p: Player) => p.id === playerId);                    const isCurrentUser = playerId === currentUser?.uid;                    const position = index + 1;                    const playerAnswerHistory = playerAnswers[playerId] || [];                    const correctAnswers = playerAnswerHistory.filter(a => a.isCorrect).length;                    const totalQuestions = processedQuestions.length;                    const accuracy = totalQuestions > 0 ? Math.round((correctAnswers/totalQuestions)*100) : 0;                                        const podiumData = {                      1: {                         trophy: 'ü•á',                         color: 'from-yellow-400 to-yellow-600',                         bgColor: 'from-yellow-50 to-orange-50',                        borderColor: 'border-yellow-400',                        height: 'h-32'                      },                      2: {                         trophy: 'ü•à',                         color: 'from-gray-400 to-gray-600',                         bgColor: 'from-gray-50 to-slate-50',                        borderColor: 'border-gray-400',                        height: 'h-24'                      },                      3: {                         trophy: 'ü•â',                         color: 'from-amber-600 to-amber-800',                         bgColor: 'from-amber-50 to-yellow-50',                        borderColor: 'border-amber-500',                        height: 'h-20'                      }                    };                                        const podium = podiumData[position as keyof typeof podiumData];                                        return (                      <div key={playerId} className=\"text-center\">                        <div className={`bg-white rounded-2xl shadow-2xl border-4 ${podium.borderColor} overflow-hidden transform hover:scale-105 transition-all duration-300 ${isCurrentUser ? 'ring-4 ring-blue-400' : ''}`}>                                                    {/* Podium Height Indicator */}                          <div className={`bg-gradient-to-r ${podium.color} ${podium.height} flex items-end justify-center pb-4`}>                            <span className=\"text-6xl\">{podium.trophy}</span>                          </div>                                                    {/* Player Info */}                          <div className={`bg-gradient-to-r ${podium.bgColor} p-6`}>                            <div className=\"text-2xl font-bold text-gray-800 mb-1\">                              #{position}                            </div>                            <div className={`text-lg font-semibold mb-2 ${isCurrentUser ? 'text-blue-700' : 'text-gray-700'}`}>                              {player?.username || player?.name || 'Player'}                              // eslint-disable-next-line i18next/no-literal-string                              {isCurrentUser && <div className=\"text-sm text-blue-600 font-medium\">(You)</div>}                            </div>                                                        {/* Score Display */}                            <div className=\"bg-white rounded-xl p-4 mb-3 shadow-inner\">                              <div className=\"text-3xl font-black text-gray-800\">{score}</div>                              <div className=\"text-sm text-gray-600 font-medium\">POINTS</div>                            </div>                                                        {/* Stats */}                            <div className=\"grid grid-cols-2 gap-2 text-xs\">                              <div className=\"bg-white rounded-lg p-2\">                                <div className=\"font-bold text-green-600\">{correctAnswers}</div>                                // eslint-disable-next-line i18next/no-literal-string                                <div className=\"text-gray-600\">Correct</div>                              </div>                              <div className=\"bg-white rounded-lg p-2\">                                <div className=\"font-bold text-blue-600\">{accuracy}%</div>                                // eslint-disable-next-line i18next/no-literal-string                                <div className=\"text-gray-600\">Accuracy</div>                              </div>                            </div>                          </div>                        </div>                      </div>                    );                  })}              </div>              {/* Complete Leaderboard */}              <div className=\"bg-white rounded-3xl shadow-2xl p-8 mb-8\">                // eslint-disable-next-line i18next/no-literal-string                <h2 className=\"text-3xl font-black text-gray-800 mb-6 text-center\">                  üèÖ COMPLETE RANKINGS                </h2>                                <div className=\"space-y-3\">                  {Object.entries(playerScores)                    .sort(([,a], [,b]) => b - a)                    .map(([playerId, score], index) => {                      const player = currentRoomData?.players?.find((p: Player) => p.id === playerId);                      const isCurrentUser = playerId === currentUser?.uid;                      const position = index + 1;                      const playerAnswerHistory = playerAnswers[playerId] || [];                      const correctAnswers = playerAnswerHistory.filter(a => a.isCorrect).length;                      const totalQuestions = processedQuestions.length;                      const accuracy = totalQuestions > 0 ? Math.round((correctAnswers/totalQuestions)*100) : 0;                      const avgTimePerQuestion = playerAnswerHistory.length > 0 ?                         Math.round(playerAnswerHistory.reduce((sum, a) => sum + (a.timeSpent || 0), 0) / playerAnswerHistory.length) : 0;                                            const positionColors = {                        1: 'bg-gradient-to-r from-yellow-100 to-orange-100 border-yellow-400',                        2: 'bg-gradient-to-r from-gray-100 to-slate-100 border-gray-400',                         3: 'bg-gradient-to-r from-amber-100 to-yellow-100 border-amber-400'                      };                                            const defaultColor = isCurrentUser ?                         'bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-400' :                         'bg-white border-gray-200';                                            const cardColor = positionColors[position as keyof typeof positionColors] || defaultColor;                                            return (                        <div                           key={playerId}                          className={`${cardColor} border-2 rounded-2xl p-4 transform hover:scale-102 transition-all duration-200 shadow-lg hover:shadow-xl`}                        >                          <div className=\"flex items-center justify-between\">                                                        {/* Left: Rank & Player Info */}                            <div className=\"flex items-center gap-4\">                              <div className=\"text-center\">                                <div className={`w-12 h-12 rounded-full flex items-center justify-center font-black text-lg ${                                  position <= 3 ? 'bg-gradient-to-r from-purple-500 to-blue-600 text-white' : 'bg-gray-200 text-gray-700'                                }`}>                                  #{position}                                </div>                              </div>                                                            <div>                                <div className={`text-xl font-bold ${isCurrentUser ? 'text-blue-700' : 'text-gray-800'}`}>                                  {player?.username || player?.name || 'Player'}                                  {isCurrentUser && <span className=\"ml-2 text-sm bg-blue-500 text-white px-2 py-1 rounded-full\">YOU</span>}                                </div>                                <div className=\"text-sm text-gray-600\">                                  // eslint-disable-next-line i18next/no-literal-string                                  {correctAnswers}/{totalQuestions} correct ‚Ä¢ {accuracy}% accuracy ‚Ä¢ Avg: {avgTimePerQuestion}s                                </div>                              </div>                            </div>                                                        {/* Right: Score */}                            <div className=\"text-right\">                              <div className={`text-3xl font-black ${isCurrentUser ? 'text-blue-700' : 'text-gray-800'}`}>                                {score}                              </div>                              <div className=\"text-sm text-gray-600 font-medium\">POINTS</div>                            </div>                          </div>                        </div>                      );                    })}                </div>              </div>              {/* Game Statistics */}              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">                <div className=\"bg-white rounded-2xl p-6 text-center shadow-xl\">                  <div className=\"text-3xl mb-2\">üìù</div>                  <div className=\"text-2xl font-bold text-gray-800\">{processedQuestions.length}</div>                  // eslint-disable-next-line i18next/no-literal-string                  <div className=\"text-sm text-gray-600 font-medium\">Total Questions</div>                </div>                <div className=\"bg-white rounded-2xl p-6 text-center shadow-xl\">                  <div className=\"text-3xl mb-2\">üë•</div>                  <div className=\"text-2xl font-bold text-gray-800\">{Object.keys(playerScores).length}</div>                  // eslint-disable-next-line i18next/no-literal-string                  <div className=\"text-sm text-gray-600 font-medium\">Players</div>                </div>                <div className=\"bg-white rounded-2xl p-6 text-center shadow-xl\">                  <div className=\"text-3xl mb-2\">‚úÖ</div>                  <div className=\"text-2xl font-bold text-gray-800\">                    {playerAnswers[currentUser?.uid || '']?.filter(a => a.isCorrect).length || 0}                  </div>                  // eslint-disable-next-line i18next/no-literal-string                  <div className=\"text-sm text-gray-600 font-medium\">Your Correct</div>                </div>                <div className=\"bg-white rounded-2xl p-6 text-center shadow-xl\">                  <div className=\"text-3xl mb-2\">üéØ</div>                  <div className=\"text-2xl font-bold text-gray-800\">                    {playerScores[currentUser?.uid || ''] || 0}                  </div>                  // eslint-disable-next-line i18next/no-literal-string                  <div className=\"text-sm text-gray-600 font-medium\">Your Score</div>                </div>              </div>              {/* Action Buttons */}              <div className=\"text-center\">                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-xl text-blue-200 mb-6\">Thanks for playing! üéâ</p>                <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">                  <button                     onClick={() => window.location.href = '/multiplayer'}                    className=\"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-4 rounded-2xl font-bold text-lg hover:from-purple-700 hover:to-blue-700 transform hover:scale-105 transition-all duration-200 shadow-2xl hover:shadow-purple-500/25\"                  // eslint-disable-next-line i18next/no-literal-string                  >                    üéÆ Play Again                  </button>                  <button                     onClick={() => window.location.href = '/profile'}                    className=\"bg-gradient-to-r from-gray-600 to-gray-700 text-white px-8 py-4 rounded-2xl font-bold text-lg hover:from-gray-700 hover:to-gray-800 transform hover:scale-105 transition-all duration-200 shadow-2xl\"                  // eslint-disable-next-line i18next/no-literal-string                  >                    üë§ View Profile                  </button>                  <button                     onClick={() => window.location.href = '/leaderboard'}                    className=\"bg-gradient-to-r from-green-600 to-teal-600 text-white px-8 py-4 rounded-2xl font-bold text-lg hover:from-green-700 hover:to-teal-700 transform hover:scale-105 transition-all duration-200 shadow-2xl\"                  // eslint-disable-next-line i18next/no-literal-string                  >                    üèÜ Global Leaderboard                  </button>                </div>              </div>                          </div>          </div>        )}        {/* Regular Game UI - show when ready to play */}        {((currentRoomStatus === 'playing' && currentGamePhase === 'question') ||           (currentRoomStatus === 'starting' && gameStartCountdown === 0)) &&          currentGamePhase !== 'finished' &&          processedQuestions.length > 0 && (          <>        {/* Header */}        <div className=\"bg-white rounded-2xl shadow-xl p-4 sm:p-6 mb-4 sm:mb-6\">          <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4\">            <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4\">              // eslint-disable-next-line i18next/no-literal-string              <div className=\"bg-gradient-to-r from-purple-500 to-blue-600 text-white px-3 sm:px-4 py-2 rounded-xl font-bold text-sm sm:text-base text-center\">                // eslint-disable-next-line i18next/no-literal-string                Question {currentQuestionIndex + 1} of {processedQuestions.length}              </div>              <div className=\"flex items-center gap-2 text-gray-600 justify-center sm:justify-start\">                <Users size={18} />                // eslint-disable-next-line i18next/no-literal-string                <span className=\"text-sm sm:text-base\">{currentRoomData?.players?.length || 0} players</span>              </div>            </div>                        <div className=\"flex flex-col sm:flex-row items-center gap-2 sm:gap-4\">              {locked && (                <div className=\"flex items-center gap-2 bg-green-100 text-green-700 px-3 py-2 rounded-xl font-medium text-sm\">                  <CheckCircle size={16} />                  // eslint-disable-next-line i18next/no-literal-string                  <span>Submitted!</span>                </div>              )}                            <div className=\"flex items-center gap-2 sm:gap-3\">                <div className={`flex items-center gap-2 px-3 sm:px-4 py-2 rounded-xl font-bold text-sm sm:text-base ${                  timeLeft <= 5 ? 'bg-red-100 text-red-700' : 'bg-blue-100 text-blue-700'                }`}>                  <Clock size={16} />                  // eslint-disable-next-line i18next/no-literal-string                  <span>{timeLeft}s</span>                </div>                                <div className=\"relative w-12 h-12 sm:w-16 sm:h-16\">                  <svg className=\"w-12 h-12 sm:w-16 sm:h-16 transform -rotate-90\" viewBox=\"0 0 36 36\">                    <circle cx=\"18\" cy=\"18\" r=\"16\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"3\"/>                    <circle                       cx=\"18\" cy=\"18\" r=\"16\" fill=\"none\"                       stroke={timeLeft <= 5 ? \"#ef4444\" : \"#3b82f6\"}                      strokeWidth=\"3\"                       strokeLinecap=\"round\"                      strokeDasharray={circumference}                      strokeDashoffset={strokeDashoffset}                      className=\"transition-all duration-1000\"                    />                  </svg>                  <div className=\"absolute inset-0 flex items-center justify-center\">                    <span className={`text-xs font-bold ${timeLeft <= 5 ? 'text-red-600' : 'text-blue-600'}`}>                      {progressPercent}%                    </span>                  </div>                </div>              </div>            </div>          </div>                    {timeLeft <= 10 && !locked && (            <div className=\"bg-orange-100 border-l-4 border-orange-500 p-4 rounded-r-lg mb-4\">              <div className=\"flex items-center gap-2 text-orange-700\">                <AlertCircle size={18} />                // eslint-disable-next-line i18next/no-literal-string                <span className=\"font-medium\">Time is running out!</span>              </div>            </div>          )}                    {waitingForOthers && (            <div className=\"bg-blue-100 border-l-4 border-blue-500 p-4 rounded-r-lg mb-4\">              <div className=\"flex items-center gap-2 text-blue-700\">                <Clock size={18} />                <span className=\"font-medium\">Waiting for other players...</span>              </div>            </div>          )}        </div>        {/* Question */}        <div className=\"bg-white rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8\">          <div className=\"text-center mb-6 sm:mb-8\">            <h2 className=\"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800 mb-4\">              {finalQuestion.title || 'No question available'}            </h2>            <div className=\"w-12 sm:w-16 h-1 bg-gradient-to-r from-purple-500 to-blue-600 mx-auto rounded-full\"></div>          </div>                    {/* Show message if no options */}          {(!finalQuestion.options || finalQuestion.options.length === 0) && (            <div className=\"text-center p-8 bg-gray-50 rounded-xl\">              <p className=\"text-gray-600\">Waiting for question options to load...</p>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-sm text-gray-500 mt-2\">                // eslint-disable-next-line i18next/no-literal-string                Questions available: {processedQuestions.length} | Current index: {currentQuestionIndex}              </p>            </div>          )}                    {/* Show options if available */}          {finalQuestion.options && finalQuestion.options.length > 0 ? (            <div className=\"grid gap-3 sm:gap-4 mb-6 sm:mb-8\">              {finalQuestion.options.map((option: string, idx: number) => {                const isSelected = selectedIndex === idx;                const optionLabels = ['A', 'B', 'C', 'D'];                                return (                  <button                    key={idx}                    onClick={() => handleSelect(idx)}                    className={`group relative px-4 sm:px-6 py-3 sm:py-4 rounded-2xl text-left transition-all duration-200 transform hover:scale-105 ${                      isSelected                         ? 'border-2 border-blue-500 bg-gradient-to-r from-blue-50 to-indigo-50 shadow-lg'                         : 'border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md'                    } ${locked ? 'opacity-60 cursor-not-allowed transform-none' : ''}`}                    disabled={locked}                  >                    <div className=\"flex items-center gap-3 sm:gap-4\">                      <div className={`w-8 h-8 sm:w-10 sm:h-10 rounded-xl flex items-center justify-center font-bold text-xs sm:text-sm ${                        isSelected                           ? 'bg-blue-500 text-white'                           : 'bg-gray-100 text-gray-600 group-hover:bg-gray-200'                      }`}>                        {optionLabels[idx] || idx + 1}                      </div>                      <span className=\"font-medium text-gray-800 text-sm sm:text-base\">{option}</span>                    </div>                  </button>                );              })}            </div>          ) : (            <div className=\"bg-red-100 p-4 rounded-lg\">              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-red-700\">‚ùå No options available for this question</p>            </div>          )}            <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">              <div className=\"text-sm text-gray-500 text-center sm:text-left\">                {locked ? 'Answer submitted' :                  selectedIndex !== null ? 'Answer selected' :                  'Choose your answer'}              </div>                            {locked && (                <div className=\"flex items-center gap-2 bg-green-100 text-green-700 px-4 py-2 rounded-xl font-medium\">                  <CheckCircle size={16} />                  // eslint-disable-next-line i18next/no-literal-string                  <span>Submitted!</span>                </div>              )}            </div>        </div>        {/* Question Results Modal */}        {showResults && questionResults && (          <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\">            <div className=\"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 transform animate-in fade-in zoom-in-95 duration-300\">              <div className=\"text-center mb-6\">                <div className={`w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 ${                  questionResults.isCorrect                     ? 'bg-green-100 text-green-600'                     : 'bg-red-100 text-red-600'                }`}>                  {questionResults.isCorrect ? (                    <CheckCircle size={40} />                  ) : (                    <AlertCircle size={40} />                  )}                </div>                                <h3 className={`text-2xl font-bold mb-2 ${                  questionResults.isCorrect ? 'text-green-600' : 'text-red-600'                }`}>                  {questionResults.isCorrect ? 'üéâ Correct!' : '‚ùå Incorrect'}                </h3>                                <div className=\"text-3xl font-bold text-blue-600 mb-4\">                  // eslint-disable-next-line i18next/no-literal-string                  +{questionResults.points} points                </div>                                <SafeHTML content={questionResults.explanation} className=\"text-gray-600 mb-4\" />                                {nextQuestionCountdown !== null && (                  <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-4\">                    <div className=\"flex items-center justify-center gap-2 text-blue-700\">                      <Clock size={20} />                      <span className=\"font-semibold\">                        {nextQuestionCountdown > 0                           ? `C√¢u h·ªèi ti·∫øp theo trong ${nextQuestionCountdown} gi√¢y...`                          : \"ƒêang ch·ªù ng∆∞·ªùi ch∆°i kh√°c...\"                        }                      </span>                    </div>                  </div>                )}              </div>            </div>          </div>        )}        </>        )}      </div>    </div>  );};export default MultiplayerQuiz;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\QuizSelector.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":14828,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useEffect, useState } from 'react';import { collection, getDocs, query, where } from 'firebase/firestore';import { db, auth } from '../../../firebase/config';import { Search, BookOpen, Clock, Loader2 } from 'lucide-react';import { logger } from '../utils/logger';import { useTranslation } from 'react-i18next';interface QuizSelectorProps {  onSelectQuiz: (quiz: any) => void;  onBack: () => void;}const QuizSelector: React.FC<QuizSelectorProps> = ({ onSelectQuiz, onBack }) => {  const { t } = useTranslation();  const [quizzes, setQuizzes] = useState<any[]>([]);  const [loading, setLoading] = useState(true);  const [searchTerm, setSearchTerm] = useState('');  const [selectedCategory, setSelectedCategory] = useState<string>('all');  const [debugInfo, setDebugInfo] = useState<any>(null);  useEffect(() => {    const fetchQuizzes = async () => {      try {        logger.debug('[QuizSelector] Starting to fetch quizzes...', {          userId: auth.currentUser?.uid,          isAuthenticated: !!auth.currentUser        });                // Wait for auth to be ready        if (!auth.currentUser) {          logger.warn('[QuizSelector] Waiting for authentication...');          // Wait for auth state to initialize          const unsubscribe = auth.onAuthStateChanged((user) => {            if (user) {              logger.success('[QuizSelector] Auth ready', { userId: user.uid });              unsubscribe();              // Retry fetch after auth is ready              fetchQuizzesData();            } else {              logger.error('[QuizSelector] User not authenticated after waiting!');              setLoading(false);              unsubscribe();            }          });          return;        }                await fetchQuizzesData();      } catch (error) {        logger.error('[QuizSelector] Error in main fetch', error);        setLoading(false);      }    };    const fetchQuizzesData = async () => {      try {        setLoading(true);        const quizzesRef = query(          collection(db, 'quizzes'),          where('status', '==', 'approved')        );                logger.debug('[QuizSelector] Fetching APPROVED quizzes...', { userId: auth.currentUser?.uid });                // Fetch ONLY APPROVED quizzes (can be accessed by users)        const snapshot = await getDocs(quizzesRef);                logger.debug('[QuizSelector] Total approved quizzes found', { count: snapshot.size });                if (snapshot.empty) {          logger.warn('[QuizSelector] No approved quizzes found in database!');          setQuizzes([]);          return;        }                const quizzesData = snapshot.docs.map(doc => {          const data = doc.data();          return {            id: doc.id,            ...data          };        });                logger.debug('[QuizSelector] Total quizzes loaded', { count: quizzesData.length });                // Filter quizzes that have questions array with length > 0        const validQuizzes = quizzesData.filter((quiz: any) => {          const isValid = Array.isArray(quiz.questions) && quiz.questions.length > 0;          if (!isValid) {            logger.debug(`[QuizSelector] Quiz \"${quiz.title}\" (${quiz.id}) INVALID - no questions`);          }          return isValid;        });                logger.success('[QuizSelector] Valid quizzes for multiplayer', {           count: validQuizzes.length         });                // Set debug info        setDebugInfo({          totalFromDb: quizzesData.length,          validQuizzes: validQuizzes.length,          authUser: auth.currentUser?.uid,          timestamp: new Date().toISOString()        });                setQuizzes(validQuizzes);      } catch (error: any) {        logger.error('[QuizSelector] Error fetching quizzes', {          name: error.name,          message: error.message,          code: error.code        });      } finally {        setLoading(false);        logger.debug('[QuizSelector] Fetch completed');      }    };    fetchQuizzes();  }, []);  const categories = [    { value: 'all', label: 'T·∫•t c·∫£' },    { value: 'programming', label: 'L·∫≠p tr√¨nh' },    { value: 'math', label: 'To√°n h·ªçc' },    { value: 'science', label: 'Khoa h·ªçc' },    { value: 'history', label: 'L·ªãch s·ª≠' },    { value: 'language', label: 'Ng√¥n ng·ªØ' },    { value: 'general', label: 'T·ªïng h·ª£p' },  ];  const filteredQuizzes = quizzes.filter(quiz => {    const matchesSearch = quiz.title?.toLowerCase().includes(searchTerm.toLowerCase()) ||                         quiz.description?.toLowerCase().includes(searchTerm.toLowerCase());    const matchesCategory = selectedCategory === 'all' || quiz.category === selectedCategory;    return matchesSearch && matchesCategory;  });  const getDifficultyColor = (difficulty: string) => {    switch (difficulty) {      case 'easy': return 'text-green-600 bg-green-100';      case 'medium': return 'text-yellow-600 bg-yellow-100';      case 'hard': return 'text-red-600 bg-red-100';      default: return 'text-gray-600 bg-gray-100';    }  };  const getDifficultyLabel = (difficulty: string) => {    switch (difficulty) {      case 'easy': return 'D·ªÖ';      case 'medium': return 'Trung b√¨nh';      case 'hard': return 'Kh√≥';      default: return difficulty;    }  };  return (    <div className=\"fixed inset-0 bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 z-50 overflow-y-auto\">      <div className=\"min-h-screen p-4\">        <div className=\"max-w-6xl mx-auto\">          {/* Header */}          <div className=\"bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 p-6 mb-6\">            <div className=\"flex items-center justify-between mb-4\">              <div>                // eslint-disable-next-line i18next/no-literal-string                <h1 className=\"text-3xl font-bold text-white mb-2\">                  üéÆ Ch·ªçn Quiz ƒë·ªÉ ch∆°i Multiplayer                </h1>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-purple-200\">                  Ch·ªçn m·ªôt quiz ƒë·ªÉ t·∫°o ph√≤ng ho·∫∑c tham gia ch∆°i v·ªõi b·∫°n b√®                </p>              </div>              <button                onClick={onBack}                className=\"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors\"              // eslint-disable-next-line i18next/no-literal-string              >                ‚Üê Quay l·∫°i              </button>            </div>            {/* Search and Filter */}            <div className=\"flex flex-col sm:flex-row gap-4\">              {/* Search */}              <div className=\"flex-1 relative\">                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />                <input                  type=\"text\"                  value={searchTerm}                  onChange={(e) => setSearchTerm(e.target.value)}                  placeholder={t('placeholders.searchQuizzes')}                  className=\"w-full pl-10 pr-4 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-400\"                />              </div>              {/* Category Filter */}              <select                value={selectedCategory}                onChange={(e) => setSelectedCategory(e.target.value)}                className=\"px-4 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-400\"              >                {categories.map(cat => (                  <option key={cat.value} value={cat.value} className=\"bg-gray-800\">                    {cat.label}                  </option>                ))}              </select>            </div>          </div>          {/* Quiz Grid */}          {loading ? (            <div className=\"flex items-center justify-center py-20\">              <div className=\"text-center\">                <Loader2 className=\"w-12 h-12 text-white animate-spin mx-auto mb-4\" />                <p className=\"text-white\">ƒêang t·∫£i danh s√°ch quiz...</p>              </div>            </div>          ) : (            <>              {/* Debug Info Panel */}              {debugInfo && (                <div className=\"bg-yellow-500/20 backdrop-blur-md rounded-lg border border-yellow-500/40 p-4 mb-6\">                  // eslint-disable-next-line i18next/no-literal-string                  <h3 className=\"text-white font-bold mb-2\">üîç Debug Information:</h3>                  <div className=\"text-sm text-yellow-100 space-y-1\">                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚úÖ Auth User: {debugInfo.authUser}</p>                    // eslint-disable-next-line i18next/no-literal-string                    <p>üìä Total Quizzes in DB: {debugInfo.totalFromDb}</p>                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚úÖ Valid Quizzes (with questions): {debugInfo.validQuizzes}</p>                    // eslint-disable-next-line i18next/no-literal-string                    <p>‚è∞ Last Fetch: {new Date(debugInfo.timestamp).toLocaleTimeString()}</p>                  </div>                </div>              )}                            {filteredQuizzes.length === 0 ? (                <div className=\"bg-white/10 backdrop-blur-md rounded-2xl shadow-xl border border-white/20 p-12 text-center\">                  <BookOpen className=\"w-16 h-16 text-white/50 mx-auto mb-4\" />                  <h3 className=\"text-xl font-semibold text-white mb-2\">                    {quizzes.length === 0 ? 'Ch∆∞a c√≥ quiz n√†o' : 'Kh√¥ng t√¨m th·∫•y quiz'}                  </h3>                  <p className=\"text-purple-200 mb-4\">                    {quizzes.length === 0                       ? 'Hi·ªán t·∫°i ch∆∞a c√≥ quiz n√†o ƒë∆∞·ª£c duy·ªát. Vui l√≤ng quay l·∫°i sau ho·∫∑c t·∫°o quiz m·ªõi!'                      : 'Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c t·ª´ kh√≥a t√¨m ki·∫øm'                    }                  </p>                  {quizzes.length === 0 && (                    <button                      onClick={onBack}                      className=\"px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg transition-all\"                    // eslint-disable-next-line i18next/no-literal-string                    >                      ‚Üê Quay l·∫°i                    </button>                  )}                </div>              ) : (                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">              {filteredQuizzes.map((quiz) => (                <div                  key={quiz.id}                  onClick={() => onSelectQuiz(quiz)}                  className=\"group bg-white/10 backdrop-blur-md hover:bg-white/20 border border-white/20 hover:border-white/40 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 cursor-pointer overflow-hidden transform hover:scale-105\"                >                  {/* Quiz Image */}                  {quiz.imageUrl ? (                    <div className=\"h-40 overflow-hidden\">                      <img                        src={quiz.imageUrl}                        alt={quiz.title}                        className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"                      />                    </div>                  ) : (                    <div className=\"h-40 bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center\">                      <BookOpen className=\"w-16 h-16 text-white/50\" />                    </div>                  )}                  {/* Quiz Info */}                  <div className=\"p-6\">                    <h3 className=\"text-xl font-bold text-white mb-2 line-clamp-2 group-hover:text-purple-200 transition-colors\">                      {quiz.title}                    </h3>                                        {quiz.description && (                      <p className=\"text-purple-200 text-sm mb-4 line-clamp-2\">                        {quiz.description}                      </p>                    )}                    {/* Stats */}                    <div className=\"flex items-center gap-4 text-sm text-purple-200 mb-4\">                      <div className=\"flex items-center gap-1\">                        <BookOpen className=\"w-4 h-4\" />                        // eslint-disable-next-line i18next/no-literal-string                        <span>{quiz.questions?.length || 0} c√¢u</span>                      </div>                      <div className=\"flex items-center gap-1\">                        <Clock className=\"w-4 h-4\" />                        // eslint-disable-next-line i18next/no-literal-string                        <span>{quiz.duration || 15} ph√∫t</span>                      </div>                    </div>                    {/* Tags */}                    <div className=\"flex items-center gap-2 flex-wrap\">                      <span className={`px-2 py-1 rounded-lg text-xs font-medium ${getDifficultyColor(quiz.difficulty)}`}>                        {getDifficultyLabel(quiz.difficulty)}                      </span>                      {quiz.category && (                        <span className=\"px-2 py-1 rounded-lg text-xs font-medium bg-blue-100 text-blue-600\">                          {categories.find(c => c.value === quiz.category)?.label || quiz.category}                        </span>                      )}                      {quiz.quizType && (                        <span className=\"px-2 py-1 rounded-lg text-xs font-medium bg-purple-100 text-purple-600\">                          {quiz.quizType === 'with-materials' ? 'üìö C√≥ t√†i li·ªáu' : '‚ö° Nhanh'}                        </span>                      )}                    </div>                    {/* Play Button */}                    // eslint-disable-next-line i18next/no-literal-string                    <button className=\"mt-4 w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 transform group-hover:scale-105\">                      üéÆ Ch·ªçn Quiz n√†y                    </button>                  </div>                </div>              ))}                </div>              )}            </>          )}          {/* Results Count */}          {!loading && filteredQuizzes.length > 0 && (            <div className=\"mt-6 text-center\">              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-purple-200\">                // eslint-disable-next-line i18next/no-literal-string                Hi·ªÉn th·ªã {filteredQuizzes.length} quiz              </p>            </div>          )}        </div>      </div>    </div>  );};export default QuizSelector;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\RealtimeChat.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\RoomLobby.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":25564,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useMemo } from 'react';import { useTranslation } from 'react-i18next';import {   Users,   CheckCircle,   Clock,  Copy,  LogOut,  Sparkles,  Trophy,  Zap,  Shield,  Star} from 'lucide-react';import type { MultiplayerServiceInterface } from '../services/enhancedMultiplayerService';import realtimeService from '../services/realtimeMultiplayerService';interface Player {  id: string;  username: string;  isReady: boolean;  // Removed isHost - all players are equal  isOnline: boolean;  joinedAt: Date;}interface Room {  id: string;  code: string;  name: string;  // Removed hostId - all players are equal  players: Player[];  maxPlayers: number;  isPrivate: boolean;  status: 'waiting' | 'starting' | 'playing' | 'finished';  settings: {    timeLimit: number;    showLeaderboard: boolean;    allowLateJoin: boolean;  };}interface RoomLobbyProps {  roomData?: Room;  currentUserId: string;  onLeaveRoom: () => void;  multiplayerService?: MultiplayerServiceInterface;}const RoomLobby: React.FC<RoomLobbyProps> = ({  roomData,  currentUserId,  onLeaveRoom,  multiplayerService}) => {  const { t } = useTranslation();  const [copySuccess, setCopySuccess] = useState(false);  const [countdownData, setCountdownData] = useState<{ remaining: number; isActive: boolean } | null>(null);  const players = useMemo(() => roomData?.players || [], [roomData?.players]);  const readyCount = useMemo(() => players.filter(p => p.isReady).length, [players]);  const onlineCount = useMemo(() => players.filter(p => p.isOnline).length, [players]);  const allReady = useMemo(() => players.length >= 2 && players.every(p => p.isReady), [players]);  const currentPlayer = players.find(p => p.id === currentUserId);    // Log player updates for debugging  useEffect(() => {    console.log('üéÆ RoomLobby - Players updated:', {      total: players.length,      ready: readyCount,      allReady,      playerList: players.map(p => ({ id: p.id, username: p.username, isReady: p.isReady }))    });  }, [players, readyCount, allReady]);    // Listen to RTDB countdown (synchronized across all clients)  useEffect(() => {    if (!roomData?.id) return;    const unsubscribe = realtimeService.listenToCountdown(roomData.id, (data) => {      setCountdownData(data);            // When countdown reaches 0, start the game      if (data && data.remaining <= 0 && data.isActive) {        console.log('‚è∞ Countdown finished - starting game');        if (multiplayerService) {          multiplayerService.startGame(roomData.id).catch(err => {            console.error('Failed to start game:', err);          });        }        realtimeService.cancelCountdown(roomData.id);      }    });    return () => {      unsubscribe();    };  }, [roomData?.id, multiplayerService]);  // Start countdown when all players ready (only one player triggers it)  useEffect(() => {    if (allReady && players.length >= 2 && !countdownData) {      // Only the first player alphabetically starts countdown to avoid race condition      const sortedPlayers = [...players].sort((a, b) => a.id.localeCompare(b.id));      const shouldStartCountdown = sortedPlayers[0].id === currentUserId;            if (shouldStartCountdown && roomData?.id) {        console.log('üöÄ Starting countdown (triggered by first player)');        realtimeService.startCountdown(roomData.id, 5);        realtimeService.setGameStatus(roomData.id, 'starting');      }    } else if (!allReady && countdownData?.isActive) {      // Cancel countdown if someone unreadies      if (roomData?.id) {        console.log('‚ùå Cancelling countdown (player unreadied)');        realtimeService.cancelCountdown(roomData.id);        realtimeService.setGameStatus(roomData.id, 'waiting');      }    }  }, [allReady, players, countdownData, currentUserId, roomData?.id]);  const handleCopyRoomCode = async () => {    if (roomData?.code) {      try {        await navigator.clipboard.writeText(roomData.code);        setCopySuccess(true);        setTimeout(() => setCopySuccess(false), 2000);      } catch (err) {        console.error('Failed to copy room code:', err);      }    }  };  const handleToggleReady = async () => {    if (!multiplayerService || !roomData?.id) return;        const newReadyState = !currentPlayer?.isReady;    await multiplayerService.updatePlayerStatus(roomData.id, newReadyState);  };  if (!roomData) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto\"></div>          <p className=\"mt-4 text-gray-600\">{t('common.loading')}</p>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 relative overflow-hidden\">      {/* Subtle Background Pattern */}      <div className=\"absolute inset-0 opacity-30\" style={{        backgroundImage: `url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")`      }}></div>      {/* Floating Geometric Shapes - Hidden on mobile */}      <div className=\"absolute inset-0 overflow-hidden pointer-events-none hidden md:block\">        <div className=\"absolute top-20 left-20 w-64 h-64 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob\"></div>        <div className=\"absolute top-40 right-20 w-64 h-64 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000\"></div>        <div className=\"absolute -bottom-20 left-1/2 w-64 h-64 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000\"></div>      </div>      <div className=\"relative z-10 p-3 sm:p-4 lg:p-6 xl:p-8\">        <div className=\"max-w-7xl mx-auto\">          {/* Header Card */}          <div className=\"bg-white rounded-2xl lg:rounded-3xl shadow-xl border border-gray-100 p-4 sm:p-5 lg:p-8 mb-4 lg:mb-6\">            {/* Room Title Section */}            <div className=\"flex flex-col lg:flex-row lg:items-start justify-between gap-4 lg:gap-6 mb-4 lg:mb-6\">              <div className=\"flex-1\">                <div className=\"flex items-center gap-2 sm:gap-3 mb-3 lg:mb-4\">                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl lg:rounded-2xl flex items-center justify-center shadow-lg\">                    <Trophy className=\"w-5 h-5 sm:w-6 sm:h-6 lg:w-8 lg:h-8 text-white\" />                  </div>                  <div className=\"flex-1 min-w-0\">                    <h1 className=\"text-xl sm:text-2xl lg:text-3xl xl:text-4xl font-bold text-gray-800 mb-1 truncate\">                      {roomData.name}                    </h1>                    <p className=\"text-gray-500 text-xs sm:text-sm font-medium flex items-center gap-1 sm:gap-2\">                      <Sparkles className=\"w-3 h-3 sm:w-4 sm:h-4 text-indigo-500 flex-shrink-0\" />                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"truncate\">Multiplayer Quiz Room</span>                    </p>                  </div>                </div>                {/* Status Badges */}                <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">                  {/* Player Count */}                  <div className=\"bg-gradient-to-r from-blue-500 to-indigo-500 px-3 py-2 sm:px-4 sm:py-2.5 rounded-lg sm:rounded-xl flex items-center gap-1.5 sm:gap-2 shadow-md hover:shadow-lg transition-shadow\">                    <Users className=\"w-4 h-4 sm:w-5 sm:h-5 text-white flex-shrink-0\" />                    <span className=\"text-white font-bold text-sm sm:text-base\">{players.length}/{roomData.maxPlayers}</span>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-blue-50 text-xs sm:text-sm font-medium hidden sm:inline\">Players</span>                    <div className=\"hidden md:flex items-center gap-1 ml-1 pl-1 border-l border-blue-300\">                      <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-blue-50 text-xs font-medium\">{onlineCount} online</span>                    </div>                  </div>                  {/* Ready Count */}                  <div className=\"bg-gradient-to-r from-green-500 to-emerald-500 px-3 py-2 sm:px-4 sm:py-2.5 rounded-lg sm:rounded-xl flex items-center gap-1.5 sm:gap-2 shadow-md hover:shadow-lg transition-shadow\">                    <CheckCircle className=\"w-4 h-4 sm:w-5 sm:h-5 text-white flex-shrink-0\" />                    <span className=\"text-white font-bold text-sm sm:text-base\">{readyCount}</span>                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-green-50 text-xs sm:text-sm font-medium hidden sm:inline\">Ready</span>                  </div>                  {/* Room Code */}                  <button                    onClick={handleCopyRoomCode}                    className={`px-3 py-2 sm:px-4 sm:py-2.5 rounded-lg sm:rounded-xl flex items-center gap-1.5 sm:gap-2 shadow-md hover:shadow-lg transition-all hover:scale-105 ${                      copySuccess                        ? 'bg-gradient-to-r from-green-500 to-emerald-500'                        : 'bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600'                    }`}                  >                    <Copy className=\"w-4 h-4 sm:w-5 sm:h-5 text-white flex-shrink-0\" />                    <span className=\"text-white font-mono font-bold text-sm sm:text-base lg:text-lg\">{roomData.code}</span>                    {copySuccess && (                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-white text-xs font-semibold\">‚úì</span>                    )}                  </button>                </div>              </div>                            {/* Action Buttons */}              <div className=\"flex flex-col gap-2 sm:gap-3 w-full lg:w-auto\">                {/* Countdown Timer - Synced via RTDB */}                {countdownData && countdownData.isActive && countdownData.remaining > 0 && (                  <div className=\"bg-gradient-to-r from-orange-500 to-red-500 px-4 py-3 sm:px-6 sm:py-4 rounded-xl sm:rounded-2xl flex items-center justify-center gap-2 sm:gap-3 shadow-lg animate-pulse\">                    <Clock className=\"w-5 h-5 sm:w-6 sm:h-6 text-white flex-shrink-0\" />                    <div className=\"text-center\">                      <div className=\"text-2xl sm:text-3xl font-black text-white\">{countdownData.remaining}</div>                      <div className=\"text-xs text-orange-50 font-semibold\">{t('multiplayer.starting')}</div>                    </div>                  </div>                )}                                <div className=\"flex gap-2 sm:gap-3\">                  {/* Leave Button */}                  <button                    onClick={onLeaveRoom}                    className=\"flex-1 lg:flex-none px-4 py-2.5 sm:px-5 sm:py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-semibold transition-all hover:scale-105 flex items-center justify-center gap-2 shadow-md text-sm sm:text-base\"                  >                    <LogOut className=\"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0\" />                    // eslint-disable-next-line i18next/no-literal-string                    <span>Leave</span>                  </button>                                    {/* Ready Button */}                  <button                    onClick={handleToggleReady}                    className={`flex-1 lg:flex-none px-5 py-2.5 sm:px-8 sm:py-3 rounded-xl font-bold transition-all hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-sm sm:text-base ${                      currentPlayer?.isReady                        ? 'bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white'                        : 'bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white'                    }`}                  >                    {currentPlayer?.isReady ? (                      <>                        <Shield className=\"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0\" />                        // eslint-disable-next-line i18next/no-literal-string                        <span className=\"whitespace-nowrap\">Not Ready</span>                      </>                    ) : (                      <>                        <Zap className=\"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0\" />                        // eslint-disable-next-line i18next/no-literal-string                        <span className=\"whitespace-nowrap\">I'm Ready!</span>                      </>                    )}                  </button>                </div>              </div>            </div>            {/* Stats Cards */}            <div className=\"grid grid-cols-3 sm:grid-cols-3 gap-2 sm:gap-3 lg:gap-4\">              {/* Total Players */}              <div className=\"group bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-5 border border-blue-100 hover:border-blue-200 transition-all hover:shadow-md\">                <div className=\"flex flex-col sm:flex-row items-center sm:justify-between gap-2\">                  <div className=\"text-center sm:text-left\">                    <div className=\"text-2xl sm:text-3xl font-bold text-blue-600 mb-0.5 sm:mb-1\">{players.length}</div>                    // eslint-disable-next-line i18next/no-literal-string                    <div className=\"text-blue-600 text-xs sm:text-sm font-semibold\">Total</div>                  </div>                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform\">                    <Users className=\"w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-white\" />                  </div>                </div>              </div>              {/* Ready Players */}              <div className=\"group bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-5 border border-green-100 hover:border-green-200 transition-all hover:shadow-md\">                <div className=\"flex flex-col sm:flex-row items-center sm:justify-between gap-2\">                  <div className=\"text-center sm:text-left\">                    <div className=\"text-2xl sm:text-3xl font-bold text-green-600 mb-0.5 sm:mb-1\">{readyCount}</div>                    // eslint-disable-next-line i18next/no-literal-string                    <div className=\"text-green-600 text-xs sm:text-sm font-semibold\">Ready</div>                  </div>                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-green-500 to-emerald-500 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform\">                    <CheckCircle className=\"w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-white\" />                  </div>                </div>              </div>              {/* Time Limit */}              <div className=\"group bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-5 border border-purple-100 hover:border-purple-200 transition-all hover:shadow-md\">                <div className=\"flex flex-col sm:flex-row items-center sm:justify-between gap-2\">                  <div className=\"text-center sm:text-left\">                    // eslint-disable-next-line i18next/no-literal-string                    <div className=\"text-2xl sm:text-3xl font-bold text-purple-600 mb-0.5 sm:mb-1\">{roomData.settings.timeLimit}s</div>                    // eslint-disable-next-line i18next/no-literal-string                    <div className=\"text-purple-600 text-xs sm:text-sm font-semibold\">Time</div>                  </div>                  <div className=\"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform\">                    <Clock className=\"w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-white\" />                  </div>                </div>              </div>            </div>          </div>          {/* Players Grid */}          <div className=\"bg-white rounded-2xl lg:rounded-3xl shadow-xl border border-gray-100 p-4 sm:p-5 lg:p-8\">            <div className=\"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6\">              <div className=\"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0\">                <Users className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" />              </div>              // eslint-disable-next-line i18next/no-literal-string              <h2 className=\"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800\">Players</h2>              <div className=\"ml-auto bg-gradient-to-r from-blue-100 to-indigo-100 px-3 py-1 sm:px-4 sm:py-1.5 rounded-full\">                <span className=\"text-blue-700 font-bold text-xs sm:text-sm\">{players.length}/{roomData.maxPlayers}</span>              </div>            </div>            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4\">              {players.length === 0 ? (                <div className=\"col-span-full text-center py-12\">                  <div className=\"text-gray-400 text-lg mb-2\">üë•</div>                  <p className=\"text-gray-500 font-medium\">No players yet...</p>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-gray-400 text-sm mt-1\">Waiting for players to join</p>                </div>              ) : (                players.map((player, index) => {                const isCurrentUser = player.id === currentUserId;                                return (                  <div                    key={player.id}                    className={`group relative bg-gradient-to-br rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-5 border-2 transition-all hover:scale-105 hover:shadow-xl ${                      isCurrentUser                        ? 'from-blue-50 to-indigo-50 border-blue-200 shadow-blue-100 shadow-lg'                        : player.isReady                        ? 'from-green-50 to-emerald-50 border-green-200 shadow-green-100 shadow-md'                        : 'from-gray-50 to-slate-50 border-gray-200'                    }`}                    style={{                      animationDelay: `${index * 100}ms`                    }}                  >                    {/* \"You\" Badge */}                    {isCurrentUser && (                      <div className=\"absolute -top-1.5 -right-1.5 sm:-top-2 sm:-right-2 z-10\">                        <div className=\"bg-gradient-to-r from-yellow-400 to-orange-400 px-2 py-0.5 sm:px-3 sm:py-1 rounded-full flex items-center gap-1 sm:gap-1.5 shadow-lg animate-pulse\">                          <Star className=\"w-3 h-3 sm:w-3.5 sm:h-3.5 text-white fill-white flex-shrink-0\" />                          <span className=\"text-xs font-black text-white\">YOU</span>                        </div>                      </div>                    )}                    {/* Player Content */}                    <div className=\"flex items-center gap-3 sm:gap-4 mb-2 sm:mb-3\">                      {/* Avatar */}                      <div className=\"relative flex-shrink-0\">                        <div className={`w-12 h-12 sm:w-14 sm:h-14 lg:w-16 lg:h-16 rounded-xl sm:rounded-2xl flex items-center justify-center text-lg sm:text-xl lg:text-2xl font-bold shadow-lg ${                          isCurrentUser                            ? 'bg-gradient-to-br from-blue-500 to-indigo-500 text-white'                            : player.isReady                            ? 'bg-gradient-to-br from-green-500 to-emerald-500 text-white'                            : 'bg-gradient-to-br from-gray-400 to-slate-400 text-white'                        }`}>                          {player.username.charAt(0).toUpperCase()}                        </div>                                                {/* Online Indicator */}                        {player.isOnline && (                          <div className=\"absolute -bottom-0.5 -right-0.5 sm:-bottom-1 sm:-right-1 w-4 h-4 sm:w-5 sm:h-5 bg-green-500 rounded-full border-2 sm:border-3 border-white shadow-md\">                            <div className=\"w-full h-full bg-green-400 rounded-full animate-ping opacity-75\"></div>                          </div>                        )}                      </div>                      {/* Player Info */}                      <div className=\"flex-1 min-w-0\">                        <h3 className={`font-bold text-sm sm:text-base lg:text-lg truncate mb-0.5 sm:mb-1 ${                          isCurrentUser ? 'text-blue-700' : player.isReady ? 'text-green-700' : 'text-gray-700'                        }`}>                          {player.username}                        </h3>                        <div className=\"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-500\">                          <div className={`w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full flex-shrink-0 ${                            player.isOnline ? 'bg-green-500' : 'bg-gray-400'                          }`}></div>                          <span className=\"truncate\">{player.isOnline ? 'Online' : 'Offline'}</span>                        </div>                      </div>                    </div>                                        {/* Status Badge */}                    <div className=\"flex items-center gap-2\">                      {player.isReady ? (                        <div className=\"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 px-2 py-1.5 sm:px-3 sm:py-2 rounded-lg flex items-center justify-center gap-1 sm:gap-1.5 shadow-sm\">                          <CheckCircle className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 text-white animate-bounce flex-shrink-0\" />                          // eslint-disable-next-line i18next/no-literal-string                          <span className=\"text-xs font-bold text-white\">Ready!</span>                        </div>                      ) : (                        <div className=\"flex-1 bg-gradient-to-r from-gray-400 to-slate-400 px-2 py-1.5 sm:px-3 sm:py-2 rounded-lg flex items-center justify-center gap-1 sm:gap-1.5 shadow-sm\">                          <Clock className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 text-white flex-shrink-0\" />                          // eslint-disable-next-line i18next/no-literal-string                          <span className=\"text-xs font-bold text-white\">Waiting</span>                        </div>                      )}                    </div>                    {/* Decorative Element */}                    {player.isReady && (                      <div className=\"absolute bottom-1.5 right-1.5 sm:bottom-2 sm:right-2 opacity-10\">                        <Trophy className=\"w-6 h-6 sm:w-7 sm:h-7 lg:w-8 lg:h-8 text-green-600\" />                      </div>                    )}                  </div>                );              })              )}              {/* Empty Slots */}              {Array.from({ length: Math.max(0, roomData.maxPlayers - players.length) }).map((_, index) => (                <div                  key={`empty-${index}`}                  className=\"bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-5 border-2 border-dashed border-gray-200 hover:border-gray-300 transition-all\"                >                  <div className=\"flex items-center gap-3 sm:gap-4 opacity-40 mb-2 sm:mb-3\">                    <div className=\"w-12 h-12 sm:w-14 sm:h-14 lg:w-16 lg:h-16 bg-gray-200 rounded-xl sm:rounded-2xl flex items-center justify-center flex-shrink-0\">                      <Users className=\"w-6 h-6 sm:w-7 sm:h-7 lg:w-8 lg:h-8 text-gray-400\" />                    </div>                    <div className=\"flex-1 min-w-0\">                      <div className=\"h-3 sm:h-4 bg-gray-200 rounded-lg mb-1.5 sm:mb-2 w-3/4\"></div>                      <div className=\"h-2 sm:h-3 bg-gray-200 rounded-lg w-1/2\"></div>                    </div>                  </div>                  <div className=\"text-center text-gray-400 text-xs sm:text-sm font-medium\">                    Waiting for player...                    <span className=\"inline-flex ml-1\">                      <span className=\"animate-bounce\" style={{ animationDelay: '0ms' }}>.</span>                      <span className=\"animate-bounce\" style={{ animationDelay: '150ms' }}>.</span>                      <span className=\"animate-bounce\" style={{ animationDelay: '300ms' }}>.</span>                    </span>                  </div>                </div>              ))}            </div>          </div>        </div>      </div>    </div>  );};export default RoomLobby;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\components\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\pages\\MultiplayerLobby.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":18548,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { useNavigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { useTranslation } from 'react-i18next';import { RootState } from '../../../lib/store';import { collection, getDocs, query, where } from 'firebase/firestore';import { db, auth } from '../../../lib/firebase/config';import QuizCard, { QuizCardSkeleton } from '../../quiz/components/QuizCard';import { Quiz } from '../../quiz/types';import {   Gamepad2,   Users,   Zap,   Trophy,   ArrowLeft,   AlertCircle} from 'lucide-react';const MultiplayerLobby: React.FC = () => {  const { t } = useTranslation();  const navigate = useNavigate();  const { user } = useSelector((state: RootState) => state.auth);  const [quizzes, setQuizzes] = useState<Quiz[]>([]);  const [loading, setLoading] = useState(true);  const [selectedQuiz, setSelectedQuiz] = useState<Quiz | null>(null);  const [searchTerm, setSearchTerm] = useState('');  const [difficultyFilter, setDifficultyFilter] = useState<string>('all');  const [categoryFilter, setCategoryFilter] = useState<string>('all');  const [fetchError, setFetchError] = useState<string | null>(null);  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');  const fetchQuizzes = useCallback(async () => {    try {      setLoading(true);      setFetchError(null);            // Wait for auth to be ready if needed      if (!auth.currentUser) {        await new Promise<void>((resolve) => {          const unsubscribe = auth.onAuthStateChanged((authUser) => {            if (authUser) {              unsubscribe();              resolve();            }          });          // Timeout after 5 seconds          setTimeout(() => {            unsubscribe();            resolve();          }, 5000);        });      }            // Fetch ONLY APPROVED quizzes with status filter      const allQuizzesRef = query(        collection(db, 'quizzes'),        where('status', '==', 'approved')      );      const allSnapshot = await getDocs(allQuizzesRef);            const allQuizData = allSnapshot.docs.map(doc => ({        id: doc.id,        ...doc.data()      } as Quiz));            // Filter quizzes - Ch·ªâ c·∫ßn 1 c√¢u h·ªèi tr·ªü l√™n (ƒë√£ approved t·ª´ query)      const validQuizzes = allQuizData.filter(quiz => {        const hasQuestions = quiz.questions && quiz.questions.length >= 1;        return hasQuestions;      });            setQuizzes(validQuizzes);    } catch (error: any) {      console.error('Error fetching quizzes:', error);      setFetchError(error.message || 'Kh√¥ng th·ªÉ t·∫£i danh s√°ch quiz');    } finally {      setLoading(false);    }  }, []);  useEffect(() => {    if (!user) {      navigate('/login');      return;    }    fetchQuizzes();  }, [user, navigate, fetchQuizzes]);  const filteredQuizzes = quizzes.filter(quiz => {    const matchesSearch = quiz.title.toLowerCase().includes(searchTerm.toLowerCase()) ||                         quiz.description.toLowerCase().includes(searchTerm.toLowerCase());    const matchesDifficulty = difficultyFilter === 'all' || quiz.difficulty === difficultyFilter;    const matchesCategory = categoryFilter === 'all' || quiz.category === categoryFilter;        return matchesSearch && matchesDifficulty && matchesCategory;  });  const handleQuizSelect = (quiz: Quiz) => {    setSelectedQuiz(quiz);    // T·ª± ƒë·ªông scroll ƒë·∫øn n√∫t b·∫Øt ƒë·∫ßu    setTimeout(() => {      const startButton = document.getElementById('multiplayer-start-button');      startButton?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });    }, 100);  };  const handleStartMultiplayer = () => {    if (selectedQuiz) {      navigate('/multiplayer/game', { state: { selectedQuiz } });    }  };  const categories = Array.from(new Set(quizzes.map(q => q.category).filter(Boolean)));  const difficulties = Array.from(new Set(quizzes.map(q => q.difficulty)));  // Stats for potential future use  // const stats = {  //   total: filteredQuizzes.length,  //   easy: filteredQuizzes.filter(q => q.difficulty === 'easy').length,  //   medium: filteredQuizzes.filter(q => q.difficulty === 'medium').length,  //   hard: filteredQuizzes.filter(q => q.difficulty === 'hard').length,  // };  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-7xl mx-auto px-4\">        {/* Header Section - Gi·ªëng QuizList */}        <div className=\"mb-8\">          <div className=\"flex items-center justify-between\">            <div>              <button                onClick={() => navigate('/quizzes')}                className=\"group flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-all duration-300 hover:gap-3\"              >                <ArrowLeft className=\"w-5 h-5 group-hover:animate-bounce-x\" />                // eslint-disable-next-line i18next/no-literal-string                <span className=\"font-medium\">Quay l·∫°i</span>              </button>              <h1 className=\"text-4xl font-bold text-gray-900 mb-2 flex items-center gap-3\">                // eslint-disable-next-line i18next/no-literal-string                <Gamepad2 className=\"w-10 h-10 text-purple-600\" />                Multiplayer - Ch∆°i v·ªõi b·∫°n b√®              </h1>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-gray-600 text-lg\">Ch·ªçn quiz v√† t·∫°o ph√≤ng ƒë·ªÉ c·∫°nh tranh tr·ª±c ti·∫øp!</p>            </div>          </div>        </div>        {/* Error Display */}        {fetchError && (          <div className=\"bg-red-50 border-l-4 border-red-500 rounded-xl p-6 mb-6 shadow-lg animate-shake\">            <div className=\"flex items-start gap-4\">              <AlertCircle className=\"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5\" />              <div className=\"flex-1\">                // eslint-disable-next-line i18next/no-literal-string                <h3 className=\"font-bold text-red-900 mb-1\">L·ªói t·∫£i d·ªØ li·ªáu</h3>                <p className=\"text-sm text-red-700 mb-3\">{fetchError}</p>                <button                  onClick={fetchQuizzes}                  className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors\"                // eslint-disable-next-line i18next/no-literal-string                >                  Th·ª≠ l·∫°i                </button>              </div>            </div>          </div>        )}                {/* Features Banner - Gi·ªëng QuizList */}        <div className=\"grid md:grid-cols-3 gap-6 mb-8\">          <div className=\"group bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:border-purple-300 hover:shadow-md transition-all\">            <div className=\"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-4 group-hover:rotate-12 transition-transform\">              <Zap className=\"w-6 h-6 text-white\" />            </div>            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"font-bold text-gray-900 mb-2 text-lg\">Real-time Competition</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-600 leading-relaxed\">C·∫°nh tranh tr·ª±c ti·∫øp v·ªõi b·∫°n b√® v√† xem k·∫øt qu·∫£ ngay l·∫≠p t·ª©c</p>          </div>                    <div className=\"group bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:border-pink-300 hover:shadow-md transition-all\">            <div className=\"w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl flex items-center justify-center mb-4 group-hover:rotate-12 transition-transform\">              <Users className=\"w-6 h-6 text-white\" />            </div>            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"font-bold text-gray-900 mb-2 text-lg\">Private Rooms</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-600 leading-relaxed\">T·∫°o ph√≤ng ri√™ng v·ªõi room code ƒë·ªÉ ch∆°i v·ªõi ng∆∞·ªùi b·∫°n mu·ªën</p>          </div>                    <div className=\"group bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:border-indigo-300 hover:shadow-md transition-all\">            <div className=\"w-12 h-12 bg-gradient-to-br from-indigo-500 to-blue-500 rounded-xl flex items-center justify-center mb-4 group-hover:rotate-12 transition-transform\">              <Trophy className=\"w-6 h-6 text-white\" />            </div>            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"font-bold text-gray-900 mb-2 text-lg\">Live Leaderboard</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-sm text-gray-600 leading-relaxed\">Theo d√µi b·∫£ng x·∫øp h·∫°ng tr·ª±c ti·∫øp trong khi ch∆°i</p>          </div>        </div>        {/* Enhanced Filter Section - Gi·ªëng QuizList */}        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8\">          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">            {/* Enhanced Search */}            <div className=\"lg:col-span-2 relative\">              <div className=\"relative\">                <input                  type=\"text\"                  placeholder={t('placeholders.searchQuiz')}                  value={searchTerm}                  onChange={(e) => setSearchTerm(e.target.value)}                  className=\"w-full border border-gray-300 rounded-lg p-3 pl-10 text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"                />                <svg className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />                </svg>                {searchTerm && (                  <button                    onClick={() => setSearchTerm('')}                    className=\"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 hover:text-gray-600\"                  >                    <svg fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />                    </svg>                  </button>                )}              </div>            </div>                        {/* Category Filter */}            <select               className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"               value={categoryFilter}               onChange={e => setCategoryFilter(e.target.value)}            >              // eslint-disable-next-line i18next/no-literal-string              <option value=\"all\">üè∑Ô∏è T·∫•t c·∫£ danh m·ª•c</option>              {categories.map(c => <option key={c} value={c}>{c}</option>)}            </select>                        {/* Difficulty Filter */}            <select               className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"               value={difficultyFilter}               onChange={e => setDifficultyFilter(e.target.value)}            >              // eslint-disable-next-line i18next/no-literal-string              <option value=\"all\">üìä T·∫•t c·∫£ ƒë·ªô kh√≥</option>              {difficulties.map(d => <option key={d} value={d}>                {d === 'easy' ? 'üòä D·ªÖ' : d === 'medium' ? 'üòê Trung b√¨nh' : 'üò§ Kh√≥'}              </option>)}            </select>          </div>          {/* Advanced Controls */}          <div className=\"flex flex-wrap items-center justify-between gap-4 pt-4 border-t border-gray-100\">            <div className=\"flex items-center gap-4\">              {/* View Mode Toggle */}              <div className=\"flex items-center gap-2\">                // eslint-disable-next-line i18next/no-literal-string                <span className=\"text-sm text-gray-600\">Hi·ªÉn th·ªã:</span>                <div className=\"flex border border-gray-300 rounded-lg overflow-hidden\">                  <button                    onClick={() => setViewMode('grid')}                    className={`p-2 ${viewMode === 'grid' ? 'bg-purple-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}                    title=\"L∆∞·ªõi\"                  >                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">                      <path d=\"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />                    </svg>                  </button>                  <button                    onClick={() => setViewMode('list')}                    className={`p-2 ${viewMode === 'list' ? 'bg-purple-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}                    title=\"Danh s√°ch\"                  >                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">                      <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\" />                    </svg>                  </button>                </div>              </div>            </div>          </div>          {/* Results Summary */}          // eslint-disable-next-line i18next/no-literal-string          <div className=\"mt-4 text-sm text-gray-600\">            // eslint-disable-next-line i18next/no-literal-string            T√¨m th·∫•y <span className=\"font-semibold text-purple-600\">{filteredQuizzes.length}</span> quiz            // eslint-disable-next-line i18next/no-literal-string            {searchTerm && <span> cho \"{searchTerm}\"</span>}            // eslint-disable-next-line i18next/no-literal-string            {categoryFilter !== 'all' && <span> trong danh m·ª•c \"{categoryFilter}\"</span>}            // eslint-disable-next-line i18next/no-literal-string            {difficultyFilter !== 'all' && <span> v·ªõi ƒë·ªô kh√≥ \"{difficultyFilter}\"</span>}          </div>        </div>        {/* Quiz Grid/List - Gi·ªëng QuizList s·ª≠ d·ª•ng QuizCard */}        <div className={viewMode === 'grid'           ? \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\"           : \"space-y-4\"        }>          {loading ? (            Array.from({length: 8}).map((_,i) => <QuizCardSkeleton key={i} />)          ) : filteredQuizzes.length === 0 ? (            <div className=\"col-span-full text-center\">              <div className=\"bg-gray-50 border border-gray-200 rounded-xl p-12\">                <Gamepad2 className='w-16 h-16 mx-auto text-gray-300 mb-4' />                // eslint-disable-next-line i18next/no-literal-string                <h3 className=\"text-xl font-medium text-gray-900 mb-2\">Kh√¥ng t√¨m th·∫•y quiz</h3>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-gray-600 mb-6\">Kh√¥ng c√≥ quiz n√†o ph√π h·ª£p v·ªõi b·ªô l·ªçc hi·ªán t·∫°i.</p>                <button                   onClick={() => {                    setSearchTerm('');                    setCategoryFilter('all');                    setDifficultyFilter('all');                  }}                  className=\"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors\"                // eslint-disable-next-line i18next/no-literal-string                >                  üîÑ X√≥a b·ªô l·ªçc                </button>              </div>            </div>          ) : (            filteredQuizzes.map(quiz => (              <div                 key={quiz.id}                onClick={() => handleQuizSelect(quiz)}                className={`cursor-pointer transition-all ${                  selectedQuiz?.id === quiz.id                     ? 'ring-4 ring-purple-500 ring-offset-2'                     : ''                }`}              >                <QuizCard                   quiz={quiz}                   viewMode={viewMode}                  onStartQuiz={() => handleQuizSelect(quiz)}                />                {selectedQuiz?.id === quiz.id && (                  <div className=\"absolute top-4 left-4 z-30\">                    <div className=\"w-8 h-8 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center animate-bounce shadow-lg\">                      <svg className=\"w-5 h-5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />                      </svg>                    </div>                  </div>                )}              </div>            ))          )}        </div>        {/* Start Button - Fixed at bottom khi ƒë√£ ch·ªçn quiz */}        {selectedQuiz && (          <div id=\"multiplayer-start-button\" className=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg p-4 z-50 animate-slide-up\">            <div className=\"max-w-7xl mx-auto flex items-center justify-between\">              <div className=\"flex items-center gap-4\">                <div className=\"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center\">                  <Gamepad2 className=\"w-6 h-6 text-purple-600\" />                </div>                <div>                  <div className=\"font-bold text-gray-900\">{selectedQuiz.title}</div>                  <div className=\"text-sm text-gray-600\">                    // eslint-disable-next-line i18next/no-literal-string                    {selectedQuiz.questions.length} c√¢u h·ªèi ‚Ä¢ {selectedQuiz.difficulty === 'easy' ? 'D·ªÖ' : selectedQuiz.difficulty === 'medium' ? 'Trung b√¨nh' : 'Kh√≥'}                  </div>                </div>              </div>              <button                onClick={handleStartMultiplayer}                className=\"flex items-center gap-2 bg-gradient-to-r from-purple-600 via-pink-600 to-indigo-600 text-white px-8 py-3 rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 font-bold\"              >                // eslint-disable-next-line i18next/no-literal-string                <Gamepad2 className=\"w-5 h-5\" />                B·∫Øt ƒë·∫ßu Multiplayer              </button>            </div>          </div>        )}      </div>    </div>  );};export default MultiplayerLobby;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\pages\\MultiplayerPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[378,381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[378,381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[710,713],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[710,713],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport MultiplayerManager from '../components/MultiplayerManager';\nimport MultiplayerErrorBoundary from '../components/MultiplayerErrorBoundary';\nimport { logger } from '../utils/logger';\n\ninterface LocationState {\n  selectedQuiz?: any;\n}\n\nconst MultiplayerPage: React.FC = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const state = location.state as LocationState;\n  const searchParams = new URLSearchParams(location.search);\n  const initialRoomId = searchParams.get('roomId') || undefined;\n  const { user } = useSelector((state: any) => state.auth);\n  \n  // Use useEffect for navigation to avoid React warnings\n  useEffect(() => {\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n    \n    // Quiz is now optional - can be selected inside multiplayer\n    const selectedQuiz = state?.selectedQuiz;\n    \n    if (selectedQuiz) {\n      // Validate quiz if provided\n      if (!selectedQuiz.questions || selectedQuiz.questions.length === 0) {\n        logger.error('Selected quiz has no questions!');\n        navigate('/quizzes', { \n          state: { \n            error: 'Selected quiz has no questions. Please choose a different quiz.' \n          } \n        });\n        return;\n      }\n      \n      logger.debug('MultiplayerPage Real Quiz Data', {\n        quizId: selectedQuiz.id,\n        quizTitle: selectedQuiz.title,\n        questionsCount: selectedQuiz.questions?.length || 0\n      });\n    } else {\n      logger.debug('No quiz pre-selected - will select inside multiplayer');\n    }\n  }, [user, state?.selectedQuiz, navigate]);\n  \n  // Don't render anything if redirecting\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n  \n  return (\n    <MultiplayerErrorBoundary>\n      <div className=\"min-h-screen bg-gray-50\">\n        <MultiplayerManager \n          selectedQuiz={state?.selectedQuiz} // Now optional\n          currentUserId={user.uid}\n          currentUserName={user.displayName || user.email || 'User'}\n          onBackToLobby={() => navigate('/multiplayer')}\n          onQuizComplete={() => {\n            // Don't auto-redirect - let players see final results\n            // navigate('/leaderboard')\n          }}\n          initialRoomId={initialRoomId}\n        />\n      </div>\n    </MultiplayerErrorBoundary>\n  );\n};\n\nexport default MultiplayerPage;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\services\\enhancedMultiplayerService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[924,927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[924,927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[962,965],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[962,965],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1559,1562],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1559,1562],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1847,1850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1847,1850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2281,2284],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2281,2284],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2341,2344],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2341,2344],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2564,2567],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2564,2567],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":93,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2989,2992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2989,2992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3793,3796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3793,3796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Simple event emitter for browser (removed - not used in current implementation)\r\n\r\n// Types\r\nexport interface Player {\r\n  id: string;\r\n  name: string;\r\n  avatar?: string;\r\n  isHost: boolean;\r\n  isReady: boolean;\r\n  score: number;\r\n  currentQuestion: number;\r\n  isOnline: boolean;\r\n  joinedAt: Date;\r\n}\r\n\r\nexport interface Room {\r\n  id: string;\r\n  name: string;\r\n  code: string;\r\n  hostId: string;\r\n  players: Player[];\r\n  maxPlayers: number;\r\n  isPrivate: boolean;\r\n  password?: string;\r\n  status: 'waiting' | 'playing' | 'finished';\r\n  quizId?: string;\r\n  quizTitle?: string;\r\n  settings: {\r\n    timePerQuestion: number;\r\n    showAnswers: boolean;\r\n    allowLateJoin: boolean;\r\n    autoStart: boolean;\r\n  };\r\n  createdAt: Date;\r\n  startedAt?: Date;\r\n  endedAt?: Date;\r\n}\r\n\r\nexport interface GameState {\r\n  roomId: string;\r\n  currentQuestion: number;\r\n  totalQuestions: number;\r\n  timeRemaining: number;\r\n  questionData: any;\r\n  playerAnswers: Record<string, any>;\r\n  leaderboard: Player[];\r\n  phase: 'question' | 'answer' | 'results' | 'finished';\r\n}\r\n\r\nexport interface ChatMessage {\r\n  id: string;\r\n  roomId: string;\r\n  playerId: string;\r\n  playerName: string;\r\n  message: string;\r\n  type: 'player' | 'system';\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface MultiplayerServiceInterface {\r\n  connect(userId: string, userName: string): Promise<void>;\r\n  disconnect(): void;\r\n  resumeRoom(roomId: string): Promise<{ room: Room } | null>;\r\n  setPresence(roomId: string, isOnline: boolean): Promise<void>;\r\n  createRoom(roomConfig: Partial<Room>, selectedQuiz?: any): Promise<{ room: Room; player: Player }>;\r\n  joinRoom(roomCode: string, password?: string): Promise<{ room: Room; player: Player }>;\r\n  leaveRoom(roomId: string): Promise<void>;\r\n  startGame(roomId: string): Promise<void>;\r\n  submitAnswer(roomId: string, questionId: string, answer: any, timeRemaining: number): Promise<void>;\r\n  advanceToNextQuestion(roomId: string): Promise<void>;\r\n  sendChatMessage(roomId: string, message: string): Promise<void>;\r\n  kickPlayer(roomId: string, playerId: string): Promise<void>;\r\n  updatePlayerStatus(roomId: string, isReady: boolean): Promise<void>;\r\n  updateRoomSettings(roomId: string, settings: Partial<Room['settings']>): Promise<void>;\r\n  on(event: string, callback: (data: any) => void): void;\r\n  off(event: string, callback: (data: any) => void): void;\r\n}\r\n\r\nimport { FirestoreMultiplayerService } from './firestoreMultiplayerService';\r\nimport realtimeService from './realtimeMultiplayerService';\r\n\r\n// Singleton instance\r\nlet multiplayerServiceInstance: any = null;\r\n\r\n/**\r\n * Get multiplayer service with hybrid approach\r\n * - Firestore: Persistent data (rooms, scores, metadata)\r\n * - Realtime DB: Live state (presence, timer, chat)\r\n */\r\nexport function getMultiplayerService(): MultiplayerServiceInterface {\r\n  if (!multiplayerServiceInstance) {\r\n    // Create Firestore service with Realtime DB integration\r\n    const firestoreService = new FirestoreMultiplayerService() as any;\r\n    \r\n    // Enhance with Realtime DB capabilities\r\n    const originalConnect = firestoreService.connect.bind(firestoreService);\r\n    firestoreService.connect = async (userId: string, userName: string) => {\r\n      await originalConnect(userId, userName);\r\n      console.log('‚úÖ Connected to Firestore + Realtime DB');\r\n    };\r\n    \r\n    const originalDisconnect = firestoreService.disconnect.bind(firestoreService);\r\n    firestoreService.disconnect = () => {\r\n      originalDisconnect();\r\n      realtimeService.cleanupAll();\r\n      console.log('‚úÖ Disconnected from all services');\r\n    };\r\n    \r\n    // Store reference to realtime service\r\n    firestoreService.realtimeService = realtimeService;\r\n    \r\n    multiplayerServiceInstance = firestoreService;\r\n  }\r\n  return multiplayerServiceInstance as any;\r\n}\r\n\r\nexport function resetMultiplayerService(): void {\r\n  if (multiplayerServiceInstance) {\r\n    multiplayerServiceInstance.disconnect();\r\n    realtimeService.cleanupAll();\r\n    multiplayerServiceInstance = null;\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\services\\firestoreMultiplayerService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[660,663],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[660,663],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[681,684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[681,684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1503,1506],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1503,1506],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1605,1608],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1605,1608],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1628,1631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1628,1631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1652,1655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1652,1655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2110,2113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2110,2113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","line":122,"column":31,"nodeType":"Identifier","messageId":"bannedTypeMessage","endLine":122,"endColumn":39},{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","line":123,"column":32,"nodeType":"Identifier","messageId":"bannedTypeMessage","endLine":123,"endColumn":40},{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","line":128,"column":36,"nodeType":"Identifier","messageId":"bannedTypeMessage","endLine":128,"endColumn":44},{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","line":130,"column":31,"nodeType":"Identifier","messageId":"bannedTypeMessage","endLine":130,"endColumn":39},{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","line":137,"column":32,"nodeType":"Identifier","messageId":"bannedTypeMessage","endLine":137,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3413,3416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3413,3416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4612,4615],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4612,4615],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":568,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17555,17558],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17555,17558],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":611,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":611,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18967,18970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18967,18970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":831,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":831,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26472,26475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26472,26475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \n  collection, \n  doc, \n  addDoc, \n  setDoc, \n  getDoc, \n  getDocs, \n  updateDoc, \n  deleteDoc, \n  query, \n  where, \n  orderBy, \n  limit, \n  onSnapshot, \n  serverTimestamp\n} from 'firebase/firestore';\nimport { db } from '../../../lib/firebase/config';\nimport { logger } from '../utils/logger';\nimport realtimeService from './realtimeMultiplayerService';\n\n// Types\nexport interface Room {\n  id: string;\n  code: string;\n  name: string;\n  // Removed hostId - all players are equal\n  players: Player[];\n  maxPlayers: number;\n  isPrivate: boolean;\n  password?: string;\n  status: 'waiting' | 'starting' | 'playing' | 'finished';\n  quizId?: string;\n  quiz?: any;\n  gameStartAt?: any;\n  gameStartDelay?: number;\n  settings: {\n    timeLimit: number;\n    timePerQuestion?: number;\n    showLeaderboard: boolean;\n    allowLateJoin: boolean;\n  };\n  createdAt: Date;\n  startedAt?: Date;\n  finishedAt?: Date;\n}\n\nexport interface Player {\n  id: string;\n  username: string;\n  isReady: boolean;\n  isOnline: boolean;\n  // Removed isHost - all players are equal\n  score: number;\n  answers: PlayerAnswer[];\n  joinedAt: Date;\n}\n\nexport interface PlayerAnswer {\n  questionId: string;\n  selectedAnswer: number;\n  isCorrect: boolean;\n  timeSpent: number;\n  points: number;\n  timestamp: Date;\n}\n\nexport interface ChatMessage {\n  id: string;\n  userId: string;\n  username: string;\n  message: string;\n  timestamp: Date;\n  type: 'user' | 'system';\n}\n\nexport interface GameData {\n  currentQuestionIndex: number;\n  questions: any[];\n  timePerQuestion?: number;\n  phase?: 'question' | 'results' | 'finished';\n  questionStartAt?: any;\n  questionEndAt?: any;\n  nextQuestionAt?: any;\n  startTime?: Date;\n  endTime?: Date;\n  results?: {\n    [playerId: string]: {\n      score: number;\n      correctAnswers: number;\n      totalAnswers: number;\n      averageTime: number;\n    };\n  };\n}\n\n// Service Interface\nexport interface MultiplayerServiceInterface {\n  // Connection\n  connect(userId: string, username: string): Promise<void>;\n  disconnect(): Promise<void>;\n  \n  // Room Management\n  createRoom(roomConfig: Partial<Room>, selectedQuiz?: any): Promise<{ room: Room; player: Player }>;\n  joinRoom(roomCode: string, password?: string): Promise<{ room: Room; player: Player }>;\n  leaveRoom(roomId: string): Promise<void>;\n  \n  // Game Control\n  startGame(roomId: string): Promise<void>;\n  submitAnswer(roomId: string, questionId: string, answer: number, timeSpent: number): Promise<void>;\n  \n  // Communication\n  sendChatMessage(roomId: string, message: string): Promise<void>;\n  \n  // Player Management\n  updatePlayerStatus(roomId: string, isReady: boolean): Promise<void>;\n  kickPlayer(roomId: string, playerId: string): Promise<void>;\n  \n  // Settings\n  updateRoomSettings(roomId: string, settings: Partial<Room['settings']>): Promise<void>;\n  \n  // Event Listeners\n  on(event: string, callback: Function): void;\n  off(event: string, callback: Function): void;\n}\n\n// Simple Event Emitter for browser compatibility\nclass SimpleEventEmitter {\n  private events: { [key: string]: Function[] } = {};\n\n  on(event: string, callback: Function) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(callback);\n  }\n\n  off(event: string, callback: Function) {\n    if (!this.events[event]) return;\n    this.events[event] = this.events[event].filter(cb => cb !== callback);\n  }\n\n  emit(event: string, ...args: any[]) {\n    if (!this.events[event]) return;\n    this.events[event].forEach(callback => callback(...args));\n  }\n}\n\n// Firestore Multiplayer Service\nexport class FirestoreMultiplayerService extends SimpleEventEmitter implements MultiplayerServiceInterface {\n  private userId: string = '';\n  private username: string = '';\n  private currentRoomId: string | null = null;\n  private unsubscribeFunctions: (() => void)[] = [];\n\n  // Connection\n  async connect(userId: string, username: string): Promise<void> {\n    this.userId = userId;\n    this.username = username;\n    logger.success('Connected to Firestore Multiplayer Service', { userId, username });\n    this.emit('connected', { userId, username });\n  }\n\n  async disconnect(): Promise<void> {\n    // Unsubscribe from all listeners\n    this.unsubscribeFunctions.forEach(unsubscribe => unsubscribe());\n    this.unsubscribeFunctions = [];\n    \n    // Leave current room if any\n    if (this.currentRoomId) {\n      await this.leaveRoom(this.currentRoomId);\n    }\n    \n    logger.info('Disconnected from Firestore Multiplayer Service');\n    this.emit('disconnected');\n  }\n\n  // Room Management\n  async createRoom(roomConfig: Partial<Room>, selectedQuiz?: any): Promise<{ room: Room; player: Player }> {\n    try {\n      console.log('üèóÔ∏è Service createRoom: Received config', {\n        isPrivate: roomConfig.isPrivate,\n        password: roomConfig.password,\n        fullConfig: roomConfig\n      });\n      \n      // Generate unique room code\n      const code = this.generateRoomCode();\n      \n      // Create room document\n      const roomDoc = doc(collection(db, 'multiplayer_rooms'));\n      \n      // Create room creator player\n      const player: Player = {\n        id: this.userId,\n        username: this.username,\n        isReady: false,\n        isOnline: true,\n        // Removed isHost - all players are equal\n        score: 0,\n        answers: [],\n        joinedAt: new Date()\n      };\n\n      // Room data\n      const roomData = {\n        code,\n        name: roomConfig.name || `${this.username}'s Room`,\n        // Removed hostId - all players are equal\n        maxPlayers: roomConfig.maxPlayers || 4,\n        isPrivate: roomConfig.isPrivate || false,\n        password: roomConfig.password || null,\n        status: 'waiting' as const,\n        quizId: selectedQuiz?.id || null,\n        quiz: selectedQuiz ? {\n          id: selectedQuiz.id,\n          title: selectedQuiz.title,\n          description: selectedQuiz.description,\n          questions: selectedQuiz.questions || []\n        } : null,\n        settings: {\n          timeLimit: roomConfig.settings?.timeLimit || 30,\n          showLeaderboard: roomConfig.settings?.showLeaderboard ?? true,\n          allowLateJoin: roomConfig.settings?.allowLateJoin ?? true\n        },\n        createdAt: serverTimestamp()\n      };\n      \n      console.log('üíæ Service createRoom: Saving to Firestore', {\n        isPrivate: roomData.isPrivate,\n        password: roomData.password,\n        code: roomData.code\n      });\n\n      await setDoc(roomDoc, roomData);\n\n      // Add player to room\n      const playerDoc = doc(collection(db, 'multiplayer_rooms', roomDoc.id, 'players'), this.userId);\n      await setDoc(playerDoc, player);\n\n      // Setup Realtime Database presence for instant sync\n      await realtimeService.setupPresence(roomDoc.id, this.userId, this.username);\n\n      // Set current room\n      this.currentRoomId = roomDoc.id;\n\n      // Start listening to room updates\n      this.listenToRoom(roomDoc.id);\n      this.listenToPlayers(roomDoc.id);\n      this.listenToMessages(roomDoc.id);\n\n      const room: Room = {\n        id: roomDoc.id,\n        code,\n        name: roomData.name,\n        // Removed hostId - all players are equal\n        players: [player],\n        maxPlayers: roomData.maxPlayers,\n        isPrivate: roomData.isPrivate,\n        password: roomData.password || undefined,\n        status: 'waiting',\n        quizId: selectedQuiz?.id || undefined,\n        quiz: roomData.quiz || undefined,\n        settings: roomData.settings,\n        createdAt: new Date()\n      };\n\n      logger.success('Room created', { roomId: room.id, code: room.code });\n      this.emit('room:created', room);\n      \n      return { room, player };\n    } catch (error) {\n      console.error('Error creating room:', error);\n      throw error;\n    }\n  }\n\n  async joinRoom(roomCode: string, password?: string): Promise<{ room: Room; player: Player }> {\n    try {\n      logger.info('üö™ Service: Attempting to join room', { roomCode, hasPassword: !!password });\n      \n      // Find room by code\n      const q = query(collection(db, 'multiplayer_rooms'), where('code', '==', roomCode), limit(1));\n      const snapshot = await getDocs(q);\n      \n      if (snapshot.empty) {\n        logger.error('‚ùå Service: Room not found', { roomCode });\n        throw new Error('room_not_found');\n      }\n      \n      const roomDoc = snapshot.docs[0];\n      const roomData = roomDoc.data();\n      \n      logger.debug('üîç Service: Room found', { \n        roomId: roomDoc.id, \n        isPrivate: roomData.isPrivate,\n        hasPassword: !!roomData.password,\n        providedPassword: !!password\n      });\n      \n      // Check if room requires password\n      if (roomData.isPrivate && !password) {\n        logger.warn('üîí Service: Room requires password but none provided');\n        throw new Error('room_requires_password');\n      }\n      \n      if (roomData.isPrivate && roomData.password !== password) {\n        logger.error('‚ùå Service: Wrong password provided');\n        throw new Error('wrong_password');\n      }\n      \n      // Check room capacity\n      const playersSnapshot = await getDocs(collection(db, 'multiplayer_rooms', roomDoc.id, 'players'));\n      if (playersSnapshot.size >= roomData.maxPlayers) {\n        throw new Error('room_full');\n      }\n      \n      // Check if game is in progress\n      if (roomData.status === 'playing' && !roomData.settings.allowLateJoin) {\n        throw new Error('game_in_progress');\n      }\n      \n      logger.success('‚úÖ Service: All checks passed, creating player');\n      \n      // Create player\n      const player: Player = {\n        id: this.userId,\n        username: this.username,\n        isReady: false,\n        isOnline: true,\n        // Removed isHost - all players are equal\n        score: 0,\n        answers: [],\n        joinedAt: new Date()\n      };\n      \n      // Add player to room\n      const playerDoc = doc(collection(db, 'multiplayer_rooms', roomDoc.id, 'players'), this.userId);\n      await setDoc(playerDoc, player);\n      \n      // Setup Realtime Database presence for instant sync\n      await realtimeService.setupPresence(roomDoc.id, this.userId, this.username);\n      \n      // Set current room\n      this.currentRoomId = roomDoc.id;\n      \n      // Start listening to room updates\n      this.listenToRoom(roomDoc.id);\n      this.listenToPlayers(roomDoc.id);\n      this.listenToMessages(roomDoc.id);\n      \n      // Send system message\n      await this.sendSystemMessage(roomDoc.id, `${this.username} joined the room`);\n      \n      const room: Room = {\n        id: roomDoc.id,\n        code: roomData.code,\n        name: roomData.name,\n        // Removed hostId - all players are equal\n        players: [player], // Will be updated by listener\n        maxPlayers: roomData.maxPlayers,\n        isPrivate: roomData.isPrivate,\n        password: roomData.password,\n        status: roomData.status,\n        quizId: roomData.quizId,\n        quiz: roomData.quiz,\n        settings: roomData.settings,\n        createdAt: roomData.createdAt?.toDate() || new Date()\n      };\n      \n      logger.success('Joined room', { roomId: room.id, code: room.code });\n      this.emit('room:joined', room);\n      \n      return { room, player };\n    } catch (error) {\n      logger.error('Error joining room', error);\n      throw error;\n    }\n  }\n\n  async leaveRoom(roomId: string): Promise<void> {\n    try {\n      if (!this.userId) return;\n      \n      // Remove player from room\n      const playerDoc = doc(db, 'multiplayer_rooms', roomId, 'players', this.userId);\n      await deleteDoc(playerDoc);\n      \n      // Send system message\n      await this.sendSystemMessage(roomId, `${this.username} left the room`);\n      \n      // Clean up listeners\n      this.unsubscribeFunctions.forEach(unsubscribe => unsubscribe());\n      this.unsubscribeFunctions = [];\n      \n      this.currentRoomId = null;\n      \n      logger.info('Left room', { roomId });\n      this.emit('room:left', roomId);\n    } catch (error) {\n      logger.error('Error leaving room', error);\n      throw error;\n    }\n  }\n\n  // Game Control\n  async startGame(roomId: string): Promise<void> {\n    try {\n      logger.info('Starting 5-second game countdown...');\n      \n      // First, set room status to 'starting' with countdown timer\n      const roomRef = doc(db, 'multiplayer_rooms', roomId);\n      await updateDoc(roomRef, {\n        status: 'starting',\n        gameStartAt: serverTimestamp(),\n        gameStartDelay: 5000 // 5 seconds delay\n      });\n      \n      // After 5 seconds, actually start the game\n      setTimeout(() => {\n        this.actuallyStartGame(roomId).catch(logger.error);\n      }, 5000);\n      \n    } catch (error) {\n      logger.error('Error starting game', error);\n      throw error;\n    }\n  }\n\n  private async actuallyStartGame(roomId: string): Promise<void> {\n    try {\n      logger.debug('Loading quiz data', {\n        roomId,\n        hasUserId: !!this.userId,\n        timestamp: new Date().toISOString()\n      });\n      \n      const roomRef = doc(db, 'multiplayer_rooms', roomId);\n      const roomSnap = await getDoc(roomRef);\n      \n      if (!roomSnap.exists()) {\n        throw new Error('Room not found');\n      }\n      \n      const roomData = roomSnap.data();\n      let questions = [];\n      \n      if (roomData.quiz && roomData.quiz.questions && roomData.quiz.questions.length > 0) {\n        logger.success('Using embedded quiz questions', { count: questions.length });\n        questions = roomData.quiz.questions;\n      } else if (roomData.quizId) {\n        try {\n          logger.debug('Fetching quiz from Firestore', { quizId: roomData.quizId });\n          \n          const quizRef = doc(db, 'quizzes', roomData.quizId);\n          const quizSnap = await getDoc(quizRef);\n          \n          if (quizSnap.exists()) {\n            logger.debug('Quiz data received', {\n              id: quizSnap.id,\n              hasData: !!quizSnap.data(),\n              hasQuestions: !!quizSnap.data()?.questions\n            });\n            \n            const quizData = quizSnap.data();\n            if (quizData?.questions && Array.isArray(quizData.questions)) {\n              questions = quizData.questions;\n              logger.success('Loaded quiz questions from Firestore', { count: questions.length });\n            } else {\n              logger.warn('Quiz found but no valid questions array');\n            }\n          } else {\n            logger.warn('Quiz document not found in Firestore');\n          }\n        } catch (e) {\n          logger.error('Failed to load quiz by quizId', e);\n        }\n      }\n      \n      // Fallback to mock questions if no real questions available\n      if (!questions || questions.length === 0) {\n        logger.warn('No quiz questions found, using fallback mock questions');\n        questions = [\n          {\n            id: 'mock-q1',\n            text: 'What is 2 + 2?',\n            answers: [\n              { text: '3', isCorrect: false },\n              { text: '4', isCorrect: true },\n              { text: '5', isCorrect: false },\n              { text: '6', isCorrect: false }\n            ]\n          },\n          {\n            id: 'mock-q2',\n            text: 'What is the capital of Vietnam?',\n            answers: [\n              { text: 'Ho Chi Minh City', isCorrect: false },\n              { text: 'Hanoi', isCorrect: true },\n              { text: 'Da Nang', isCorrect: false },\n              { text: 'Hue', isCorrect: false }\n            ]\n          }\n        ];\n      }\n      \n      const timePerQuestion = roomData.settings?.timePerQuestion || 30;\n      \n      const gameData = {\n        currentQuestionIndex: 0,\n        questions,\n        timePerQuestion,\n        phase: 'question',\n        questionStartAt: serverTimestamp(),\n        questionEndAt: new Date(Date.now() + (timePerQuestion * 1000))\n      };\n      \n      // Update room with game data and playing status\n      await updateDoc(roomRef, {\n        status: 'playing',\n        startedAt: serverTimestamp(),\n        gameData,\n        // Clear countdown fields\n        gameStartAt: null,\n        gameStartDelay: null\n      });\n      \n      const emitData = {\n        ...gameData,\n        roomId,\n        questionsCount: questions.length\n      };\n      \n      logger.success('Game actually started', { roomId, questionsCount: questions.length });\n      this.emit('game:start', emitData);\n    } catch (error) {\n      logger.error('Error starting game', error);\n      throw error;\n    }\n  }\n\n  async submitAnswer(roomId: string, questionId: string, answer: number, timeSpent: number): Promise<void> {\n    try {\n      const playerDoc = doc(db, 'multiplayer_rooms', roomId, 'players', this.userId);\n      const playerSnap = await getDoc(playerDoc);\n      \n      if (!playerSnap.exists()) return;\n      \n      const playerData = playerSnap.data();\n      \n      // Get room data to access questions for correct answer calculation\n      const roomRef = doc(db, 'multiplayer_rooms', roomId);\n      const roomSnap = await getDoc(roomRef);\n      \n      if (!roomSnap.exists()) return;\n      \n      const roomData = roomSnap.data();\n      const currentQuestionIndex = roomData.gameData?.currentQuestionIndex || 0;\n      const currentQuestion = roomData.gameData?.questions?.[currentQuestionIndex];\n      \n      // Calculate correct answer and points\n      let isCorrect = false;\n      let points = 0;\n      \n      if (currentQuestion) {\n        // Find correct answer index\n        let correctIndex = 0;\n        if (currentQuestion.answers && Array.isArray(currentQuestion.answers)) {\n          correctIndex = currentQuestion.answers.findIndex((a: any) => a.isCorrect);\n          if (correctIndex === -1) correctIndex = 0;\n        }\n        \n        isCorrect = answer === correctIndex;\n        points = isCorrect ? Math.max(10, Math.floor(100 - (timeSpent * 2))) : 0;\n      }\n      \n      const playerAnswer: PlayerAnswer = {\n        questionId,\n        selectedAnswer: answer,\n        isCorrect,\n        timeSpent,\n        points,\n        timestamp: new Date()\n      };\n      \n      // Update player's answers\n      const updatedAnswers = [...(playerData.answers || []), playerAnswer];\n      \n      await updateDoc(playerDoc, {\n        answers: updatedAnswers\n      });\n      \n      this.emit('answer:submitted', { questionId, answer, timeSpent, isCorrect, points });\n      \n      // Check if all players have submitted and auto-advance\n      this.checkAndAdvanceQuestion(roomId, questionId);\n      \n    } catch (error) {\n      console.error('Error submitting answer:', error);\n      throw error;\n    }\n  }\n\n  private async checkAndAdvanceQuestion(roomId: string, questionId: string): Promise<void> {\n    try {\n      // Get all players\n      const playersSnapshot = await getDocs(collection(db, 'multiplayer_rooms', roomId, 'players'));\n      const players = playersSnapshot.docs.map(doc => doc.data());\n      \n      // Check if all players have answered this question\n      const allAnswered = players.every(player => \n        player.answers?.some((answer: any) => answer.questionId === questionId)\n      );\n      \n      if (allAnswered && players.length > 0) {\n        logger.info('All players answered, advancing to next question...');\n        \n        // Update room with advancement countdown immediately for real-time sync\n        const roomRef = doc(db, 'multiplayer_rooms', roomId);\n        await updateDoc(roomRef, {\n          'gameData.phase': 'results',\n          'gameData.nextQuestionAt': new Date(Date.now() + 3000) // 3 seconds to show results\n        });\n        \n        // After 3 seconds, advance to next question or finish game\n        setTimeout(async () => {\n          try {\n            const roomSnap = await getDoc(roomRef);\n            if (!roomSnap.exists()) return;\n            \n            const roomData = roomSnap.data();\n            const currentIndex = roomData.gameData?.currentQuestionIndex || 0;\n            const totalQuestions = roomData.gameData?.questions?.length || 0;\n            \n            if (currentIndex + 1 >= totalQuestions) {\n              // Game finished\n              await updateDoc(roomRef, {\n                status: 'finished',\n                finishedAt: serverTimestamp(),\n                'gameData.phase': 'finished'\n              });\n            } else {\n              // Next question\n              const nextIndex = currentIndex + 1;\n              const timePerQuestion = roomData.settings?.timePerQuestion || 30;\n              \n              await updateDoc(roomRef, {\n                'gameData.currentQuestionIndex': nextIndex,\n                'gameData.phase': 'question',\n                'gameData.questionStartAt': serverTimestamp(),\n                'gameData.questionEndAt': new Date(Date.now() + (timePerQuestion * 1000)),\n                'gameData.nextQuestionAt': null\n              });\n            }\n          } catch (error) {\n            console.error('Error advancing question:', error);\n          }\n        }, 3000);\n      }\n    } catch (error) {\n      console.error('Error checking players answers:', error);\n    }\n  }\n\n  // Communication\n  async sendChatMessage(roomId: string, message: string): Promise<void> {\n    try {\n      // Use Realtime Database for instant chat delivery\n      const messageData = {\n        userId: this.userId,\n        username: this.username,\n        message: message.trim(),\n        type: 'user'\n      };\n      \n      await realtimeService.sendChatMessage(roomId, messageData);\n      \n      logger.debug('Chat message sent via Realtime DB');\n      // Don't emit locally - let the listener handle it for consistency\n    } catch (error) {\n      logger.error('Error sending chat message', error);\n      throw error;\n    }\n  }\n\n  private async sendSystemMessage(roomId: string, message: string): Promise<void> {\n    try {\n      const messageData = {\n        userId: 'system',\n        username: 'System',\n        message,\n        timestamp: serverTimestamp(),\n        type: 'system'\n      };\n      \n      await addDoc(collection(db, 'multiplayer_rooms', roomId, 'messages'), messageData);\n    } catch (error) {\n      logger.error('Error sending system message', error);\n    }\n  }\n\n  // Player Management\n  async updatePlayerStatus(roomId: string, isReady: boolean): Promise<void> {\n    try {\n      const playerDoc = doc(db, 'multiplayer_rooms', roomId, 'players', this.userId);\n      await updateDoc(playerDoc, { isReady });\n      \n      logger.debug('Player status updated', { isReady });\n      this.emit('player:status_updated', { isReady });\n    } catch (error) {\n      logger.error('Error updating player status', error);\n      throw error;\n    }\n  }\n\n  async kickPlayer(roomId: string, playerId: string): Promise<void> {\n    try {\n      const playerDoc = doc(db, 'multiplayer_rooms', roomId, 'players', playerId);\n      await deleteDoc(playerDoc);\n      \n      logger.info('Player kicked', { playerId });\n      this.emit('player:kicked', playerId);\n    } catch (error) {\n      logger.error('Error kicking player', error);\n      throw error;\n    }\n  }\n\n  // Settings\n  async updateRoomSettings(roomId: string, settings: Partial<Room['settings']>): Promise<void> {\n    try {\n      const roomDoc = doc(db, 'multiplayer_rooms', roomId);\n      await updateDoc(roomDoc, { \n        [`settings.${Object.keys(settings)[0]}`]: Object.values(settings)[0] \n      });\n      \n      logger.debug('Room settings updated', settings);\n      this.emit('room:settings_updated', settings);\n    } catch (error) {\n      logger.error('Error updating room settings', error);\n      throw error;\n    }\n  }\n\n  // Listeners\n  private listenToRoom(roomId: string) {\n    const roomDoc = doc(db, 'multiplayer_rooms', roomId);\n    const unsubscribe = onSnapshot(roomDoc, (doc) => {\n      if (doc.exists()) {\n        const roomData = doc.data();\n        const room: Room = {\n          id: doc.id,\n          code: roomData.code,\n          name: roomData.name,\n          // Removed hostId - all players are equal\n          players: [], // Will be populated by players listener\n          maxPlayers: roomData.maxPlayers,\n          isPrivate: roomData.isPrivate,\n          password: roomData.password,\n          status: roomData.status,\n          quizId: roomData.quizId,\n          quiz: roomData.quiz,\n          settings: roomData.settings,\n          createdAt: roomData.createdAt?.toDate() || new Date(),\n          startedAt: roomData.startedAt?.toDate(),\n          finishedAt: roomData.finishedAt?.toDate()\n        };\n        \n        this.emit('room:updated', room);\n        \n        // Emit game events\n        if (roomData.gameData) {\n          this.emit('game:data_updated', roomData.gameData);\n        }\n      }\n    });\n    \n    this.unsubscribeFunctions.push(unsubscribe);\n  }\n\n  private listenToPlayers(roomId: string) {\n    const playersCollection = collection(db, 'multiplayer_rooms', roomId, 'players');\n    const q = query(playersCollection, orderBy('joinedAt', 'asc'));\n    \n    // Store Firestore players for merging with Realtime DB data\n    let firestorePlayers: Player[] = [];\n    \n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const players: Player[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        players.push({\n          ...data,\n          joinedAt: data.joinedAt?.toDate() || new Date()\n        } as Player);\n      });\n      \n      firestorePlayers = players;\n      \n      logger.info('Players snapshot updated', { \n        roomId, \n        count: players.length,\n        playerNames: players.map(p => p.username)\n      });\n      \n      this.emit('players:updated', players);\n    });\n    \n    // Listen to Realtime Database presence for instant online/offline updates\n    realtimeService.listenToPresence(roomId, (presence) => {\n      // Merge Firestore data with Realtime DB presence\n      const enhancedPlayers = firestorePlayers.map(player => ({\n        ...player,\n        isOnline: presence[player.id]?.isOnline ?? player.isOnline\n      }));\n      \n      logger.debug('Merged presence data', { \n        roomId, \n        onlineCount: Object.values(presence).filter(p => p.isOnline).length \n      });\n      \n      this.emit('players:updated', enhancedPlayers);\n    });\n    \n    this.unsubscribeFunctions.push(unsubscribe);\n  }\n\n  private listenToMessages(roomId: string) {\n    // Use Realtime Database for instant chat updates\n    realtimeService.listenToChatMessages(roomId, (realtimeMessages) => {\n      // Convert Realtime DB format to ChatMessage format\n      const messages: ChatMessage[] = realtimeMessages.map((msg: any) => ({\n        id: msg.id || `${msg.userId}_${msg.timestamp}`,\n        userId: msg.userId,\n        username: msg.username,\n        message: msg.message,\n        timestamp: msg.timestamp ? new Date(msg.timestamp) : new Date(),\n        type: msg.type || 'user'\n      }));\n      \n      logger.debug('Chat messages updated from Realtime DB', { count: messages.length });\n      this.emit('messages:updated', messages);\n    });\n  }\n\n  // Utility\n  private generateRoomCode(): string {\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    let result = '';\n    for (let i = 0; i < 6; i++) {\n      result += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    return result;\n  }\n}\n\n// Export singleton instance\nexport const firestoreMultiplayerService = new FirestoreMultiplayerService();\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\services\\realtimeMultiplayerService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[526,529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[526,529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1503,1506],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1503,1506],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1760,1763],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1760,1763],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2944,2947],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2944,2947],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3202,3205],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3202,3205],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4614,4617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4614,4617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6037,6040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6037,6040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":220,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":220,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6310,6313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6310,6313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":240,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":240,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6912,6915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6912,6915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":260,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7437,7440],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7437,7440],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7748,7751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7748,7751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \r\n  ref, \r\n  onValue, \r\n  set, \r\n  update, \r\n  remove,\r\n  serverTimestamp,\r\n  onDisconnect,\r\n  push,\r\n  get,\r\n  off\r\n} from 'firebase/database';\r\nimport { rtdb } from '../../../lib/firebase/config';\r\nimport { logger } from '../utils/logger';\r\n\r\n/**\r\n * Realtime Database Service for multiplayer\r\n * Handles instant sync for:\r\n * - Player presence (online/offline)\r\n * - Ready status\r\n * - Game timer\r\n * - Answer progress\r\n * - Chat messages\r\n */\r\nclass RealtimeMultiplayerService {\r\n  private listeners: Map<string, any> = new Map();\r\n\r\n  /**\r\n   * Setup presence system - auto set offline on disconnect\r\n   */\r\n  async setupPresence(roomId: string, userId: string, userName: string) {\r\n    try {\r\n      const presenceRef = ref(rtdb, `rooms/${roomId}/presence/${userId}`);\r\n      \r\n      // Set online - ph·∫£i match v·ªõi database.rules.json validation\r\n      await set(presenceRef, {\r\n        isOnline: true,\r\n        username: userName,\r\n        lastSeen: Date.now(),\r\n      });\r\n\r\n      logger.success(`Presence setup for ${userName} in room ${roomId}`);\r\n\r\n      // Auto set offline on disconnect\r\n      onDisconnect(presenceRef).set({\r\n        isOnline: false,\r\n        username: userName,\r\n        lastSeen: Date.now(),\r\n      });\r\n    } catch (error) {\r\n      logger.error('Failed to setup presence:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to player presence (real-time online/offline)\r\n   */\r\n  listenToPresence(roomId: string, callback: (presence: Record<string, any>) => void) {\r\n    const presenceRef = ref(rtdb, `rooms/${roomId}/presence`);\r\n    \r\n    const unsubscribe = onValue(presenceRef, (snapshot) => {\r\n      const presence = snapshot.val() || {};\r\n      const onlineCount = Object.values(presence).filter((p: any) => p.isOnline).length;\r\n      \r\n      logger.debug('Presence updated:', { \r\n        roomId, \r\n        onlineCount,\r\n        players: Object.keys(presence)\r\n      });\r\n      \r\n      callback(presence);\r\n    }, (error) => {\r\n      logger.error('Presence listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `presence_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: presenceRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(presenceRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Update player ready status (instant sync)\r\n   */\r\n  async updatePlayerStatus(roomId: string, userId: string, isReady: boolean) {\r\n    try {\r\n      const statusRef = ref(rtdb, `rooms/${roomId}/playerStatuses/${userId}`);\r\n      \r\n      await set(statusRef, {\r\n        isReady: isReady,\r\n        updatedAt: Date.now(),\r\n      });\r\n\r\n      logger.info(`Player ${userId} ready status: ${isReady}`);\r\n    } catch (error) {\r\n      logger.error('Failed to update player status:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to all players' ready status\r\n   */\r\n  listenToPlayerStatuses(roomId: string, callback: (players: Record<string, any>) => void) {\r\n    const playersRef = ref(rtdb, `rooms/${roomId}/playerStatuses`);\r\n    \r\n    const unsubscribe = onValue(playersRef, (snapshot) => {\r\n      const players = snapshot.val() || {};\r\n      const readyCount = Object.values(players).filter((p: any) => p.isReady).length;\r\n      const totalCount = Object.keys(players).length;\r\n      \r\n      logger.debug('Players status updated:', { \r\n        roomId, \r\n        ready: readyCount, \r\n        total: totalCount,\r\n        playerIds: Object.keys(players)\r\n      });\r\n      \r\n      callback(players);\r\n    }, (error) => {\r\n      logger.error('Players listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `players_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: playersRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(playersRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Broadcast game timer (sync across all clients)\r\n   */\r\n  async updateGameTimer(roomId: string, timeRemaining: number, questionIndex: number) {\r\n    try {\r\n      const timerRef = ref(rtdb, `rooms/${roomId}/game/timer`);\r\n      \r\n      await set(timerRef, {\r\n        timeLeft: timeRemaining,\r\n        isRunning: timeRemaining > 0,\r\n        updatedAt: Date.now(),\r\n      });\r\n      \r\n      // Also update current question\r\n      const gameRef = ref(rtdb, `rooms/${roomId}/game`);\r\n      await update(gameRef, {\r\n        currentQuestion: questionIndex,\r\n        updatedAt: Date.now(),\r\n      });\r\n    } catch (error) {\r\n      logger.error('Failed to update game timer:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to game timer\r\n   */\r\n  listenToGameTimer(roomId: string, callback: (timer: any) => void) {\r\n    const timerRef = ref(rtdb, `rooms/${roomId}/game/timer`);\r\n    \r\n    const unsubscribe = onValue(timerRef, (snapshot) => {\r\n      const timer = snapshot.val();\r\n      if (timer) {\r\n        logger.debug('Timer updated:', timer);\r\n        callback(timer);\r\n      }\r\n    }, (error) => {\r\n      logger.error('Timer listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `timer_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: timerRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(timerRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Submit answer progress (for tracking who answered)\r\n   */\r\n  async submitAnswerProgress(roomId: string, questionId: string, userId: string) {\r\n    try {\r\n      const answerRef = ref(\r\n        rtdb, \r\n        `rooms/${roomId}/answerProgress/${userId}`\r\n      );\r\n      \r\n      await set(answerRef, {\r\n        hasAnswered: true,\r\n        answeredAt: Date.now(),\r\n      });\r\n\r\n      logger.debug(`Answer progress: ${userId} answered question ${questionId}`);\r\n    } catch (error) {\r\n      logger.error('Failed to submit answer progress:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to answer progress (how many players answered for a specific question)\r\n   * Updated to support per-question tracking\r\n   */\r\n  listenToAnswerProgress(\r\n    roomId: string, \r\n    questionIndex: number, \r\n    callback: (count: number, answers: any) => void\r\n  ) {\r\n    const answersRef = ref(rtdb, `rooms/${roomId}/answerProgress/${questionIndex}`);\r\n    \r\n    const unsubscribe = onValue(answersRef, (snapshot) => {\r\n      const answers = snapshot.val() || {};\r\n      const count = Object.values(answers).filter((a: any) => a.hasAnswered).length;\r\n      \r\n      logger.debug(`Answer progress Q${questionIndex}: ${count} players answered`);\r\n      callback(count, answers);\r\n    }, (error) => {\r\n      logger.error('Answer progress listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `answers_${roomId}_${questionIndex}`;\r\n    this.listeners.set(listenerKey, { ref: answersRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(answersRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Send chat message (instant delivery)\r\n   */\r\n  async sendChatMessage(roomId: string, message: any) {\r\n    try {\r\n      const messagesRef = ref(rtdb, `rooms/${roomId}/chat`);\r\n      const newMessageRef = push(messagesRef);\r\n      \r\n      await set(newMessageRef, {\r\n        ...message,\r\n        timestamp: serverTimestamp(),\r\n      });\r\n\r\n      logger.debug('Chat message sent:', message.message);\r\n    } catch (error) {\r\n      logger.error('Failed to send chat message:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to chat messages\r\n   */\r\n  listenToChatMessages(roomId: string, callback: (messages: any[]) => void) {\r\n    const messagesRef = ref(rtdb, `rooms/${roomId}/chat`);\r\n    \r\n    const unsubscribe = onValue(messagesRef, (snapshot) => {\r\n      const messagesObj = snapshot.val() || {};\r\n      const messages = Object.entries(messagesObj).map(([key, value]) => ({\r\n        id: key,\r\n        ...value as any,\r\n      })).sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\r\n      \r\n      logger.debug(`Chat updated: ${messages.length} messages`);\r\n      callback(messages);\r\n    }, (error) => {\r\n      logger.error('Chat listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `chat_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: messagesRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(messagesRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Update current question index (sync game state)\r\n   */\r\n  async updateCurrentQuestion(roomId: string, questionIndex: number) {\r\n    try {\r\n      const gameRef = ref(rtdb, `rooms/${roomId}/game`);\r\n      \r\n      await update(gameRef, {\r\n        currentQuestion: questionIndex,\r\n        updatedAt: Date.now(),\r\n      });\r\n\r\n      logger.info(`Current question updated: ${questionIndex}`);\r\n    } catch (error) {\r\n      logger.error('Failed to update current question:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to current question changes\r\n   */\r\n  listenToCurrentQuestion(roomId: string, callback: (index: number) => void) {\r\n    const questionRef = ref(rtdb, `rooms/${roomId}/game/currentQuestion`);\r\n    \r\n    const unsubscribe = onValue(questionRef, (snapshot) => {\r\n      const index = snapshot.val();\r\n      if (index !== null && index !== undefined) {\r\n        logger.debug(`Question changed to: ${index}`);\r\n        callback(index);\r\n      }\r\n    }, (error) => {\r\n      logger.error('Question listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `question_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: questionRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(questionRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set room as active (for cleanup purposes)\r\n   */\r\n  async setRoomActive(roomId: string, isActive: boolean) {\r\n    try {\r\n      const roomRef = ref(rtdb, `rooms/${roomId}/metadata`);\r\n      \r\n      await set(roomRef, {\r\n        active: isActive,\r\n        updatedAt: Date.now(),\r\n      });\r\n    } catch (error) {\r\n      logger.error('Failed to set room active status:', error);\r\n    }\r\n  }\r\n\r\n  // ============================================================================\r\n  // SYNCHRONIZED GAME TIMER\r\n  // ============================================================================\r\n\r\n  /**\r\n   * Start synchronized game timer\r\n   * Server-authoritative: only the host (first player alphabetically) should call this\r\n   */\r\n  async startQuestionTimer(roomId: string, durationSeconds: number) {\r\n    try {\r\n      const timerRef = ref(rtdb, `rooms/${roomId}/game/timer`);\r\n      \r\n      await set(timerRef, {\r\n        startedAt: Date.now(),\r\n        duration: durationSeconds,\r\n        remaining: durationSeconds,\r\n        isActive: true,\r\n      });\r\n\r\n      logger.info(`Question timer started: ${durationSeconds}s`);\r\n    } catch (error) {\r\n      logger.error('Failed to start question timer:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to synchronized timer\r\n   */\r\n  listenToTimer(roomId: string, callback: (timerData: {\r\n    remaining: number;\r\n    isActive: boolean;\r\n    startedAt: number;\r\n    duration: number;\r\n  } | null) => void) {\r\n    const timerRef = ref(rtdb, `rooms/${roomId}/game/timer`);\r\n    \r\n    const unsubscribe = onValue(timerRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        // Calculate remaining time based on server time\r\n        const elapsed = Math.floor((Date.now() - data.startedAt) / 1000);\r\n        const remaining = Math.max(0, data.duration - elapsed);\r\n        \r\n        callback({\r\n          remaining,\r\n          isActive: data.isActive && remaining > 0,\r\n          startedAt: data.startedAt,\r\n          duration: data.duration,\r\n        });\r\n      } else {\r\n        callback(null);\r\n      }\r\n    }, (error) => {\r\n      logger.error('Timer listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `timer_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: timerRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(timerRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Stop the question timer\r\n   */\r\n  async stopQuestionTimer(roomId: string) {\r\n    try {\r\n      const timerRef = ref(rtdb, `rooms/${roomId}/game/timer`);\r\n      \r\n      await update(timerRef, {\r\n        isActive: false,\r\n        remaining: 0,\r\n      });\r\n\r\n      logger.info('Question timer stopped');\r\n    } catch (error) {\r\n      logger.error('Failed to stop question timer:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Track who has answered the current question\r\n   */\r\n  async markPlayerAnswered(roomId: string, userId: string, questionIndex: number) {\r\n    try {\r\n      const answerRef = ref(rtdb, `rooms/${roomId}/answerProgress/${questionIndex}/${userId}`);\r\n      \r\n      await set(answerRef, {\r\n        hasAnswered: true,\r\n        timestamp: Date.now(),\r\n      });\r\n\r\n      logger.info(`Player ${userId} marked as answered for Q${questionIndex}`);\r\n    } catch (error) {\r\n      logger.error('Failed to mark player as answered:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear answer progress for next question\r\n   */\r\n  async clearAnswerProgress(roomId: string, questionIndex: number) {\r\n    try {\r\n      const progressRef = ref(rtdb, `rooms/${roomId}/answerProgress/${questionIndex}`);\r\n      await remove(progressRef);\r\n      logger.info(`Cleared answer progress for Q${questionIndex}`);\r\n    } catch (error) {\r\n      logger.error('Failed to clear answer progress:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleanup all listeners for a room\r\n   */\r\n  cleanupRoom(roomId: string) {\r\n    logger.info(`Cleaning up listeners for room ${roomId}`);\r\n    \r\n    this.listeners.forEach((listener, key) => {\r\n      if (key.includes(roomId)) {\r\n        if (listener.ref) {\r\n          off(listener.ref);\r\n        }\r\n        this.listeners.delete(key);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Delete room data (when game ends)\r\n   */\r\n  async deleteRoom(roomId: string) {\r\n    try {\r\n      const roomRef = ref(rtdb, `rooms/${roomId}`);\r\n      await remove(roomRef);\r\n      \r\n      logger.success(`Room ${roomId} deleted from Realtime DB`);\r\n    } catch (error) {\r\n      logger.error('Failed to delete room:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if room exists in Realtime DB\r\n   */\r\n  async roomExists(roomId: string): Promise<boolean> {\r\n    try {\r\n      const roomRef = ref(rtdb, `rooms/${roomId}/metadata`);\r\n      const snapshot = await get(roomRef);\r\n      return snapshot.exists();\r\n    } catch (error) {\r\n      logger.error('Failed to check room existence:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all active listeners count (for debugging)\r\n   */\r\n  getActiveListenersCount(): number {\r\n    return this.listeners.size;\r\n  }\r\n\r\n  /**\r\n   * Cleanup all listeners (call on app unmount)\r\n   */\r\n  cleanupAll() {\r\n    logger.info(`Cleaning up all listeners (${this.listeners.size})`);\r\n    \r\n    this.listeners.forEach((listener) => {\r\n      if (listener.ref) {\r\n        off(listener.ref);\r\n      }\r\n    });\r\n    \r\n    this.listeners.clear();\r\n  }\r\n\r\n  /**\r\n   * Start countdown for game start (synchronized)\r\n   */\r\n  async startCountdown(roomId: string, seconds: number) {\r\n    try {\r\n      const countdownRef = ref(rtdb, `rooms/${roomId}/countdown`);\r\n      \r\n      await set(countdownRef, {\r\n        remaining: seconds,\r\n        startedAt: Date.now(),\r\n        isActive: true,\r\n      });\r\n\r\n      logger.info(`Countdown started: ${seconds} seconds`);\r\n    } catch (error) {\r\n      logger.error('Failed to start countdown:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to countdown (synchronized across all clients)\r\n   */\r\n  listenToCountdown(roomId: string, callback: (countdown: { remaining: number; isActive: boolean } | null) => void) {\r\n    const countdownRef = ref(rtdb, `rooms/${roomId}/countdown`);\r\n    \r\n    const unsubscribe = onValue(countdownRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        logger.debug('Countdown updated:', data);\r\n        callback(data);\r\n      } else {\r\n        callback(null);\r\n      }\r\n    }, (error) => {\r\n      logger.error('Countdown listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `countdown_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: countdownRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(countdownRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Cancel countdown\r\n   */\r\n  async cancelCountdown(roomId: string) {\r\n    try {\r\n      const countdownRef = ref(rtdb, `rooms/${roomId}/countdown`);\r\n      await remove(countdownRef);\r\n      \r\n      logger.info('Countdown cancelled');\r\n    } catch (error) {\r\n      logger.error('Failed to cancel countdown:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set game status (waiting, starting, playing, finished)\r\n   */\r\n  async setGameStatus(roomId: string, status: 'waiting' | 'starting' | 'playing' | 'finished') {\r\n    try {\r\n      const statusRef = ref(rtdb, `rooms/${roomId}/gameStatus`);\r\n      \r\n      await set(statusRef, {\r\n        status,\r\n        updatedAt: Date.now(),\r\n      });\r\n\r\n      logger.info(`Game status updated: ${status}`);\r\n    } catch (error) {\r\n      logger.error('Failed to update game status:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to game status changes\r\n   */\r\n  listenToGameStatus(roomId: string, callback: (status: string) => void) {\r\n    const statusRef = ref(rtdb, `rooms/${roomId}/gameStatus/status`);\r\n    \r\n    const unsubscribe = onValue(statusRef, (snapshot) => {\r\n      const status = snapshot.val();\r\n      if (status) {\r\n        logger.debug(`Game status changed: ${status}`);\r\n        callback(status);\r\n      }\r\n    }, (error) => {\r\n      logger.error('Game status listener error:', error);\r\n    });\r\n\r\n    const listenerKey = `gameStatus_${roomId}`;\r\n    this.listeners.set(listenerKey, { ref: statusRef, unsubscribe });\r\n    \r\n    return () => {\r\n      off(statusRef);\r\n      this.listeners.delete(listenerKey);\r\n    };\r\n  }\r\n}\r\n\r\nexport default new RealtimeMultiplayerService();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\types\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2480,2483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2480,2483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":135,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2851,2854],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2851,2854],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Question } from '../../quiz/types';\r\n\r\nexport interface Player {\r\n  id: string;\r\n  name: string;\r\n  avatar?: string;\r\n  isReady: boolean;\r\n  score: number;\r\n  joinedAt: number;\r\n}\r\n\r\nexport interface MultiplayerRoom {\r\n  id: string;\r\n  // Removed hostId - all players are equal\r\n  quiz: {\r\n    id: string;\r\n    title: string;\r\n    questions: Question[];\r\n  };\r\n  players: Player[];\r\n  settings: {\r\n    maxPlayers: number;\r\n    questionTimeLimit: number;\r\n    showLeaderboard: boolean;\r\n    allowSpectators: boolean;\r\n  };\r\n  status: 'waiting' | 'starting' | 'playing' | 'finished';\r\n  currentQuestion?: number;\r\n  questionAnswers?: {\r\n    [questionIndex: number]: {\r\n      [playerId: string]: {\r\n        answer: string;\r\n        timeToAnswer: number;\r\n        pointsEarned: number;\r\n        isCorrect: boolean;\r\n        timestamp: number;\r\n      };\r\n    };\r\n  };\r\n  createdAt: number;\r\n  startedAt?: number;\r\n  finishedAt?: number;\r\n}\r\n\r\nexport interface GameAnswer {\r\n  playerId: string;\r\n  playerName: string;\r\n  answer: string;\r\n  timeToAnswer: number;\r\n  pointsEarned: number;\r\n  isCorrect: boolean;\r\n  timestamp: number;\r\n}\r\n\r\nexport interface QuestionResult {\r\n  questionIndex: number;\r\n  question: Question;\r\n  answers: GameAnswer[];\r\n  correctAnswer: string;\r\n  totalAnswers: number;\r\n}\r\n\r\nexport interface GameStatistics {\r\n  totalPlayers: number;\r\n  totalQuestions: number;\r\n  averageScore: number;\r\n  topScore: number;\r\n  fastestAnswer: number;\r\n  completionRate: number;\r\n}\r\n\r\nexport interface RoomSettings {\r\n  maxPlayers: number;\r\n  questionTimeLimit: number;\r\n  showLeaderboard: boolean;\r\n  allowSpectators: boolean;\r\n  enableChat?: boolean;\r\n  autoAdvanceTime?: number;\r\n}\r\n\r\nexport interface ChatMessage {\r\n  id: string;\r\n  playerId: string;\r\n  playerName: string;\r\n  message: string;\r\n  timestamp: number;\r\n  type: 'message' | 'system' | 'emoji';\r\n}\r\n\r\nexport interface PlayerStats {\r\n  playerId: string;\r\n  playerName: string;\r\n  totalScore: number;\r\n  correctAnswers: number;\r\n  averageTimePerAnswer: number;\r\n  streak: number;\r\n  rank: number;\r\n}\r\n\r\nexport interface LeaderboardEntry {\r\n  playerId: string;\r\n  playerName: string;\r\n  score: number;\r\n  correctAnswers: number;\r\n  totalQuestions: number;\r\n  averageTime: number;\r\n  rank: number;\r\n  avatar?: string;\r\n}\r\n\r\n// Real-time events\r\nexport interface MultiplayerEvent {\r\n  type: 'player_joined' | 'player_left' | 'game_started' | 'question_changed' | 'game_finished' | 'chat_message';\r\n  data: any;\r\n  timestamp: number;\r\n}\r\n\r\n// Room creation data\r\nexport interface CreateRoomData {\r\n  quizId: string;\r\n  settings: RoomSettings;\r\n  isPrivate?: boolean;\r\n}\r\n\r\n// Join room data\r\nexport interface JoinRoomData {\r\n  roomId: string;\r\n  playerName: string;\r\n  avatar?: string;\r\n}\r\n\r\nexport interface MultiplayerError {\r\n  code: string;\r\n  message: string;\r\n  details?: any;\r\n}\r\n\r\n// Additional types for better type safety\r\nexport interface Quiz {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  questions: Question[];\r\n  category?: string;\r\n  difficulty?: 'easy' | 'medium' | 'hard';\r\n  createdBy?: string;\r\n  createdAt?: Date;\r\n}\r\n\r\nexport interface RoomConfig {\r\n  name: string;\r\n  maxPlayers: number;\r\n  isPrivate: boolean;\r\n  password?: string;\r\n  settings: {\r\n    timePerQuestion: number;\r\n    showLeaderboard: boolean;\r\n    showAnswers?: boolean;\r\n    allowLateJoin: boolean;\r\n    autoStart?: boolean;\r\n  };\r\n}\r\n\r\nexport interface PlayerResult {\r\n  playerId: string;\r\n  playerName: string;\r\n  isCorrect: boolean;\r\n  selectedAnswer: number | null;\r\n  points: number;\r\n  timeSpent: number;\r\n}\r\n\r\nexport interface GameResults {\r\n  roomId: string;\r\n  quizId: string;\r\n  players: PlayerStats[];\r\n  gameStats: GameStatistics;\r\n  completedAt: Date;\r\n}\r\n\r\nexport interface GameData {\r\n  questions: Question[];\r\n  currentQuestionIndex: number;\r\n  questionStartTime: number;\r\n  questionEndTime: number;\r\n  serverTimeOffset: number;\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\multiplayer\\utils\\logger.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":11,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[294,297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[294,297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[441,444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[441,444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[592,595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[592,595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[744,747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[744,747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[907,910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[907,910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1062,1065],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1062,1065],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Multiplayer Logging Utility\r\n * Environment-based logging that only works in development\r\n */\r\n\r\nconst isDevelopment = import.meta.env.DEV || import.meta.env.MODE === 'development';\r\n\r\nclass MultiplayerLogger {\r\n  private prefix = 'üéÆ [Multiplayer]';\r\n\r\n  log(message: string, ...args: any[]): void {\r\n    if (isDevelopment) {\r\n      console.log(`${this.prefix} ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  info(message: string, ...args: any[]): void {\r\n    if (isDevelopment) {\r\n      console.info(`${this.prefix} ‚ÑπÔ∏è ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  warn(message: string, ...args: any[]): void {\r\n    if (isDevelopment) {\r\n      console.warn(`${this.prefix} ‚ö†Ô∏è ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  error(message: string, ...args: any[]): void {\r\n    // Always log errors, even in production\r\n    console.error(`${this.prefix} ‚ùå ${message}`, ...args);\r\n  }\r\n\r\n  debug(message: string, ...args: any[]): void {\r\n    if (isDevelopment) {\r\n      console.debug(`${this.prefix} üîç ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  success(message: string, ...args: any[]): void {\r\n    if (isDevelopment) {\r\n      console.log(`${this.prefix} ‚úÖ ${message}`, ...args);\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new MultiplayerLogger();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\admin.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[532,535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[532,535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[538,541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[538,541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ...API admin, gi·ªØ nguy√™n v·ªã tr√≠ chu·∫©n h√≥a...\r\n// ...existing code...\r\n// ...existing code...\r\nimport {\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  limit,\r\n  startAfter,\r\n  DocumentSnapshot,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz, QuizFilters } from '../types';\r\nimport { QUIZZES_COLLECTION } from './base';\r\nimport { applyQuizFilters } from './shared';\r\n\r\n/**\r\n * Convert Firestore Timestamp fields to ISO strings\r\n */\r\nconst convertTimestamps = (data: any): any => {\r\n  const converted = { ...data };\r\n  \r\n  // Convert common timestamp fields\r\n  const timestampFields = ['createdAt', 'updatedAt', 'submittedAt', 'completedAt', 'approvedAt'];\r\n  \r\n  timestampFields.forEach(field => {\r\n    if (converted[field]) {\r\n      if (converted[field]?.toDate) {\r\n        // Firestore Timestamp\r\n        converted[field] = converted[field].toDate().toISOString();\r\n      } else if (converted[field] instanceof Date) {\r\n        // JavaScript Date\r\n        converted[field] = converted[field].toISOString();\r\n      } else if (typeof converted[field] !== 'string') {\r\n        // Other types, convert to empty string\r\n        converted[field] = '';\r\n      }\r\n    }\r\n  });\r\n  \r\n  return converted;\r\n};\r\n\r\n/**\r\n * Get quizzes for ADMIN role - can see ALL quizzes\r\n */\r\nexport const getAdminQuizzes = async (\r\n  filters?: QuizFilters, \r\n  pageSize = 20, \r\n  lastDoc?: DocumentSnapshot\r\n): Promise<{\r\n  quizzes: Quiz[];\r\n  lastDoc: DocumentSnapshot | null;\r\n  hasMore: boolean;\r\n}> => {\r\n  try {\r\n    console.log('üîç [ADMIN] Fetching ALL quizzes from Firestore...');\r\n    \r\n    let q = query(collection(db, QUIZZES_COLLECTION));\r\n    q = query(q, orderBy('createdAt', 'desc'), limit(pageSize || 50));\r\n\r\n    if (lastDoc) {\r\n      q = query(q, startAfter(lastDoc));\r\n    }\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n    let lastDocument: DocumentSnapshot | null = null;\r\n\r\n    console.log('üìù [ADMIN] Found', querySnapshot.size, 'quiz documents');\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      console.log('üìù [ADMIN] Quiz data:', doc.id, {\r\n        title: convertedData.title,\r\n        status: convertedData.status,\r\n        isPublished: convertedData.isPublished,\r\n        createdBy: convertedData.createdBy\r\n      });\r\n      quizzes.push({\r\n        id: doc.id,\r\n        ...convertedData,\r\n      } as Quiz);\r\n      lastDocument = doc;\r\n    });\r\n\r\n    console.log('‚úÖ [ADMIN] Total quizzes before filtering:', quizzes.length);\r\n\r\n    // Admin sees ALL quizzes - no role-based filtering\r\n    let filteredQuizzes = quizzes;\r\n\r\n    // Apply client-side filters only\r\n    filteredQuizzes = applyQuizFilters(filteredQuizzes, filters);\r\n\r\n    console.log('‚úÖ [ADMIN] Returning', filteredQuizzes.length, 'filtered quizzes');\r\n\r\n    return {\r\n      quizzes: filteredQuizzes,\r\n      lastDoc: lastDocument,\r\n      hasMore: querySnapshot.size === pageSize,\r\n    };\r\n  } catch (error) {\r\n    console.error('‚ùå [ADMIN] Error fetching quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i danh s√°ch quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quizzes created by a specific user (Admin function)\r\n */\r\nexport const getUserQuizzesAdmin = async (userId: string): Promise<Quiz[]> => {\r\n  try {\r\n    console.log('üîç [ADMIN] Fetching quizzes for user:', userId);\r\n    \r\n    const q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('createdBy', '==', userId),\r\n      orderBy('createdAt', 'desc')\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      quizzes.push({ id: doc.id, ...convertedData } as Quiz);\r\n    });\r\n\r\n    console.log('‚úÖ [ADMIN] Found', quizzes.length, 'quizzes for user:', userId);\r\n    return quizzes;\r\n  } catch (error) {\r\n    console.error('‚ùå [ADMIN] Error fetching user quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i quiz c·ªßa ng∆∞·ªùi d√πng');\r\n  }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\ai.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":4,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[153,156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[153,156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Placeholder API functions for AI integration\r\n// This file is kept for backward compatibility\r\n\r\nexport const generateQuestionsWithAI = async (_data: any) => {\r\n  throw new Error('This function is deprecated. Use ClientSideAIGenerator instead.');\r\n};\r\n\r\nexport const testAIConnection = async () => {\r\n  throw new Error('This function is deprecated. Use ClientSideAIGenerator instead.');\r\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\base.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[496,499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[496,499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[502,505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[502,505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4010,4013],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4010,4013],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":245,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7955,7958],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7955,7958],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7993,7996],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7993,7996],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":247,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8028,8031],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8028,8031],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  collection,\r\n  doc,\r\n  addDoc,\r\n  updateDoc,\r\n  deleteDoc,\r\n  getDoc,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz, QuizResult } from '../types';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst QUIZZES_COLLECTION = 'quizzes';\r\nconst QUIZ_RESULTS_COLLECTION = 'quizResults';\r\n\r\n/**\r\n * Convert Firestore Timestamp fields to ISO strings (recursive)\r\n */\r\nconst convertTimestamps = (data: any): any => {\r\n  if (!data || typeof data !== 'object') {\r\n    return data;\r\n  }\r\n\r\n  // Handle arrays\r\n  if (Array.isArray(data)) {\r\n    return data.map(item => convertTimestamps(item));\r\n  }\r\n\r\n  const converted = { ...data };\r\n  \r\n  // Convert all fields recursively\r\n  Object.keys(converted).forEach(key => {\r\n    const value = converted[key];\r\n    \r\n    if (value && typeof value === 'object') {\r\n      // Check if it's a Firestore Timestamp\r\n      if (value.toDate && typeof value.toDate === 'function') {\r\n        // Firestore Timestamp\r\n        converted[key] = value.toDate().toISOString();\r\n      } else if (value instanceof Date) {\r\n        // JavaScript Date\r\n        converted[key] = value.toISOString();\r\n      } else if (Array.isArray(value)) {\r\n        // Recursively handle arrays\r\n        converted[key] = value.map(item => convertTimestamps(item));\r\n      } else {\r\n        // Recursively handle nested objects\r\n        converted[key] = convertTimestamps(value);\r\n      }\r\n    }\r\n  });\r\n  \r\n  return converted;\r\n};\r\n\r\n/**\r\n * Create a new quiz\r\n */\r\nexport const createQuiz = async (quizData: Omit<Quiz, 'id' | 'createdAt' | 'updatedAt'>): Promise<string> => {\r\n  try {\r\n    const quiz: Omit<Quiz, 'id'> = {\r\n      ...quizData,\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    const docRef = await addDoc(collection(db, QUIZZES_COLLECTION), quiz);\r\n    toast.success('T·∫°o quiz th√†nh c√¥ng!');\r\n    return docRef.id;\r\n  } catch (error) {\r\n    console.error('Error creating quiz:', error);\r\n    toast.error('Kh√¥ng th·ªÉ t·∫°o quiz');\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫°o quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Update an existing quiz\r\n */\r\nexport const updateQuiz = async (quizId: string, updates: Partial<Quiz>): Promise<void> => {\r\n  try {\r\n    const quizRef = doc(db, QUIZZES_COLLECTION, quizId);\r\n    await updateDoc(quizRef, {\r\n      ...updates,\r\n      updatedAt: new Date(),\r\n    });\r\n    toast.success('C·∫≠p nh·∫≠t quiz th√†nh c√¥ng!');\r\n  } catch (error) {\r\n    console.error('Error updating quiz:', error);\r\n    toast.error('Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t quiz');\r\n    throw new Error('Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Delete a quiz\r\n */\r\nexport const deleteQuiz = async (quizId: string): Promise<void> => {\r\n  try {\r\n    await deleteDoc(doc(db, QUIZZES_COLLECTION, quizId));\r\n    toast.success('X√≥a quiz th√†nh c√¥ng!');\r\n  } catch (error) {\r\n    console.error('Error deleting quiz:', error);\r\n    toast.error('Kh√¥ng th·ªÉ x√≥a quiz');\r\n    throw new Error('Kh√¥ng th·ªÉ x√≥a quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quiz by ID\r\n */\r\nexport const getQuizById = async (quizId: string): Promise<Quiz | null> => {\r\n  try {\r\n    const quizDoc = await getDoc(doc(db, QUIZZES_COLLECTION, quizId));\r\n    if (quizDoc.exists()) {\r\n      const data = quizDoc.data();\r\n      const convertedData = convertTimestamps(data);\r\n      return {\r\n        id: quizDoc.id,\r\n        ...convertedData,\r\n      } as Quiz;\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error fetching quiz:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Submit quiz result\r\n */\r\nexport const submitQuizResult = async (result: Omit<QuizResult, 'id'>): Promise<string> => {\r\n  console.log('üîç [submitQuizResult] Input data:', result);\r\n  \r\n  // Enhanced validation for all required fields\r\n  const requiredFields = ['userId', 'quizId', 'score', 'correctAnswers', 'totalQuestions', 'answers', 'completedAt'];\r\n  const missingFields = requiredFields.filter(field => {\r\n    const value = (result as any)[field];\r\n    if (field === 'answers') return !Array.isArray(value);\r\n    if (field === 'completedAt') return !value;\r\n    if (['score', 'correctAnswers', 'totalQuestions'].includes(field)) {\r\n      return typeof value !== 'number' || isNaN(value);\r\n    }\r\n    return !value;\r\n  });\r\n\r\n  if (missingFields.length > 0) {\r\n    console.error('‚ùå [submitQuizResult] Missing required fields:', missingFields, result);\r\n    throw new Error(`Thi·∫øu tr∆∞·ªùng b·∫Øt bu·ªôc: ${missingFields.join(', ')}`);\r\n  }\r\n\r\n  // Validate score range\r\n  if (result.score < 0 || result.score > 100) {\r\n    console.error('‚ùå [submitQuizResult] Invalid score range:', result.score);\r\n    throw new Error('ƒêi·ªÉm s·ªë ph·∫£i trong kho·∫£ng 0-100');\r\n  }\r\n\r\n  // Validate correctAnswers vs totalQuestions\r\n  if (result.correctAnswers > result.totalQuestions) {\r\n    console.error('‚ùå [submitQuizResult] correctAnswers > totalQuestions:', { \r\n      correctAnswers: result.correctAnswers, \r\n      totalQuestions: result.totalQuestions \r\n    });\r\n    throw new Error('S·ªë c√¢u ƒë√∫ng kh√¥ng th·ªÉ l·ªõn h∆°n t·ªïng s·ªë c√¢u');\r\n  }\r\n\r\n  // Validate answers array has isCorrect field\r\n  const answersWithoutCorrect = result.answers.filter(a => typeof a.isCorrect !== 'boolean');\r\n  if (answersWithoutCorrect.length > 0) {\r\n    console.warn('‚ö†Ô∏è [submitQuizResult] Some answers missing isCorrect field:', answersWithoutCorrect.length);\r\n  }\r\n  \r\n  console.log('‚úÖ [submitQuizResult] All validations passed, saving to Firestore...');\r\n  console.log('üìä [submitQuizResult] Final data to save:', {\r\n    userId: result.userId,\r\n    quizId: result.quizId,\r\n    score: result.score,\r\n    correctAnswers: result.correctAnswers,\r\n    totalQuestions: result.totalQuestions,\r\n    answersCount: result.answers.length,\r\n    answersWithCorrect: result.answers.filter(a => a.isCorrect).length\r\n  });\r\n  \r\n  try {\r\n    const docRef = await addDoc(collection(db, QUIZ_RESULTS_COLLECTION), result);\r\n    console.log('‚úÖ [submitQuizResult] Successfully saved with ID:', docRef.id);\r\n    toast.success('N·ªôp b√†i th√†nh c√¥ng!');\r\n    return docRef.id;\r\n  } catch (error) {\r\n    console.error('‚ùå [submitQuizResult] Firestore error:', error);\r\n    console.error('‚ùå [submitQuizResult] Data that failed to save:', result);\r\n    toast.error('Kh√¥ng th·ªÉ l∆∞u k·∫øt qu·∫£ quiz');\r\n    throw new Error('Kh√¥ng th·ªÉ l∆∞u k·∫øt qu·∫£ quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quiz results for a specific quiz\r\n */\r\nexport const getQuizResults = async (quizId: string): Promise<QuizResult[]> => {\r\n  try {\r\n    console.log('üîç getQuizResults called for quizId:', quizId);\r\n    console.log('üîç Collection name:', QUIZ_RESULTS_COLLECTION);\r\n    \r\n    const q = query(\r\n      collection(db, QUIZ_RESULTS_COLLECTION),\r\n      where('quizId', '==', quizId),\r\n      orderBy('completedAt', 'desc')\r\n    );\r\n\r\n    console.log('üîç Executing Firestore query...');\r\n    const querySnapshot = await getDocs(q);\r\n    const results: QuizResult[] = [];\r\n    \r\n    console.log('üìä Found', querySnapshot.size, 'quiz results');\r\n\r\n    if (querySnapshot.empty) {\r\n      console.log('üìä No quiz results found for quizId:', quizId);\r\n      console.log('üìä This could mean:');\r\n      console.log('   - No one has completed this quiz yet');\r\n      console.log('   - The quizId is incorrect');\r\n      console.log('   - There are Firestore permission issues');\r\n      return [];\r\n    }\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const data = doc.data();\r\n      console.log('üìä Raw document data:', { id: doc.id, ...data });\r\n      const convertedData = convertTimestamps(data);\r\n      const result = { id: doc.id, ...convertedData } as QuizResult;\r\n      console.log('üìä Converted quiz result:', result);\r\n      results.push(result);\r\n    });\r\n    \r\n    console.log('üìä Returning', results.length, 'quiz results');\r\n    return results;\r\n  } catch (error) {\r\n    console.error('‚ùå Error fetching quiz results:', error);\r\n    console.error('‚ùå Error details:', {\r\n      message: (error as any)?.message,\r\n      code: (error as any)?.code,\r\n      name: (error as any)?.name\r\n    });\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i k·∫øt qu·∫£ quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quiz result by ID\r\n */\r\nexport async function getQuizResultById(attemptId: string) {\r\n  console.log('üîç [getQuizResultById] Fetching result for ID:', attemptId);\r\n  \r\n  try {\r\n    const docRef = doc(db, QUIZ_RESULTS_COLLECTION, attemptId);\r\n    const docSnap = await getDoc(docRef);\r\n    \r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data();\r\n      console.log('‚úÖ [getQuizResultById] Raw Firestore data:', data);\r\n      \r\n      const convertedData = convertTimestamps(data);\r\n      const result = { id: docSnap.id, ...convertedData };\r\n      \r\n      console.log('‚úÖ [getQuizResultById] Converted data:', result);\r\n      console.log('üìä [getQuizResultById] Key fields:', {\r\n        score: result.score,\r\n        correctAnswers: result.correctAnswers,\r\n        totalQuestions: result.totalQuestions,\r\n        answersCount: result.answers?.length,\r\n        userId: result.userId,\r\n        quizId: result.quizId\r\n      });\r\n      \r\n      return result;\r\n    } else {\r\n      console.warn('‚ùå [getQuizResultById] No document found for ID:', attemptId);\r\n      return null;\r\n    }\r\n  } catch (error) {\r\n    console.error('‚ùå [getQuizResultById] Error fetching document:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Export collection names for other modules\r\nexport { QUIZZES_COLLECTION, QUIZ_RESULTS_COLLECTION };\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\creator.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[435,438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[435,438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[441,444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[441,444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  limit,\r\n  startAfter,\r\n  DocumentSnapshot,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz, QuizFilters } from '../types';\r\nimport { QUIZZES_COLLECTION } from './base';\r\nimport { applyQuizFilters } from './shared';\r\n\r\n/**\r\n * Convert Firestore Timestamp fields to ISO strings\r\n */\r\nconst convertTimestamps = (data: any): any => {\r\n  const converted = { ...data };\r\n  \r\n  // Convert common timestamp fields\r\n  const timestampFields = ['createdAt', 'updatedAt', 'submittedAt', 'completedAt', 'approvedAt'];\r\n  \r\n  timestampFields.forEach(field => {\r\n    if (converted[field]) {\r\n      if (converted[field]?.toDate) {\r\n        // Firestore Timestamp\r\n        converted[field] = converted[field].toDate().toISOString();\r\n      } else if (converted[field] instanceof Date) {\r\n        // JavaScript Date\r\n        converted[field] = converted[field].toISOString();\r\n      } else if (typeof converted[field] !== 'string') {\r\n        // Other types, convert to empty string\r\n        converted[field] = '';\r\n      }\r\n    }\r\n  });\r\n  \r\n  return converted;\r\n};\r\n\r\n/**\r\n * Get quizzes for CREATOR role - can see own quizzes + approved published quizzes\r\n */\r\nexport const getCreatorQuizzes = async (\r\n  userId: string,\r\n  filters?: QuizFilters, \r\n  pageSize = 20, \r\n  lastDoc?: DocumentSnapshot\r\n): Promise<{\r\n  quizzes: Quiz[];\r\n  lastDoc: DocumentSnapshot | null;\r\n  hasMore: boolean;\r\n}> => {\r\n  try {\r\n    console.log('üîç [CREATOR] Fetching quizzes for creator:', userId);\r\n    \r\n    let q = query(collection(db, QUIZZES_COLLECTION));\r\n    q = query(q, orderBy('createdAt', 'desc'), limit(pageSize || 50));\r\n\r\n    if (lastDoc) {\r\n      q = query(q, startAfter(lastDoc));\r\n    }\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const allQuizzes: Quiz[] = [];\r\n    let lastDocument: DocumentSnapshot | null = null;\r\n\r\n    console.log('üìù [CREATOR] Found', querySnapshot.size, 'quiz documents');\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      allQuizzes.push({ id: doc.id, ...convertedData } as Quiz);\r\n      lastDocument = doc;\r\n    });\r\n\r\n    // Filter quizzes for creator:\r\n    // 1. Own quizzes (regardless of status)\r\n    // 2. Other's approved and published quizzes\r\n    const filteredQuizzes = allQuizzes.filter(quiz => {\r\n      // Own quiz - always show\r\n      if (quiz.createdBy === userId) {\r\n        console.log('üìù [CREATOR] Own quiz:', quiz.title, 'Status:', quiz.status);\r\n        return true;\r\n      }\r\n      \r\n      // Other's quiz - must be approved and published\r\n      if (quiz.status === 'approved' && quiz.isPublished === true) {\r\n        console.log('üìù [CREATOR] Approved quiz:', quiz.title);\r\n        return true;\r\n      }\r\n      \r\n      console.log('üìù [CREATOR] Filtered out quiz:', quiz.title, 'Status:', quiz.status, 'Published:', quiz.isPublished);\r\n      return false;\r\n    });\r\n\r\n    console.log('‚úÖ [CREATOR] Filtered quizzes:', {\r\n      total: allQuizzes.length,\r\n      creatorVisible: filteredQuizzes.length,\r\n      ownQuizzes: filteredQuizzes.filter(q => q.createdBy === userId).length,\r\n      approvedQuizzes: filteredQuizzes.filter(q => q.createdBy !== userId).length\r\n    });\r\n\r\n    // Apply client-side filters\r\n    const finalQuizzes = applyQuizFilters(filteredQuizzes, filters);\r\n\r\n    console.log('‚úÖ [CREATOR] Returning', finalQuizzes.length, 'quizzes after filters');\r\n\r\n    return {\r\n      quizzes: finalQuizzes,\r\n      lastDoc: lastDocument,\r\n      hasMore: querySnapshot.size === pageSize,\r\n    };\r\n  } catch (error) {\r\n    console.error('‚ùå [CREATOR] Error fetching quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i danh s√°ch quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quizzes created by a specific creator\r\n */\r\nexport const getCreatorOwnQuizzes = async (userId: string): Promise<Quiz[]> => {\r\n  try {\r\n    console.log('üîç [CREATOR] Fetching own quizzes for:', userId);\r\n    \r\n    const q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('createdBy', '==', userId),\r\n      orderBy('createdAt', 'desc')\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      console.log('üìù [CREATOR] Own quiz:', doc.id, convertedData.title, 'Status:', convertedData.status);\r\n      quizzes.push({\r\n        id: doc.id,\r\n        ...convertedData,\r\n      } as Quiz);\r\n    });\r\n\r\n    console.log('‚úÖ [CREATOR] Found', quizzes.length, 'own quizzes');\r\n    return quizzes;\r\n  } catch (error) {\r\n    console.error('‚ùå [CREATOR] Error fetching own quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i quiz c·ªßa ng∆∞·ªùi d√πng');\r\n  }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\shared.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1200,1203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1200,1203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1799,1802],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1799,1802],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  limit,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz, QuizResult, QuizFilters } from '../types';\r\nimport { QUIZZES_COLLECTION, QUIZ_RESULTS_COLLECTION } from './base';\r\n\r\n/**\r\n * Get user's quiz results\r\n */\r\nexport const getUserQuizResults = async (userId: string): Promise<QuizResult[]> => {\r\n  try {\r\n    const q = query(\r\n      collection(db, QUIZ_RESULTS_COLLECTION),\r\n      where('userId', '==', userId),\r\n      orderBy('completedAt', 'desc')\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const results: QuizResult[] = [];\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const data = doc.data();\r\n      console.log('üîç Raw Firestore data for result:', doc.id, data);\r\n      \r\n      const result = {\r\n        id: doc.id,\r\n        ...data,\r\n        completedAt: data.completedAt?.toDate\r\n          ? data.completedAt.toDate().toISOString()\r\n          : (data.completedAt instanceof Date\r\n              ? data.completedAt.toISOString()\r\n              : typeof data.completedAt === 'string'\r\n                ? data.completedAt\r\n                : ''),\r\n      } as any;\r\n\r\n      // Validate and fix score data for legacy results\r\n      const hasValidCorrectAnswers = typeof result.correctAnswers === 'number';\r\n      const hasValidTotalQuestions = typeof result.totalQuestions === 'number' && result.totalQuestions > 0;\r\n      const hasValidScore = typeof result.score === 'number' && !isNaN(result.score);\r\n\r\n      // If missing critical fields but has answers, compute them\r\n      if ((!hasValidCorrectAnswers || !hasValidTotalQuestions) && Array.isArray(result.answers) && result.answers.length > 0) {\r\n        const computedCorrect = result.answers.filter((a: any) => a && a.isCorrect === true).length;\r\n        const computedTotal = result.answers.length;\r\n        \r\n        if (!hasValidCorrectAnswers) {\r\n          result.correctAnswers = computedCorrect;\r\n        }\r\n        if (!hasValidTotalQuestions) {\r\n          result.totalQuestions = computedTotal;\r\n        }\r\n        \r\n        // Recompute score if missing or zero\r\n        if (!hasValidScore || result.score === 0) {\r\n          result.score = result.totalQuestions > 0 ? Math.round((result.correctAnswers / result.totalQuestions) * 100) : 0;\r\n        }\r\n        \r\n        console.log('üõ†Ô∏è Hydrated legacy result:', { \r\n          id: result.id, \r\n          correctAnswers: result.correctAnswers, \r\n          totalQuestions: result.totalQuestions, \r\n          score: result.score,\r\n          computedFromAnswers: true\r\n        });\r\n      }\r\n\r\n      results.push(result as QuizResult);\r\n    });\r\n\r\n    return results;\r\n  } catch (error) {\r\n    console.error('Error fetching user quiz results:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i k·∫øt qu·∫£ quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quiz categories (from existing quizzes)\r\n */\r\nexport const getQuizCategories = async (): Promise<string[]> => {\r\n  try {\r\n    const q = query(collection(db, QUIZZES_COLLECTION), where('isPublished', '==', true));\r\n    const querySnapshot = await getDocs(q);\r\n    \r\n    const categories = new Set<string>();\r\n    querySnapshot.forEach((doc) => {\r\n      const quiz = doc.data() as Quiz;\r\n      categories.add(quiz.category);\r\n    });\r\n\r\n    return Array.from(categories).sort();\r\n  } catch (error) {\r\n    console.error('Error fetching quiz categories:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Get popular quizzes (most attempts)\r\n */\r\nexport const getPopularQuizzes = async (limitCount = 10): Promise<Quiz[]> => {\r\n  try {\r\n    // This would require aggregation queries or a separate collection\r\n    // For now, we'll get recent quizzes as a placeholder\r\n    const q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('isPublished', '==', true),\r\n      orderBy('createdAt', 'desc'),\r\n      limit(limitCount)\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      quizzes.push({ id: doc.id, ...doc.data() } as Quiz);\r\n    });\r\n\r\n    return quizzes;\r\n  } catch (error) {\r\n    console.error('Error fetching popular quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i quiz ph·ªï bi·∫øn');\r\n  }\r\n};\r\n\r\n/**\r\n * Search quizzes by title or description\r\n */\r\nexport const searchQuizzes = async (searchTerm: string, limitCount = 20): Promise<Quiz[]> => {\r\n  try {\r\n    // Firestore doesn't support full-text search natively\r\n    // This is a basic implementation - in production, you'd use Algolia or similar\r\n    const q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('isPublished', '==', true),\r\n      orderBy('title'),\r\n      limit(limitCount)\r\n    );\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quiz = { id: doc.id, ...doc.data() } as Quiz;\r\n      const term = searchTerm.toLowerCase();\r\n      \r\n      if (\r\n        quiz.title.toLowerCase().includes(term) ||\r\n        quiz.description.toLowerCase().includes(term) ||\r\n        quiz.category.toLowerCase().includes(term)\r\n      ) {\r\n        quizzes.push(quiz);\r\n      }\r\n    });\r\n\r\n    return quizzes;\r\n  } catch (error) {\r\n    console.error('Error searching quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t√¨m ki·∫øm quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Apply client-side filters to quiz list\r\n */\r\nexport const applyQuizFilters = (quizzes: Quiz[], filters?: QuizFilters): Quiz[] => {\r\n  let filteredQuizzes = [...quizzes];\r\n\r\n  if (filters?.category) {\r\n    filteredQuizzes = filteredQuizzes.filter(quiz => quiz.category === filters.category);\r\n  }\r\n\r\n  if (filters?.difficulty) {\r\n    filteredQuizzes = filteredQuizzes.filter(quiz => quiz.difficulty === filters.difficulty);\r\n  }\r\n\r\n  if (filters?.searchTerm) {\r\n    const searchTerm = filters.searchTerm.toLowerCase();\r\n    filteredQuizzes = filteredQuizzes.filter(\r\n      quiz =>\r\n        quiz.title?.toLowerCase().includes(searchTerm) ||\r\n        quiz.description?.toLowerCase().includes(searchTerm) ||\r\n        quiz.category?.toLowerCase().includes(searchTerm)\r\n    );\r\n  }\r\n\r\n  return filteredQuizzes;\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\api\\user.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[435,438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[435,438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[441,444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[441,444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1539,1542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1539,1542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  limit,\r\n  startAfter,\r\n  DocumentSnapshot,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz, QuizFilters } from '../types';\r\nimport { QUIZZES_COLLECTION } from './base';\r\nimport { applyQuizFilters } from './shared';\r\n\r\n/**\r\n * Convert Firestore Timestamp fields to ISO strings\r\n */\r\nconst convertTimestamps = (data: any): any => {\r\n  const converted = { ...data };\r\n  \r\n  // Convert common timestamp fields\r\n  const timestampFields = ['createdAt', 'updatedAt', 'submittedAt', 'completedAt', 'approvedAt'];\r\n  \r\n  timestampFields.forEach(field => {\r\n    if (converted[field]) {\r\n      if (converted[field]?.toDate) {\r\n        // Firestore Timestamp\r\n        converted[field] = converted[field].toDate().toISOString();\r\n      } else if (converted[field] instanceof Date) {\r\n        // JavaScript Date\r\n        converted[field] = converted[field].toISOString();\r\n      } else if (typeof converted[field] !== 'string') {\r\n        // Other types, convert to empty string\r\n        converted[field] = '';\r\n      }\r\n    }\r\n  });\r\n  \r\n  return converted;\r\n};\r\n\r\n/**\r\n * Check if Firestore is accessible\r\n */\r\nconst checkFirestoreConnection = async (): Promise<boolean> => {\r\n  try {\r\n    // Simple test query\r\n    const testQuery = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      limit(1)\r\n    );\r\n    await getDocs(testQuery);\r\n    console.log('‚úÖ Firestore connection successful');\r\n    return true;\r\n  } catch (error: any) {\r\n    console.error('‚ùå Firestore connection failed:', error);\r\n    \r\n    if (error.code === 'unavailable' || error.message?.includes('ERR_BLOCKED_BY_CLIENT')) {\r\n      console.error('üö´ Firestore b·ªã ch·∫∑n b·ªüi ad blocker ho·∫∑c network. Vui l√≤ng:');\r\n      console.error('   1. T·∫Øt ad blocker cho localhost');\r\n      console.error('   2. Th√™m *.googleapis.com v√†o whitelist');\r\n      console.error('   3. Th·ª≠ ch·∫ø ƒë·ªô Incognito');\r\n    }\r\n    \r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Get quizzes for USER role - can see published quizzes only\r\n */\r\nexport const getUserQuizzes = async (\r\n  filters?: QuizFilters, \r\n  pageSize = 20, \r\n  lastDoc?: DocumentSnapshot\r\n): Promise<{\r\n  quizzes: Quiz[];\r\n  lastDoc: DocumentSnapshot | null;\r\n  hasMore: boolean;\r\n}> => {\r\n  try {\r\n    // Check Firestore connection first\r\n    const isConnected = await checkFirestoreConnection();\r\n    if (!isConnected) {\r\n      throw new Error('Kh√¥ng th·ªÉ k·∫øt n·ªëi Firestore. Vui l√≤ng t·∫Øt ad blocker ho·∫∑c th·ª≠ ch·∫ø ƒë·ªô Incognito.');\r\n    }\r\n\r\n    console.log('üîç [USER] Fetching published quizzes for regular user');\r\n    \r\n    let q = query(collection(db, QUIZZES_COLLECTION));\r\n    q = query(q, orderBy('createdAt', 'desc'), limit(pageSize || 50));\r\n\r\n    if (lastDoc) {\r\n      q = query(q, startAfter(lastDoc));\r\n    }\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const allQuizzes: Quiz[] = [];\r\n    let lastDocument: DocumentSnapshot | null = null;\r\n\r\n    console.log('üìù [USER] Found', querySnapshot.size, 'quiz documents');\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      allQuizzes.push({\r\n        id: doc.id,\r\n        ...convertedData,\r\n      } as Quiz);\r\n      lastDocument = doc;\r\n    });\r\n\r\n    // Filter quizzes for regular user:\r\n    // Only approved AND published quizzes\r\n    const filteredQuizzes = allQuizzes.filter(quiz => {\r\n      const isApproved = quiz.status === 'approved';\r\n      const isPublished = quiz.isPublished === true;\r\n      \r\n      if (isApproved && isPublished) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    console.log('‚úÖ [USER] Filtered quizzes:', {\r\n      total: allQuizzes.length,\r\n      userVisible: filteredQuizzes.length,\r\n      publishedQuizzes: filteredQuizzes.length\r\n    });\r\n\r\n    // Apply client-side filters\r\n    const finalQuizzes = applyQuizFilters(filteredQuizzes, filters);\r\n\r\n    console.log('‚úÖ [USER] Returning', finalQuizzes.length, 'quizzes after filters');\r\n\r\n    return {\r\n      quizzes: finalQuizzes,\r\n      lastDoc: lastDocument,\r\n      hasMore: querySnapshot.size === pageSize,\r\n    };\r\n  } catch (error) {\r\n    console.error('‚ùå [USER] Error fetching quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i danh s√°ch quiz');\r\n  }\r\n};\r\n\r\n/**\r\n * Get quizzes for anonymous (not logged in) users\r\n */\r\nexport const getAnonymousQuizzes = async (\r\n  filters?: QuizFilters, \r\n  pageSize = 20, \r\n  lastDoc?: DocumentSnapshot\r\n): Promise<{\r\n  quizzes: Quiz[];\r\n  lastDoc: DocumentSnapshot | null;\r\n  hasMore: boolean;\r\n}> => {\r\n  try {\r\n    // Check Firestore connection first\r\n    const isConnected = await checkFirestoreConnection();\r\n    if (!isConnected) {\r\n      throw new Error('Kh√¥ng th·ªÉ k·∫øt n·ªëi Firestore. Vui l√≤ng t·∫Øt ad blocker ho·∫∑c th·ª≠ ch·∫ø ƒë·ªô Incognito.');\r\n    }\r\n\r\n    console.log('üîç [ANONYMOUS] Fetching published quizzes for anonymous user');\r\n    \r\n    // For anonymous users, only show published quizzes (filter by status client-side)\r\n    let q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('isPublished', '==', true)\r\n    );\r\n    q = query(q, orderBy('createdAt', 'desc'), limit(pageSize || 50));\r\n\r\n    if (lastDoc) {\r\n      q = query(q, startAfter(lastDoc));\r\n    }\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    const quizzes: Quiz[] = [];\r\n    let lastDocument: DocumentSnapshot | null = null;\r\n\r\n    console.log('üìù [ANONYMOUS] Found', querySnapshot.size, 'published quiz documents');\r\n\r\n    querySnapshot.forEach((doc) => {\r\n      const quizData = doc.data();\r\n      const convertedData = convertTimestamps(quizData);\r\n      console.log('üìù [ANONYMOUS] Published quiz:', doc.id, convertedData.title, 'status:', convertedData.status);\r\n      quizzes.push({ id: doc.id, ...convertedData } as Quiz);\r\n      lastDocument = doc;\r\n    });\r\n\r\n    // Filter for anonymous users: only approved quizzes\r\n    const approvedQuizzes = quizzes.filter(quiz => {\r\n      const isApproved = quiz.status === 'approved';\r\n      if (!isApproved) {\r\n        console.log('üö´ [ANONYMOUS] Filtering out quiz:', quiz.id, quiz.title, 'status:', quiz.status);\r\n      }\r\n      return isApproved;\r\n    });\r\n\r\n    console.log('‚úÖ [ANONYMOUS] Approved quizzes:', {\r\n      total: quizzes.length,\r\n      approved: approvedQuizzes.length\r\n    });\r\n\r\n    // Apply client-side filters\r\n    const finalQuizzes = applyQuizFilters(approvedQuizzes, filters);\r\n\r\n    console.log('‚úÖ [ANONYMOUS] Returning', finalQuizzes.length, 'quizzes after filters');\r\n\r\n    return {\r\n      quizzes: finalQuizzes,\r\n      lastDoc: lastDocument,\r\n      hasMore: querySnapshot.size === pageSize,\r\n    };\r\n  } catch (error) {\r\n    console.error('‚ùå [ANONYMOUS] Error fetching quizzes:', error);\r\n    throw new Error('Kh√¥ng th·ªÉ t·∫£i danh s√°ch quiz');\r\n  }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\GeminiAIQuestionGenerator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ModernGeminiAIGenerator_new.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuestionEditor.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"{ useState","message":"Definition for rule '{ useState' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"useEffect } from 'react';import { useTranslation } from 'react-i18next';import { Question } from '../types';import {   Plus","message":"Definition for rule 'useEffect } from 'react';import { useTranslation } from 'react-i18next';import { Question } from '../types';import {   Plus' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Trash2","message":"Definition for rule 'Trash2' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Edit3","message":"Definition for rule 'Edit3' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Check","message":"Definition for rule 'Check' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"X","message":"Definition for rule 'X' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"ArrowUp","message":"Definition for rule 'ArrowUp' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"ArrowDown","message":"Definition for rule 'ArrowDown' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Lightbulb","message":"Definition for rule 'Lightbulb' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Target","message":"Definition for rule 'Target' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"Type","message":"Definition for rule 'Type' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"List} from 'lucide-react';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface QuestionEditorProps {  question: Question;  index: number;  isEditing: boolean;  onEdit: (questionId: string) => void;  onUpdate: (questionId: string","message":"Definition for rule 'List} from 'lucide-react';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface QuestionEditorProps {  question: Question;  index: number;  isEditing: boolean;  onEdit: (questionId: string) => void;  onUpdate: (questionId: string' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"updates: Partial<Question>) => void;  onDelete: (questionId: string) => void;  onMove: (index: number","message":"Definition for rule 'updates: Partial<Question>) => void;  onDelete: (questionId: string) => void;  onMove: (index: number' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"direction: 'up' | 'down') => void;  totalQuestions: number;}export const QuestionEditor: React.FC<QuestionEditorProps> = ({  question","message":"Definition for rule 'direction: 'up' | 'down') => void;  totalQuestions: number;}export const QuestionEditor: React.FC<QuestionEditorProps> = ({  question' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"index","message":"Definition for rule 'index' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"isEditing","message":"Definition for rule 'isEditing' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"onEdit","message":"Definition for rule 'onEdit' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"onUpdate","message":"Definition for rule 'onUpdate' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"onDelete","message":"Definition for rule 'onDelete' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"onMove","message":"Definition for rule 'onMove' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"totalQuestions}) => {  const { t } = useTranslation();  const [localQuestion","message":"Definition for rule 'totalQuestions}) => {  const { t } = useTranslation();  const [localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"setLocalQuestion] = useState<Question>(question);  useEffect(() => {    setLocalQuestion(question);  }","message":"Definition for rule 'setLocalQuestion] = useState<Question>(question);  useEffect(() => {    setLocalQuestion(question);  }' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"[question]);  const handleSave = () => {    onUpdate(question.id","message":"Definition for rule '[question]);  const handleSave = () => {    onUpdate(question.id' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"localQuestion);    onEdit('');  };  const handleCancel = () => {    setLocalQuestion(question);    onEdit('');  };  const addAnswer = () => {    if (localQuestion.answers.length < 6) {      const newAnswer = {        id: `a_${Date.now()}`","message":"Definition for rule 'localQuestion);    onEdit('');  };  const handleCancel = () => {    setLocalQuestion(question);    onEdit('');  };  const addAnswer = () => {    if (localQuestion.answers.length < 6) {      const newAnswer = {        id: `a_${Date.now()}`' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"text: ''","message":"Definition for rule 'text: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"isCorrect: false      };      setLocalQuestion({        ...localQuestion","message":"Definition for rule 'isCorrect: false      };      setLocalQuestion({        ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"answers: [...localQuestion.answers","message":"Definition for rule 'answers: [...localQuestion.answers' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"newAnswer]      });    }  };  const updateAnswer = (answerId: string","message":"Definition for rule 'newAnswer]      });    }  };  const updateAnswer = (answerId: string' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"updates: Partial<{ text: string; isCorrect: boolean }>) => {    setLocalQuestion({      ...localQuestion","message":"Definition for rule 'updates: Partial<{ text: string; isCorrect: boolean }>) => {    setLocalQuestion({      ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"answers: localQuestion.answers.map(a =>         a.id === answerId ? { ...a","message":"Definition for rule 'answers: localQuestion.answers.map(a =>         a.id === answerId ? { ...a' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"...updates } : a      )    });  };  const deleteAnswer = (answerId: string) => {    if (localQuestion.answers.length > 2) {      setLocalQuestion({        ...localQuestion","message":"Definition for rule '...updates } : a      )    });  };  const deleteAnswer = (answerId: string) => {    if (localQuestion.answers.length > 2) {      setLocalQuestion({        ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"answers: localQuestion.answers.filter(a => a.id !== answerId)      });    }  };  return (    <div className={`bg-gradient-to-br from-white to-gray-50 rounded-3xl border-2 transition-all duration-300 shadow-sm hover:shadow-lg ${      isEditing         ? 'border-blue-300 shadow-blue-100'         : 'border-gray-200 hover:border-gray-300'    }`}>      {/* Header */}      <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">        <div className=\"flex items-center gap-4\">          {/* Question Number */}          <div className=\"relative\">            <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg\">              {index + 1}            </div>            {question.type === 'multiple' && (              <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center\">                <List className=\"w-3 h-3 text-white\" />              </div>            )}          </div>          {/* Move Controls */}          <div className=\"flex flex-col gap-1\">            <button              onClick={() => onMove(index","message":"Definition for rule 'answers: localQuestion.answers.filter(a => a.id !== answerId)      });    }  };  return (    <div className={`bg-gradient-to-br from-white to-gray-50 rounded-3xl border-2 transition-all duration-300 shadow-sm hover:shadow-lg ${      isEditing         ? 'border-blue-300 shadow-blue-100'         : 'border-gray-200 hover:border-gray-300'    }`}>      {/* Header */}      <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">        <div className=\"flex items-center gap-4\">          {/* Question Number */}          <div className=\"relative\">            <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg\">              {index + 1}            </div>            {question.type === 'multiple' && (              <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center\">                <List className=\"w-3 h-3 text-white\" />              </div>            )}          </div>          {/* Move Controls */}          <div className=\"flex flex-col gap-1\">            <button              onClick={() => onMove(index' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"'up')}              disabled={index === 0}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move up\"            >              <ArrowUp className=\"w-4 h-4\" />            </button>            <button              onClick={() => onMove(index","message":"Definition for rule ''up')}              disabled={index === 0}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move up\"            >              <ArrowUp className=\"w-4 h-4\" />            </button>            <button              onClick={() => onMove(index' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"'down')}              disabled={index === totalQuestions - 1}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move down\"            >              <ArrowDown className=\"w-4 h-4\" />            </button>          </div>          {/* Question Type Badge */}          <div className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium\">            {question.type === 'multiple' ? 'üî¢ Multiple Choice' :              question.type === 'boolean' ? '‚úì‚úó True/False' :              question.type === 'checkbox' ? '‚òëÔ∏è Checkbox' :             question.type === 'short_answer' ? 'üìù Short Answer' :             'üñºÔ∏è Image Choice'}          </div>        </div>        {/* Action Buttons */}        <div className=\"flex items-center gap-2\">          {isEditing ? (            <div className=\"flex gap-2\">              <button                onClick={handleSave}                className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <Check className=\"w-4 h-4\" />                Save              </button>              <button                onClick={handleCancel}                className=\"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <X className=\"w-4 h-4\" />                Cancel              </button>            </div>          ) : (            <div className=\"flex gap-2\">              <button                onClick={() => onEdit(question.id)}                className=\"p-3 bg-blue-100 text-blue-600 rounded-xl hover:bg-blue-200 transition-colors shadow-sm\"                title=\"Edit question\"              >                <Edit3 className=\"w-5 h-5\" />              </button>              <button                onClick={() => onDelete(question.id)}                className=\"p-3 bg-red-100 text-red-600 rounded-xl hover:bg-red-200 transition-colors shadow-sm\"                title=\"Delete question\"              >                <Trash2 className=\"w-5 h-5\" />              </button>            </div>          )}        </div>      </div>      {/* Content */}      <div className=\"p-6\">        {isEditing ? (          <div className=\"space-y-6\">            {/* Question Text */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Type className=\"w-4 h-4\" />                Question Text *              </label>              <textarea                value={localQuestion.text}                onChange={(e) => setLocalQuestion({ ...localQuestion","message":"Definition for rule ''down')}              disabled={index === totalQuestions - 1}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move down\"            >              <ArrowDown className=\"w-4 h-4\" />            </button>          </div>          {/* Question Type Badge */}          <div className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium\">            {question.type === 'multiple' ? 'üî¢ Multiple Choice' :              question.type === 'boolean' ? '‚úì‚úó True/False' :              question.type === 'checkbox' ? '‚òëÔ∏è Checkbox' :             question.type === 'short_answer' ? 'üìù Short Answer' :             'üñºÔ∏è Image Choice'}          </div>        </div>        {/* Action Buttons */}        <div className=\"flex items-center gap-2\">          {isEditing ? (            <div className=\"flex gap-2\">              <button                onClick={handleSave}                className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <Check className=\"w-4 h-4\" />                Save              </button>              <button                onClick={handleCancel}                className=\"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <X className=\"w-4 h-4\" />                Cancel              </button>            </div>          ) : (            <div className=\"flex gap-2\">              <button                onClick={() => onEdit(question.id)}                className=\"p-3 bg-blue-100 text-blue-600 rounded-xl hover:bg-blue-200 transition-colors shadow-sm\"                title=\"Edit question\"              >                <Edit3 className=\"w-5 h-5\" />              </button>              <button                onClick={() => onDelete(question.id)}                className=\"p-3 bg-red-100 text-red-600 rounded-xl hover:bg-red-200 transition-colors shadow-sm\"                title=\"Delete question\"              >                <Trash2 className=\"w-5 h-5\" />              </button>            </div>          )}        </div>      </div>      {/* Content */}      <div className=\"p-6\">        {isEditing ? (          <div className=\"space-y-6\">            {/* Question Text */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Type className=\"w-4 h-4\" />                Question Text *              </label>              <textarea                value={localQuestion.text}                onChange={(e) => setLocalQuestion({ ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"text: e.target.value })}                placeholder={t('placeholders.enterQuestionHere')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none\"                rows={3}              />            </div>            {/* Question Type */}            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Question Type                </label>                <select                  value={localQuestion.type}                  onChange={(e) => setLocalQuestion({ ...localQuestion","message":"Definition for rule 'text: e.target.value })}                placeholder={t('placeholders.enterQuestionHere')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none\"                rows={3}              />            </div>            {/* Question Type */}            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Question Type                </label>                <select                  value={localQuestion.type}                  onChange={(e) => setLocalQuestion({ ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"type: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"multiple\">Multiple Choice</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"boolean\">True/False</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"checkbox\">Checkbox</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"short_answer\">Short Answer</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"image\">Image Choice</option>                </select>              </div>              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <Target className=\"w-4 h-4\" />                  Points                </label>                <input                  type=\"number\"                  value={localQuestion.points}                  onChange={(e) => setLocalQuestion({ ...localQuestion","message":"Definition for rule 'type: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"multiple\">Multiple Choice</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"boolean\">True/False</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"checkbox\">Checkbox</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"short_answer\">Short Answer</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"image\">Image Choice</option>                </select>              </div>              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <Target className=\"w-4 h-4\" />                  Points                </label>                <input                  type=\"number\"                  value={localQuestion.points}                  onChange={(e) => setLocalQuestion({ ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"points: parseInt(e.target.value) || 10 })}                  min=\"1\"                  max=\"100\"                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                />              </div>              <div className=\"space-y-2\">                // eslint-disable-next-line i18next/no-literal-string                <label className=\"text-sm font-semibold text-gray-700\">Difficulty</label>                <select                  value={localQuestion.difficulty || 'medium'}                  onChange={(e) => setLocalQuestion({ ...localQuestion","message":"Definition for rule 'points: parseInt(e.target.value) || 10 })}                  min=\"1\"                  max=\"100\"                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                />              </div>              <div className=\"space-y-2\">                // eslint-disable-next-line i18next/no-literal-string                <label className=\"text-sm font-semibold text-gray-700\">Difficulty</label>                <select                  value={localQuestion.difficulty || 'medium'}                  onChange={(e) => setLocalQuestion({ ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"difficulty: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"easy\">üü¢ Easy</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"medium\">üü° Medium</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"hard\">üî¥ Hard</option>                </select>              </div>            </div>            {/* Answers */}            <div className=\"space-y-4\">              <div className=\"flex items-center justify-between\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Answer Options *                </label>                <button                  onClick={addAnswer}                  disabled={localQuestion.answers.length >= 6}                  className=\"flex items-center gap-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm font-medium disabled:opacity-50\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <Plus className=\"w-4 h-4\" />                  Add Answer                </button>              </div>                            <div className=\"space-y-3\">                {localQuestion.answers.map((answer","message":"Definition for rule 'difficulty: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"easy\">üü¢ Easy</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"medium\">üü° Medium</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"hard\">üî¥ Hard</option>                </select>              </div>            </div>            {/* Answers */}            <div className=\"space-y-4\">              <div className=\"flex items-center justify-between\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Answer Options *                </label>                <button                  onClick={addAnswer}                  disabled={localQuestion.answers.length >= 6}                  className=\"flex items-center gap-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm font-medium disabled:opacity-50\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <Plus className=\"w-4 h-4\" />                  Add Answer                </button>              </div>                            <div className=\"space-y-3\">                {localQuestion.answers.map((answer' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"answerIndex) => (                  <div key={answer.id} className=\"flex items-center gap-3 p-4 bg-gray-50 rounded-xl border-2 border-gray-100\">                    <div className=\"w-8 h-8 bg-white rounded-full flex items-center justify-center text-gray-700 font-semibold shadow-sm\">                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <input                      type=\"text\"                      value={answer.text}                      onChange={(e) => updateAnswer(answer.id","message":"Definition for rule 'answerIndex) => (                  <div key={answer.id} className=\"flex items-center gap-3 p-4 bg-gray-50 rounded-xl border-2 border-gray-100\">                    <div className=\"w-8 h-8 bg-white rounded-full flex items-center justify-center text-gray-700 font-semibold shadow-sm\">                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <input                      type=\"text\"                      value={answer.text}                      onChange={(e) => updateAnswer(answer.id' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"{ text: e.target.value })}                      placeholder={`Answer ${String.fromCharCode(65 + answerIndex)}`}                      className=\"flex-1 p-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                    />                    <label className=\"flex items-center gap-2 text-sm font-medium\">                      <input                        type=\"checkbox\"                        checked={answer.isCorrect}                        onChange={(e) => updateAnswer(answer.id","message":"Definition for rule '{ text: e.target.value })}                      placeholder={`Answer ${String.fromCharCode(65 + answerIndex)}`}                      className=\"flex-1 p-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                    />                    <label className=\"flex items-center gap-2 text-sm font-medium\">                      <input                        type=\"checkbox\"                        checked={answer.isCorrect}                        onChange={(e) => updateAnswer(answer.id' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"{ isCorrect: e.target.checked })}                        className=\"w-5 h-5 text-green-600 rounded focus:ring-green-500\"                      />                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-green-700\">Correct</span>                    </label>                    {localQuestion.answers.length > 2 && (                      <button                        onClick={() => deleteAnswer(answer.id)}                        className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors\"                      >                        <X className=\"w-5 h-5\" />                      </button>                    )}                  </div>                ))}              </div>            </div>            {/* Explanation */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Lightbulb className=\"w-4 h-4\" />                Explanation (Optional)              </label>              <textarea                value={localQuestion.explanation || ''}                onChange={(e) => setLocalQuestion({ ...localQuestion","message":"Definition for rule '{ isCorrect: e.target.checked })}                        className=\"w-5 h-5 text-green-600 rounded focus:ring-green-500\"                      />                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-green-700\">Correct</span>                    </label>                    {localQuestion.answers.length > 2 && (                      <button                        onClick={() => deleteAnswer(answer.id)}                        className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors\"                      >                        <X className=\"w-5 h-5\" />                      </button>                    )}                  </div>                ))}              </div>            </div>            {/* Explanation */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Lightbulb className=\"w-4 h-4\" />                Explanation (Optional)              </label>              <textarea                value={localQuestion.explanation || ''}                onChange={(e) => setLocalQuestion({ ...localQuestion' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"explanation: e.target.value })}                placeholder={t('placeholders.explainAnswer')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none\"                rows={3}              />            </div>          </div>        ) : (          <div className=\"space-y-4\">            {/* Question Display */}            <h4 className=\"text-xl font-bold text-gray-900 leading-relaxed\">              {question.text || '‚ùì Untitled Question'}            </h4>                        {/* Answers Grid */}            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">              {question.answers.map((answer","message":"Definition for rule 'explanation: e.target.value })}                placeholder={t('placeholders.explainAnswer')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none\"                rows={3}              />            </div>          </div>        ) : (          <div className=\"space-y-4\">            {/* Question Display */}            <h4 className=\"text-xl font-bold text-gray-900 leading-relaxed\">              {question.text || '‚ùì Untitled Question'}            </h4>                        {/* Answers Grid */}            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">              {question.answers.map((answer' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null},{"ruleId":"answerIndex) => (                <div key={answer.id} className={`p-4 rounded-xl border-2 transition-all ${                  answer.isCorrect                     ? 'bg-green-50 border-green-200 text-green-800'                     : 'bg-gray-50 border-gray-200 text-gray-700'                }`}>                  <div className=\"flex items-center gap-3\">                    <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${                      answer.isCorrect ? 'bg-green-500 text-white' : 'bg-gray-300 text-gray-600'                    }`}>                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <span className=\"flex-1 font-medium\">                      {answer.text || 'Empty answer'}                    </span>                    {answer.isCorrect && <Check className=\"w-5 h-5 text-green-600\" />}                  </div>                </div>              ))}            </div>            {/* Question Info */}            <div className=\"flex items-center gap-6 text-sm text-gray-600 bg-gray-50 p-4 rounded-xl\">              <span className=\"flex items-center gap-1\">                <Target className=\"w-4 h-4\" />                // eslint-disable-next-line i18next/no-literal-string                <strong>{question.points}</strong> points              </span>              <span className=\"flex items-center gap-1\">                <Type className=\"w-4 h-4\" />                {question.type}              </span>              <span className=\"flex items-center gap-1\">                üìä {question.difficulty || 'medium'}              </span>              {question.explanation && (                <span className=\"flex items-center gap-1\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Has explanation                </span>              )}            </div>            {/* Explanation Preview */}            {question.explanation && (              <div className=\"bg-blue-50 p-4 rounded-xl border-l-4 border-blue-400\">                <h5 className=\"flex items-center gap-2 font-semibold text-blue-800 mb-2\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Explanation                </h5>                <SafeHTML content={question.explanation} className=\"text-blue-700\" />              </div>            )}          </div>        )}      </div>    </div>  );};","message":"Definition for rule 'answerIndex) => (                <div key={answer.id} className={`p-4 rounded-xl border-2 transition-all ${                  answer.isCorrect                     ? 'bg-green-50 border-green-200 text-green-800'                     : 'bg-gray-50 border-gray-200 text-gray-700'                }`}>                  <div className=\"flex items-center gap-3\">                    <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${                      answer.isCorrect ? 'bg-green-500 text-white' : 'bg-gray-300 text-gray-600'                    }`}>                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <span className=\"flex-1 font-medium\">                      {answer.text || 'Empty answer'}                    </span>                    {answer.isCorrect && <Check className=\"w-5 h-5 text-green-600\" />}                  </div>                </div>              ))}            </div>            {/* Question Info */}            <div className=\"flex items-center gap-6 text-sm text-gray-600 bg-gray-50 p-4 rounded-xl\">              <span className=\"flex items-center gap-1\">                <Target className=\"w-4 h-4\" />                // eslint-disable-next-line i18next/no-literal-string                <strong>{question.points}</strong> points              </span>              <span className=\"flex items-center gap-1\">                <Type className=\"w-4 h-4\" />                {question.type}              </span>              <span className=\"flex items-center gap-1\">                üìä {question.difficulty || 'medium'}              </span>              {question.explanation && (                <span className=\"flex items-center gap-1\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Has explanation                </span>              )}            </div>            {/* Explanation Preview */}            {question.explanation && (              <div className=\"bg-blue-50 p-4 rounded-xl border-l-4 border-blue-400\">                <h5 className=\"flex items-center gap-2 font-semibold text-blue-800 mb-2\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Explanation                </h5>                <SafeHTML content={question.explanation} className=\"text-blue-700\" />              </div>            )}          </div>        )}      </div>    </div>  );};' was not found.","line":1,"column":1,"endLine":1,"endColumn":16405,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":44,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState, useEffect } from 'react';import { useTranslation } from 'react-i18next';import { Question } from '../types';import {   Plus, Trash2, Edit3, Check, X, ArrowUp, ArrowDown,   Lightbulb, Target, Type, List} from 'lucide-react';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface QuestionEditorProps {  question: Question;  index: number;  isEditing: boolean;  onEdit: (questionId: string) => void;  onUpdate: (questionId: string, updates: Partial<Question>) => void;  onDelete: (questionId: string) => void;  onMove: (index: number, direction: 'up' | 'down') => void;  totalQuestions: number;}export const QuestionEditor: React.FC<QuestionEditorProps> = ({  question,  index,  isEditing,  onEdit,  onUpdate,  onDelete,  onMove,  totalQuestions}) => {  const { t } = useTranslation();  const [localQuestion, setLocalQuestion] = useState<Question>(question);  useEffect(() => {    setLocalQuestion(question);  }, [question]);  const handleSave = () => {    onUpdate(question.id, localQuestion);    onEdit('');  };  const handleCancel = () => {    setLocalQuestion(question);    onEdit('');  };  const addAnswer = () => {    if (localQuestion.answers.length < 6) {      const newAnswer = {        id: `a_${Date.now()}`,        text: '',        isCorrect: false      };      setLocalQuestion({        ...localQuestion,        answers: [...localQuestion.answers, newAnswer]      });    }  };  const updateAnswer = (answerId: string, updates: Partial<{ text: string; isCorrect: boolean }>) => {    setLocalQuestion({      ...localQuestion,      answers: localQuestion.answers.map(a =>         a.id === answerId ? { ...a, ...updates } : a      )    });  };  const deleteAnswer = (answerId: string) => {    if (localQuestion.answers.length > 2) {      setLocalQuestion({        ...localQuestion,        answers: localQuestion.answers.filter(a => a.id !== answerId)      });    }  };  return (    <div className={`bg-gradient-to-br from-white to-gray-50 rounded-3xl border-2 transition-all duration-300 shadow-sm hover:shadow-lg ${      isEditing         ? 'border-blue-300 shadow-blue-100'         : 'border-gray-200 hover:border-gray-300'    }`}>      {/* Header */}      <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">        <div className=\"flex items-center gap-4\">          {/* Question Number */}          <div className=\"relative\">            <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg\">              {index + 1}            </div>            {question.type === 'multiple' && (              <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center\">                <List className=\"w-3 h-3 text-white\" />              </div>            )}          </div>          {/* Move Controls */}          <div className=\"flex flex-col gap-1\">            <button              onClick={() => onMove(index, 'up')}              disabled={index === 0}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move up\"            >              <ArrowUp className=\"w-4 h-4\" />            </button>            <button              onClick={() => onMove(index, 'down')}              disabled={index === totalQuestions - 1}              className=\"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 transition-colors\"              title=\"Move down\"            >              <ArrowDown className=\"w-4 h-4\" />            </button>          </div>          {/* Question Type Badge */}          <div className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium\">            {question.type === 'multiple' ? 'üî¢ Multiple Choice' :              question.type === 'boolean' ? '‚úì‚úó True/False' :              question.type === 'checkbox' ? '‚òëÔ∏è Checkbox' :             question.type === 'short_answer' ? 'üìù Short Answer' :             'üñºÔ∏è Image Choice'}          </div>        </div>        {/* Action Buttons */}        <div className=\"flex items-center gap-2\">          {isEditing ? (            <div className=\"flex gap-2\">              <button                onClick={handleSave}                className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <Check className=\"w-4 h-4\" />                Save              </button>              <button                onClick={handleCancel}                className=\"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-colors shadow-sm\"              >                // eslint-disable-next-line i18next/no-literal-string                <X className=\"w-4 h-4\" />                Cancel              </button>            </div>          ) : (            <div className=\"flex gap-2\">              <button                onClick={() => onEdit(question.id)}                className=\"p-3 bg-blue-100 text-blue-600 rounded-xl hover:bg-blue-200 transition-colors shadow-sm\"                title=\"Edit question\"              >                <Edit3 className=\"w-5 h-5\" />              </button>              <button                onClick={() => onDelete(question.id)}                className=\"p-3 bg-red-100 text-red-600 rounded-xl hover:bg-red-200 transition-colors shadow-sm\"                title=\"Delete question\"              >                <Trash2 className=\"w-5 h-5\" />              </button>            </div>          )}        </div>      </div>      {/* Content */}      <div className=\"p-6\">        {isEditing ? (          <div className=\"space-y-6\">            {/* Question Text */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Type className=\"w-4 h-4\" />                Question Text *              </label>              <textarea                value={localQuestion.text}                onChange={(e) => setLocalQuestion({ ...localQuestion, text: e.target.value })}                placeholder={t('placeholders.enterQuestionHere')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none\"                rows={3}              />            </div>            {/* Question Type */}            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Question Type                </label>                <select                  value={localQuestion.type}                  onChange={(e) => setLocalQuestion({ ...localQuestion, type: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"multiple\">Multiple Choice</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"boolean\">True/False</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"checkbox\">Checkbox</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"short_answer\">Short Answer</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"image\">Image Choice</option>                </select>              </div>              <div className=\"space-y-2\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <Target className=\"w-4 h-4\" />                  Points                </label>                <input                  type=\"number\"                  value={localQuestion.points}                  onChange={(e) => setLocalQuestion({ ...localQuestion, points: parseInt(e.target.value) || 10 })}                  min=\"1\"                  max=\"100\"                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                />              </div>              <div className=\"space-y-2\">                // eslint-disable-next-line i18next/no-literal-string                <label className=\"text-sm font-semibold text-gray-700\">Difficulty</label>                <select                  value={localQuestion.difficulty || 'medium'}                  onChange={(e) => setLocalQuestion({ ...localQuestion, difficulty: e.target.value as any })}                  className=\"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"easy\">üü¢ Easy</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"medium\">üü° Medium</option>                  // eslint-disable-next-line i18next/no-literal-string                  <option value=\"hard\">üî¥ Hard</option>                </select>              </div>            </div>            {/* Answers */}            <div className=\"space-y-4\">              <div className=\"flex items-center justify-between\">                <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                  // eslint-disable-next-line i18next/no-literal-string                  <List className=\"w-4 h-4\" />                  Answer Options *                </label>                <button                  onClick={addAnswer}                  disabled={localQuestion.answers.length >= 6}                  className=\"flex items-center gap-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm font-medium disabled:opacity-50\"                >                  // eslint-disable-next-line i18next/no-literal-string                  <Plus className=\"w-4 h-4\" />                  Add Answer                </button>              </div>                            <div className=\"space-y-3\">                {localQuestion.answers.map((answer, answerIndex) => (                  <div key={answer.id} className=\"flex items-center gap-3 p-4 bg-gray-50 rounded-xl border-2 border-gray-100\">                    <div className=\"w-8 h-8 bg-white rounded-full flex items-center justify-center text-gray-700 font-semibold shadow-sm\">                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <input                      type=\"text\"                      value={answer.text}                      onChange={(e) => updateAnswer(answer.id, { text: e.target.value })}                      placeholder={`Answer ${String.fromCharCode(65 + answerIndex)}`}                      className=\"flex-1 p-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"                    />                    <label className=\"flex items-center gap-2 text-sm font-medium\">                      <input                        type=\"checkbox\"                        checked={answer.isCorrect}                        onChange={(e) => updateAnswer(answer.id, { isCorrect: e.target.checked })}                        className=\"w-5 h-5 text-green-600 rounded focus:ring-green-500\"                      />                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-green-700\">Correct</span>                    </label>                    {localQuestion.answers.length > 2 && (                      <button                        onClick={() => deleteAnswer(answer.id)}                        className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors\"                      >                        <X className=\"w-5 h-5\" />                      </button>                    )}                  </div>                ))}              </div>            </div>            {/* Explanation */}            <div className=\"space-y-2\">              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                // eslint-disable-next-line i18next/no-literal-string                <Lightbulb className=\"w-4 h-4\" />                Explanation (Optional)              </label>              <textarea                value={localQuestion.explanation || ''}                onChange={(e) => setLocalQuestion({ ...localQuestion, explanation: e.target.value })}                placeholder={t('placeholders.explainAnswer')}                className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none\"                rows={3}              />            </div>          </div>        ) : (          <div className=\"space-y-4\">            {/* Question Display */}            <h4 className=\"text-xl font-bold text-gray-900 leading-relaxed\">              {question.text || '‚ùì Untitled Question'}            </h4>                        {/* Answers Grid */}            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">              {question.answers.map((answer, answerIndex) => (                <div key={answer.id} className={`p-4 rounded-xl border-2 transition-all ${                  answer.isCorrect                     ? 'bg-green-50 border-green-200 text-green-800'                     : 'bg-gray-50 border-gray-200 text-gray-700'                }`}>                  <div className=\"flex items-center gap-3\">                    <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${                      answer.isCorrect ? 'bg-green-500 text-white' : 'bg-gray-300 text-gray-600'                    }`}>                      {String.fromCharCode(65 + answerIndex)}                    </div>                    <span className=\"flex-1 font-medium\">                      {answer.text || 'Empty answer'}                    </span>                    {answer.isCorrect && <Check className=\"w-5 h-5 text-green-600\" />}                  </div>                </div>              ))}            </div>            {/* Question Info */}            <div className=\"flex items-center gap-6 text-sm text-gray-600 bg-gray-50 p-4 rounded-xl\">              <span className=\"flex items-center gap-1\">                <Target className=\"w-4 h-4\" />                // eslint-disable-next-line i18next/no-literal-string                <strong>{question.points}</strong> points              </span>              <span className=\"flex items-center gap-1\">                <Type className=\"w-4 h-4\" />                {question.type}              </span>              <span className=\"flex items-center gap-1\">                üìä {question.difficulty || 'medium'}              </span>              {question.explanation && (                <span className=\"flex items-center gap-1\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Has explanation                </span>              )}            </div>            {/* Explanation Preview */}            {question.explanation && (              <div className=\"bg-blue-50 p-4 rounded-xl border-l-4 border-blue-400\">                <h5 className=\"flex items-center gap-2 font-semibold text-blue-800 mb-2\">                  // eslint-disable-next-line i18next/no-literal-string                  <Lightbulb className=\"w-4 h-4\" />                  Explanation                </h5>                <SafeHTML content={question.explanation} className=\"text-blue-700\" />              </div>            )}          </div>        )}      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizBulkImport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1117,1120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1117,1120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Quiz } from '../types';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../lib/store';\r\nimport { doc, getDoc, setDoc, updateDoc, arrayUnion, arrayRemove } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\n// import { toast } from 'react-toastify';\r\nimport { Star, Eye, Play } from 'lucide-react';\r\nimport { reviewService } from '../services/reviewService';\r\nimport { QuizReviewStats } from '../types/review';\r\nimport SafeHTML from '../../../shared/components/ui/SafeHTML';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\ninterface QuizCardProps {\r\n  quiz: Quiz;\r\n  viewMode?: 'grid' | 'list';\r\n  onStartQuiz?: (quiz: Quiz) => void;\r\n}\r\n\r\n  const QuizCard: React.FC<QuizCardProps> = ({ quiz, viewMode = 'grid', onStartQuiz }) => {\r\n  const { t } = useTranslation();\r\n\r\n  const translate = useCallback(\r\n    (key: string, fallback: string, options?: Record<string, unknown>): string => {\r\n      const value = t(key, options as any);\r\n      if (typeof value === 'string') {\r\n        return value === key ? fallback : value;\r\n      }\r\n      return fallback;\r\n    },\r\n    [t]\r\n  );\r\n\r\n  const resources = Array.isArray(quiz.resources) ? quiz.resources : [];\r\n  const hasResources = resources.length > 0;\r\n  const resourceCount = resources.length;\r\n\r\n  const isPasswordProtected = useMemo(() => {\r\n    const extended = quiz as Partial<{ havePassword?: string; visibility?: string }>;\r\n    return extended.havePassword === 'password' || extended.visibility === 'password';\r\n  }, [quiz]);\r\n\r\n  // **TH√äM M·ªöI**: Helper functions\r\n  const getDifficultyColor = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'easy': return 'bg-green-100 text-green-800 border-green-200';\r\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\r\n      case 'hard': return 'bg-red-100 text-red-800 border-red-200';\r\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\r\n    }\r\n  };\r\n\r\n  const formatDuration = useCallback(\r\n    (minutes: number) => {\r\n      if (!Number.isFinite(minutes)) {\r\n        return '';\r\n      }\r\n\r\n      if (minutes < 60) {\r\n        return translate('quiz.card.duration.minutes', `${minutes} ph√∫t`, { count: minutes });\r\n      }\r\n\r\n      const hours = Math.floor(minutes / 60);\r\n      const remainingMinutes = minutes % 60;\r\n\r\n      if (remainingMinutes > 0) {\r\n        return translate('quiz.card.duration.hoursAndMinutes', `${hours} gi·ªù ${remainingMinutes} ph√∫t`, {\r\n          hours,\r\n          minutes: remainingMinutes,\r\n        });\r\n      }\r\n\r\n      return translate('quiz.card.duration.hours', `${hours} gi·ªù`, { count: hours });\r\n    },\r\n    [translate]\r\n  );\r\n\r\n  const getDifficultyLabel = useCallback(\r\n    (difficulty: Quiz['difficulty']) =>\r\n      translate(`quiz.difficulty.${difficulty}`, difficulty.charAt(0).toUpperCase() + difficulty.slice(1)),\r\n    [translate]\r\n  );\r\n\r\n  const getDifficultyBadgeLabel = useCallback(\r\n    (difficulty: Quiz['difficulty']) =>\r\n      translate(`quiz.card.difficultyBadge.${difficulty}`, difficulty.charAt(0).toUpperCase() + difficulty.slice(1)),\r\n    [translate]\r\n  );\r\n\r\n  const getResourceLabel = useCallback(\r\n    (count: number) => translate('quiz.card.resources', `üìö ${count} t√†i li·ªáu h·ªçc t·∫≠p`, { count }),\r\n    [translate]\r\n  );\r\n\r\n  const getQuestionsLabel = useCallback(\r\n    (count: number) => translate('quiz.card.questions', `${count} c√¢u h·ªèi`, { count }),\r\n    [translate]\r\n  );\r\n\r\n  const getPlayersLabel = useCallback(\r\n    (count: number) => translate('quiz.card.players', `${count} l∆∞·ª£t ch∆°i`, { count }),\r\n    [translate]\r\n  );\r\n\r\n  const getTagsRemainingLabel = useCallback(\r\n    (count: number) => translate('quiz.card.tagsRemaining', `+${count}`, { count }),\r\n    [translate]\r\n  );\r\n\r\n  const getCompletedWithScore = useCallback(\r\n    (score?: number) => translate('quiz.card.completedWithScore', `ƒê√£ ho√†n th√†nh: ${score ?? 0}%`, { score: score ?? 0 }),\r\n    [translate]\r\n  );\r\n\r\n  const getRatingSummary = useCallback(\r\n    (rating: number, count: number) =>\r\n      translate('quiz.card.ratingSummary', `${rating.toFixed(1)} (${count})`, {\r\n        rating: rating.toFixed(1),\r\n        count\r\n      }),\r\n    [translate]\r\n  );\r\n\r\n  const favoriteTooltipAdd = useMemo(\r\n    () => translate('quiz.card.favoriteTooltipAdd', 'Y√™u th√≠ch quiz n√†y'),\r\n    [translate]\r\n  );\r\n\r\n  const favoriteTooltipRemove = useMemo(\r\n    () => translate('quiz.card.favoriteTooltipRemove', 'B·ªè y√™u th√≠ch'),\r\n    [translate]\r\n  );\r\n\r\n  const viewReviewsLabel = useMemo(\r\n    () => translate('quiz.card.viewReviews', 'Xem ƒë√°nh gi√°'),\r\n    [translate]\r\n  );\r\n\r\n  const retakeLabel = useMemo(\r\n    () => translate('quiz.card.retake', 'üîÑ Ch∆°i l·∫°i'),\r\n    [translate]\r\n  );\r\n\r\n  const startLabel = useMemo(\r\n    () => translate('quiz.card.start', 'üöÄ B·∫Øt ƒë·∫ßu Quiz'),\r\n    [translate]\r\n  );\r\n\r\n  const completedBadgeLabel = useMemo(\r\n    () => translate('quiz.card.completed', '‚úì Ho√†n th√†nh'),\r\n    [translate]\r\n  );\r\n\r\n  const passwordBadgeLabel = useMemo(\r\n    () => translate('quiz.card.passwordRequired', 'üîí C·∫ßn m·∫≠t kh·∫©u'),\r\n    [translate]\r\n  );\r\n\r\n  const resourcesHint = useMemo(\r\n    () => translate('quiz.card.resourcesHint', 'üí° Xem t√†i li·ªáu ƒë·ªÉ hi·ªÉu s√¢u h∆°n tr∆∞·ªõc khi l√†m b√†i!'),\r\n    [translate]\r\n  );\r\n\r\n  const reviewsButtonLabel = useMemo(\r\n    () => translate('quiz.card.reviewsButton', 'ƒê√°nh gi√°'),\r\n    [translate]\r\n  );\r\n\r\n  const favoriteButtonAddedLabel = useMemo(\r\n    () => translate('quiz.card.favoriteAdded', 'ƒê√£ th√≠ch'),\r\n    [translate]\r\n  );\r\n\r\n  const favoriteButtonAddLabel = useMemo(\r\n    () => translate('quiz.card.favoriteAction', 'Y√™u th√≠ch'),\r\n    [translate]\r\n  );\r\n\r\n  // Helper component for rating display\r\n  const RatingDisplay = ({ rating, reviewCount, size = 'sm' }: { rating: number; reviewCount: number; size?: 'sm' | 'md' }) => {\r\n    const starSize = size === 'sm' ? 'w-4 h-4' : 'w-5 h-5';\r\n    const textSize = size === 'sm' ? 'text-sm' : 'text-base';\r\n    \r\n    return (\r\n      <div className={`flex items-center gap-1 ${textSize}`}>\r\n        <div className=\"flex items-center\">\r\n          {[1, 2, 3, 4, 5].map((star) => (\r\n            <Star\r\n              key={star}\r\n              className={`${starSize} ${\r\n                star <= Math.round(rating)\r\n                  ? 'text-yellow-400 fill-current'\r\n                  : 'text-gray-300'\r\n              }`}\r\n            />\r\n          ))}\r\n        </div>\r\n        <span className=\"text-gray-600 font-medium\">\r\n          {rating.toFixed(1)}\r\n        </span>\r\n        <span className=\"text-gray-500\">\r\n          ({reviewCount})\r\n        </span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const user = useSelector((state: RootState) => state.auth.user);\r\n  const [isFavorite, setIsFavorite] = useState(false);\r\n  const [favLoading, setFavLoading] = useState(false);\r\n  const [reviewStats, setReviewStats] = useState<QuizReviewStats | null>(null);\r\n\r\n  // Fetch review stats\r\n  useEffect(() => {\r\n    const fetchReviewStats = async () => {\r\n      try {\r\n        const stats = await reviewService.getQuizReviewStats(quiz.id);\r\n        setReviewStats(stats);\r\n      } catch (error) {\r\n        console.error('Error fetching review stats:', error);\r\n      }\r\n    };\r\n    \r\n    fetchReviewStats();\r\n  }, [quiz.id]);\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    const checkFavorite = async () => {\r\n      const favRef = doc(db, 'user_favorites', user.uid);\r\n      const favSnap = await getDoc(favRef);\r\n      if (favSnap.exists()) {\r\n        const data = favSnap.data();\r\n        setIsFavorite(Array.isArray(data.quizIds) && data.quizIds.includes(quiz.id));\r\n      } else {\r\n        setIsFavorite(false);\r\n      }\r\n    };\r\n    checkFavorite();\r\n  }, [user, quiz.id]);\r\n\r\n  const handleToggleFavorite = async (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    if (!user) return;\r\n    setFavLoading(true);\r\n    const favRef = doc(db, 'user_favorites', user.uid);\r\n    try {\r\n      const favSnap = await getDoc(favRef);\r\n      if (favSnap.exists()) {\r\n        await updateDoc(favRef, {\r\n          quizIds: isFavorite ? arrayRemove(quiz.id) : arrayUnion(quiz.id)\r\n        });\r\n      } else {\r\n        await setDoc(favRef, {\r\n          quizIds: [quiz.id]\r\n        });\r\n      }\r\n      setIsFavorite(!isFavorite);\r\n      // toast.success(isFavorite ? 'ƒê√£ b·ªè y√™u th√≠ch quiz!' : 'ƒê√£ th√™m v√†o y√™u th√≠ch!');\r\n      // N·∫øu ƒëang ·ªü trang Favorites, refetch l·∫°i\r\n      if (window.location.pathname.startsWith('/favorites')) {\r\n        window.location.reload();\r\n      }\r\n    } catch (err) {\r\n      // toast.error('L·ªói khi c·∫≠p nh·∫≠t y√™u th√≠ch!');\r\n    } finally {\r\n      setFavLoading(false);\r\n    }\r\n  };\r\n\r\n  // **TH√äM M·ªöI**: Render list view\r\n  if (viewMode === 'list') {\r\n    return (\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow\">\r\n        <div className=\"flex items-center gap-6\">\r\n          {/* Image/Icon */}\r\n          <div className=\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-gradient-to-br from-blue-500 to-purple-600 relative\">\r\n            {quiz.imageUrl ? (\r\n              <img src={quiz.imageUrl} alt={quiz.title} className=\"w-full h-full object-cover\" />\r\n            ) : (\r\n              <div className=\"w-full h-full flex items-center justify-center text-white text-2xl font-bold\">\r\n                {quiz.category.charAt(0).toUpperCase()}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-start justify-between mb-2\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 truncate pr-4\">{quiz.title}</h3>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className={`px-2 py-1 rounded text-xs font-medium ${getDifficultyColor(quiz.difficulty)}`}>\r\n                  {getDifficultyLabel(quiz.difficulty)}\r\n                </span>\r\n                {quiz.isCompleted && (\r\n                  <span className=\"px-2 py-1 bg-green-100 text-green-800 text-xs rounded font-medium\">\r\n                    {completedBadgeLabel}\r\n                  </span>\r\n                )}\r\n                {/* üîí Password Badge - Support both old (havePassword) and new (visibility) format */}\r\n                {isPasswordProtected && (\r\n                  <span className=\"px-2 py-1 bg-purple-100 text-purple-700 border border-purple-300 text-xs rounded-full font-bold flex items-center gap-1\">\r\n                    {passwordBadgeLabel}\r\n                  </span>\r\n                )}\r\n                {/* üÜï Resource Badge */}\r\n                {hasResources && (\r\n                  <span className=\"px-2 py-1 bg-emerald-100 text-emerald-700 border border-emerald-300 text-xs rounded-full font-bold flex items-center gap-1\">\r\n                    {getResourceLabel(resourceCount)}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n            \r\n            <SafeHTML content={quiz.description} className=\"text-gray-600 text-sm mb-3 line-clamp-1\" />\r\n            \r\n            <div className=\"flex items-center gap-6 text-sm text-gray-500 mb-4\">\r\n              <div className=\"flex items-center\">\r\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z\" />\r\n                </svg>\r\n                {quiz.category}\r\n              </div>\r\n              <div className=\"flex items-center\">\r\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                </svg>\r\n                {getQuestionsLabel(quiz.questions.length)}\r\n              </div>\r\n              <div className=\"flex items-center\">\r\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                </svg>\r\n                {formatDuration(quiz.duration)}\r\n              </div>\r\n              {quiz.totalPlayers && (\r\n                <div className=\"flex items-center\">\r\n                  <Eye className=\"w-4 h-4 mr-1\" />\r\n                  {getPlayersLabel(quiz.totalPlayers)}\r\n                </div>\r\n              )}\r\n              {reviewStats && reviewStats.totalReviews > 0 && (\r\n                <RatingDisplay \r\n                  rating={reviewStats.averageRating} \r\n                  reviewCount={reviewStats.totalReviews} \r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Tags */}\r\n            {quiz.tags && quiz.tags.length > 0 && (\r\n              <div className=\"flex flex-wrap gap-1 mb-4\">\r\n                {quiz.tags.slice(0, 4).map((tag, index) => (\r\n                  <span key={index} className=\"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded\">\r\n                    {tag}\r\n                  </span>\r\n                ))}\r\n                {quiz.tags.length > 4 && (\r\n                  <span className=\"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded\">\r\n                    {getTagsRemainingLabel(quiz.tags.length - 4)}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex items-center gap-3 flex-shrink-0\">\r\n            <button\r\n              onClick={handleToggleFavorite}\r\n              disabled={!user || favLoading}\r\n              className={`p-2 border rounded-lg transition-colors ${isFavorite ? 'bg-yellow-100 border-yellow-400 text-yellow-600' : 'border-gray-300 text-gray-700 hover:bg-gray-50'}`}\r\n              title={isFavorite ? favoriteTooltipRemove : favoriteTooltipAdd}\r\n            >\r\n              <svg className=\"w-5 h-5\" fill={isFavorite ? 'gold' : 'none'} stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\" />\r\n              </svg>\r\n            </button>\r\n            <Link\r\n              to={`/quiz/${quiz.id}/reviews`}\r\n              className=\"p-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\r\n              title={viewReviewsLabel}\r\n            >\r\n              <Eye className=\"w-5 h-5\" />\r\n            </Link>\r\n            <button\r\n              onClick={() => onStartQuiz?.(quiz)}\r\n              className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 px-6 rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200\"\r\n            >\r\n              {quiz.isCompleted ? retakeLabel : startLabel}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Grid view (existing code)\r\n  return (\r\n    <div className=\"bg-white rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-500 overflow-hidden border border-gray-100 hover:border-blue-300 group transform hover:scale-105 cursor-pointer flex flex-col h-full\">\r\n      {/* **TH√äM M·ªöI**: Image Header */}\r\n      <div className=\"relative h-48 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 overflow-hidden\">\r\n        {quiz.imageUrl ? (\r\n          <img \r\n            src={quiz.imageUrl} \r\n            alt={quiz.title}\r\n            className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\"\r\n          />\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center relative\">\r\n            <div className=\"absolute inset-0 bg-gradient-to-br from-blue-400/20 to-purple-600/20 backdrop-blur-3xl\"></div>\r\n            <div className=\"relative text-white text-6xl font-bold opacity-30 drop-shadow-lg\">\r\n              {quiz.category.charAt(0).toUpperCase()}\r\n            </div>\r\n            <div className=\"absolute bottom-4 left-4 text-white/90 font-semibold text-sm px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full border border-white/30\">\r\n              {quiz.category}\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent z-10\" />\r\n        \r\n        {/* **TH√äM M·ªöI**: Overlay badges */}\r\n        <div className=\"absolute top-4 left-4 flex flex-wrap gap-2 z-20\">\r\n          <span className={`px-3 py-1.5 rounded-2xl text-xs font-semibold backdrop-blur-sm shadow-lg ${getDifficultyColor(quiz.difficulty)}`}>\r\n            {getDifficultyBadgeLabel(quiz.difficulty)}\r\n          </span>\r\n          {/* üîí Password Badge - Support both old (havePassword) and new (visibility) format */}\r\n          {isPasswordProtected && (\r\n            <span className=\"px-3 py-1.5 rounded-2xl text-xs font-semibold bg-purple-500/90 text-white backdrop-blur-sm shadow-lg border border-purple-400\">\r\n              {passwordBadgeLabel}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {/* **TH√äM M·ªöI**: Favorite button in overlay */}\r\n        <div className=\"absolute top-4 right-4 z-20\">\r\n          <button\r\n            onClick={handleToggleFavorite}\r\n            disabled={!user || favLoading}\r\n            className={`p-2.5 backdrop-blur-sm rounded-2xl shadow-lg transition-all duration-300 ${isFavorite ? 'bg-yellow-400/90 border border-yellow-300 text-yellow-900' : 'bg-white/20 border border-white/30 text-white hover:bg-white/30'}`}\r\n            title={isFavorite ? favoriteTooltipRemove : favoriteTooltipAdd}\r\n          >\r\n            <svg className=\"w-5 h-5\" fill={isFavorite ? 'currentColor' : 'none'} stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Quiz stats in bottom */}\r\n        <div className=\"absolute bottom-4 left-4 right-4 z-20 flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            {quiz.totalPlayers && (\r\n              <div className=\"flex items-center text-white/90 text-sm bg-black/30 backdrop-blur-sm px-3 py-1.5 rounded-2xl\">\r\n                <Eye className=\"w-4 h-4 mr-1.5\" />\r\n                {getPlayersLabel(quiz.totalPlayers)}\r\n              </div>\r\n            )}\r\n          </div>\r\n          {reviewStats && reviewStats.totalReviews > 0 && (\r\n            <div className=\"flex items-center text-white text-sm bg-black/30 backdrop-blur-sm px-3 py-1.5 rounded-2xl\">\r\n              <Star className=\"w-4 h-4 mr-1.5 fill-current text-yellow-400\" />\r\n              {getRatingSummary(reviewStats.averageRating, reviewStats.totalReviews)}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"p-6 flex-1 flex flex-col\">\r\n        <div className=\"flex items-start justify-between mb-4\">\r\n          <h3 className=\"text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors line-clamp-2 flex-1\">\r\n            {quiz.title}\r\n          </h3>\r\n        </div>\r\n        \r\n        <SafeHTML content={quiz.description} className=\"text-gray-600 text-sm mb-6 line-clamp-2 leading-relaxed\" />\r\n\r\n        {/* **TH√äM M·ªöI**: Quiz metadata */}\r\n        <div className=\"space-y-4 mb-6\">\r\n          <div className=\"flex items-center justify-between text-sm text-gray-500\">\r\n            <div className=\"flex items-center\">\r\n              <svg className=\"w-4 h-4 mr-2 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z\" />\r\n              </svg>\r\n              <span className=\"font-medium\">{quiz.category}</span>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <svg className=\"w-4 h-4 mr-2 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n              </svg>\r\n              <span className=\"font-medium\">{formatDuration(quiz.duration)}</span>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center justify-between text-sm text-gray-500\">\r\n            <div className=\"flex items-center\">\r\n              <svg className=\"w-4 h-4 mr-2 text-purple-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n              </svg>\r\n              <span className=\"font-medium\">{getQuestionsLabel(quiz.questions.length)}</span>\r\n            </div>\r\n            {reviewStats && reviewStats.totalReviews > 0 && (\r\n              <div className=\"flex items-center\">\r\n                <Star className=\"w-4 h-4 mr-1 text-yellow-500 fill-current\" />\r\n                <span className=\"font-medium\">{getRatingSummary(reviewStats.averageRating, reviewStats.totalReviews)}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* **TH√äM M·ªöI**: Completion status */}\r\n        {quiz.isCompleted && (\r\n          <div className=\"flex items-center text-green-600 text-sm mb-4 bg-green-50 px-3 py-2 rounded-2xl border border-green-200\">\r\n            <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n            <span className=\"font-semibold\">{getCompletedWithScore(quiz.score)}</span>\r\n          </div>\r\n        )}\r\n\r\n        {/* **TH√äM M·ªöI**: Tags */}\r\n        {quiz.tags && quiz.tags.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-2 mb-6\">\r\n            {quiz.tags.slice(0, 3).map((tag, index) => (\r\n              <span\r\n                key={index}\r\n                className=\"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs rounded-2xl font-medium transition-colors\"\r\n              >\r\n                #{tag}\r\n              </span>\r\n            ))}\r\n            {quiz.tags.length > 3 && (\r\n              <span className=\"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-2xl font-medium\">\r\n                {getTagsRemainingLabel(quiz.tags.length - 3)}\r\n              </span>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* üÜï Learning Resources Badge */}\r\n        {hasResources && (\r\n          <div className=\"mb-4 p-3 bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl\">\r\n            <div className=\"flex items-center gap-2 text-emerald-800\">\r\n              <span className=\"text-lg\">üìö</span>\r\n              <span className=\"font-bold text-sm\">\r\n                {getResourceLabel(resourceCount)}\r\n              </span>\r\n            </div>\r\n            <p className=\"text-xs text-emerald-600 mt-1\">\r\n              {resourcesHint}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Action buttons */}\r\n        <div className=\"mt-auto pt-4 border-t border-gray-100\">\r\n          <button\r\n            onClick={() => onStartQuiz?.(quiz)}\r\n            className=\"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 px-4 rounded-xl font-semibold text-center transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2\"\r\n          >\r\n            <Play className=\"w-5 h-5\" />\r\n            <span>{quiz.isCompleted ? retakeLabel : startLabel}</span>\r\n          </button>\r\n          \r\n          <div className=\"flex gap-2 mt-3\">\r\n            <Link\r\n              to={`/quiz/${quiz.id}/reviews`}\r\n              className=\"flex-1 px-3 py-2 border border-gray-200 hover:border-blue-300 text-gray-700 hover:text-blue-600 rounded-lg transition-all duration-300 hover:bg-blue-50 text-sm text-center flex items-center justify-center\"\r\n              title={viewReviewsLabel}\r\n            >\r\n              <Eye className=\"w-4 h-4 mr-2\" />\r\n              {reviewsButtonLabel}\r\n            </Link>\r\n            \r\n            <button\r\n              onClick={handleToggleFavorite}\r\n              disabled={favLoading}\r\n              className={`flex-1 px-3 py-2 rounded-lg text-sm transition-all duration-300 flex items-center justify-center ${\r\n                isFavorite\r\n                  ? 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'\r\n                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n              }`}\r\n              title={isFavorite ? favoriteTooltipRemove : favoriteTooltipAdd}\r\n            >\r\n              <Star className={`w-4 h-4 mr-2 ${isFavorite ? 'fill-current' : ''}`} />\r\n              {isFavorite ? favoriteButtonAddedLabel : favoriteButtonAddLabel}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const QuizCardSkeleton = () => (\r\n  <div className=\"bg-white rounded-xl shadow-lg animate-pulse h-96 flex flex-col\">\r\n    <div className=\"h-48 bg-gray-200 w-full\" />\r\n    <div className=\"p-6 flex-1 flex flex-col\">\r\n      <div className=\"h-6 bg-gray-200 rounded w-2/3 mb-4\" />\r\n      <div className=\"h-4 bg-gray-200 rounded w-1/2 mb-2\" />\r\n      <div className=\"h-4 bg-gray-200 rounded w-1/3 mb-6\" />\r\n      <div className=\"flex gap-2 mt-auto\">\r\n        <div className=\"h-10 w-24 bg-gray-200 rounded\" />\r\n        <div className=\"h-10 w-10 bg-gray-200 rounded\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default QuizCard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizFilters.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"{ useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizFiltersProps {  onFilterChange: (filters: FilterOptions) => void;  categories: string[];  difficulties: string[];  totalQuizzes: number;  filteredCount: number;}interface FilterOptions {  search: string;  category: string;  difficulty: string;  sortBy: string;  showCompleted: boolean;  tags: string[];  minQuestions: number;  maxDuration: number;}const QuizFilters: React.FC<QuizFiltersProps> = ({  onFilterChange","message":"Definition for rule '{ useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizFiltersProps {  onFilterChange: (filters: FilterOptions) => void;  categories: string[];  difficulties: string[];  totalQuizzes: number;  filteredCount: number;}interface FilterOptions {  search: string;  category: string;  difficulty: string;  sortBy: string;  showCompleted: boolean;  tags: string[];  minQuestions: number;  maxDuration: number;}const QuizFilters: React.FC<QuizFiltersProps> = ({  onFilterChange' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"categories","message":"Definition for rule 'categories' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"difficulties","message":"Definition for rule 'difficulties' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"totalQuizzes","message":"Definition for rule 'totalQuizzes' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"filteredCount}) => {  const { t } = useTranslation();  const [filters","message":"Definition for rule 'filteredCount}) => {  const { t } = useTranslation();  const [filters' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"setFilters] = useState<FilterOptions>({    search: ''","message":"Definition for rule 'setFilters] = useState<FilterOptions>({    search: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"category: 'all'","message":"Definition for rule 'category: 'all'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"difficulty: 'all'","message":"Definition for rule 'difficulty: 'all'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"sortBy: 'newest'","message":"Definition for rule 'sortBy: 'newest'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"showCompleted: true","message":"Definition for rule 'showCompleted: true' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"tags: []","message":"Definition for rule 'tags: []' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"minQuestions: 0","message":"Definition for rule 'minQuestions: 0' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"maxDuration: 120  });  const [showAdvanced","message":"Definition for rule 'maxDuration: 120  });  const [showAdvanced' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"setShowAdvanced] = useState(false);  const updateFilter = (key: keyof FilterOptions","message":"Definition for rule 'setShowAdvanced] = useState(false);  const updateFilter = (key: keyof FilterOptions' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"value: any) => {    const newFilters = { ...filters","message":"Definition for rule 'value: any) => {    const newFilters = { ...filters' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"[key]: value };    setFilters(newFilters);    onFilterChange(newFilters);  };  const resetFilters = () => {    const defaultFilters: FilterOptions = {      search: ''","message":"Definition for rule '[key]: value };    setFilters(newFilters);    onFilterChange(newFilters);  };  const resetFilters = () => {    const defaultFilters: FilterOptions = {      search: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"maxDuration: 120    };    setFilters(defaultFilters);    onFilterChange(defaultFilters);  };  return (    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8\">      {/* Quick Stats */}      <div className=\"flex items-center justify-between mb-6\">        <div className=\"flex items-center gap-6\">          // eslint-disable-next-line i18next/no-literal-string          <div className=\"text-sm text-gray-600\">{t(\"profile.pagination.showing\")} <span className=\"font-semibold text-blue-600\">{filteredCount}</span> / {totalQuizzes} quiz          </div>          {filteredCount !== totalQuizzes && (            <button              onClick={resetFilters}              className=\"text-sm text-blue-600 hover:text-blue-700 font-medium\"            >{t(\"quizList.empty.clearFilters\")}            </button>          )}        </div>        <button          onClick={() => setShowAdvanced(!showAdvanced)}          className=\"text-sm text-gray-600 hover:text-gray-700 flex items-center gap-1\"        >          // eslint-disable-next-line i18next/no-literal-string          <span>{showAdvanced ? '·∫®n' : 'Hi·ªán'} t√πy ch·ªçn n√¢ng cao</span>          <svg             className={`w-4 h-4 transition-transform ${showAdvanced ? 'rotate-180' : ''}`}             fill=\"none\"             stroke=\"currentColor\"             viewBox=\"0 0 24 24\"          >            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />          </svg>        </button>      </div>      {/* Basic Filters */}      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">        {/* Search */}        <div className=\"lg:col-span-2\">          <input            type=\"text\"            placeholder={t('placeholders.searchQuiz')}            value={filters.search}            onChange={(e) => updateFilter('search'","message":"Definition for rule 'maxDuration: 120    };    setFilters(defaultFilters);    onFilterChange(defaultFilters);  };  return (    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8\">      {/* Quick Stats */}      <div className=\"flex items-center justify-between mb-6\">        <div className=\"flex items-center gap-6\">          // eslint-disable-next-line i18next/no-literal-string          <div className=\"text-sm text-gray-600\">{t(\"profile.pagination.showing\")} <span className=\"font-semibold text-blue-600\">{filteredCount}</span> / {totalQuizzes} quiz          </div>          {filteredCount !== totalQuizzes && (            <button              onClick={resetFilters}              className=\"text-sm text-blue-600 hover:text-blue-700 font-medium\"            >{t(\"quizList.empty.clearFilters\")}            </button>          )}        </div>        <button          onClick={() => setShowAdvanced(!showAdvanced)}          className=\"text-sm text-gray-600 hover:text-gray-700 flex items-center gap-1\"        >          // eslint-disable-next-line i18next/no-literal-string          <span>{showAdvanced ? '·∫®n' : 'Hi·ªán'} t√πy ch·ªçn n√¢ng cao</span>          <svg             className={`w-4 h-4 transition-transform ${showAdvanced ? 'rotate-180' : ''}`}             fill=\"none\"             stroke=\"currentColor\"             viewBox=\"0 0 24 24\"          >            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />          </svg>        </button>      </div>      {/* Basic Filters */}      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">        {/* Search */}        <div className=\"lg:col-span-2\">          <input            type=\"text\"            placeholder={t('placeholders.searchQuiz')}            value={filters.search}            onChange={(e) => updateFilter('search'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}            className=\"w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"          />        </div>                {/* Category */}        <select           value={filters.category}          onChange={(e) => updateFilter('category'","message":"Definition for rule 'e.target.value)}            className=\"w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"          />        </div>                {/* Category */}        <select           value={filters.category}          onChange={(e) => updateFilter('category'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allCategories\")}</option>          {categories.map(c => <option key={c} value={c}>{c}</option>)}        </select>                {/* Difficulty */}        <select           value={filters.difficulty}          onChange={(e) => updateFilter('difficulty'","message":"Definition for rule 'e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allCategories\")}</option>          {categories.map(c => <option key={c} value={c}>{c}</option>)}        </select>                {/* Difficulty */}        <select           value={filters.difficulty}          onChange={(e) => updateFilter('difficulty'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allDifficulties\")}</option>          {difficulties.map(d => <option key={d} value={d}>            {d === 'easy' ? 'üòä D·ªÖ' : d === 'medium' ? 'üòê Trung b√¨nh' : 'üò§ Kh√≥'}          </option>)}        </select>      </div>      {/* Advanced Filters */}      {showAdvanced && (        <div className=\"border-t border-gray-100 pt-4\">          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">            {/* Sort Options */}            <select               value={filters.sortBy}              onChange={(e) => updateFilter('sortBy'","message":"Definition for rule 'e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allDifficulties\")}</option>          {difficulties.map(d => <option key={d} value={d}>            {d === 'easy' ? 'üòä D·ªÖ' : d === 'medium' ? 'üòê Trung b√¨nh' : 'üò§ Kh√≥'}          </option>)}        </select>      </div>      {/* Advanced Filters */}      {showAdvanced && (        <div className=\"border-t border-gray-100 pt-4\">          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">            {/* Sort Options */}            <select               value={filters.sortBy}              onChange={(e) => updateFilter('sortBy'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}              className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"            >              <option value=\"newest\">{t(\"quizList.sort.newest\")}</option>              <option value=\"oldest\">{t(\"quizList.sort.oldest\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"popular\">üî• Ph·ªï bi·∫øn nh·∫•t</option>              <option value=\"difficulty\">{t(\"quizList.sort.difficulty\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"questions\">üî¢ Theo s·ªë c√¢u h·ªèi</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"duration\">‚è±Ô∏è Theo th·ªùi l∆∞·ª£ng</option>            </select>            {/* Min Questions */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">S·ªë c√¢u h·ªèi t·ªëi thi·ªÉu: {filters.minQuestions}</label>              <input                type=\"range\"                min=\"0\"                max=\"50\"                value={filters.minQuestions}                onChange={(e) => updateFilter('minQuestions'","message":"Definition for rule 'e.target.value)}              className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"            >              <option value=\"newest\">{t(\"quizList.sort.newest\")}</option>              <option value=\"oldest\">{t(\"quizList.sort.oldest\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"popular\">üî• Ph·ªï bi·∫øn nh·∫•t</option>              <option value=\"difficulty\">{t(\"quizList.sort.difficulty\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"questions\">üî¢ Theo s·ªë c√¢u h·ªèi</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"duration\">‚è±Ô∏è Theo th·ªùi l∆∞·ª£ng</option>            </select>            {/* Min Questions */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">S·ªë c√¢u h·ªèi t·ªëi thi·ªÉu: {filters.minQuestions}</label>              <input                type=\"range\"                min=\"0\"                max=\"50\"                value={filters.minQuestions}                onChange={(e) => updateFilter('minQuestions'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"parseInt(e.target.value))}                className=\"w-full\"              />            </div>            {/* Max Duration */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">Th·ªùi l∆∞·ª£ng t·ªëi ƒëa: {filters.maxDuration} ph√∫t</label>              <input                type=\"range\"                min=\"5\"                max=\"120\"                value={filters.maxDuration}                onChange={(e) => updateFilter('maxDuration'","message":"Definition for rule 'parseInt(e.target.value))}                className=\"w-full\"              />            </div>            {/* Max Duration */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">Th·ªùi l∆∞·ª£ng t·ªëi ƒëa: {filters.maxDuration} ph√∫t</label>              <input                type=\"range\"                min=\"5\"                max=\"120\"                value={filters.maxDuration}                onChange={(e) => updateFilter('maxDuration'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"parseInt(e.target.value))}                className=\"w-full\"              />            </div>          </div>          {/* Additional Options */}          <div className=\"flex items-center gap-6\">            <label className=\"flex items-center gap-2 text-sm text-gray-600\">              <input                type=\"checkbox\"                checked={filters.showCompleted}                onChange={(e) => updateFilter('showCompleted'","message":"Definition for rule 'parseInt(e.target.value))}                className=\"w-full\"              />            </div>          </div>          {/* Additional Options */}          <div className=\"flex items-center gap-6\">            <label className=\"flex items-center gap-2 text-sm text-gray-600\">              <input                type=\"checkbox\"                checked={filters.showCompleted}                onChange={(e) => updateFilter('showCompleted'' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null},{"ruleId":"e.target.checked)}                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"              />{t(\"quizList.options.showCompleted\")}            </label>          </div>        </div>      )}    </div>  );};export default QuizFilters;","message":"Definition for rule 'e.target.checked)}                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"              />{t(\"quizList.options.showCompleted\")}            </label>          </div>        </div>      )}    </div>  );};export default QuizFilters;' was not found.","line":1,"column":1,"endLine":1,"endColumn":7150,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizFiltersProps {  onFilterChange: (filters: FilterOptions) => void;  categories: string[];  difficulties: string[];  totalQuizzes: number;  filteredCount: number;}interface FilterOptions {  search: string;  category: string;  difficulty: string;  sortBy: string;  showCompleted: boolean;  tags: string[];  minQuestions: number;  maxDuration: number;}const QuizFilters: React.FC<QuizFiltersProps> = ({  onFilterChange,  categories,  difficulties,  totalQuizzes,  filteredCount}) => {  const { t } = useTranslation();  const [filters, setFilters] = useState<FilterOptions>({    search: '',    category: 'all',    difficulty: 'all',    sortBy: 'newest',    showCompleted: true,    tags: [],    minQuestions: 0,    maxDuration: 120  });  const [showAdvanced, setShowAdvanced] = useState(false);  const updateFilter = (key: keyof FilterOptions, value: any) => {    const newFilters = { ...filters, [key]: value };    setFilters(newFilters);    onFilterChange(newFilters);  };  const resetFilters = () => {    const defaultFilters: FilterOptions = {      search: '',      category: 'all',      difficulty: 'all',      sortBy: 'newest',      showCompleted: true,      tags: [],      minQuestions: 0,      maxDuration: 120    };    setFilters(defaultFilters);    onFilterChange(defaultFilters);  };  return (    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8\">      {/* Quick Stats */}      <div className=\"flex items-center justify-between mb-6\">        <div className=\"flex items-center gap-6\">          // eslint-disable-next-line i18next/no-literal-string          <div className=\"text-sm text-gray-600\">{t(\"profile.pagination.showing\")} <span className=\"font-semibold text-blue-600\">{filteredCount}</span> / {totalQuizzes} quiz          </div>          {filteredCount !== totalQuizzes && (            <button              onClick={resetFilters}              className=\"text-sm text-blue-600 hover:text-blue-700 font-medium\"            >{t(\"quizList.empty.clearFilters\")}            </button>          )}        </div>        <button          onClick={() => setShowAdvanced(!showAdvanced)}          className=\"text-sm text-gray-600 hover:text-gray-700 flex items-center gap-1\"        >          // eslint-disable-next-line i18next/no-literal-string          <span>{showAdvanced ? '·∫®n' : 'Hi·ªán'} t√πy ch·ªçn n√¢ng cao</span>          <svg             className={`w-4 h-4 transition-transform ${showAdvanced ? 'rotate-180' : ''}`}             fill=\"none\"             stroke=\"currentColor\"             viewBox=\"0 0 24 24\"          >            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />          </svg>        </button>      </div>      {/* Basic Filters */}      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">        {/* Search */}        <div className=\"lg:col-span-2\">          <input            type=\"text\"            placeholder={t('placeholders.searchQuiz')}            value={filters.search}            onChange={(e) => updateFilter('search', e.target.value)}            className=\"w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"          />        </div>                {/* Category */}        <select           value={filters.category}          onChange={(e) => updateFilter('category', e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allCategories\")}</option>          {categories.map(c => <option key={c} value={c}>{c}</option>)}        </select>                {/* Difficulty */}        <select           value={filters.difficulty}          onChange={(e) => updateFilter('difficulty', e.target.value)}          className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"        >          <option value=\"all\">{t(\"quizList.filters.allDifficulties\")}</option>          {difficulties.map(d => <option key={d} value={d}>            {d === 'easy' ? 'üòä D·ªÖ' : d === 'medium' ? 'üòê Trung b√¨nh' : 'üò§ Kh√≥'}          </option>)}        </select>      </div>      {/* Advanced Filters */}      {showAdvanced && (        <div className=\"border-t border-gray-100 pt-4\">          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">            {/* Sort Options */}            <select               value={filters.sortBy}              onChange={(e) => updateFilter('sortBy', e.target.value)}              className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"            >              <option value=\"newest\">{t(\"quizList.sort.newest\")}</option>              <option value=\"oldest\">{t(\"quizList.sort.oldest\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"popular\">üî• Ph·ªï bi·∫øn nh·∫•t</option>              <option value=\"difficulty\">{t(\"quizList.sort.difficulty\")}</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"questions\">üî¢ Theo s·ªë c√¢u h·ªèi</option>              // eslint-disable-next-line i18next/no-literal-string              <option value=\"duration\">‚è±Ô∏è Theo th·ªùi l∆∞·ª£ng</option>            </select>            {/* Min Questions */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">S·ªë c√¢u h·ªèi t·ªëi thi·ªÉu: {filters.minQuestions}</label>              <input                type=\"range\"                min=\"0\"                max=\"50\"                value={filters.minQuestions}                onChange={(e) => updateFilter('minQuestions', parseInt(e.target.value))}                className=\"w-full\"              />            </div>            {/* Max Duration */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm text-gray-600 mb-1\">Th·ªùi l∆∞·ª£ng t·ªëi ƒëa: {filters.maxDuration} ph√∫t</label>              <input                type=\"range\"                min=\"5\"                max=\"120\"                value={filters.maxDuration}                onChange={(e) => updateFilter('maxDuration', parseInt(e.target.value))}                className=\"w-full\"              />            </div>          </div>          {/* Additional Options */}          <div className=\"flex items-center gap-6\">            <label className=\"flex items-center gap-2 text-sm text-gray-600\">              <input                type=\"checkbox\"                checked={filters.showCompleted}                onChange={(e) => updateFilter('showCompleted', e.target.checked)}                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"              />{t(\"quizList.options.showCompleted\")}            </label>          </div>        </div>      )}    </div>  );};export default QuizFilters;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizPreviewModal.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":8755,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { useTranslation } from 'react-i18next';import { Quiz } from '../types';interface QuizPreviewModalProps {  isOpen: boolean;  onClose: () => void;  quiz: Partial<Quiz>;  onProceedToPublish: () => void;}export const QuizPreviewModal: React.FC<QuizPreviewModalProps> = ({  isOpen,  onClose,  quiz,  onProceedToPublish}) => {  const { t } = useTranslation();  if (!isOpen) return null;  const questionCount = quiz.questions?.length || 0;  const hasResources = (quiz as any).resources && (quiz as any).resources.length > 0;  const estimatedTime = questionCount * 1.5; // 1.5 ph√∫t/c√¢u  return (    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl\">        {/* Header */}        <div className=\"bg-gradient-to-r from-indigo-600 to-blue-600 p-6 text-white rounded-t-2xl\">          <div className=\"flex items-center justify-between\">            <div>              // eslint-disable-next-line i18next/no-literal-string              <h2 className=\"text-2xl font-bold flex items-center gap-2\">                üëÅÔ∏è {t('quiz.preview.title') || 'Preview Quiz'}              </h2>              <p className=\"text-indigo-100 mt-1\">                {t('quiz.preview.subtitle') || 'Review before publishing'}              </p>            </div>            <button              onClick={onClose}              className=\"text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors\"            // eslint-disable-next-line i18next/no-literal-string            >              ‚úï            </button>          </div>        </div>        <div className=\"p-6 space-y-6\">          {/* Quiz Header */}          <div>            <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">              {quiz.title || t('quiz.untitled')}            </h3>            <p className=\"text-gray-600 leading-relaxed\">              {quiz.description || t('quiz.noDescription')}            </p>          </div>          {/* Quiz Stats */}          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">            <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">              <p className=\"text-sm text-blue-600 mb-1\">{t('quiz.questions') || 'Questions'}</p>              <p className=\"text-2xl font-bold text-blue-900\">{questionCount}</p>            </div>            <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">              <p className=\"text-sm text-purple-600 mb-1\">{t('quiz.difficulty') || 'Difficulty'}</p>              <p className=\"text-lg font-bold text-purple-900\">                {quiz.difficulty === 'easy' ? 'üü¢ Easy' :                 quiz.difficulty === 'medium' ? 'üü° Medium' :                 quiz.difficulty === 'hard' ? 'üî¥ Hard' : '‚ùì'}              </p>            </div>            <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">              <p className=\"text-sm text-green-600 mb-1\">{t('quiz.timeLimit') || 'Time Limit'}</p>              <p className=\"text-lg font-bold text-green-900\">                {(quiz as any).timeLimit ? `${(quiz as any).timeLimit} min` : '‚àû Unlimited'}              </p>            </div>            <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">              <p className=\"text-sm text-orange-600 mb-1\">{t('quiz.estimatedTime') || 'Est. Time'}</p>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-lg font-bold text-orange-900\">~{estimatedTime} min</p>            </div>          </div>          {/* Quiz Settings */}          <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">            // eslint-disable-next-line i18next/no-literal-string            <h4 className=\"font-semibold text-gray-900 mb-3\">              ‚öôÔ∏è {t('quiz.settings') || 'Settings'}            </h4>            <div className=\"grid grid-cols-2 gap-3 text-sm\">              <div className=\"flex items-center gap-2\">                <span className={(quiz as any).visibility === 'public' ? 'text-green-600' : 'text-orange-600'}>                  {(quiz as any).visibility === 'public' ? 'üåê Public' : 'üîí Password Protected'}                </span>              </div>              <div className=\"flex items-center gap-2\">                <span className=\"text-gray-700\">                  {quiz.category || t('quiz.noCategory')}                </span>              </div>              {hasResources && (                <div className=\"flex items-center gap-2 text-blue-600\">                  üìö {t('quiz.hasResources') || 'Has Learning Materials'}                </div>              )}              {(quiz as any).showResults && (                <div className=\"flex items-center gap-2 text-green-600\">                  ‚úÖ {t('quiz.showResults') || 'Show Results'}                </div>              )}            </div>          </div>          {/* Questions Preview */}          <div>            <h4 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">              üìù {t('quiz.questionsPreview') || 'Questions Preview'}              <span className=\"text-sm font-normal text-gray-500\">                ({questionCount} {t('quiz.total') || 'total'})              </span>            </h4>            <div className=\"space-y-3 max-h-96 overflow-y-auto\">              {quiz.questions && quiz.questions.length > 0 ? (                quiz.questions.slice(0, 5).map((q: any, index: number) => (                  <div key={index} className=\"bg-white p-4 rounded-lg border border-gray-200\">                    <div className=\"flex items-start gap-3\">                      <span className=\"flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-semibold text-sm\">                        {index + 1}                      </span>                      <div className=\"flex-1\">                        <p className=\"text-gray-900 font-medium mb-2\">{q.question}</p>                        <div className=\"space-y-1\">                          {q.options.map((opt: string, optIndex: number) => (                            <div                              key={optIndex}                              className={`text-sm px-3 py-1.5 rounded ${                                optIndex === q.correctAnswer                                  ? 'bg-green-50 text-green-700 border border-green-200'                                  : 'bg-gray-50 text-gray-600'                              }`}                            >                              {opt}                              {optIndex === q.correctAnswer && ' ‚úì'}                            </div>                          ))}                        </div>                      </div>                    </div>                  </div>                ))              ) : (                <div className=\"text-center py-8 text-gray-500\">                  {t('quiz.noQuestions') || 'No questions added yet'}                </div>              )}              {questionCount > 5 && (                <p className=\"text-center text-sm text-gray-500 py-2\">                  ... {t('quiz.andMore', { count: questionCount - 5 }) || `and ${questionCount - 5} more questions`}                </p>              )}            </div>          </div>          {/* Validation Warnings */}          {questionCount < 3 && (            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-yellow-800 flex items-center gap-2\">                ‚ö†Ô∏è <span className=\"font-medium\">                  {t('quiz.validation.minQuestions') || 'Recommended: At least 3 questions for a good quiz'}                </span>              </p>            </div>          )}        </div>        {/* Footer */}        <div className=\"flex items-center justify-between p-6 bg-gray-50 rounded-b-2xl border-t border-gray-200\">          <button            onClick={onClose}            className=\"px-6 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"          >            ‚Üê {t('common.back') || 'Back to Edit'}          </button>          <button            onClick={onProceedToPublish}            disabled={questionCount === 0}            className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"          >            {t('quiz.preview.proceedPublish') || 'Proceed to Publish'} ‚Üí          </button>        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizPublishModal.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"{ useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizPublishModalProps {  isOpen: boolean;  onClose: () => void;  onPublish: (settings: PublishSettings) => Promise<void>;  quizTitle: string;  currentStatus: 'draft' | 'pending' | 'approved' | 'rejected';}export interface PublishSettings {  visibility: 'public' | 'password';  requireReview: boolean;  password?: string;  schedulePublish?: boolean;  publishDate?: string;  notifyUsers?: boolean;}export const QuizPublishModal: React.FC<QuizPublishModalProps> = ({  isOpen","message":"Definition for rule '{ useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizPublishModalProps {  isOpen: boolean;  onClose: () => void;  onPublish: (settings: PublishSettings) => Promise<void>;  quizTitle: string;  currentStatus: 'draft' | 'pending' | 'approved' | 'rejected';}export interface PublishSettings {  visibility: 'public' | 'password';  requireReview: boolean;  password?: string;  schedulePublish?: boolean;  publishDate?: string;  notifyUsers?: boolean;}export const QuizPublishModal: React.FC<QuizPublishModalProps> = ({  isOpen' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"onClose","message":"Definition for rule 'onClose' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"onPublish","message":"Definition for rule 'onPublish' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"quizTitle","message":"Definition for rule 'quizTitle' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"currentStatus}) => {  const { t } = useTranslation();  const [loading","message":"Definition for rule 'currentStatus}) => {  const { t } = useTranslation();  const [loading' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"setLoading] = useState(false);  const [settings","message":"Definition for rule 'setLoading] = useState(false);  const [settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"setSettings] = useState<PublishSettings>({    visibility: 'public'","message":"Definition for rule 'setSettings] = useState<PublishSettings>({    visibility: 'public'' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"requireReview: true","message":"Definition for rule 'requireReview: true' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"schedulePublish: false","message":"Definition for rule 'schedulePublish: false' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"notifyUsers: false  });  const handlePublish = async () => {    try {      setLoading(true);      await onPublish(settings);      onClose();    } catch (error) {      console.error('Error publishing quiz:'","message":"Definition for rule 'notifyUsers: false  });  const handlePublish = async () => {    try {      setLoading(true);      await onPublish(settings);      onClose();    } catch (error) {      console.error('Error publishing quiz:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"error);      alert(t('quiz.publish.error') || 'Failed to publish quiz');    } finally {      setLoading(false);    }  };  if (!isOpen) return null;  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl\">        {/* Header */}        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl\">          <h2 className=\"text-2xl font-bold flex items-center gap-2\">            üöÄ {t('quiz.publish.title') || 'Publish Quiz'}          </h2>          <p className=\"text-blue-100 mt-1\">{quizTitle}</p>        </div>        <div className=\"p-6 space-y-6\">          {/* Current Status */}          <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">            <p className=\"text-sm text-gray-600 mb-1\">              {t('quiz.publish.currentStatus') || 'Current Status'}:            </p>            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${              currentStatus === 'draft' ? 'bg-gray-100 text-gray-800' :              currentStatus === 'pending' ? 'bg-yellow-100 text-yellow-800' :              currentStatus === 'approved' ? 'bg-green-100 text-green-800' :              'bg-red-100 text-red-800'            }`}>              {currentStatus === 'draft' ? 'üìù Draft' :               currentStatus === 'pending' ? '‚è≥ Pending Review' :               currentStatus === 'approved' ? '‚úÖ Approved' :               '‚ùå Rejected'}            </span>          </div>          {/* Visibility Setting */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              {t('quiz.publish.visibility') || 'Visibility'}            </label>            <div className=\"space-y-3\">              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors\"                style={{ borderColor: settings.visibility === 'public' ? '#3b82f6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"public\"                  checked={settings.visibility === 'public'}                  onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'error);      alert(t('quiz.publish.error') || 'Failed to publish quiz');    } finally {      setLoading(false);    }  };  if (!isOpen) return null;  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl\">        {/* Header */}        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl\">          <h2 className=\"text-2xl font-bold flex items-center gap-2\">            üöÄ {t('quiz.publish.title') || 'Publish Quiz'}          </h2>          <p className=\"text-blue-100 mt-1\">{quizTitle}</p>        </div>        <div className=\"p-6 space-y-6\">          {/* Current Status */}          <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">            <p className=\"text-sm text-gray-600 mb-1\">              {t('quiz.publish.currentStatus') || 'Current Status'}:            </p>            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${              currentStatus === 'draft' ? 'bg-gray-100 text-gray-800' :              currentStatus === 'pending' ? 'bg-yellow-100 text-yellow-800' :              currentStatus === 'approved' ? 'bg-green-100 text-green-800' :              'bg-red-100 text-red-800'            }`}>              {currentStatus === 'draft' ? 'üìù Draft' :               currentStatus === 'pending' ? '‚è≥ Pending Review' :               currentStatus === 'approved' ? '‚úÖ Approved' :               '‚ùå Rejected'}            </span>          </div>          {/* Visibility Setting */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              {t('quiz.publish.visibility') || 'Visibility'}            </label>            <div className=\"space-y-3\">              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors\"                style={{ borderColor: settings.visibility === 'public' ? '#3b82f6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"public\"                  checked={settings.visibility === 'public'}                  onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div>                  <p className=\"font-medium text-gray-900\">                    üåê {t('quiz.visibility.public') || 'Public'}                  </p>                  <p className=\"text-sm text-gray-500\">                    {t('quiz.visibility.publicDesc') || 'Anyone can access this quiz'}                  </p>                </div>              </label>              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-purple-50 transition-colors\"                style={{ borderColor: settings.visibility === 'password' ? '#8b5cf6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"password\"                  checked={settings.visibility === 'password'}                  onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div>                  <p className=\"font-medium text-gray-900\">                    üåê {t('quiz.visibility.public') || 'Public'}                  </p>                  <p className=\"text-sm text-gray-500\">                    {t('quiz.visibility.publicDesc') || 'Anyone can access this quiz'}                  </p>                </div>              </label>              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-purple-50 transition-colors\"                style={{ borderColor: settings.visibility === 'password' ? '#8b5cf6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"password\"                  checked={settings.visibility === 'password'}                  onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div className=\"flex-1\">                  <p className=\"font-medium text-gray-900\">                    üîí {t('quiz.visibility.password') || 'Password Protected'}                  </p>                  <p className=\"text-sm text-gray-500 mb-2\">                    {t('quiz.visibility.passwordDesc') || 'Requires password to access'}                  </p>                  {settings.visibility === 'password' && (                    <input                      type=\"password\"                      placeholder={t('quiz.password.enter') || 'Enter password...'}                      value={settings.password || ''}                      onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div className=\"flex-1\">                  <p className=\"font-medium text-gray-900\">                    üîí {t('quiz.visibility.password') || 'Password Protected'}                  </p>                  <p className=\"text-sm text-gray-500 mb-2\">                    {t('quiz.visibility.passwordDesc') || 'Requires password to access'}                  </p>                  {settings.visibility === 'password' && (                    <input                      type=\"password\"                      placeholder={t('quiz.password.enter') || 'Enter password...'}                      value={settings.password || ''}                      onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"password: e.target.value })}                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"                      required                    />                  )}                </div>              </label>            </div>          </div>          {/* Review Requirement */}          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">            <label className=\"flex items-start gap-3 cursor-pointer\">              <input                type=\"checkbox\"                checked={settings.requireReview}                onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'password: e.target.value })}                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"                      required                    />                  )}                </div>              </label>            </div>          </div>          {/* Review Requirement */}          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">            <label className=\"flex items-start gap-3 cursor-pointer\">              <input                type=\"checkbox\"                checked={settings.requireReview}                onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"requireReview: e.target.checked })}                className=\"mt-1\"              />              <div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"font-medium text-blue-900\">                  üë®‚Äçüíº {t('quiz.publish.requireReview') || 'Submit for Admin Review'}                </p>                <p className=\"text-sm text-blue-700\">                  {t('quiz.publish.requireReviewDesc') || 'Quiz will be reviewed by admin before going live'}                </p>              </div>            </label>          </div>          {/* Schedule Publishing */}          <div>            <label className=\"flex items-center gap-3 cursor-pointer mb-3\">              <input                type=\"checkbox\"                checked={settings.schedulePublish || false}                onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'requireReview: e.target.checked })}                className=\"mt-1\"              />              <div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"font-medium text-blue-900\">                  üë®‚Äçüíº {t('quiz.publish.requireReview') || 'Submit for Admin Review'}                </p>                <p className=\"text-sm text-blue-700\">                  {t('quiz.publish.requireReviewDesc') || 'Quiz will be reviewed by admin before going live'}                </p>              </div>            </label>          </div>          {/* Schedule Publishing */}          <div>            <label className=\"flex items-center gap-3 cursor-pointer mb-3\">              <input                type=\"checkbox\"                checked={settings.schedulePublish || false}                onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"schedulePublish: e.target.checked })}              />              <span className=\"font-medium text-gray-700\">                üìÖ {t('quiz.publish.schedule') || 'Schedule Publishing'}              </span>            </label>            {settings.schedulePublish && (              <input                type=\"datetime-local\"                value={settings.publishDate || ''}                onChange={(e) => setSettings({ ...settings","message":"Definition for rule 'schedulePublish: e.target.checked })}              />              <span className=\"font-medium text-gray-700\">                üìÖ {t('quiz.publish.schedule') || 'Schedule Publishing'}              </span>            </label>            {settings.schedulePublish && (              <input                type=\"datetime-local\"                value={settings.publishDate || ''}                onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"publishDate: e.target.value })}                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                min={new Date().toISOString().slice(0","message":"Definition for rule 'publishDate: e.target.value })}                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                min={new Date().toISOString().slice(0' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"16)}              />            )}          </div>          {/* Notify Users */}          <label className=\"flex items-center gap-3 cursor-pointer\">            <input              type=\"checkbox\"              checked={settings.notifyUsers || false}              onChange={(e) => setSettings({ ...settings","message":"Definition for rule '16)}              />            )}          </div>          {/* Notify Users */}          <label className=\"flex items-center gap-3 cursor-pointer\">            <input              type=\"checkbox\"              checked={settings.notifyUsers || false}              onChange={(e) => setSettings({ ...settings' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null},{"ruleId":"notifyUsers: e.target.checked })}            />            <span className=\"text-gray-700\">              üîî {t('quiz.publish.notifyUsers') || 'Notify followers when published'}            </span>          </label>          {/* Info Box */}          <div className=\"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4\">            <p className=\"text-sm text-gray-700\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium\">‚ÑπÔ∏è {t('quiz.publish.info') || 'What happens next'}:</span>            </p>            <ul className=\"text-sm text-gray-600 mt-2 space-y-1 ml-4\">              {settings.requireReview ? (                <>                  <li>‚Ä¢ {t('quiz.publish.step1') || 'Quiz will be submitted for review'}</li>                  <li>‚Ä¢ {t('quiz.publish.step2') || 'Admin will review your quiz'}</li>                  <li>‚Ä¢ {t('quiz.publish.step3') || 'You will be notified of the decision'}</li>                  {settings.schedulePublish && (                    <li>‚Ä¢ {t('quiz.publish.step4') || 'Quiz will be published at scheduled time'}</li>                  )}                </>              ) : (                <>                  <li>‚Ä¢ {t('quiz.publish.immediate1') || 'Quiz will be published immediately'}</li>                  <li>‚Ä¢ {t('quiz.publish.immediate2') || 'Users can start taking it right away'}</li>                </>              )}            </ul>          </div>        </div>        {/* Footer */}        <div className=\"flex items-center justify-end gap-3 p-6 bg-gray-50 rounded-b-2xl\">          <button            onClick={onClose}            disabled={loading}            className=\"px-6 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50\"          >            {t('common.cancel') || 'Cancel'}          </button>          <button            onClick={handlePublish}            disabled={loading || (settings.visibility === 'password' && !settings.password)}            className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"          >            {loading ? (              <>                <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />                </svg>                {t('quiz.publish.publishing') || 'Publishing...'}              </>            ) : (              <>                üöÄ {settings.requireReview                   ? (t('quiz.publish.submitReview') || 'Submit for Review')                  : (t('quiz.publish.publishNow') || 'Publish Now')                }              </>            )}          </button>        </div>      </div>    </div>  );};","message":"Definition for rule 'notifyUsers: e.target.checked })}            />            <span className=\"text-gray-700\">              üîî {t('quiz.publish.notifyUsers') || 'Notify followers when published'}            </span>          </label>          {/* Info Box */}          <div className=\"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4\">            <p className=\"text-sm text-gray-700\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium\">‚ÑπÔ∏è {t('quiz.publish.info') || 'What happens next'}:</span>            </p>            <ul className=\"text-sm text-gray-600 mt-2 space-y-1 ml-4\">              {settings.requireReview ? (                <>                  <li>‚Ä¢ {t('quiz.publish.step1') || 'Quiz will be submitted for review'}</li>                  <li>‚Ä¢ {t('quiz.publish.step2') || 'Admin will review your quiz'}</li>                  <li>‚Ä¢ {t('quiz.publish.step3') || 'You will be notified of the decision'}</li>                  {settings.schedulePublish && (                    <li>‚Ä¢ {t('quiz.publish.step4') || 'Quiz will be published at scheduled time'}</li>                  )}                </>              ) : (                <>                  <li>‚Ä¢ {t('quiz.publish.immediate1') || 'Quiz will be published immediately'}</li>                  <li>‚Ä¢ {t('quiz.publish.immediate2') || 'Users can start taking it right away'}</li>                </>              )}            </ul>          </div>        </div>        {/* Footer */}        <div className=\"flex items-center justify-end gap-3 p-6 bg-gray-50 rounded-b-2xl\">          <button            onClick={onClose}            disabled={loading}            className=\"px-6 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50\"          >            {t('common.cancel') || 'Cancel'}          </button>          <button            onClick={handlePublish}            disabled={loading || (settings.visibility === 'password' && !settings.password)}            className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"          >            {loading ? (              <>                <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />                </svg>                {t('quiz.publish.publishing') || 'Publishing...'}              </>            ) : (              <>                üöÄ {settings.requireReview                   ? (t('quiz.publish.submitReview') || 'Submit for Review')                  : (t('quiz.publish.publishNow') || 'Publish Now')                }              </>            )}          </button>        </div>      </div>    </div>  );};' was not found.","line":1,"column":1,"endLine":1,"endColumn":10789,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState } from 'react';import { useTranslation } from 'react-i18next';interface QuizPublishModalProps {  isOpen: boolean;  onClose: () => void;  onPublish: (settings: PublishSettings) => Promise<void>;  quizTitle: string;  currentStatus: 'draft' | 'pending' | 'approved' | 'rejected';}export interface PublishSettings {  visibility: 'public' | 'password';  requireReview: boolean;  password?: string;  schedulePublish?: boolean;  publishDate?: string;  notifyUsers?: boolean;}export const QuizPublishModal: React.FC<QuizPublishModalProps> = ({  isOpen,  onClose,  onPublish,  quizTitle,  currentStatus}) => {  const { t } = useTranslation();  const [loading, setLoading] = useState(false);  const [settings, setSettings] = useState<PublishSettings>({    visibility: 'public',    requireReview: true,    schedulePublish: false,    notifyUsers: false  });  const handlePublish = async () => {    try {      setLoading(true);      await onPublish(settings);      onClose();    } catch (error) {      console.error('Error publishing quiz:', error);      alert(t('quiz.publish.error') || 'Failed to publish quiz');    } finally {      setLoading(false);    }  };  if (!isOpen) return null;  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl\">        {/* Header */}        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl\">          <h2 className=\"text-2xl font-bold flex items-center gap-2\">            üöÄ {t('quiz.publish.title') || 'Publish Quiz'}          </h2>          <p className=\"text-blue-100 mt-1\">{quizTitle}</p>        </div>        <div className=\"p-6 space-y-6\">          {/* Current Status */}          <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">            <p className=\"text-sm text-gray-600 mb-1\">              {t('quiz.publish.currentStatus') || 'Current Status'}:            </p>            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${              currentStatus === 'draft' ? 'bg-gray-100 text-gray-800' :              currentStatus === 'pending' ? 'bg-yellow-100 text-yellow-800' :              currentStatus === 'approved' ? 'bg-green-100 text-green-800' :              'bg-red-100 text-red-800'            }`}>              {currentStatus === 'draft' ? 'üìù Draft' :               currentStatus === 'pending' ? '‚è≥ Pending Review' :               currentStatus === 'approved' ? '‚úÖ Approved' :               '‚ùå Rejected'}            </span>          </div>          {/* Visibility Setting */}          <div>            <label className=\"block text-sm font-medium text-gray-700 mb-2\">              {t('quiz.publish.visibility') || 'Visibility'}            </label>            <div className=\"space-y-3\">              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors\"                style={{ borderColor: settings.visibility === 'public' ? '#3b82f6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"public\"                  checked={settings.visibility === 'public'}                  onChange={(e) => setSettings({ ...settings, visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div>                  <p className=\"font-medium text-gray-900\">                    üåê {t('quiz.visibility.public') || 'Public'}                  </p>                  <p className=\"text-sm text-gray-500\">                    {t('quiz.visibility.publicDesc') || 'Anyone can access this quiz'}                  </p>                </div>              </label>              <label className=\"flex items-start gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-purple-50 transition-colors\"                style={{ borderColor: settings.visibility === 'password' ? '#8b5cf6' : '#e5e7eb' }}>                <input                  type=\"radio\"                  name=\"visibility\"                  value=\"password\"                  checked={settings.visibility === 'password'}                  onChange={(e) => setSettings({ ...settings, visibility: e.target.value as 'public' | 'password' })}                  className=\"mt-1\"                />                <div className=\"flex-1\">                  <p className=\"font-medium text-gray-900\">                    üîí {t('quiz.visibility.password') || 'Password Protected'}                  </p>                  <p className=\"text-sm text-gray-500 mb-2\">                    {t('quiz.visibility.passwordDesc') || 'Requires password to access'}                  </p>                  {settings.visibility === 'password' && (                    <input                      type=\"password\"                      placeholder={t('quiz.password.enter') || 'Enter password...'}                      value={settings.password || ''}                      onChange={(e) => setSettings({ ...settings, password: e.target.value })}                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"                      required                    />                  )}                </div>              </label>            </div>          </div>          {/* Review Requirement */}          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">            <label className=\"flex items-start gap-3 cursor-pointer\">              <input                type=\"checkbox\"                checked={settings.requireReview}                onChange={(e) => setSettings({ ...settings, requireReview: e.target.checked })}                className=\"mt-1\"              />              <div>                // eslint-disable-next-line i18next/no-literal-string                <p className=\"font-medium text-blue-900\">                  üë®‚Äçüíº {t('quiz.publish.requireReview') || 'Submit for Admin Review'}                </p>                <p className=\"text-sm text-blue-700\">                  {t('quiz.publish.requireReviewDesc') || 'Quiz will be reviewed by admin before going live'}                </p>              </div>            </label>          </div>          {/* Schedule Publishing */}          <div>            <label className=\"flex items-center gap-3 cursor-pointer mb-3\">              <input                type=\"checkbox\"                checked={settings.schedulePublish || false}                onChange={(e) => setSettings({ ...settings, schedulePublish: e.target.checked })}              />              <span className=\"font-medium text-gray-700\">                üìÖ {t('quiz.publish.schedule') || 'Schedule Publishing'}              </span>            </label>            {settings.schedulePublish && (              <input                type=\"datetime-local\"                value={settings.publishDate || ''}                onChange={(e) => setSettings({ ...settings, publishDate: e.target.value })}                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                min={new Date().toISOString().slice(0, 16)}              />            )}          </div>          {/* Notify Users */}          <label className=\"flex items-center gap-3 cursor-pointer\">            <input              type=\"checkbox\"              checked={settings.notifyUsers || false}              onChange={(e) => setSettings({ ...settings, notifyUsers: e.target.checked })}            />            <span className=\"text-gray-700\">              üîî {t('quiz.publish.notifyUsers') || 'Notify followers when published'}            </span>          </label>          {/* Info Box */}          <div className=\"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4\">            <p className=\"text-sm text-gray-700\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium\">‚ÑπÔ∏è {t('quiz.publish.info') || 'What happens next'}:</span>            </p>            <ul className=\"text-sm text-gray-600 mt-2 space-y-1 ml-4\">              {settings.requireReview ? (                <>                  <li>‚Ä¢ {t('quiz.publish.step1') || 'Quiz will be submitted for review'}</li>                  <li>‚Ä¢ {t('quiz.publish.step2') || 'Admin will review your quiz'}</li>                  <li>‚Ä¢ {t('quiz.publish.step3') || 'You will be notified of the decision'}</li>                  {settings.schedulePublish && (                    <li>‚Ä¢ {t('quiz.publish.step4') || 'Quiz will be published at scheduled time'}</li>                  )}                </>              ) : (                <>                  <li>‚Ä¢ {t('quiz.publish.immediate1') || 'Quiz will be published immediately'}</li>                  <li>‚Ä¢ {t('quiz.publish.immediate2') || 'Users can start taking it right away'}</li>                </>              )}            </ul>          </div>        </div>        {/* Footer */}        <div className=\"flex items-center justify-end gap-3 p-6 bg-gray-50 rounded-b-2xl\">          <button            onClick={onClose}            disabled={loading}            className=\"px-6 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50\"          >            {t('common.cancel') || 'Cancel'}          </button>          <button            onClick={handlePublish}            disabled={loading || (settings.visibility === 'password' && !settings.password)}            className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"          >            {loading ? (              <>                <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />                </svg>                {t('quiz.publish.publishing') || 'Publishing...'}              </>            ) : (              <>                üöÄ {settings.requireReview                   ? (t('quiz.publish.submitReview') || 'Submit for Review')                  : (t('quiz.publish.publishNow') || 'Publish Now')                }              </>            )}          </button>        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\QuizStats.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":9929,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { Quiz } from '../types';import { useTranslation } from 'react-i18next';interface QuizStatsProps {  quizzes: Quiz[];}const QuizStats: React.FC<QuizStatsProps> = ({ quizzes }) => {  const { t } = useTranslation();  // Calculate statistics  const totalQuizzes = quizzes.length;  const completedQuizzes = quizzes.filter(q => q.isCompleted).length;  const totalQuestions = quizzes.reduce((sum, q) => sum + q.questions.length, 0);  const averageQuestions = totalQuizzes > 0 ? Math.round(totalQuestions / totalQuizzes) : 0;    const difficultyCount = {    easy: quizzes.filter(q => q.difficulty === 'easy').length,    medium: quizzes.filter(q => q.difficulty === 'medium').length,    hard: quizzes.filter(q => q.difficulty === 'hard').length  };  const categoryCount = quizzes.reduce((acc, quiz) => {    acc[quiz.category] = (acc[quiz.category] || 0) + 1;    return acc;  }, {} as Record<string, number>);  const topCategories = Object.entries(categoryCount)    .sort(([,a], [,b]) => b - a)    .slice(0, 5);  const totalPlayers = quizzes.reduce((sum, q) => sum + (q.totalPlayers || 0), 0);  const averageScore = quizzes.filter(q => q.averageScore).reduce((sum, q) => sum + (q.averageScore || 0), 0) / quizzes.filter(q => q.averageScore).length || 0;  const progressPercentage = totalQuizzes > 0 ? Math.round((completedQuizzes / totalQuizzes) * 100) : 0;  return (    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">      {/* Total Quizzes */}      <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white\">        <div className=\"flex items-center justify-between\">          <div>            <p className=\"text-blue-100 text-sm font-medium\">{t(\"admin.quizManagement.cards.totalQuizzes\")}</p>            <p className=\"text-3xl font-bold\">{totalQuizzes}</p>          </div>          <div className=\"p-3 bg-white/20 rounded-lg\">            <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">              <path d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>            </svg>          </div>        </div>        <div className=\"mt-4 flex items-center text-blue-100 text-sm\">          // eslint-disable-next-line i18next/no-literal-string          <span>{averageQuestions} c√¢u h·ªèi trung b√¨nh</span>        </div>      </div>      {/* Completed Progress */}      <div className=\"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white\">        <div className=\"flex items-center justify-between\">          <div>            <p className=\"text-green-100 text-sm font-medium\">{t(\"admin.quickActions.stats.completions\")}</p>            <p className=\"text-3xl font-bold\">{completedQuizzes}</p>          </div>          <div className=\"p-3 bg-white/20 rounded-lg\">            <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\"/>            </svg>          </div>        </div>        <div className=\"mt-4\">          <div className=\"flex items-center justify-between text-green-100 text-sm mb-1\">            // eslint-disable-next-line i18next/no-literal-string            <span>Ti·∫øn ƒë·ªô</span>            <span>{progressPercentage}%</span>          </div>          <div className=\"w-full bg-white/20 rounded-full h-2\">            <div               className=\"bg-white rounded-full h-2 transition-all duration-300\"              style={{ width: `${progressPercentage}%` }}            />          </div>        </div>      </div>      {/* Total Players */}      <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white\">        <div className=\"flex items-center justify-between\">          <div>            <p className=\"text-purple-100 text-sm font-medium\">{t(\"leaderboard.plays\")}</p>            <p className=\"text-3xl font-bold\">{totalPlayers.toLocaleString()}</p>          </div>          <div className=\"p-3 bg-white/20 rounded-lg\">            <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">              <path d=\"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z\"/>            </svg>          </div>        </div>        <div className=\"mt-4 flex items-center text-purple-100 text-sm\">          <span>            // eslint-disable-next-line i18next/no-literal-string            {totalQuizzes > 0 ? Math.round(totalPlayers / totalQuizzes) : 0} trung b√¨nh/quiz          </span>        </div>      </div>      {/* Average Score */}      <div className=\"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white\">        <div className=\"flex items-center justify-between\">          <div>            <p className=\"text-orange-100 text-sm font-medium\">{t(\"leaderboard.avgScore\")}</p>            <p className=\"text-3xl font-bold\">{Math.round(averageScore)}%</p>          </div>          <div className=\"p-3 bg-white/20 rounded-lg\">            <svg className=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 20 20\">              <path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\"/>            </svg>          </div>        </div>        <div className=\"mt-4 flex items-center text-orange-100 text-sm\">          // eslint-disable-next-line i18next/no-literal-string          <span>Ch·∫•t l∆∞·ª£ng t·ªët</span>        </div>      </div>      {/* Difficulty Distribution */}      <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-200 md:col-span-2\">        // eslint-disable-next-line i18next/no-literal-string        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Ph√¢n b·ªë ƒë·ªô kh√≥</h3>        <div className=\"space-y-3\">          <div className=\"flex items-center justify-between\">            <div className=\"flex items-center gap-3\">              <div className=\"w-4 h-4 bg-green-500 rounded\"></div>              <span className=\"text-sm text-gray-600\">{t(\"difficulty.easy\")}</span>            </div>            <div className=\"flex items-center gap-3\">              <span className=\"text-sm font-medium\">{difficultyCount.easy}</span>              <div className=\"w-20 bg-gray-200 rounded-full h-2\">                <div                   className=\"bg-green-500 h-2 rounded-full\"                  style={{ width: `${totalQuizzes > 0 ? (difficultyCount.easy / totalQuizzes) * 100 : 0}%` }}                />              </div>            </div>          </div>          <div className=\"flex items-center justify-between\">            <div className=\"flex items-center gap-3\">              <div className=\"w-4 h-4 bg-yellow-500 rounded\"></div>              <span className=\"text-sm text-gray-600\">{t(\"difficulty.medium\")}</span>            </div>            <div className=\"flex items-center gap-3\">              <span className=\"text-sm font-medium\">{difficultyCount.medium}</span>              <div className=\"w-20 bg-gray-200 rounded-full h-2\">                <div                   className=\"bg-yellow-500 h-2 rounded-full\"                  style={{ width: `${totalQuizzes > 0 ? (difficultyCount.medium / totalQuizzes) * 100 : 0}%` }}                />              </div>            </div>          </div>          <div className=\"flex items-center justify-between\">            <div className=\"flex items-center gap-3\">              <div className=\"w-4 h-4 bg-red-500 rounded\"></div>              <span className=\"text-sm text-gray-600\">{t(\"difficulty.hard\")}</span>            </div>            <div className=\"flex items-center gap-3\">              <span className=\"text-sm font-medium\">{difficultyCount.hard}</span>              <div className=\"w-20 bg-gray-200 rounded-full h-2\">                <div                   className=\"bg-red-500 h-2 rounded-full\"                  style={{ width: `${totalQuizzes > 0 ? (difficultyCount.hard / totalQuizzes) * 100 : 0}%` }}                />              </div>            </div>          </div>        </div>      </div>      {/* Top Categories */}      <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-200 md:col-span-2\">        // eslint-disable-next-line i18next/no-literal-string        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Danh m·ª•c ph·ªï bi·∫øn</h3>        <div className=\"space-y-3\">          {topCategories.map(([category, count], index) => (            <div key={category} className=\"flex items-center justify-between\">              <div className=\"flex items-center gap-3\">                <div className=\"flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs font-medium\">                  {index + 1}                </div>                <span className=\"text-sm text-gray-900 font-medium\">{category}</span>              </div>              <div className=\"flex items-center gap-3\">                // eslint-disable-next-line i18next/no-literal-string                <span className=\"text-sm text-gray-600\">{count} quiz</span>                <div className=\"w-16 bg-gray-200 rounded-full h-2\">                  <div                     className=\"bg-blue-500 h-2 rounded-full\"                    style={{ width: `${totalQuizzes > 0 ? (count / totalQuizzes) * 100 : 0}%` }}                  />                </div>              </div>            </div>          ))}          {topCategories.length === 0 && (            // eslint-disable-next-line i18next/no-literal-string            <div className=\"text-center text-gray-500 py-4\">              Ch∆∞a c√≥ d·ªØ li·ªáu danh m·ª•c            </div>          )}        </div>      </div>    </div>  );};export default QuizStats;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ResourceViewers\\ImageSlidesViewer.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":8892,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { ChevronLeft, ChevronRight, Maximize2, Grid } from 'lucide-react';interface ImageSlidesViewerProps {  urls: string[]; // Array of image URLs  title: string;  onProgressUpdate: (progress: {    imagesViewed: number[];    imageViewTimes: Record<number, number>;  }) => void;  initialProgress?: {    imagesViewed?: number[];    imageViewTimes?: Record<number, number>;  };}export const ImageSlidesViewer: React.FC<ImageSlidesViewerProps> = ({  urls,  title,  onProgressUpdate,  initialProgress}) => {  const [currentIndex, setCurrentIndex] = useState(0);  const [imagesViewed, setImagesViewed] = useState<Set<number>>(    new Set(initialProgress?.imagesViewed || [])  );  const [imageViewTimes, setImageViewTimes] = useState<Record<number, number>>(    initialProgress?.imageViewTimes || {}  );  const [imageStartTime, setImageStartTime] = useState<number>(Date.now());  const [showGrid, setShowGrid] = useState(false);  const [isFullscreen, setIsFullscreen] = useState(false);  useEffect(() => {    // Track image view time    const interval = setInterval(() => {      const newImageViewTimes = {        ...imageViewTimes,        [currentIndex]: (imageViewTimes[currentIndex] || 0) + 1      };      setImageViewTimes(newImageViewTimes);            const newImagesViewed = new Set(imagesViewed).add(currentIndex);      setImagesViewed(newImagesViewed);            onProgressUpdate({        imagesViewed: Array.from(newImagesViewed),        imageViewTimes: newImageViewTimes      });    }, 1000);    return () => clearInterval(interval);  }, [currentIndex, imageStartTime, imageViewTimes, imagesViewed, onProgressUpdate]);  useEffect(() => {    // Reset timer when image changes    setImageStartTime(Date.now());        // Mark image as viewed    const newImagesViewed = new Set(imagesViewed).add(currentIndex);    setImagesViewed(newImagesViewed);  }, [currentIndex, imagesViewed]);  const handlePrevious = useCallback(() => {    setCurrentIndex((prev) => Math.max(0, prev - 1));  }, []);  const handleNext = useCallback(() => {    setCurrentIndex((prev) => Math.min(urls.length - 1, prev + 1));  }, [urls.length]);  const handleImageClick = (index: number) => {    setCurrentIndex(index);    setShowGrid(false);  };  const handleKeyDown = useCallback((e: KeyboardEvent) => {    if (e.key === 'ArrowLeft') handlePrevious();    if (e.key === 'ArrowRight') handleNext();    if (e.key === 'Escape') setIsFullscreen(false);  }, [handlePrevious, handleNext]);  useEffect(() => {    document.addEventListener('keydown', handleKeyDown);    return () => document.removeEventListener('keydown', handleKeyDown);  }, [handleKeyDown]);  const progressPercent = urls.length > 0 ? Math.round((imagesViewed.size / urls.length) * 100) : 0;  return (    <div className={`flex flex-col bg-gray-900 rounded-lg overflow-hidden ${      isFullscreen ? 'fixed inset-0 z-50' : 'h-full'    }`}>      {/* Header */}      <div className=\"bg-gray-800 text-white p-4 flex items-center justify-between\">        <div>          <h3 className=\"font-semibold\">{title}</h3>          // eslint-disable-next-line i18next/no-literal-string          <p className=\"text-sm text-gray-400\">            Slide {currentIndex + 1} / {urls.length}          </p>        </div>                <div className=\"flex items-center gap-2\">          <button            onClick={() => setShowGrid(!showGrid)}            className=\"p-2 rounded hover:bg-gray-700 transition-colors\"            title={showGrid ? 'Xem slide' : 'Xem t·ªïng quan'}          >            <Grid className=\"w-5 h-5\" />          </button>          <button            onClick={() => setIsFullscreen(!isFullscreen)}            className=\"p-2 rounded hover:bg-gray-700 transition-colors\"            title=\"To√†n m√†n h√¨nh\"          >            <Maximize2 className=\"w-5 h-5\" />          </button>        </div>      </div>      {/* Progress Bar */}      <div className=\"bg-gray-800 px-4 py-2 border-t border-gray-700\">        <div className=\"flex items-center justify-between text-sm text-white mb-1\">          // eslint-disable-next-line i18next/no-literal-string          <span>            // eslint-disable-next-line i18next/no-literal-string            üìä ƒê√£ xem: {imagesViewed.size}/{urls.length} slides ({progressPercent}%)          </span>          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-400\">            // eslint-disable-next-line i18next/no-literal-string            ‚è±Ô∏è Th·ªùi gian slide n√†y: {imageViewTimes[currentIndex] || 0}s          </span>        </div>        <div className=\"w-full bg-gray-700 rounded-full h-2\">          <div            className=\"bg-blue-500 h-2 rounded-full transition-all\"            style={{ width: `${progressPercent}%` }}          />        </div>      </div>      {/* Main Content */}      {showGrid ? (        // Grid View        <div className=\"flex-1 overflow-auto p-4 bg-gray-900\">          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">            {urls.map((url, index) => (              <button                key={index}                onClick={() => handleImageClick(index)}                className={`relative aspect-video rounded-lg overflow-hidden border-2 transition-all ${                  index === currentIndex                    ? 'border-blue-500 ring-2 ring-blue-500'                    : imagesViewed.has(index)                    ? 'border-green-500'                    : 'border-gray-600 hover:border-gray-500'                }`}              >                <img                  src={url}                  alt={`Slide ${index + 1}`}                  className=\"w-full h-full object-cover\"                />                <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center text-white font-semibold\">                  {index + 1}                </div>                {imagesViewed.has(index) && (                  <div className=\"absolute top-2 right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center\">                    <svg className=\"w-4 h-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">                      <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />                    </svg>                  </div>                )}              </button>            ))}          </div>        </div>      ) : (        // Slide View        <div className=\"flex-1 flex items-center justify-center bg-black relative\">          {/* Navigation Arrows */}          <button            onClick={handlePrevious}            disabled={currentIndex === 0}            className=\"absolute left-4 z-10 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"          >            <ChevronLeft className=\"w-8 h-8\" />          </button>          <button            onClick={handleNext}            disabled={currentIndex === urls.length - 1}            className=\"absolute right-4 z-10 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"          >            <ChevronRight className=\"w-8 h-8\" />          </button>          {/* Current Image */}          <img            src={urls[currentIndex]}            alt={`Slide ${currentIndex + 1}`}            className=\"max-w-full max-h-full object-contain\"          />          {/* Slide Number Overlay */}          <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/70 text-white px-4 py-2 rounded-full text-sm\">            {currentIndex + 1} / {urls.length}          </div>        </div>      )}      {/* Thumbnail Strip */}      {!showGrid && (        <div className=\"bg-gray-800 p-2 overflow-x-auto\">          <div className=\"flex gap-2\">            {urls.map((url, index) => (              <button                key={index}                onClick={() => setCurrentIndex(index)}                className={`relative flex-shrink-0 w-20 h-14 rounded overflow-hidden border-2 transition-all ${                  index === currentIndex                    ? 'border-blue-500 ring-2 ring-blue-500'                    : imagesViewed.has(index)                    ? 'border-green-500'                    : 'border-gray-600 hover:border-gray-500'                }`}              >                <img                  src={url}                  alt={`Slide ${index + 1}`}                  className=\"w-full h-full object-cover\"                />                {imagesViewed.has(index) && (                  <div className=\"absolute top-0 right-0 w-4 h-4 bg-green-500 rounded-full border-2 border-gray-800\" />                )}              </button>            ))}          </div>        </div>      )}    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ResourceViewers\\LinkViewer.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":5547,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';import { ExternalLink, CheckCircle, Clock } from 'lucide-react';interface LinkViewerProps {  url: string;  title: string;  description?: string;  estimatedTime?: number;  onProgressUpdate: (progress: {    confirmed: boolean;    timeSpent: number;  }) => void;  initialProgress?: {    confirmed?: boolean;    timeSpent?: number;  };}export const LinkViewer: React.FC<LinkViewerProps> = ({  url,  title,  description,  estimatedTime,  onProgressUpdate,  initialProgress}) => {  const [confirmed, setConfirmed] = useState(initialProgress?.confirmed || false);  const [timeSpent, setTimeSpent] = useState(initialProgress?.timeSpent || 0);  const [isIframeSupported, setIsIframeSupported] = useState(true);  useEffect(() => {    // Track time spent    const interval = setInterval(() => {      const newTimeSpent = timeSpent + 1;      setTimeSpent(newTimeSpent);            onProgressUpdate({        confirmed,        timeSpent: newTimeSpent      });    }, 1000);    return () => clearInterval(interval);  }, [timeSpent, confirmed, onProgressUpdate]);  const handleConfirm = () => {    setConfirmed(true);    onProgressUpdate({      confirmed: true,      timeSpent    });  };  const handleOpenExternal = () => {    window.open(url, '_blank', 'noopener,noreferrer');  };  const formatTime = (seconds: number) => {    const mins = Math.floor(seconds / 60);    const secs = seconds % 60;    return `${mins}:${secs.toString().padStart(2, '0')}`;  };  return (    <div className=\"flex flex-col h-full bg-white rounded-lg overflow-hidden border border-gray-200\">      {/* Header */}      <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 p-6 border-b border-gray-200\">        <h3 className=\"text-xl font-bold text-gray-900 mb-2\">{title}</h3>        {description && (          <p className=\"text-gray-600 mb-4\">{description}</p>        )}                <div className=\"flex items-center gap-4 text-sm text-gray-700\">          {estimatedTime && (            <div className=\"flex items-center gap-2\">              <Clock className=\"w-4 h-4\" />              // eslint-disable-next-line i18next/no-literal-string              <span>Th·ªùi gian ƒë·ªçc: ~{estimatedTime} ph√∫t</span>            </div>          )}          <div className=\"flex items-center gap-2\">            <Clock className=\"w-4 h-4\" />            // eslint-disable-next-line i18next/no-literal-string            <span>ƒê√£ xem: {formatTime(timeSpent)}</span>          </div>        </div>      </div>      {/* Content */}      <div className=\"flex-1 overflow-hidden relative\">        {isIframeSupported ? (          <iframe            src={url}            className=\"w-full h-full border-0\"            title={title}            sandbox=\"allow-same-origin allow-scripts allow-popups allow-forms\"            onError={() => setIsIframeSupported(false)}          />        ) : (          <div className=\"flex flex-col items-center justify-center h-full p-8 text-center\">            <ExternalLink className=\"w-16 h-16 text-gray-400 mb-4\" />            // eslint-disable-next-line i18next/no-literal-string            <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">              Kh√¥ng th·ªÉ xem tr·ª±c ti·∫øp            </h4>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600 mb-6 max-w-md\">              Trang web n√†y kh√¥ng h·ªó tr·ª£ xem nh√∫ng. Vui l√≤ng nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ m·ªü trong tab m·ªõi.            </p>            <button              onClick={handleOpenExternal}              className=\"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"            >              // eslint-disable-next-line i18next/no-literal-string              <ExternalLink className=\"w-5 h-5\" />              M·ªü trong tab m·ªõi            </button>          </div>        )}      </div>      {/* Confirmation Footer */}      <div className=\"bg-gray-50 border-t border-gray-200 p-4\">        {!confirmed ? (          <div className=\"flex items-center justify-between\">            <div className=\"flex-1\">              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-sm text-gray-700 mb-1\">                üìñ ƒê√£ ƒë·ªçc xong t√†i li·ªáu n√†y?              </p>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-xs text-gray-500\">                X√°c nh·∫≠n ƒë·ªÉ ti·∫øp t·ª•c (ho·∫∑c m·ªü trong tab m·ªõi ƒë·ªÉ ƒë·ªçc)              </p>            </div>            <div className=\"flex gap-2\">              <button                onClick={handleOpenExternal}                className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm\"              // eslint-disable-next-line i18next/no-literal-string              >                M·ªü tab m·ªõi              </button>              <button                onClick={handleConfirm}                className=\"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium\"              // eslint-disable-next-line i18next/no-literal-string              >                ‚úì ƒê√£ ƒë·ªçc xong              </button>            </div>          </div>        ) : (          <div className=\"flex items-center justify-center gap-2 text-green-600 py-2\">            <CheckCircle className=\"w-5 h-5\" />            // eslint-disable-next-line i18next/no-literal-string            <span className=\"font-medium\">ƒê√£ x√°c nh·∫≠n ho√†n th√†nh</span>          </div>        )}      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ResourceViewers\\PDFViewer.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":7453,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';import { ChevronLeft, ChevronRight, ZoomIn, ZoomOut, Download } from 'lucide-react';interface PDFViewerProps {  url: string;  title: string;  onProgressUpdate: (progress: {    pagesViewed: number[];    pageViewTimes: Record<number, number>;  }) => void;  initialProgress?: {    pagesViewed?: number[];    pageViewTimes?: Record<number, number>;  };}export const PDFViewer: React.FC<PDFViewerProps> = ({  url,  title,  onProgressUpdate,  initialProgress}) => {  const [currentPage, setCurrentPage] = useState(1);  const [totalPages, setTotalPages] = useState(0);  const [zoom, setZoom] = useState(1);  const [pagesViewed, setPagesViewed] = useState<Set<number>>(    new Set(initialProgress?.pagesViewed || [])  );  const [pageViewTimes, setPageViewTimes] = useState<Record<number, number>>(    initialProgress?.pageViewTimes || {}  );  const [pageStartTime] = useState<number>(Date.now());  useEffect(() => {    // Track page view time    const interval = setInterval(() => {      const newPageViewTimes = {        ...pageViewTimes,        [currentPage]: (pageViewTimes[currentPage] || 0) + 1      };      setPageViewTimes(newPageViewTimes);            const newPagesViewed = new Set(pagesViewed).add(currentPage);      setPagesViewed(newPagesViewed);            onProgressUpdate({        pagesViewed: Array.from(newPagesViewed),        pageViewTimes: newPageViewTimes      });    }, 1000);    return () => clearInterval(interval);  }, [currentPage, pageStartTime, onProgressUpdate, pageViewTimes, pagesViewed]);  useEffect(() => {    // Mark page as viewed    const newPagesViewed = new Set(pagesViewed).add(currentPage);    setPagesViewed(newPagesViewed);  }, [currentPage, pagesViewed]);  const handlePrevPage = () => {    if (currentPage > 1) {      setCurrentPage(currentPage - 1);    }  };  const handleNextPage = () => {    if (currentPage < totalPages) {      setCurrentPage(currentPage + 1);    }  };  const handleZoomIn = () => {    setZoom(Math.min(zoom + 0.25, 3));  };  const handleZoomOut = () => {    setZoom(Math.max(zoom - 0.25, 0.5));  };  const handleDownload = () => {    const link = document.createElement('a');    link.href = url;    link.download = title || 'document.pdf';    link.click();  };  const progressPercent = totalPages > 0 ? Math.round((pagesViewed.size / totalPages) * 100) : 0;  return (    <div className=\"flex flex-col h-full bg-gray-100 rounded-lg overflow-hidden\">      {/* Toolbar */}      <div className=\"bg-white border-b border-gray-200 p-3 flex items-center justify-between\">        <div className=\"flex items-center gap-3\">          {/* Navigation */}          <button            onClick={handlePrevPage}            disabled={currentPage === 1}            className=\"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed\"          >            <ChevronLeft className=\"w-5 h-5\" />          </button>                    <div className=\"flex items-center gap-2\">            <input              type=\"number\"              min=\"1\"              max={totalPages}              value={currentPage}              onChange={(e) => {                const page = parseInt(e.target.value);                if (page >= 1 && page <= totalPages) {                  setCurrentPage(page);                }              }}              className=\"w-16 px-2 py-1 border border-gray-300 rounded text-center\"            />            <span className=\"text-gray-600\">/ {totalPages || '?'}</span>          </div>          <button            onClick={handleNextPage}            disabled={currentPage === totalPages}            className=\"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed\"          >            <ChevronRight className=\"w-5 h-5\" />          </button>        </div>        <div className=\"flex items-center gap-3\">          {/* Zoom */}          <button            onClick={handleZoomOut}            className=\"p-2 rounded hover:bg-gray-100\"            disabled={zoom <= 0.5}          >            <ZoomOut className=\"w-5 h-5\" />          </button>          <span className=\"text-sm text-gray-600 w-12 text-center\">            {Math.round(zoom * 100)}%          </span>          <button            onClick={handleZoomIn}            className=\"p-2 rounded hover:bg-gray-100\"            disabled={zoom >= 3}          >            <ZoomIn className=\"w-5 h-5\" />          </button>          {/* Download */}          <button            onClick={handleDownload}            className=\"p-2 rounded hover:bg-gray-100\"            title=\"T·∫£i xu·ªëng\"          >            <Download className=\"w-5 h-5\" />          </button>        </div>      </div>      {/* Progress Bar */}      <div className=\"bg-blue-50 px-4 py-2 border-b border-gray-200\">        <div className=\"flex items-center justify-between text-sm mb-1\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-700\">            // eslint-disable-next-line i18next/no-literal-string            üìñ ƒê√£ xem: {pagesViewed.size}/{totalPages} trang ({progressPercent}%)          </span>          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">            // eslint-disable-next-line i18next/no-literal-string            ‚è±Ô∏è Th·ªùi gian trang n√†y: {pageViewTimes[currentPage] || 0}s          </span>        </div>        <div className=\"w-full bg-gray-200 rounded-full h-2\">          <div            className=\"bg-blue-600 h-2 rounded-full transition-all\"            style={{ width: `${progressPercent}%` }}          />        </div>      </div>      {/* PDF Viewer */}      <div className=\"flex-1 overflow-auto p-4 flex items-center justify-center\">        <div          style={{            transform: `scale(${zoom})`,            transformOrigin: 'top center',            transition: 'transform 0.2s'          }}        >          <iframe            src={`${url}#page=${currentPage}&toolbar=0&navpanes=0`}            className=\"w-full h-screen border border-gray-300 rounded shadow-lg\"            title={title}            onLoad={() => {              // Try to detect total pages (not always possible with iframe)              // This is a simplified version              if (!totalPages) {                setTotalPages(10); // Default fallback              }            }}          />        </div>      </div>      {/* Page Thumbnails/Navigator */}      <div className=\"bg-white border-t border-gray-200 p-2 overflow-x-auto\">        <div className=\"flex gap-2\">          {Array.from({ length: totalPages || 10 }, (_, i) => i + 1).map(pageNum => (            <button              key={pageNum}              onClick={() => setCurrentPage(pageNum)}              className={`relative flex-shrink-0 w-12 h-16 border-2 rounded transition-all ${                pageNum === currentPage                  ? 'border-blue-500 bg-blue-50'                  : pagesViewed.has(pageNum)                  ? 'border-green-300 bg-green-50'                  : 'border-gray-300 bg-white'              }`}            >              <div className=\"flex items-center justify-center h-full text-xs font-medium\">                {pageNum}              </div>              {pagesViewed.has(pageNum) && (                <div className=\"absolute top-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white\" />              )}            </button>          ))}        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ResourceViewers\\VideoViewer.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":9038,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useRef, useEffect, useState } from 'react';import { Play, Pause, Volume2, VolumeX, Maximize, Settings } from 'lucide-react';interface VideoViewerProps {  url: string;  title: string;  onProgressUpdate: (progress: {    secondsWatched: number;    watchPercent: number;    lastWatchPosition: number;  }) => void;  initialProgress?: {    lastWatchPosition?: number;    secondsWatched?: number;  };}export const VideoViewer: React.FC<VideoViewerProps> = ({  url,  title,  onProgressUpdate,  initialProgress}) => {  const videoRef = useRef<HTMLVideoElement>(null);  const progressIntervalRef = useRef<NodeJS.Timeout>();    const [isPlaying, setIsPlaying] = useState(false);  const [isMuted, setIsMuted] = useState(false);  const [currentTime, setCurrentTime] = useState(0);  const [duration, setDuration] = useState(0);  const [volume, setVolume] = useState(1);  const [playbackRate, setPlaybackRate] = useState(1);  const [showControls, setShowControls] = useState(false);  const [totalWatchedSeconds, setTotalWatchedSeconds] = useState(    initialProgress?.secondsWatched || 0  );  // Extract video ID from YouTube URL  const getYouTubeVideoId = (url: string) => {    const regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;    const match = url.match(regExp);    return match && match[2].length === 11 ? match[2] : null;  };  const videoId = getYouTubeVideoId(url);  const isYouTube = !!videoId;  useEffect(() => {    if (videoRef.current && initialProgress?.lastWatchPosition) {      videoRef.current.currentTime = initialProgress.lastWatchPosition;    }  }, [initialProgress?.lastWatchPosition]);  useEffect(() => {    // Track progress every second when playing    if (isPlaying) {      progressIntervalRef.current = setInterval(() => {        if (videoRef.current) {          const current = videoRef.current.currentTime;          const total = videoRef.current.duration;          const watched = totalWatchedSeconds + 1;                    setTotalWatchedSeconds(watched);          setCurrentTime(current);                    onProgressUpdate({            secondsWatched: watched,            watchPercent: total > 0 ? Math.round((current / total) * 100) : 0,            lastWatchPosition: current          });        }      }, 1000);    } else {      if (progressIntervalRef.current) {        clearInterval(progressIntervalRef.current);      }    }    return () => {      if (progressIntervalRef.current) {        clearInterval(progressIntervalRef.current);      }    };  }, [isPlaying, totalWatchedSeconds, onProgressUpdate]);  const handlePlayPause = () => {    if (videoRef.current) {      if (isPlaying) {        videoRef.current.pause();      } else {        videoRef.current.play();      }      setIsPlaying(!isPlaying);    }  };  const handleMuteToggle = () => {    if (videoRef.current) {      videoRef.current.muted = !isMuted;      setIsMuted(!isMuted);    }  };  const handleVolumeChange = (e: React.ChangeEvent<HTMLInputElement>) => {    const newVolume = parseFloat(e.target.value);    if (videoRef.current) {      videoRef.current.volume = newVolume;      setVolume(newVolume);      setIsMuted(newVolume === 0);    }  };  const handleSeek = (e: React.ChangeEvent<HTMLInputElement>) => {    const newTime = parseFloat(e.target.value);    if (videoRef.current) {      videoRef.current.currentTime = newTime;      setCurrentTime(newTime);    }  };  const handlePlaybackRateChange = (rate: number) => {    if (videoRef.current) {      videoRef.current.playbackRate = rate;      setPlaybackRate(rate);    }  };  const handleFullscreen = () => {    if (videoRef.current) {      if (videoRef.current.requestFullscreen) {        videoRef.current.requestFullscreen();      }    }  };  const formatTime = (seconds: number) => {    const mins = Math.floor(seconds / 60);    const secs = Math.floor(seconds % 60);    return `${mins}:${secs.toString().padStart(2, '0')}`;  };  if (isYouTube) {    // YouTube embed with API for tracking    return (      <div className=\"relative w-full\" style={{ paddingBottom: '56.25%' }}>        <iframe          src={`https://www.youtube.com/embed/${videoId}?enablejsapi=1&start=${Math.floor(initialProgress?.lastWatchPosition || 0)}`}          title={title}          className=\"absolute top-0 left-0 w-full h-full rounded-lg\"          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"          allowFullScreen        />        // eslint-disable-next-line i18next/no-literal-string        <div className=\"absolute bottom-4 left-4 right-4 bg-black/70 text-white text-sm px-3 py-2 rounded\">          // eslint-disable-next-line i18next/no-literal-string          ‚è±Ô∏è ƒê√£ xem: {formatTime(totalWatchedSeconds)} |           üìä Ti·∫øn ƒë·ªô: {Math.round((totalWatchedSeconds / (duration || 1)) * 100)}%        </div>      </div>    );  }  // Direct video player  return (    <div       className=\"relative w-full bg-black rounded-lg overflow-hidden\"      onMouseEnter={() => setShowControls(true)}      onMouseLeave={() => setShowControls(false)}    >      <video        ref={videoRef}        src={url}        className=\"w-full\"        onLoadedMetadata={(e) => setDuration(e.currentTarget.duration)}        onTimeUpdate={(e) => setCurrentTime(e.currentTarget.currentTime)}        onPlay={() => setIsPlaying(true)}        onPause={() => setIsPlaying(false)}      />      {/* Custom Controls */}      <div         className={`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-4 transition-opacity ${          showControls ? 'opacity-100' : 'opacity-0'        }`}      >        {/* Progress Bar */}        <input          type=\"range\"          min=\"0\"          max={duration}          value={currentTime}          onChange={handleSeek}          className=\"w-full mb-2 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer\"          style={{            background: `linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(currentTime / duration) * 100}%, #4b5563 ${(currentTime / duration) * 100}%, #4b5563 100%)`          }}        />        <div className=\"flex items-center justify-between text-white\">          <div className=\"flex items-center gap-3\">            {/* Play/Pause */}            <button              onClick={handlePlayPause}              className=\"hover:text-blue-400 transition-colors\"            >              {isPlaying ? <Pause className=\"w-6 h-6\" /> : <Play className=\"w-6 h-6\" />}            </button>            {/* Volume */}            <div className=\"flex items-center gap-2\">              <button                onClick={handleMuteToggle}                className=\"hover:text-blue-400 transition-colors\"              >                {isMuted ? <VolumeX className=\"w-5 h-5\" /> : <Volume2 className=\"w-5 h-5\" />}              </button>              <input                type=\"range\"                min=\"0\"                max=\"1\"                step=\"0.1\"                value={volume}                onChange={handleVolumeChange}                className=\"w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer\"              />            </div>            {/* Time */}            <span className=\"text-sm\">              {formatTime(currentTime)} / {formatTime(duration)}            </span>          </div>          <div className=\"flex items-center gap-3\">            {/* Playback Speed */}            <div className=\"relative group\">              <button className=\"hover:text-blue-400 transition-colors flex items-center gap-1\">                <Settings className=\"w-5 h-5\" />                // eslint-disable-next-line i18next/no-literal-string                <span className=\"text-sm\">{playbackRate}x</span>              </button>              <div className=\"absolute bottom-full right-0 mb-2 bg-gray-800 rounded-lg p-2 hidden group-hover:block\">                {[0.5, 0.75, 1, 1.25, 1.5, 2].map(rate => (                  <button                    key={rate}                    onClick={() => handlePlaybackRateChange(rate)}                    className={`block w-full text-left px-3 py-1 rounded hover:bg-gray-700 text-sm ${                      rate === playbackRate ? 'text-blue-400' : ''                    }`}                  >                    // eslint-disable-next-line i18next/no-literal-string                    {rate}x                  </button>                ))}              </div>            </div>            {/* Fullscreen */}            <button              onClick={handleFullscreen}              className=\"hover:text-blue-400 transition-colors\"            >              <Maximize className=\"w-5 h-5\" />            </button>          </div>        </div>        {/* Stats */}        // eslint-disable-next-line i18next/no-literal-string        <div className=\"mt-2 text-xs text-gray-300\">          // eslint-disable-next-line i18next/no-literal-string          ‚è±Ô∏è T·ªïng th·ªùi gian xem: {formatTime(totalWatchedSeconds)} |           üìä Ti·∫øn ƒë·ªô: {Math.round((currentTime / duration) * 100)}%        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ResourceViewers\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ReviewForm.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":6067,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { Star, Send, X } from 'lucide-react';import { toast } from 'react-toastify';import { reviewService } from '../services/reviewService';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { useTranslation } from 'react-i18next';interface ReviewFormProps {  quizId: string;  onReviewSubmitted: () => void;  onClose: () => void;  existingReview?: {    id: string;    rating: number;    comment: string;  };}const ReviewForm: React.FC<ReviewFormProps> = ({  quizId,  onReviewSubmitted,  onClose,  existingReview}) => {  const { t } = useTranslation();  const { user } = useSelector((state: RootState) => state.auth);  const [rating, setRating] = useState(existingReview?.rating || 0);  const [comment, setComment] = useState(existingReview?.comment || '');  const [submitting, setSubmitting] = useState(false);  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();        if (!user) {      toast.error('B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ ƒë√°nh gi√°');      return;    }    if (rating === 0) {      toast.error('Vui l√≤ng ch·ªçn s·ªë sao');      return;    }    setSubmitting(true);    try {      if (existingReview) {        // Update existing review        await reviewService.updateReview(existingReview.id, {          rating,          comment        });        toast.success('C·∫≠p nh·∫≠t ƒë√°nh gi√° th√†nh c√¥ng!');      } else {        // Create new review        await reviewService.createReview({          quizId,          rating,          comment        }, user.uid, user.displayName || user.email || '');        toast.success('G·ª≠i ƒë√°nh gi√° th√†nh c√¥ng!');      }            onReviewSubmitted();    } catch (error) {      console.error('Error submitting review:', error);      toast.error('C√≥ l·ªói khi g·ª≠i ƒë√°nh gi√°');    } finally {      setSubmitting(false);    }  };  return (    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto\">        <div className=\"p-6\">          <div className=\"flex items-center justify-between mb-6\">            <h3 className=\"text-lg font-semibold text-gray-900\">              {existingReview ? 'Ch·ªânh s·ª≠a ƒë√°nh gi√°' : 'Vi·∫øt ƒë√°nh gi√°'}            </h3>            <button              onClick={onClose}              className=\"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100\"            >              <X className=\"w-5 h-5\" />            </button>          </div>          <form onSubmit={handleSubmit} className=\"space-y-6\">            {/* Rating */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                ƒê√°nh gi√° c·ªßa b·∫°n              </label>              <div className=\"flex items-center space-x-1\">                {[1, 2, 3, 4, 5].map((star) => (                  <button                    key={star}                    type=\"button\"                    onClick={() => setRating(star)}                    className={`p-1 transition-colors ${                      star <= rating                        ? 'text-yellow-400 hover:text-yellow-500'                        : 'text-gray-300 hover:text-gray-400'                    }`}                  >                    <Star                      className={`w-8 h-8 ${                        star <= rating ? 'fill-current' : ''                      }`}                    />                  </button>                ))}              </div>              {rating > 0 && (                <p className=\"text-sm text-gray-600 mt-1\">                  {rating === 1 && 'R·∫•t kh√¥ng h√†i l√≤ng'}                  {rating === 2 && 'Kh√¥ng h√†i l√≤ng'}                  {rating === 3 && 'B√¨nh th∆∞·ªùng'}                  {rating === 4 && 'H√†i l√≤ng'}                  {rating === 5 && 'R·∫•t h√†i l√≤ng'}                </p>              )}            </div>            {/* Comment */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                Nh·∫≠n x√©t (t√πy ch·ªçn)              </label>              <textarea                value={comment}                onChange={(e) => setComment(e.target.value)}                rows={4}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"                placeholder={t('placeholders.shareExperience')}                maxLength={500}              />              <p className=\"text-xs text-gray-500 mt-1\">                // eslint-disable-next-line i18next/no-literal-string                {comment.length}/500 k√Ω t·ª±              </p>            </div>            {/* Submit Button */}            <div className=\"flex items-center justify-end space-x-3\">              <button                type=\"button\"                onClick={onClose}                className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\"              >{t(\"common.cancel\")}              </button>              <button                type=\"submit\"                disabled={submitting || rating === 0}                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2\"              >                {submitting ? (                  <>                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>                    <span>{t(\"admin.quickActions.modal.sending\")}</span>                  </>                ) : (                  <>                    <Send className=\"w-4 h-4\" />                    <span>{existingReview ? 'C·∫≠p nh·∫≠t' : 'G·ª≠i ƒë√°nh gi√°'}</span>                  </>                )}              </button>            </div>          </form>        </div>      </div>    </div>  );};export default ReviewForm;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\components\\ReviewList.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: Expression expected.","line":1,"column":6920,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { Star, ThumbsUp, Flag, Calendar, User, MoreVertical } from 'lucide-react';import { QuizReview } from '../types/review';interface ReviewListProps {  reviews: QuizReview[];  loading: boolean;  onHelpfulClick?: (reviewId: string) => void;  onReportClick?: (reviewId: string) => void;}const ReviewList: React.FC<ReviewListProps> = ({  reviews,  loading,  onHelpfulClick,  onReportClick}) => {  const [expandedReviews, setExpandedReviews] = useState<Set<string>>(new Set());  const toggleExpanded = (reviewId: string) => {    const newExpanded = new Set(expandedReviews);    if (newExpanded.has(reviewId)) {      newExpanded.delete(reviewId);    } else {      newExpanded.add(reviewId);    }    setExpandedReviews(newExpanded);  };  const formatDate = (date: any) => {    if (!date) return '';    const d = date.toDate ? date.toDate() : new Date(date);    return d.toLocaleDateString('vi-VN', {      year: 'numeric',      month: 'long',      day: 'numeric'    });  };  const renderStars = (rating: number) => {    return (      <div className=\"flex items-center space-x-1\">        {[1, 2, 3, 4, 5].map((star) => (          <Star            key={star}            className={`w-4 h-4 ${              star <= rating                ? 'fill-yellow-400 text-yellow-400'                : 'text-gray-300'            }`}          />        ))}      </div>    );  };  const getRatingText = (rating: number) => {    switch (rating) {      case 1: return 'R·∫•t t·ªá';      case 2: return 'T·ªá';      case 3: return 'B√¨nh th∆∞·ªùng';      case 4: return 'T·ªët';      case 5: return 'R·∫•t t·ªët';      default: return '';    }  };  if (loading) {    return (      <div className=\"space-y-4\">        {[1, 2, 3].map((i) => (          <div key={i} className=\"animate-pulse\">            <div className=\"bg-gray-100 rounded-lg p-4\">              <div className=\"flex items-center space-x-3 mb-3\">                <div className=\"w-10 h-10 bg-gray-300 rounded-full\"></div>                <div className=\"flex-1\">                  <div className=\"h-4 bg-gray-300 rounded w-1/4 mb-1\"></div>                  <div className=\"h-3 bg-gray-300 rounded w-1/3\"></div>                </div>              </div>              <div className=\"space-y-2\">                <div className=\"h-4 bg-gray-300 rounded w-full\"></div>                <div className=\"h-4 bg-gray-300 rounded w-3/4\"></div>              </div>            </div>          </div>        ))}      </div>    );  }  if (reviews.length === 0) {    return (      <div className=\"text-center py-12\">        <Star className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />        // eslint-disable-next-line i18next/no-literal-string        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Ch∆∞a c√≥ ƒë√°nh gi√° n√†o</h3>        // eslint-disable-next-line i18next/no-literal-string        <p className=\"text-gray-600\">H√£y l√† ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë√°nh gi√° quiz n√†y!</p>      </div>    );  }  return (    <div className=\"space-y-4\">      {reviews.map((review) => {        const isExpanded = expandedReviews.has(review.id);        const shouldShowExpand = review.comment && review.comment.length > 200;        const displayComment = shouldShowExpand && !isExpanded           ? review.comment.substring(0, 200) + '...'          : review.comment;        return (          <div key={review.id} className=\"bg-white rounded-lg border border-gray-100 p-6 hover:shadow-md transition-shadow\">            {/* Header */}            <div className=\"flex items-start justify-between mb-4\">              <div className=\"flex items-center space-x-3\">                <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center\">                  {review.userAvatar ? (                    <img                      src={review.userAvatar}                      alt={review.userName}                      className=\"w-full h-full rounded-full object-cover\"                    />                  ) : (                    <User className=\"w-5 h-5 text-white\" />                  )}                </div>                <div>                  <h4 className=\"font-semibold text-gray-900\">{review.userName || 'Ng∆∞·ªùi d√πng ·∫©n danh'}</h4>                  <div className=\"flex items-center space-x-2 text-sm text-gray-500\">                    <Calendar className=\"w-3 h-3\" />                    <span>{formatDate(review.createdAt)}</span>                  </div>                </div>              </div>                            <div className=\"flex items-center space-x-2\">                <button className=\"p-1 text-gray-400 hover:text-gray-600 rounded\">                  <MoreVertical className=\"w-4 h-4\" />                </button>              </div>            </div>            {/* Rating */}            <div className=\"flex items-center space-x-3 mb-4\">              {renderStars(review.rating)}              <span className=\"text-sm font-medium text-gray-700\">                {getRatingText(review.rating)}              </span>              <span className=\"text-sm text-gray-500\">                // eslint-disable-next-line i18next/no-literal-string                ({review.rating}/5 sao)              </span>            </div>            {/* Comment */}            {review.comment && (              <div className=\"mb-4\">                <p className=\"text-gray-700 leading-relaxed\">                  {displayComment}                </p>                {shouldShowExpand && (                  <button                    onClick={() => toggleExpanded(review.id)}                    className=\"mt-2 text-blue-600 hover:text-blue-700 text-sm font-medium\"                  >                    {isExpanded ? 'Thu g·ªçn' : 'Xem th√™m'}                  </button>                )}              </div>            )}            {/* Actions */}            <div className=\"flex items-center justify-between pt-3 border-t border-gray-100\">              <div className=\"flex items-center space-x-4\">                <button                  onClick={() => onHelpfulClick?.(review.id)}                  className=\"flex items-center space-x-2 text-sm text-gray-600 hover:text-green-600 transition-colors\"                >                  <ThumbsUp className=\"w-4 h-4\" />                  // eslint-disable-next-line i18next/no-literal-string                  <span>H·ªØu √≠ch ({review.helpful?.length || 0})</span>                </button>                                <button                  onClick={() => onReportClick?.(review.id)}                  className=\"flex items-center space-x-2 text-sm text-gray-600 hover:text-red-600 transition-colors\"                >                  <Flag className=\"w-4 h-4\" />                  // eslint-disable-next-line i18next/no-literal-string                  <span>B√°o c√°o</span>                </button>              </div>              {review.updatedAt && review.updatedAt !== review.createdAt && (                // eslint-disable-next-line i18next/no-literal-string                <span className=\"text-xs text-gray-500\">                  ƒê√£ ch·ªânh s·ª≠a {formatDate(review.updatedAt)}                </span>              )}            </div>          </div>        );      })}    </div>  );};export default ReviewList;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\hooks\\useAutoSaveDraft.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\AdvancedAIGenerator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\FileUploadDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\FileUploadSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\HavePasswordStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\PrivacyStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuestionEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuestionsStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuizBulkImport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuizInfoStep.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":16405,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { useTranslation } from 'react-i18next';import { QuizFormData } from '../types';import { categories, difficulties } from '../constants';import RichTextEditor from '../../../../../shared/components/ui/RichTextEditor';import RichTextViewer from '../../../../../shared/components/ui/RichTextViewer';import ImageUploader from '../../../../../components/ImageUploader';import { BookOpen, Clock, Tag, Star, FileText, ImageIcon, Lock, Key } from 'lucide-react';interface QuizInfoStepProps {  quiz: QuizFormData;  setQuiz: React.Dispatch<React.SetStateAction<QuizFormData>>;}const QuizInfoStep: React.FC<QuizInfoStepProps> = ({ quiz, setQuiz }) => {  const { t } = useTranslation();    return (    <div className=\"space-y-8\">      {/* Header */}      <div className=\"text-center space-y-2\">        <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto\">          <BookOpen className=\"w-8 h-8 text-white\" />        </div>        <h2 className=\"text-2xl font-bold text-gray-900\">{t('createQuiz.info.basicInfo')}</h2>        <p className=\"text-gray-600\">{t('createQuiz.info.fillInfo')}</p>      </div>      {/* Form */}      <div className=\"space-y-6\">        {/* Title */}        <div className=\"space-y-2\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <FileText className=\"w-4 h-4\" />            {t('createQuiz.info.titleLabel')}          </label>          <input            className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-lg\"            placeholder={t('createQuiz.info.titlePlaceholder')}            value={quiz.title}            onChange={e => setQuiz(q => ({ ...q, title: e.target.value }))}          />        </div>        {/* Description */}        <div className=\"space-y-2\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <FileText className=\"w-4 h-4\" />            {t('createQuiz.info.descriptionLabel')}          </label>          <RichTextEditor            value={quiz.description}            onChange={(value: string) => setQuiz(q => ({ ...q, description: value }))}            placeholder={t('createQuiz.info.descriptionPlaceholder')}            height={200}          />        </div>        {/* Category & Difficulty */}        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">          <div className=\"space-y-2\">            <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">              <Tag className=\"w-4 h-4\" />              {t('createQuiz.info.categoryLabel')}            </label>            <select              className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"              value={quiz.category}              onChange={e => setQuiz(q => ({ ...q, category: e.target.value }))}            >              <option value=\"\">{t('createQuiz.info.categoryPlaceholder')}</option>              {categories.map(c => (                <option key={c.value} value={c.value}>{t(c.labelKey)}</option>              ))}            </select>          </div>          <div className=\"space-y-2\">            <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">              <Star className=\"w-4 h-4\" />              {t('createQuiz.info.difficultyLabel')}            </label>            <select              className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"              value={quiz.difficulty}              onChange={e => setQuiz(q => ({ ...q, difficulty: e.target.value }))}            >              <option value=\"\">{t('createQuiz.info.difficultyPlaceholder')}</option>              {difficulties.map(d => (                <option key={d.value} value={d.value}>{t(d.labelKey)}</option>              ))}            </select>          </div>        </div>        {/* Duration only */}        <div className=\"space-y-2\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <Clock className=\"w-4 h-4\" />            {t('createQuiz.info.durationLabel')}          </label>          <input            type=\"number\"            className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"            min={5}            max={120}            value={quiz.duration}            onChange={e => setQuiz(q => ({ ...q, duration: parseInt(e.target.value) || 15 }))}            placeholder={t('createQuiz.info.durationPlaceholder')}          />          <p className=\"text-sm text-gray-500\">{t('quizCreation.from5to120minutes')}</p>        </div>        {/* Tags */}        <div className=\"space-y-2\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <Tag className=\"w-4 h-4\" />            {t('quizCreation.tagsOptional')}          </label>          <input            className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"            placeholder={t('placeholders.enterTags')}            value={quiz.tags?.join(', ') || ''}            onChange={e => setQuiz(q => ({               ...q,               tags: e.target.value.split(',').map(tag => tag.trim()).filter(tag => tag)             }))}          />          <p className=\"text-sm text-gray-500\">{t('quizCreation.tagsExample')}</p>        </div>        {/* Cover Image Upload */}        <div className=\"space-y-2\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <ImageIcon className=\"w-4 h-4\" />            {t('quizCreation.coverImage')}          </label>                    {/* Tab ch·ªçn Upload ho·∫∑c URL */}          <div className=\"flex gap-2 mb-3\">            <button              type=\"button\"              onClick={() => {                const uploadMode = document.getElementById('upload-mode');                const urlMode = document.getElementById('url-mode');                if (uploadMode && urlMode) {                  uploadMode.classList.remove('hidden');                  urlMode.classList.add('hidden');                }              }}              className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors\"            >              {t('quizCreation.uploadImage')}            </button>            <button              type=\"button\"              onClick={() => {                const uploadMode = document.getElementById('upload-mode');                const urlMode = document.getElementById('url-mode');                if (uploadMode && urlMode) {                  uploadMode.classList.add('hidden');                  urlMode.classList.remove('hidden');                }              }}              className=\"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\"            >              {t('quizCreation.enterUrl')}            </button>          </div>          {/* Upload Mode */}          <div id=\"upload-mode\">            <ImageUploader              onUploadSuccess={(result) => {                if (result.success && result.originalUrl) {                  setQuiz(q => ({ ...q, imageUrl: result.originalUrl! }));                }              }}              onUploadError={(error) => {                console.error('Upload error:', error);              }}              options={{                folder: 'covers',                maxSizeKB: 3072, // 3MB                allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],                generateThumbnails: true              }}              previewUrl={quiz.imageUrl || undefined}              label=\"\"              showThumbnails={false}              compressBeforeUpload={true}              instantUpload={true}              ultraFast={true}            />          </div>          {/* URL Mode */}          <div id=\"url-mode\" className=\"hidden\">            <input              type=\"url\"              value={quiz.imageUrl || ''}              onChange={(e) => setQuiz(q => ({ ...q, imageUrl: e.target.value }))}              placeholder={t('placeholders.imageUrl')}              className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"            />            {quiz.imageUrl && (              <div className=\"mt-3\">                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-sm font-medium text-gray-700 mb-2\">Preview:</p>                <img                   src={quiz.imageUrl}                   alt={t('createQuiz.info.previewImageAlt')}                   className=\"w-full h-48 object-cover rounded-lg border-2 border-gray-200\"                  onError={(e) => {                    (e.target as HTMLImageElement).src = 'https://via.placeholder.com/400x200?text=Invalid+Image+URL';                  }}                />              </div>            )}          </div>          <p className=\"text-xs text-gray-500\">            {t('quizCreation.coverImageHint')}          </p>        </div>        {/* Password Protection */}        <div className=\"space-y-3\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <Lock className=\"w-4 h-4\" />            {t('quizCreation.quizSecurity')}          </label>                    {/* Have Password Checkbox */}          <div className=\"flex items-center gap-3 p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl border-2 border-purple-200\">            <input              type=\"checkbox\"              id=\"havePassword\"              checked={quiz.havePassword === 'password'}              onChange={(e) => {                setQuiz(q => ({                  ...q,                  havePassword: e.target.checked ? 'password' : 'public',                  password: e.target.checked ? q.password : ''                }));              }}              className=\"w-5 h-5 text-purple-600 rounded focus:ring-2 focus:ring-purple-500\"            />            <label htmlFor=\"havePassword\" className=\"flex-1 cursor-pointer\">              <div className=\"font-semibold text-purple-900 flex items-center gap-2\">                {t('quizCreation.requirePassword')}              </div>              <p className=\"text-sm text-purple-700 mt-1\">                {t('quizCreation.quizVisibleNeedPassword')}              </p>            </label>          </div>          {/* Password Input - Show when checkbox is checked */}          {quiz.havePassword === 'password' && (            <div className=\"ml-4 space-y-2 animate-in fade-in duration-300\">              <label className=\"flex items-center gap-2 text-sm font-medium text-gray-700\">                <Key className=\"w-4 h-4\" />                {t('quizCreation.passwordRequired')}              </label>              <div className=\"relative\">                <input                  type=\"password\"                  value={quiz.password || ''}                  onChange={(e) => setQuiz(q => ({ ...q, password: e.target.value }))}                  placeholder={t('placeholders.minPasswordLength')}                  minLength={6}                  className={`w-full px-4 py-3 pr-12 border-2 rounded-xl focus:outline-none focus:ring-2 transition-all ${                    quiz.password && quiz.password.length >= 6                      ? 'border-green-300 focus:border-green-500 focus:ring-green-500/20'                      : 'border-purple-200 focus:border-purple-500 focus:ring-purple-500/20'                  }`}                />                <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">                  {quiz.password && quiz.password.length >= 6 ? (                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"text-green-600\">‚úì</span>                  ) : (                    <Lock className=\"w-5 h-5 text-gray-400\" />                  )}                </div>              </div>              {quiz.password && quiz.password.length < 6 && (                <p className=\"text-sm text-red-600 flex items-center gap-2\">                  <span className=\"w-1 h-1 bg-red-600 rounded-full\" />                  {t('quizCreation.passwordMinLength')}                </p>              )}              <p className=\"text-xs text-gray-600\">                {t('quizCreation.passwordHint')}              </p>            </div>          )}        </div>        {/* Additional Settings */}        <div className=\"space-y-3\">          <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">            <Star className=\"w-4 h-4\" />            {t('quizCreation.additionalSettings')}          </label>                    <div className=\"space-y-2\">            {/* Allow Retake */}            <div className=\"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200\">              <input                type=\"checkbox\"                id=\"allowRetake\"                checked={quiz.allowRetake !== false}                onChange={(e) => setQuiz(q => ({ ...q, allowRetake: e.target.checked }))}                className=\"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500\"              />              <label htmlFor=\"allowRetake\" className=\"flex-1 cursor-pointer\">                <div className=\"font-medium text-gray-900\">{t('quizCreation.allowRetake')}</div>                <p className=\"text-sm text-gray-600 mt-0.5\">                  {t('quizCreation.allowRetakeDesc')}                </p>              </label>            </div>          </div>        </div>      </div>      {/* Preview */}      <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-2xl border border-blue-200\">        <h3 className=\"font-semibold text-blue-900 mb-3\">üìã {t('createQuiz.info.preview')}</h3>        <div className=\"space-y-2 text-sm\">          <p><strong>{t('createQuiz.info.previewLabels.title')}:</strong> {quiz.title || t('createQuiz.info.noTitle')}</p>          <div>            <strong>{t('createQuiz.info.previewLabels.description')}:</strong>{' '}            {quiz.description ? (              <RichTextViewer content={quiz.description} />            ) : (              <span>{t('createQuiz.info.noDescription')}</span>            )}          </div>          <p><strong>{t('createQuiz.info.previewLabels.category')}:</strong> {quiz.category ? t(`createQuiz.info.categoryOptions.${quiz.category}`) : t('createQuiz.info.noCategory')}</p>          <p><strong>{t('createQuiz.info.previewLabels.difficulty')}:</strong> {quiz.difficulty ? t(`difficulty.${quiz.difficulty as 'easy' | 'medium' | 'hard'}`) : t('createQuiz.info.noDifficulty')}</p>          <p><strong>{t('createQuiz.info.previewLabels.duration')}:</strong> {t('createQuiz.info.durationValue', { count: quiz.duration })}</p>          <p>            <strong>{t('createQuiz.info.previewLabels.privacy')}</strong>{' '}            <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded ${              quiz.isPublic === true                 ? 'bg-blue-100 text-blue-700'                 : 'bg-purple-100 text-purple-700'            }`}>              {quiz.isPublic === true ? (                <>                  {t('quizCreation.public')}                </>              ) : (                <>{t('quizCreation.private')}</>              )}            </span>          </p>          <p>            <strong>{t('createQuiz.info.previewLabels.retake')}:</strong>{' '}            {quiz.allowRetake !== false ? t('createQuiz.info.retakeAllowed') : t('createQuiz.info.retakeDisabled')}          </p>          {quiz.tags && quiz.tags.length > 0 && (            <p><strong>{t('createQuiz.info.previewLabels.tags')}:</strong> {quiz.tags.join(', ')}</p>          )}          {quiz.imageUrl && (            <div className=\"mt-3\">              <p><strong>{t('createQuiz.info.previewImage')}</strong></p>              <img src={quiz.imageUrl} alt={t('createQuiz.info.previewImageAlt')} className=\"mt-2 w-32 h-20 object-cover rounded-lg\" />            </div>          )}        </div>      </div>    </div>  );};export default QuizInfoStep;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuizInfoStep_new.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\QuizTypeStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\ResourcesStep.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":29325,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø/** * ResourcesStep - Step 3: Th√™m t√†i li·ªáu h·ªçc t·∫≠p (video/PDF/image/audio/YouTube) */import React, { useState } from 'react';import {   Upload,   Video,   FileText,   Image as ImageIcon,   Music,   Link as LinkIcon,  Trash2,  Edit2,  Plus,  X} from 'lucide-react';import { LearningResource, ResourceType } from '../../../types/learning';import { uploadImage } from '../../../../../services/imageUploadService';import { storage } from '../../../../../lib/firebase/config';import { ref, uploadBytes, getDownloadURL } from 'firebase/storage';import { toast } from 'react-toastify';import { useTranslation } from 'react-i18next';interface ResourcesStepProps {  resources: LearningResource[];  onResourcesChange: (resources: LearningResource[]) => void;}const ResourcesStep: React.FC<ResourcesStepProps> = ({ resources, onResourcesChange }) => {  const { t } = useTranslation();  const [showForm, setShowForm] = useState(false);  const [editingId, setEditingId] = useState<string | null>(null);  const [uploading, setUploading] = useState(false);  // Form state  const [formData, setFormData] = useState<Partial<LearningResource>>({    type: 'video',    title: '',    description: '',    url: '',    required: false,    threshold: {},    learningOutcomes: [],    order: resources.length  });  const handleAddResource = () => {    setShowForm(true);    setEditingId(null);    setFormData({      type: 'video',      title: '',      description: '',      url: '',      required: false,      threshold: {},      learningOutcomes: [],      order: resources.length    });  };  const handleEditResource = (resource: LearningResource) => {    setShowForm(true);    setEditingId(resource.id);    setFormData(resource);  };  const handleDeleteResource = (id: string) => {    if (confirm(t('resources.confirmDelete'))) {      onResourcesChange(resources.filter(r => r.id !== id));      toast.success(t('resources.success.deleted'));    }  };  const handleFileUpload = async (file: File, type: ResourceType) => {    setUploading(true);    try {      // Validate file size based on type      const maxSizes = {        video: 50 * 1024 * 1024, // 50MB        pdf: 10 * 1024 * 1024,   // 10MB        audio: 10 * 1024 * 1024, // 10MB        image: 5 * 1024 * 1024,  // 5MB        link: 0,        slides: 5 * 1024 * 1024      };      if (file.size > maxSizes[type]) {        const sizeMB = (maxSizes[type] / (1024 * 1024)).toFixed(0);        toast.error(t('resources.errors.fileTooLarge', { size: sizeMB, type }));        setUploading(false);        return;      }      // Validate file type strictly      const validTypes: Record<ResourceType, string[]> = {        video: ['video/mp4', 'video/webm', 'video/ogg', 'video/quicktime', 'video/x-msvideo'],        pdf: ['application/pdf'],        audio: ['audio/mpeg', 'audio/mp3', 'audio/wav', 'audio/ogg', 'audio/m4a'],        image: ['image/jpeg', 'image/png', 'image/webp', 'image/gif'],        link: [],        slides: ['image/jpeg', 'image/png', 'image/webp']      };      if (validTypes[type] && !validTypes[type].includes(file.type) && type !== 'link') {        toast.error(t('resources.errors.invalidFormat', { type }));        setUploading(false);        return;      }      // Use uploadImage for images, otherwise use direct Firebase upload      if (type === 'image') {        const result = await uploadImage(file, {          folder: 'temp' as any,          maxSizeKB: 5120,          generateThumbnails: true        });        if (result.success) {          setFormData(prev => ({            ...prev,            url: result.originalUrl,            thumbnailUrl: result.thumbnailUrls?.medium          }));          toast.success(t('resources.success.imageUploaded'));        } else {          toast.error(result.error || t('resources.errors.uploadFailed'));        }      } else {        // For video, pdf, audio - upload to Firebase Storage directly        console.log('üì§ Starting upload for:', type, file.name);                // T·∫°o quizId t·∫°m th·ªùi n·∫øu ch∆∞a c√≥ (d√πng timestamp)        const tempQuizId = 'draft_' + Date.now();                // C·∫•u tr√∫c th∆∞ m·ª•c r√µ r√†ng theo ch·ª©c nƒÉng        const folder = type === 'video' ? `learning-resources/videos/${tempQuizId}` :                       type === 'pdf' ? `learning-resources/pdfs/${tempQuizId}` :                       type === 'audio' ? `learning-resources/audios/${tempQuizId}` :                      `learning-resources/images/${tempQuizId}`;                const timestamp = Date.now();        const fileName = `${timestamp}_${file.name}`;        const fullPath = `${folder}/${fileName}`;                console.log('ÔøΩ Upload path:', fullPath);        console.log('üì¶ File info:', {          name: file.name,          type: file.type,          size: `${(file.size / 1024 / 1024).toFixed(2)} MB`        });                const storageRef = ref(storage, fullPath);                // Upload file with metadata        const metadata = {          contentType: file.type,          customMetadata: {            uploadedBy: 'user',            originalName: file.name,            uploadedAt: new Date().toISOString()          }        };                console.log('‚¨ÜÔ∏è Uploading to Firebase Storage...');                await uploadBytes(storageRef, file, metadata);                console.log('‚úÖ Upload complete, getting download URL...');                // Get download URL        const downloadURL = await getDownloadURL(storageRef);                console.log('üîó Download URL:', downloadURL);                setFormData(prev => ({          ...prev,          url: downloadURL        }));                const successKey = type === 'video' ? 'resources.success.videoUploaded' :                          type === 'pdf' ? 'resources.success.pdfUploaded' :                          'resources.success.audioUploaded';        toast.success(t(successKey));      }    } catch (error: any) {      console.error('Upload error:', error);      toast.error(t('resources.errors.uploadError', { error: error.message }));    } finally {      setUploading(false);    }  };  const handleSaveResource = () => {    // Validation    if (!formData.title?.trim()) {      toast.error(t('resources.errors.titleRequired'));      return;    }    if (!formData.url?.trim()) {      toast.error(t('resources.errors.urlRequired'));      return;    }    const newResource: LearningResource = {      id: editingId || `res_${Date.now()}`,      type: formData.type!,      title: formData.title!,      description: formData.description || '',      url: formData.url!,      required: formData.required || false,      threshold: formData.threshold || {},      learningOutcomes: formData.learningOutcomes || [],      order: formData.order || resources.length,      thumbnailUrl: formData.thumbnailUrl,      whyWatch: formData.whyWatch,      estimatedTime: formData.estimatedTime,      createdAt: new Date(),      updatedAt: new Date()    };    if (editingId) {      // Update existing      onResourcesChange(resources.map(r => r.id === editingId ? newResource : r));      toast.success(t('resources.success.updated'));    } else {      // Add new      onResourcesChange([...resources, newResource]);      toast.success(t('resources.success.added'));    }    setShowForm(false);    setEditingId(null);  };  const getResourceIcon = (type: ResourceType) => {    switch (type) {      case 'video': return <Video className=\"w-5 h-5\" />;      case 'pdf': return <FileText className=\"w-5 h-5\" />;      case 'image': return <ImageIcon className=\"w-5 h-5\" />;      case 'link': return <LinkIcon className=\"w-5 h-5\" />;      default: return <Music className=\"w-5 h-5\" />;    }  };  const getTypeLabel = (type: ResourceType) => {    const labels: Record<ResourceType, string> = {      video: t('resources.types.video'),      pdf: t('resources.types.pdf'),      image: t('resources.types.image'),      audio: t('resources.types.audio'),      link: t('resources.types.link'),      slides: t('resources.types.slides')    };    return labels[type];  };  return (    <div className=\"space-y-6\">      {/* Header */}      <div className=\"flex items-center justify-between\">        <div>          <h3 className=\"text-lg font-semibold text-gray-900\">            üìö {t('resources.title')} <span className=\"text-red-500\">*</span>          </h3>          <p className=\"text-sm text-gray-600 mt-1\">            {t('resources.subtitle')}          </p>        </div>        <button          onClick={handleAddResource}          className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"        >          <Plus className=\"w-4 h-4\" />          {t('resources.addResource')}        </button>      </div>      {/* Resources List */}      {resources.length === 0 ? (        <div className=\"text-center py-12 bg-red-50 rounded-lg border-2 border-dashed border-red-300\">          <Upload className=\"w-12 h-12 mx-auto text-red-400 mb-3\" />          <p className=\"text-red-600 font-semibold mb-2\">{t('resources.emptyState.warning')}</p>          <p className=\"text-sm text-gray-600 mb-4\">            {t('resources.emptyState.description')}<br/>            {t('resources.emptyState.cannotContinue')}          </p>          <button            onClick={handleAddResource}            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"          >            + {t('resources.firstResource')}          </button>        </div>      ) : (        <div className=\"space-y-3\">          {resources.map((resource, index) => (            <div              key={resource.id}              className=\"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\"            >              <div className=\"flex items-start gap-4\">                {/* Icon */}                <div className={`p-3 rounded-lg ${                  resource.type === 'video' ? 'bg-purple-100 text-purple-600' :                  resource.type === 'pdf' ? 'bg-red-100 text-red-600' :                  resource.type === 'image' ? 'bg-blue-100 text-blue-600' :                  'bg-green-100 text-green-600'                }`}>                  {getResourceIcon(resource.type)}                </div>                {/* Content */}                <div className=\"flex-1 min-w-0\">                  <div className=\"flex items-start justify-between gap-2\">                    <div className=\"flex-1\">                      <div className=\"flex items-center gap-2 mb-1\">                        <h4 className=\"font-semibold text-gray-900\">                          {index + 1}. {resource.title}                        </h4>                        {resource.required && (                          <span className=\"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-medium rounded\">                            {t('resources.required')}                          </span>                        )}                        {!resource.required && (                          <span className=\"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs font-medium rounded\">                            {t('resources.recommended')}                          </span>                        )}                      </div>                                            {resource.description && (                        <p className=\"text-sm text-gray-600 mb-2\">                          {resource.description}                        </p>                      )}                      <div className=\"flex items-center gap-4 text-xs text-gray-500\">                        <span className=\"flex items-center gap-1\">                          {getResourceIcon(resource.type)}                          {getTypeLabel(resource.type)}                        </span>                        {resource.estimatedTime && (                          // eslint-disable-next-line i18next/no-literal-string                          <span>‚è±Ô∏è {resource.estimatedTime} ph√∫t</span>                        )}                        {resource.whyWatch && (                          <span className=\"truncate max-w-xs\">                            üí° {resource.whyWatch}                          </span>                        )}                      </div>                    </div>                    {/* Actions */}                    <div className=\"flex items-center gap-2\">                      <button                        onClick={() => handleEditResource(resource)}                        className=\"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors\"                        title={t('resources.editButton')}                      >                        <Edit2 className=\"w-4 h-4\" />                      </button>                      <button                        onClick={() => handleDeleteResource(resource.id)}                        className=\"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors\"                        title={t('resources.deleteButton')}                      >                        <Trash2 className=\"w-4 h-4\" />                      </button>                    </div>                  </div>                </div>              </div>            </div>          ))}        </div>      )}      {/* Add/Edit Form Modal */}      {showForm && (        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">          <div className=\"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">            {/* Header */}            <div className=\"flex items-center justify-between p-6 border-b\">              <h3 className=\"text-xl font-bold text-gray-900\">                {editingId ? t('resources.editResource') : t('resources.newResource')}              </h3>              <button                onClick={() => setShowForm(false)}                className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"              >                <X className=\"w-5 h-5\" />              </button>            </div>            {/* Form Content */}            <div className=\"p-6 space-y-4\">              {/* Resource Type */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('resources.form.typeLabel')}                </label>                <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-2\">                  {(['video', 'pdf', 'image', 'audio', 'link'] as ResourceType[]).map(type => (                    <button                      key={type}                      type=\"button\"                      onClick={() => setFormData(prev => ({ ...prev, type }))}                      className={`p-3 rounded-lg border-2 transition-all ${                        formData.type === type                          ? 'border-blue-600 bg-blue-50 text-blue-700'                          : 'border-gray-200 hover:border-gray-300'                      }`}                    >                      <div className=\"flex flex-col items-center gap-1\">                        {getResourceIcon(type)}                        <span className=\"text-xs font-medium\">                          {getTypeLabel(type)}                        </span>                      </div>                    </button>                  ))}                </div>              </div>              {/* Title */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('resources.form.titleLabel')}                </label>                <input                  type=\"text\"                  value={formData.title || ''}                  onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}                  placeholder={t('resources.form.titlePlaceholder')}                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                />              </div>              {/* Description */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('resources.form.descriptionLabel')}                </label>                <textarea                  value={formData.description || ''}                  onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}                  placeholder={t('resources.form.descriptionPlaceholder')}                  rows={2}                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                />              </div>              {/* URL or Upload - CHIA LU·ªíNG R√ï R√ÄNG */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {formData.type === 'link' ? t('resources.form.urlLabel.link') :                    formData.type === 'video' ? t('resources.form.urlLabel.video') :                   formData.type === 'pdf' ? t('resources.form.urlLabel.pdf') :                   formData.type === 'audio' ? t('resources.form.urlLabel.audio') :                   t('resources.form.urlLabel.image')}                </label>                                {formData.type === 'link' ? (                  // LINK - CH·ªà NH·∫¨P URL                  <div>                    <input                      type=\"url\"                      value={formData.url || ''}                      onChange={(e) => setFormData(prev => ({ ...prev, url: e.target.value }))}                      placeholder={t('resources.form.urlPlaceholder.link')}                      className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                    />                    <p className=\"text-xs text-gray-500 mt-2\">                      {t('resources.form.linkHint')}                    </p>                  </div>                ) : formData.type === 'video' ? (                  // VIDEO - CH·ªà CH·∫§P NH·∫¨N VIDEO FILES                  <div className=\"space-y-3\">                    <div className=\"border-2 border-dashed border-blue-300 rounded-lg p-4 bg-blue-50\">                      <input                        type=\"file\"                        accept=\"video/mp4,video/webm,video/ogg,video/quicktime,video/x-msvideo\"                        onChange={(e) => {                          const file = e.target.files?.[0];                          if (file) {                            // Validate file type                            if (!file.type.startsWith('video/')) {                              toast.error(t('resources.errors.videoOnly'));                              e.target.value = '';                              return;                            }                            handleFileUpload(file, 'video');                          }                        }}                        disabled={uploading}                        className=\"w-full text-sm\"                      />                      <p className=\"text-xs text-blue-600 mt-2 font-medium\">                        {t('resources.form.acceptedFormats.video')}                      </p>                    </div>                    <div className=\"text-center text-sm text-gray-500\">{t('resources.form.orDivider')}</div>                    <input                      type=\"url\"                      value={formData.url || ''}                      onChange={(e) => setFormData(prev => ({ ...prev, url: e.target.value }))}                      placeholder={t('resources.form.urlPlaceholder.video')}                      disabled={uploading}                      className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                    />                  </div>                ) : formData.type === 'pdf' ? (                  // PDF - CH·ªà CH·∫§P NH·∫¨N PDF FILES                  <div className=\"space-y-3\">                    <div className=\"border-2 border-dashed border-red-300 rounded-lg p-4 bg-red-50\">                      <input                        type=\"file\"                        accept=\".pdf,application/pdf\"                        onChange={(e) => {                          const file = e.target.files?.[0];                          if (file) {                            // Validate file type                            if (file.type !== 'application/pdf' && !file.name.endsWith('.pdf')) {                              toast.error(t('resources.errors.pdfOnly'));                              e.target.value = '';                              return;                            }                            handleFileUpload(file, 'pdf');                          }                        }}                        disabled={uploading}                        className=\"w-full text-sm\"                      />                      <p className=\"text-xs text-red-600 mt-2 font-medium\">                        {t('resources.form.acceptedFormats.pdf')}                      </p>                    </div>                    <div className=\"text-center text-sm text-gray-500\">{t('resources.form.orDivider')}</div>                    <input                      type=\"url\"                      value={formData.url || ''}                      onChange={(e) => setFormData(prev => ({ ...prev, url: e.target.value }))}                      placeholder={t('resources.form.urlPlaceholder.pdf')}                      disabled={uploading}                      className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                    />                  </div>                ) : formData.type === 'audio' ? (                  // AUDIO - CH·ªà CH·∫§P NH·∫¨N AUDIO FILES                  <div className=\"space-y-3\">                    <div className=\"border-2 border-dashed border-green-300 rounded-lg p-4 bg-green-50\">                      <input                        type=\"file\"                        accept=\"audio/mp3,audio/mpeg,audio/wav,audio/ogg,audio/m4a\"                        onChange={(e) => {                          const file = e.target.files?.[0];                          if (file) {                            // Validate file type                            if (!file.type.startsWith('audio/')) {                              toast.error(t('resources.errors.audioOnly'));                              e.target.value = '';                              return;                            }                            handleFileUpload(file, 'audio');                          }                        }}                        disabled={uploading}                        className=\"w-full text-sm\"                      />                      <p className=\"text-xs text-green-600 mt-2 font-medium\">                        {t('resources.form.acceptedFormats.audio')}                      </p>                    </div>                    <div className=\"text-center text-sm text-gray-500\">{t('resources.form.orDivider')}</div>                    <input                      type=\"url\"                      value={formData.url || ''}                      onChange={(e) => setFormData(prev => ({ ...prev, url: e.target.value }))}                      placeholder={t('resources.form.urlPlaceholder.audio')}                      disabled={uploading}                      className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                    />                  </div>                ) : (                  // IMAGE - CH·ªà CH·∫§P NH·∫¨N IMAGE FILES                  <div className=\"space-y-3\">                    <div className=\"border-2 border-dashed border-purple-300 rounded-lg p-4 bg-purple-50\">                      <input                        type=\"file\"                        accept=\"image/jpeg,image/jpg,image/png,image/webp,image/gif\"                        onChange={(e) => {                          const file = e.target.files?.[0];                          if (file) {                            // Validate file type                            if (!file.type.startsWith('image/')) {                              toast.error(t('resources.errors.imageOnly'));                              e.target.value = '';                              return;                            }                            handleFileUpload(file, 'image');                          }                        }}                        disabled={uploading}                        className=\"w-full text-sm\"                      />                      <p className=\"text-xs text-purple-600 mt-2 font-medium\">                        {t('resources.form.acceptedFormats.image')}                      </p>                    </div>                    <div className=\"text-center text-sm text-gray-500\">{t('resources.form.orDivider')}</div>                    <input                      type=\"url\"                      value={formData.url || ''}                      onChange={(e) => setFormData(prev => ({ ...prev, url: e.target.value }))}                      placeholder={t('resources.form.urlPlaceholder.image')}                      disabled={uploading}                      className=\"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"                    />                  </div>                )}                                {uploading && (                  <div className=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">                    <div className=\"flex items-center gap-2\">                      <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent\"></div>                      <span className=\"text-sm text-blue-600 font-medium\">{t('resources.form.uploading')}</span>                    </div>                  </div>                )}                                {formData.url && !uploading && (                  <div className=\"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg\">                    <p className=\"text-sm text-green-700 font-medium\">{t('resources.form.urlReady')}</p>                    <p className=\"text-xs text-green-600 truncate\">{formData.url}</p>                  </div>                )}              </div>              {/* Required */}              <div className=\"flex items-center gap-3 p-4 bg-gray-50 rounded-lg\">                <input                  type=\"checkbox\"                  id=\"required\"                  checked={formData.required || false}                  onChange={(e) => setFormData(prev => ({ ...prev, required: e.target.checked }))}                  className=\"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500\"                />                <label htmlFor=\"required\" className=\"flex-1 text-sm text-gray-700\">                  <span className=\"font-medium\">{t('resources.form.requiredLabel')}</span>                  <p className=\"text-xs text-gray-500 mt-0.5\">                    {t('resources.form.requiredDescription')}                  </p>                </label>              </div>              {/* Why Watch */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('resources.form.whyWatchLabel')}                </label>                <input                  type=\"text\"                  value={formData.whyWatch || ''}                  onChange={(e) => setFormData(prev => ({ ...prev, whyWatch: e.target.value }))}                  placeholder={t('resources.form.whyWatchPlaceholder')}                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                />              </div>              {/* Estimated Time */}              <div>                <label className=\"block text-sm font-medium text-gray-700 mb-2\">                  {t('resources.form.estimatedTimeLabel')}                </label>                <input                  type=\"number\"                  value={formData.estimatedTime || ''}                  onChange={(e) => setFormData(prev => ({ ...prev, estimatedTime: parseInt(e.target.value) || undefined }))}                  placeholder={t('resources.form.estimatedTimePlaceholder')}                  min=\"1\"                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"                />              </div>            </div>            {/* Footer */}            <div className=\"flex items-center justify-end gap-3 p-6 border-t bg-gray-50\">              <button                onClick={() => setShowForm(false)}                className=\"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors\"              >                {t('resources.cancelButton')}              </button>              <button                onClick={handleSaveResource}                disabled={uploading}                className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors\"              >                {uploading ? t('resources.form.uploading') : editingId ? t('resources.updateButton') : t('resources.saveButton')}              </button>            </div>          </div>        </div>      )}    </div>  );};export default ResourcesStep;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\ReviewStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\SimpleAIGenerator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\components\\SortableItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\CreateQuizPage\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\EditQuizPage.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"{ useState","message":"Definition for rule '{ useState' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"useEffect","message":"Definition for rule 'useEffect' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"useCallback } from 'react';import { useParams","message":"Definition for rule 'useCallback } from 'react';import { useParams' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"useNavigate } from 'react-router-dom';import { getQuizById } from '../api';import { updateQuiz } from '../api';import { Quiz } from '../types';import { toast } from 'react-toastify';import { ArrowLeft","message":"Definition for rule 'useNavigate } from 'react-router-dom';import { getQuizById } from '../api';import { updateQuiz } from '../api';import { Quiz } from '../types';import { toast } from 'react-toastify';import { ArrowLeft' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"Save","message":"Definition for rule 'Save' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"Loader2 } from 'lucide-react';import { useTranslation } from 'react-i18next';const EditQuizPage: React.FC = () => {  const { t } = useTranslation();  const { id } = useParams<{ id: string }>();  const navigate = useNavigate();  const [quiz","message":"Definition for rule 'Loader2 } from 'lucide-react';import { useTranslation } from 'react-i18next';const EditQuizPage: React.FC = () => {  const { t } = useTranslation();  const { id } = useParams<{ id: string }>();  const navigate = useNavigate();  const [quiz' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"setQuiz] = useState<Quiz | null>(null);  const [loading","message":"Definition for rule 'setQuiz] = useState<Quiz | null>(null);  const [loading' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"setLoading] = useState(true);  const [saving","message":"Definition for rule 'setLoading] = useState(true);  const [saving' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"setSaving] = useState(false);  const [formData","message":"Definition for rule 'setSaving] = useState(false);  const [formData' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"setFormData] = useState({    title: ''","message":"Definition for rule 'setFormData] = useState({    title: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"description: ''","message":"Definition for rule 'description: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"category: ''","message":"Definition for rule 'category: ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"difficulty: 'medium' as 'easy' | 'medium' | 'hard'","message":"Definition for rule 'difficulty: 'medium' as 'easy' | 'medium' | 'hard'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"status: 'pending' as 'pending' | 'approved' | 'rejected' | 'draft'  });  const loadQuiz = useCallback(async () => {    if (!id) return;        setLoading(true);    try {      const quizData = await getQuizById(id);      if (quizData) {        setQuiz(quizData);        setFormData({          title: quizData.title || ''","message":"Definition for rule 'status: 'pending' as 'pending' | 'approved' | 'rejected' | 'draft'  });  const loadQuiz = useCallback(async () => {    if (!id) return;        setLoading(true);    try {      const quizData = await getQuizById(id);      if (quizData) {        setQuiz(quizData);        setFormData({          title: quizData.title || ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"description: quizData.description || ''","message":"Definition for rule 'description: quizData.description || ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"category: quizData.category || ''","message":"Definition for rule 'category: quizData.category || ''' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"difficulty: quizData.difficulty || 'medium'","message":"Definition for rule 'difficulty: quizData.difficulty || 'medium'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"status: quizData.status || 'pending'        });      } else {        toast.error('Kh√¥ng t√¨m th·∫•y quiz n√†y');        navigate('/admin');      }    } catch (error) {      console.error('Error loading quiz:'","message":"Definition for rule 'status: quizData.status || 'pending'        });      } else {        toast.error('Kh√¥ng t√¨m th·∫•y quiz n√†y');        navigate('/admin');      }    } catch (error) {      console.error('Error loading quiz:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"error);      toast.error('L·ªói khi t·∫£i quiz');      navigate('/admin');    } finally {      setLoading(false);    }  }","message":"Definition for rule 'error);      toast.error('L·ªói khi t·∫£i quiz');      navigate('/admin');    } finally {      setLoading(false);    }  }' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"[id","message":"Definition for rule '[id' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"navigate]);  useEffect(() => {    if (id) {      loadQuiz();    }  }","message":"Definition for rule 'navigate]);  useEffect(() => {    if (id) {      loadQuiz();    }  }' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"loadQuiz]);  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();    if (!id || !quiz) return;    setSaving(true);    try {      const updatedQuiz = {        ...quiz","message":"Definition for rule 'loadQuiz]);  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();    if (!id || !quiz) return;    setSaving(true);    try {      const updatedQuiz = {        ...quiz' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"...formData","message":"Definition for rule '...formData' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"updatedAt: new Date()      };      await updateQuiz(id","message":"Definition for rule 'updatedAt: new Date()      };      await updateQuiz(id' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"updatedQuiz);      toast.success('C·∫≠p nh·∫≠t quiz th√†nh c√¥ng!');      navigate('/admin');    } catch (error) {      console.error('Error updating quiz:'","message":"Definition for rule 'updatedQuiz);      toast.success('C·∫≠p nh·∫≠t quiz th√†nh c√¥ng!');      navigate('/admin');    } catch (error) {      console.error('Error updating quiz:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"error);      toast.error('L·ªói khi c·∫≠p nh·∫≠t quiz');    } finally {      setSaving(false);    }  };  const handleInputChange = (field: string","message":"Definition for rule 'error);      toast.error('L·ªói khi c·∫≠p nh·∫≠t quiz');    } finally {      setSaving(false);    }  };  const handleInputChange = (field: string' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"value: string) => {    setFormData(prev => ({      ...prev","message":"Definition for rule 'value: string) => {    setFormData(prev => ({      ...prev' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"[field]: value    }));  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">ƒêang t·∫£i quiz...</span>          </div>        </div>      </div>    );  }  if (!quiz) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"text-center py-12\">            <p className=\"text-gray-500\">{t(\"quizList.empty.noQuizFound\")}</p>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-4xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <button            onClick={() => navigate('/admin')}            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            // eslint-disable-next-line i18next/no-literal-string            <ArrowLeft className=\"w-4 h-4 mr-2\" />            Quay l·∫°i Admin          </button>                    <div className=\"bg-white rounded-lg p-6 shadow-sm\">            // eslint-disable-next-line i18next/no-literal-string            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">              ‚úèÔ∏è Ch·ªânh s·ª≠a Quiz            </h1>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600\">              ID: <code className=\"bg-gray-100 px-2 py-1 rounded\">{id}</code>            </p>          </div>        </div>        {/* Edit Form */}        <div className=\"bg-white rounded-lg shadow-sm\">          <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">            {/* Title */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                Ti√™u ƒë·ªÅ Quiz              </label>              <input                type=\"text\"                value={formData.title}                onChange={(e) => handleInputChange('title'","message":"Definition for rule '[field]: value    }));  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">ƒêang t·∫£i quiz...</span>          </div>        </div>      </div>    );  }  if (!quiz) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"text-center py-12\">            <p className=\"text-gray-500\">{t(\"quizList.empty.noQuizFound\")}</p>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-4xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <button            onClick={() => navigate('/admin')}            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            // eslint-disable-next-line i18next/no-literal-string            <ArrowLeft className=\"w-4 h-4 mr-2\" />            Quay l·∫°i Admin          </button>                    <div className=\"bg-white rounded-lg p-6 shadow-sm\">            // eslint-disable-next-line i18next/no-literal-string            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">              ‚úèÔ∏è Ch·ªânh s·ª≠a Quiz            </h1>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600\">              ID: <code className=\"bg-gray-100 px-2 py-1 rounded\">{id}</code>            </p>          </div>        </div>        {/* Edit Form */}        <div className=\"bg-white rounded-lg shadow-sm\">          <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">            {/* Title */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                Ti√™u ƒë·ªÅ Quiz              </label>              <input                type=\"text\"                value={formData.title}                onChange={(e) => handleInputChange('title'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Description */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.description\")}              </label>              <textarea                value={formData.description}                onChange={(e) => handleInputChange('description'","message":"Definition for rule 'e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Description */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.description\")}              </label>              <textarea                value={formData.description}                onChange={(e) => handleInputChange('description'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}                rows={4}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Category */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.category\")}              </label>              <input                type=\"text\"                value={formData.category}                onChange={(e) => handleInputChange('category'","message":"Definition for rule 'e.target.value)}                rows={4}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Category */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.category\")}              </label>              <input                type=\"text\"                value={formData.category}                onChange={(e) => handleInputChange('category'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Difficulty */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.difficulty\")}              </label>              <select                value={formData.difficulty}                onChange={(e) => handleInputChange('difficulty'","message":"Definition for rule 'e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Difficulty */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.difficulty\")}              </label>              <select                value={formData.difficulty}                onChange={(e) => handleInputChange('difficulty'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"easy\">{t(\"difficulty.easy\")}</option>                <option value=\"medium\">{t(\"difficulty.medium\")}</option>                <option value=\"hard\">{t(\"difficulty.hard\")}</option>              </select>            </div>            {/* Status */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.status\")}              </label>              <select                value={formData.status}                onChange={(e) => handleInputChange('status'","message":"Definition for rule 'e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"easy\">{t(\"difficulty.easy\")}</option>                <option value=\"medium\">{t(\"difficulty.medium\")}</option>                <option value=\"hard\">{t(\"difficulty.hard\")}</option>              </select>            </div>            {/* Status */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.status\")}              </label>              <select                value={formData.status}                onChange={(e) => handleInputChange('status'' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null},{"ruleId":"e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"pending\">{t(\"admin.quizManagement.filter.pending\")}</option>                <option value=\"approved\">{t(\"admin.quizManagement.filter.approved\")}</option>                <option value=\"rejected\">{t(\"status.rejected\")}</option>              </select>            </div>            {/* Actions */}            <div className=\"flex items-center justify-between pt-6 border-t border-gray-200\">              <button                type=\"button\"                onClick={() => navigate('/admin')}                className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200\"              >{t(\"common.cancel\")}              </button>                            <button                type=\"submit\"                disabled={saving}                className=\"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50\"              >                {saving ? (                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />                ) : (                  <Save className=\"w-4 h-4 mr-2\" />                )}                {saving ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi'}              </button>            </div>          </form>        </div>        {/* Quiz Info */}        <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">          // eslint-disable-next-line i18next/no-literal-string          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä Th√¥ng tin Quiz</h3>                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">            <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">S·ªë c√¢u h·ªèi:</span>              <span className=\"ml-2 text-gray-600\">{quiz.questions?.length || 0}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng∆∞·ªùi t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">{quiz.createdBy || 'N/A'}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng√†y t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.createdAt ? new Date(quiz.createdAt).toLocaleDateString('vi-VN') : 'N/A'}              </span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">L·∫ßn s·ª≠a cu·ªëi:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.updatedAt ? new Date(quiz.updatedAt).toLocaleDateString('vi-VN') : 'Ch∆∞a s·ª≠a'}              </span>            </div>          </div>        </div>      </div>    </div>  );};export default EditQuizPage;","message":"Definition for rule 'e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"pending\">{t(\"admin.quizManagement.filter.pending\")}</option>                <option value=\"approved\">{t(\"admin.quizManagement.filter.approved\")}</option>                <option value=\"rejected\">{t(\"status.rejected\")}</option>              </select>            </div>            {/* Actions */}            <div className=\"flex items-center justify-between pt-6 border-t border-gray-200\">              <button                type=\"button\"                onClick={() => navigate('/admin')}                className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200\"              >{t(\"common.cancel\")}              </button>                            <button                type=\"submit\"                disabled={saving}                className=\"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50\"              >                {saving ? (                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />                ) : (                  <Save className=\"w-4 h-4 mr-2\" />                )}                {saving ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi'}              </button>            </div>          </form>        </div>        {/* Quiz Info */}        <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">          // eslint-disable-next-line i18next/no-literal-string          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä Th√¥ng tin Quiz</h3>                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">            <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">S·ªë c√¢u h·ªèi:</span>              <span className=\"ml-2 text-gray-600\">{quiz.questions?.length || 0}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng∆∞·ªùi t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">{quiz.createdBy || 'N/A'}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng√†y t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.createdAt ? new Date(quiz.createdAt).toLocaleDateString('vi-VN') : 'N/A'}              </span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">L·∫ßn s·ª≠a cu·ªëi:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.updatedAt ? new Date(quiz.updatedAt).toLocaleDateString('vi-VN') : 'Ch∆∞a s·ª≠a'}              </span>            </div>          </div>        </div>      </div>    </div>  );};export default EditQuizPage;' was not found.","line":1,"column":1,"endLine":1,"endColumn":9929,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":34,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState, useEffect, useCallback } from 'react';import { useParams, useNavigate } from 'react-router-dom';import { getQuizById } from '../api';import { updateQuiz } from '../api';import { Quiz } from '../types';import { toast } from 'react-toastify';import { ArrowLeft, Save, Loader2 } from 'lucide-react';import { useTranslation } from 'react-i18next';const EditQuizPage: React.FC = () => {  const { t } = useTranslation();  const { id } = useParams<{ id: string }>();  const navigate = useNavigate();  const [quiz, setQuiz] = useState<Quiz | null>(null);  const [loading, setLoading] = useState(true);  const [saving, setSaving] = useState(false);  const [formData, setFormData] = useState({    title: '',    description: '',    category: '',    difficulty: 'medium' as 'easy' | 'medium' | 'hard',    status: 'pending' as 'pending' | 'approved' | 'rejected' | 'draft'  });  const loadQuiz = useCallback(async () => {    if (!id) return;        setLoading(true);    try {      const quizData = await getQuizById(id);      if (quizData) {        setQuiz(quizData);        setFormData({          title: quizData.title || '',          description: quizData.description || '',          category: quizData.category || '',          difficulty: quizData.difficulty || 'medium',          status: quizData.status || 'pending'        });      } else {        toast.error('Kh√¥ng t√¨m th·∫•y quiz n√†y');        navigate('/admin');      }    } catch (error) {      console.error('Error loading quiz:', error);      toast.error('L·ªói khi t·∫£i quiz');      navigate('/admin');    } finally {      setLoading(false);    }  }, [id, navigate]);  useEffect(() => {    if (id) {      loadQuiz();    }  }, [id, loadQuiz]);  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();    if (!id || !quiz) return;    setSaving(true);    try {      const updatedQuiz = {        ...quiz,        ...formData,        updatedAt: new Date()      };      await updateQuiz(id, updatedQuiz);      toast.success('C·∫≠p nh·∫≠t quiz th√†nh c√¥ng!');      navigate('/admin');    } catch (error) {      console.error('Error updating quiz:', error);      toast.error('L·ªói khi c·∫≠p nh·∫≠t quiz');    } finally {      setSaving(false);    }  };  const handleInputChange = (field: string, value: string) => {    setFormData(prev => ({      ...prev,      [field]: value    }));  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">ƒêang t·∫£i quiz...</span>          </div>        </div>      </div>    );  }  if (!quiz) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"text-center py-12\">            <p className=\"text-gray-500\">{t(\"quizList.empty.noQuizFound\")}</p>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-4xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <button            onClick={() => navigate('/admin')}            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            // eslint-disable-next-line i18next/no-literal-string            <ArrowLeft className=\"w-4 h-4 mr-2\" />            Quay l·∫°i Admin          </button>                    <div className=\"bg-white rounded-lg p-6 shadow-sm\">            // eslint-disable-next-line i18next/no-literal-string            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">              ‚úèÔ∏è Ch·ªânh s·ª≠a Quiz            </h1>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600\">              ID: <code className=\"bg-gray-100 px-2 py-1 rounded\">{id}</code>            </p>          </div>        </div>        {/* Edit Form */}        <div className=\"bg-white rounded-lg shadow-sm\">          <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">            {/* Title */}            <div>              // eslint-disable-next-line i18next/no-literal-string              <label className=\"block text-sm font-medium text-gray-700 mb-2\">                Ti√™u ƒë·ªÅ Quiz              </label>              <input                type=\"text\"                value={formData.title}                onChange={(e) => handleInputChange('title', e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Description */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.description\")}              </label>              <textarea                value={formData.description}                onChange={(e) => handleInputChange('description', e.target.value)}                rows={4}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Category */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.category\")}              </label>              <input                type=\"text\"                value={formData.category}                onChange={(e) => handleInputChange('category', e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"                required              />            </div>            {/* Difficulty */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.difficulty\")}              </label>              <select                value={formData.difficulty}                onChange={(e) => handleInputChange('difficulty', e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"easy\">{t(\"difficulty.easy\")}</option>                <option value=\"medium\">{t(\"difficulty.medium\")}</option>                <option value=\"hard\">{t(\"difficulty.hard\")}</option>              </select>            </div>            {/* Status */}            <div>              <label className=\"block text-sm font-medium text-gray-700 mb-2\">{t(\"admin.preview.status\")}              </label>              <select                value={formData.status}                onChange={(e) => handleInputChange('status', e.target.value)}                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"              >                <option value=\"pending\">{t(\"admin.quizManagement.filter.pending\")}</option>                <option value=\"approved\">{t(\"admin.quizManagement.filter.approved\")}</option>                <option value=\"rejected\">{t(\"status.rejected\")}</option>              </select>            </div>            {/* Actions */}            <div className=\"flex items-center justify-between pt-6 border-t border-gray-200\">              <button                type=\"button\"                onClick={() => navigate('/admin')}                className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200\"              >{t(\"common.cancel\")}              </button>                            <button                type=\"submit\"                disabled={saving}                className=\"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50\"              >                {saving ? (                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />                ) : (                  <Save className=\"w-4 h-4 mr-2\" />                )}                {saving ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi'}              </button>            </div>          </form>        </div>        {/* Quiz Info */}        <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">          // eslint-disable-next-line i18next/no-literal-string          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä Th√¥ng tin Quiz</h3>                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">            <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">S·ªë c√¢u h·ªèi:</span>              <span className=\"ml-2 text-gray-600\">{quiz.questions?.length || 0}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng∆∞·ªùi t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">{quiz.createdBy || 'N/A'}</span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">Ng√†y t·∫°o:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.createdAt ? new Date(quiz.createdAt).toLocaleDateString('vi-VN') : 'N/A'}              </span>            </div>                        <div>              // eslint-disable-next-line i18next/no-literal-string              <span className=\"font-medium text-gray-700\">L·∫ßn s·ª≠a cu·ªëi:</span>              <span className=\"ml-2 text-gray-600\">                {quiz.updatedAt ? new Date(quiz.updatedAt).toLocaleDateString('vi-VN') : 'Ch∆∞a s·ª≠a'}              </span>            </div>          </div>        </div>      </div>    </div>  );};export default EditQuizPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\EditQuizPageAdvanced.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useParams' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useNavigate' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":85,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":96},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getQuizById' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":132,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":143},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateQuiz' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":145,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":155},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Quiz' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":181,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":185},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Question' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":187,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":195},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'QuestionEditor' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":223,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":237},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":285,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":290},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":326,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":335},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Save' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":337,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":341},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":343,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":350},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":352,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":356},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":360,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":368},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Target' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":370,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":376},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":378,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":391},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":393,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":404},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":407,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":415},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":417,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":420},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":422,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":426},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":428,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":433},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'db' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":464,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":466},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'addDoc' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":510,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":516},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'collection' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":518,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":528},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'serverTimestamp' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":530,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":545},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSelector' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":583,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":594},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RootState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":625,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":634},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslation' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":672,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":686}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":31,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { useParams, useNavigate } from 'react-router-dom';import { getQuizById, updateQuiz } from '../api';import { Quiz, Question } from '../types';import { QuestionEditor } from '../components/QuestionEditor';import { toast } from 'react-toastify';import {   ArrowLeft, Save, Loader2, Plus,   BookOpen, Target, MessageSquare, AlertCircle,  FileText, Tag, Star, Clock} from 'lucide-react';import { db } from '../../../firebase/config';import { addDoc, collection, serverTimestamp } from 'firebase/firestore';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { useTranslation } from 'react-i18next';// Import categories and difficulties from CreateQuizPageconst categories = [  { value: 'general', label: '' },  { value: 'science', label: '' },  { value: 'history', label: '' },  { value: 'geography', label: '' },  { value: 'literature', label: '' },  { value: 'math', label: '' },  { value: 'technology', label: '' },  { value: 'sports', label: '' },  { value: 'entertainment', label: '' },  { value: 'food', label: '' }];const difficulties = [  { value: 'easy', label: '', color: 'bg-green-100 text-green-800' },  { value: 'medium', label: '', color: 'bg-yellow-100 text-yellow-800' },  { value: 'hard', label: '', color: 'bg-red-100 text-red-800' }];const EditQuizPageAdvanced: React.FC = () => {  const { t } = useTranslation();  const { id } = useParams<{ id: string }>();  const navigate = useNavigate();  const { user } = useSelector((state: RootState) => state.auth);  const [quiz, setQuiz] = useState<Quiz | null>(null);  const [loading, setLoading] = useState(true);  const [saving, setSaving] = useState(false);  const [activeTab, setActiveTab] = useState<'info' | 'questions' | 'settings'>('info');  const [editingQuestionId, setEditingQuestionId] = useState<string | null>(null);  const [quizInfo, setQuizInfo] = useState({    title: '',    description: '',    category: '',    difficulty: 'medium' as 'easy' | 'medium' | 'hard',    status: 'pending' as 'pending' | 'approved' | 'rejected' | 'draft',    timeLimit: 30,    passingScore: 70,    tags: [] as string[],    isPublished: false  });  const [questions, setQuestions] = useState<Question[]>([]);  const loadQuiz = useCallback(async () => {    if (!id) return;        setLoading(true);    try {      const quizData = await getQuizById(id);      if (quizData) {        setQuiz(quizData);        setQuizInfo({          title: quizData.title || '',          description: quizData.description || '',          category: quizData.category || '',          difficulty: quizData.difficulty || 'medium',          status: quizData.status || 'pending',          timeLimit: quizData.duration || 30,          passingScore: 70,          tags: quizData.tags || [],          isPublished: quizData.isPublished || false        });        setQuestions(quizData.questions || []);      } else {        toast.error(t('editQuiz.notFound'));        navigate('/admin/stats-test');      }    } catch (error) {      console.error('Error loading quiz:', error);      toast.error(t('editQuiz.loadFailed'));    } finally {      setLoading(false);    }  }, [id, t, navigate]);  useEffect(() => {    if (id) loadQuiz();  }, [id, loadQuiz]);  const handleSave = async () => {    if (!id || !quiz) return;    if (!quizInfo.title.trim()) {      toast.error(t('editQuiz.titleRequired'));      return;    }    if (questions.length === 0) {      toast.error(t('editQuiz.questionRequired'));      return;    }    setSaving(true);    try {      const updatedQuiz: Quiz = {        ...quiz,        ...quizInfo,        duration: quizInfo.timeLimit,        questions,        updatedAt: new Date()      };      // ‚úÖ HANDLE RESUBMISSION AFTER EDIT APPROVAL      if (quiz.needsReApproval) {        // Quiz was edited after admin approval, resubmit for approval        updatedQuiz.status = 'pending';        updatedQuiz.canEdit = false;        updatedQuiz.isApproved = false;        updatedQuiz.needsReApproval = false;        updatedQuiz.resubmittedAt = new Date();                // Create notification for admin about resubmission        await addDoc(collection(db, 'notifications'), {          userId: 'admin', // Or get actual admin IDs          type: 'quiz_resubmitted',          title: t('editQuiz.notifications.resubmitted'),          message: t('editQuiz.notifications.resubmittedMessage', { title: updatedQuiz.title }),          quizId: id,          createdBy: user?.uid,          createdByName: user?.displayName || user?.email,          createdAt: serverTimestamp(),          read: false        });                toast.success(t('editQuiz.resubmitSuccess'));      } else {        toast.success(t('editQuiz.updateSuccess'));      }      await updateQuiz(id, updatedQuiz);      navigate('/admin/stats-test');    } catch (error) {      console.error('Error updating quiz:', error);      toast.error(t('editQuiz.updateFailed'));    } finally {      setSaving(false);    }  };  const addQuestion = () => {    const newQuestion: Question = {      id: `q_${Date.now()}`,      text: '',      type: 'multiple',      answers: [        { id: 'a1', text: '', isCorrect: true },        { id: 'a2', text: '', isCorrect: false },        { id: 'a3', text: '', isCorrect: false },        { id: 'a4', text: '', isCorrect: false }      ],      explanation: '',      points: 10,      difficulty: 'medium'    };    setQuestions([...questions, newQuestion]);    setEditingQuestionId(newQuestion.id);  };  const deleteQuestion = (questionId: string) => {    if (window.confirm(t('editQuiz.confirmDeleteQuestion'))) {      setQuestions(questions.filter(q => q.id !== questionId));      if (editingQuestionId === questionId) {        setEditingQuestionId(null);      }    }  };  const updateQuestion = (questionId: string, updatedQuestion: Partial<Question>) => {    setQuestions(questions.map(q =>       q.id === questionId ? { ...q, ...updatedQuestion } : q    ));  };  const moveQuestion = (index: number, direction: 'up' | 'down') => {    const newQuestions = [...questions];    const targetIndex = direction === 'up' ? index - 1 : index + 1;        if (targetIndex >= 0 && targetIndex < newQuestions.length) {      [newQuestions[index], newQuestions[targetIndex]] = [newQuestions[targetIndex], newQuestions[index]];      setQuestions(newQuestions);    }  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mx-auto\" />          <p className=\"mt-4 text-gray-600\">{t('editQuiz.loading')}</p>        </div>      </div>    );  }  if (!quiz) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          <AlertCircle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />          <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('editQuiz.notFoundTitle')}</h2>          <p className=\"text-gray-600 mb-6\">{t('editQuiz.notFoundDesc')}</p>          <button            onClick={() => navigate('/admin/stats-test')}            className=\"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors\"          >            {t('editQuiz.backToAdmin')}          </button>        </div>      </div>    );  }  const tabs = [    { id: 'info', label: t('editQuiz.tabs.info'), icon: BookOpen },    { id: 'questions', label: t('editQuiz.tabs.questions'), icon: MessageSquare, count: questions.length },    { id: 'settings', label: t('editQuiz.tabs.settings'), icon: Target }  ];  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">      <div className=\"max-w-7xl mx-auto px-4 py-8\">        {/* Header */}        <div className=\"flex items-center justify-between mb-8\">          <div className=\"flex items-center gap-4\">            <button              onClick={() => navigate('/admin/stats-test')}              className=\"p-3 text-gray-600 hover:text-gray-900 hover:bg-white rounded-2xl transition-all shadow-sm\"            >              <ArrowLeft className=\"w-6 h-6\" />            </button>            <div>              <h1 className=\"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">                {t('editQuiz.title')}              </h1>              <p className=\"text-gray-600 text-lg\">{t('editQuiz.subtitle')}</p>            </div>          </div>          <button            onClick={handleSave}            disabled={saving}            className=\"flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg disabled:opacity-50 font-semibold\"          >            {saving ? (              <Loader2 className=\"w-6 h-6 animate-spin\" />            ) : (              <Save className=\"w-6 h-6\" />            )}            {saving ? t('editQuiz.buttons.saving') : t('editQuiz.buttons.save')}          </button>        </div>        {/* Tabs */}        <div className=\"mb-8\">          <nav className=\"flex space-x-2 bg-white/80 backdrop-blur-sm rounded-3xl p-2 shadow-lg border border-white/20\">            {tabs.map((tab) => {              const Icon = tab.icon;              return (                <button                  key={tab.id}                  onClick={() => setActiveTab(tab.id as any)}                  className={`flex items-center gap-3 px-8 py-4 rounded-2xl font-semibold transition-all ${                    activeTab === tab.id                      ? 'bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg'                      : 'text-gray-600 hover:text-gray-900 hover:bg-white/60'                  }`}                >                  <Icon className=\"w-6 h-6\" />                  {tab.label}                  {'count' in tab && tab.count !== undefined && (                    <span className={`px-3 py-1 text-sm rounded-full font-bold ${                      activeTab === tab.id ? 'bg-white text-blue-600' : 'bg-blue-100 text-blue-600'                    }`}>                      {tab.count}                    </span>                  )}                </button>              );            })}          </nav>        </div>        {/* Tab Content */}        <div>          {activeTab === 'info' && (            <div className=\"bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl p-8 border border-white/20\">              <div className=\"space-y-8\">                {/* Header */}                <div className=\"text-center space-y-2\">                  <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto\">                    <BookOpen className=\"w-8 h-8 text-white\" />                  </div>                  <h2 className=\"text-2xl font-bold text-gray-900\">{t(\"createQuiz.info.basicInfo\")}</h2>                  // eslint-disable-next-line i18next/no-literal-string                  <p className=\"text-gray-600\">Ch·ªânh s·ª≠a th√¥ng tin quiz c·ªßa b·∫°n</p>                </div>                {/* Form */}                <div className=\"space-y-6\">                  {/* Title */}                  <div className=\"space-y-2\">                    <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                      <FileText className=\"w-4 h-4\" />{t(\"createQuiz.info.titleLabel\")}                    </label>                    <input                      className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-lg\"                      placeholder={t(\"createQuiz.info.titlePlaceholder\")}                      value={quizInfo.title}                      onChange={(e) => setQuizInfo({ ...quizInfo, title: e.target.value })}                    />                  </div>                  {/* Description */}                  <div className=\"space-y-2\">                    <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                      // eslint-disable-next-line i18next/no-literal-string                      <FileText className=\"w-4 h-4\" />                      M√¥ t·∫£ quiz *                    </label>                    <textarea                      className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none\"                      placeholder={t('placeholders.quizDescription')}                      rows={4}                      value={quizInfo.description}                      onChange={(e) => setQuizInfo({ ...quizInfo, description: e.target.value })}                    />                  </div>                  {/* Category & Difficulty */}                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">                    <div className=\"space-y-2\">                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                        <Tag className=\"w-4 h-4\" />{t(\"createQuiz.info.categoryLabel\")}                      </label>                      <select                        className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                        value={quizInfo.category}                        onChange={(e) => setQuizInfo({ ...quizInfo, category: e.target.value })}                      >                        <option value=\"\">{t(\"createQuiz.info.categoryPlaceholder\")}</option>                        {categories.map(c => (                          <option key={c.value} value={c.value}>{c.label}</option>                        ))}                      </select>                    </div>                    <div className=\"space-y-2\">                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                        <Star className=\"w-4 h-4\" />{t(\"createQuiz.info.difficultyLabel\")}                      </label>                      <select                        className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                        value={quizInfo.difficulty}                        onChange={(e) => setQuizInfo({ ...quizInfo, difficulty: e.target.value as any })}                      >                        {difficulties.map(d => (                          <option key={d.value} value={d.value}>{d.label}</option>                        ))}                      </select>                    </div>                  </div>                  {/* Time Limit & Status */}                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">                    <div className=\"space-y-2\">                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                        <Clock className=\"w-4 h-4\" />                        {t('quizCreation.timeMinutes')}                      </label>                      <input                        type=\"number\"                        min=\"1\"                        max=\"180\"                        className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                        value={quizInfo.timeLimit}                        onChange={(e) => setQuizInfo({ ...quizInfo, timeLimit: parseInt(e.target.value) || 30 })}                      />                    </div>                    <div className=\"space-y-2\">                      <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700\">                        <Target className=\"w-4 h-4\" />{t(\"admin.preview.status\")}                      </label>                      <select                        className=\"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                        value={quizInfo.status}                        onChange={(e) => setQuizInfo({ ...quizInfo, status: e.target.value as any })}                      >                        <option value=\"pending\">{t('quizCreation.pending')}</option>                        <option value=\"approved\">{t('quizCreation.approved')}</option>                        <option value=\"rejected\">{t('quizCreation.rejected')}</option>                      </select>                    </div>                  </div>                </div>              </div>            </div>          )}          {activeTab === 'questions' && (            <div className=\"space-y-8\">              <div className=\"bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl p-8 border border-white/20\">                <div className=\"flex items-center justify-between\">                  // eslint-disable-next-line i18next/no-literal-string                  <h2 className=\"text-3xl font-bold text-gray-900\">Questions ({questions.length})</h2>                  <button                    onClick={addQuestion}                    className=\"flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-2xl hover:from-green-700 hover:to-emerald-700 transition-all shadow-lg font-semibold\"                  >                    // eslint-disable-next-line i18next/no-literal-string                    <Plus className=\"w-6 h-6\" />                    Add Question                  </button>                </div>                {questions.length === 0 && (                  <div className=\"text-center py-16\">                    <MessageSquare className=\"w-20 h-20 text-gray-300 mx-auto mb-6\" />                    // eslint-disable-next-line i18next/no-literal-string                    <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">No Questions Yet</h3>                    // eslint-disable-next-line i18next/no-literal-string                    <p className=\"text-gray-600 mb-8 text-lg\">Start building your quiz by adding questions.</p>                    <button                      onClick={addQuestion}                      className=\"px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all font-semibold\"                    // eslint-disable-next-line i18next/no-literal-string                    >                      Add First Question                    </button>                  </div>                )}              </div>              {questions.map((question, index) => (                <QuestionEditor                  key={question.id}                  question={question}                  index={index}                  isEditing={editingQuestionId === question.id}                  onEdit={setEditingQuestionId}                  onUpdate={updateQuestion}                  onDelete={deleteQuestion}                  onMove={moveQuestion}                  totalQuestions={questions.length}                />              ))}            </div>          )}          {activeTab === 'settings' && (            <div className=\"bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl p-8 border border-white/20\">              // eslint-disable-next-line i18next/no-literal-string              <h2 className=\"text-3xl font-bold text-gray-900 mb-8\">Quiz Settings</h2>              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">                <div className=\"space-y-2\">                  // eslint-disable-next-line i18next/no-literal-string                  <label className=\"block text-sm font-semibold text-gray-700\">Time Limit (minutes)</label>                  <input                    type=\"number\"                    value={quizInfo.timeLimit}                    onChange={(e) => setQuizInfo({ ...quizInfo, timeLimit: parseInt(e.target.value) || 30 })}                    min=\"1\"                    max=\"180\"                    className=\"w-full p-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                  />                </div>                <div className=\"space-y-2\">                  // eslint-disable-next-line i18next/no-literal-string                  <label className=\"block text-sm font-semibold text-gray-700\">Passing Score (%)</label>                  <input                    type=\"number\"                    value={quizInfo.passingScore}                    onChange={(e) => setQuizInfo({ ...quizInfo, passingScore: parseInt(e.target.value) || 70 })}                    min=\"0\"                    max=\"100\"                    className=\"w-full p-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"                  />                </div>              </div>              <div className=\"mt-8\">                <label className=\"flex items-center gap-4\">                  <input                    type=\"checkbox\"                    checked={quizInfo.isPublished}                    onChange={(e) => setQuizInfo({ ...quizInfo, isPublished: e.target.checked })}                    className=\"w-6 h-6 text-blue-600 rounded-lg focus:ring-blue-500\"                  />                  <span className=\"text-lg font-semibold text-gray-700\">{t('quizCreation.published')}</span>                </label>              </div>            </div>          )}        </div>      </div>    </div>  );};export default EditQuizPageAdvanced;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\FavoritesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":24,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1103,1106],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1103,1106],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { RootState } from '../../../lib/store';\r\nimport { doc, getDoc } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport QuizList from './QuizList';\r\nimport { Quiz } from '../types';\r\nimport { fetchQuizzes } from '../store';\r\n\r\nconst FavoritesPage: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const user = useSelector((state: RootState) => state.auth.user);\r\n  const allQuizzes = useSelector((state: RootState) => state.quiz.quizzes);\r\n  const quizLoading = useSelector((state: RootState) => state.quiz.loading || state.quiz.isLoading);\r\n  const dispatch = useDispatch();\r\n  const [favoriteQuizzes, setFavoriteQuizzes] = useState<Quiz[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    if (allQuizzes.length === 0 && !quizLoading) {\r\n      dispatch(fetchQuizzes({ user }) as any)\r\n        .unwrap()\r\n        .catch(() => {\r\n          setError(t('favorites.loadError'));\r\n          setLoading(false);\r\n        });\r\n      return;\r\n    }\r\n    const fetchFavorites = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const favRef = doc(db, 'user_favorites', user.uid);\r\n        const favSnap = await getDoc(favRef);\r\n        if (favSnap.exists()) {\r\n          const quizIds = favSnap.data().quizIds || [];\r\n          setFavoriteQuizzes(allQuizzes.filter(q => quizIds.includes(q.id)));\r\n        } else {\r\n          setFavoriteQuizzes([]);\r\n        }\r\n        setError(null);\r\n      } catch (e) {\r\n        setError(t('favorites.fetchError'));\r\n      }\r\n      setLoading(false);\r\n    };\r\n    fetchFavorites();\r\n  }, [user, allQuizzes, quizLoading, dispatch, t]);\r\n\r\n  if (!user) return <div className=\"p-8 text-center\">{t('favorites.loginRequired')}</div>;\r\n  if (error) return <div className=\"p-8 text-center text-red-600\">{error}</div>;\r\n  if (loading || quizLoading) return <div className=\"p-8 text-center\">{t('loading')}</div>;\r\n\r\n  return <QuizList quizzes={favoriteQuizzes} title={t('favorites.title')} />;\r\n};\r\n\r\nexport default FavoritesPage; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\LeaderboardPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":332,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":332,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12709,12712],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12709,12712],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { collection, getDocs, query, orderBy, where } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { FaCrown, FaUserCircle, FaTrophy, FaMedal, FaAward, FaFire, FaStar } from 'react-icons/fa';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../lib/store';\r\n\r\ninterface UserStat {\r\n  userId: string;\r\n  displayName: string;\r\n  email?: string;\r\n  totalScore: number;\r\n  totalAttempts: number;\r\n  averageScore: number;\r\n  perfectScores: number;\r\n  recentActivity: string;\r\n  badge: string;\r\n  rank?: number;\r\n}\r\n\r\ninterface QuizStat {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  category: string;\r\n  difficulty: string;\r\n  totalAttempts: number;\r\n  averageScore: number;\r\n  totalCompletions: number;\r\n  createdBy?: string;\r\n  isPublished: boolean;\r\n  recentActivity: string;\r\n}\r\n\r\ninterface OverallStats {\r\n  totalUsers: number;\r\n  totalQuizzes: number;\r\n  totalAttempts: number;\r\n  averageScore: number;\r\n  activeToday: number;\r\n  perfectScoresCount: number;\r\n}\r\n\r\nconst LeaderboardPage: React.FC = () => {\r\n  // Safe translation hook with error handling\r\n  const { t, ready } = useTranslation();\r\n  \r\n  const [topUsers, setTopUsers] = useState<UserStat[]>([]);\r\n  const [topQuizzes, setTopQuizzes] = useState<QuizStat[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [stats, setStats] = useState<OverallStats | null>(null);\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n  const [timeFilter, setTimeFilter] = useState<'all' | 'week' | 'month'>('all');\r\n  const [search, setSearch] = useState('');\r\n  const [currentUserRank, setCurrentUserRank] = useState<number | null>(null);\r\n  \r\n  // Pagination states\r\n  const [showAllUsers, setShowAllUsers] = useState(false);\r\n  const [showAllQuizzes, setShowAllQuizzes] = useState(false);\r\n\r\n  // Calculate comprehensive leaderboard data - Move before conditional return\r\n  useEffect(() => {\r\n    if (!ready) return; // Skip if i18n not ready\r\n    \r\n    const fetchLeaderboardData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        console.log('üèÜ Fetching leaderboard data...');\r\n        \r\n        // Get all quiz results\r\n        const resultsQuery = query(collection(db, 'quizResults'), orderBy('completedAt', 'desc'));\r\n        const resultsSnapshot = await getDocs(resultsQuery);\r\n        \r\n        // Get all quizzes\r\n        const quizzesQuery = query(collection(db, 'quizzes'), where('isPublished', '==', true));\r\n        const quizzesSnapshot = await getDocs(quizzesQuery);\r\n        \r\n        // Get all users\r\n        const usersQuery = query(collection(db, 'users'));\r\n        const usersSnapshot = await getDocs(usersQuery);\r\n        \r\n        console.log('üìä Found:', {\r\n          results: resultsSnapshot.size,\r\n          quizzes: quizzesSnapshot.size,\r\n          users: usersSnapshot.size\r\n        });\r\n\r\n        // Process users data\r\n        const usersMap = new Map();\r\n        usersSnapshot.forEach(doc => {\r\n          const userData = doc.data();\r\n          usersMap.set(doc.id, {\r\n            id: doc.id,\r\n            displayName: userData.displayName || userData.email?.split('@')[0] || t('leaderboard.anonymous'),\r\n            email: userData.email,\r\n            ...userData\r\n          });\r\n        });\r\n\r\n        // Process quizzes data\r\n        const quizzesMap = new Map();\r\n        quizzesSnapshot.forEach(doc => {\r\n          const quizData = doc.data();\r\n          quizzesMap.set(doc.id, {\r\n            id: doc.id,\r\n            title: quizData.title || t('leaderboard.untitledQuiz'),\r\n            description: quizData.description || '',\r\n            category: quizData.category || 'general',\r\n            difficulty: quizData.difficulty || 'medium',\r\n            createdBy: quizData.createdBy,\r\n            isPublished: quizData.isPublished,\r\n            ...quizData\r\n          });\r\n        });\r\n\r\n        // Calculate user statistics\r\n        const userStats = new Map<string, UserStat>();\r\n        const quizStats = new Map<string, QuizStat>();\r\n        let totalScore = 0;\r\n        let totalAttempts = 0;\r\n        let perfectScoresCount = 0;\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n\r\n        resultsSnapshot.forEach(doc => {\r\n          const result = doc.data();\r\n          const completedAt = result.completedAt?.toDate?.() || new Date(result.completedAt);\r\n          \r\n          // User statistics\r\n          const userId = result.userId;\r\n          if (!userStats.has(userId)) {\r\n            const userData = usersMap.get(userId) || {};\r\n            userStats.set(userId, {\r\n              userId,\r\n              displayName: userData.displayName || result.userName || t('leaderboard.anonymous'),\r\n              email: userData.email || result.userEmail,\r\n              totalScore: 0,\r\n              totalAttempts: 0,\r\n              averageScore: 0,\r\n              perfectScores: 0,\r\n              recentActivity: completedAt.toLocaleDateString('vi-VN'),\r\n              badge: 'beginner'\r\n            });\r\n          }\r\n\r\n          const userStat = userStats.get(userId)!;\r\n          userStat.totalAttempts++;\r\n          userStat.totalScore += result.score || 0;\r\n          \r\n          if (result.score === 100) {\r\n            userStat.perfectScores++;\r\n            perfectScoresCount++;\r\n          }\r\n          \r\n          if (completedAt > new Date(userStat.recentActivity)) {\r\n            userStat.recentActivity = completedAt.toLocaleDateString('vi-VN');\r\n          }\r\n\r\n          // Quiz statistics\r\n          const quizId = result.quizId;\r\n          if (!quizStats.has(quizId)) {\r\n            const quizData = quizzesMap.get(quizId) || {};\r\n            quizStats.set(quizId, {\r\n              id: quizId,\r\n              title: quizData.title || t('leaderboard.unknownQuiz'),\r\n              description: quizData.description || '',\r\n              category: quizData.category || 'general',\r\n              difficulty: quizData.difficulty || 'medium',\r\n              totalAttempts: 0,\r\n              averageScore: 0,\r\n              totalCompletions: 0,\r\n              createdBy: quizData.createdBy,\r\n              isPublished: quizData.isPublished,\r\n              recentActivity: completedAt.toLocaleDateString('vi-VN')\r\n            });\r\n          }\r\n\r\n          const quizStat = quizStats.get(quizId)!;\r\n          quizStat.totalAttempts++;\r\n          quizStat.totalCompletions++;\r\n          quizStat.averageScore = ((quizStat.averageScore * (quizStat.totalAttempts - 1)) + (result.score || 0)) / quizStat.totalAttempts;\r\n          \r\n          if (completedAt > new Date(quizStat.recentActivity)) {\r\n            quizStat.recentActivity = completedAt.toLocaleDateString('vi-VN');\r\n          }\r\n\r\n          totalScore += result.score || 0;\r\n          totalAttempts++;\r\n        });\r\n\r\n        // Calculate user averages and assign badges\r\n        userStats.forEach(userStat => {\r\n          userStat.averageScore = userStat.totalAttempts > 0 ? userStat.totalScore / userStat.totalAttempts : 0;\r\n          \r\n          // Assign badges based on performance\r\n          if (userStat.averageScore >= 90 && userStat.totalAttempts >= 10) {\r\n            userStat.badge = 'legendary';\r\n          } else if (userStat.averageScore >= 80 && userStat.totalAttempts >= 5) {\r\n            userStat.badge = 'expert';\r\n          } else if (userStat.averageScore >= 70 && userStat.totalAttempts >= 3) {\r\n            userStat.badge = 'advanced';\r\n          } else if (userStat.totalAttempts >= 2) {\r\n            userStat.badge = 'intermediate';\r\n          } else {\r\n            userStat.badge = 'beginner';\r\n          }\r\n        });\r\n\r\n        // Sort and rank users - NEW PRIORITY: Quiz count -> Score -> Total time\r\n        const sortedUsers = Array.from(userStats.values())\r\n          .sort((a, b) => {\r\n            // Primary: Total quiz attempts (more quizzes = higher rank)\r\n            if (a.totalAttempts !== b.totalAttempts) {\r\n              return b.totalAttempts - a.totalAttempts;\r\n            }\r\n            // Secondary: Average score \r\n            if (Math.abs(a.averageScore - b.averageScore) > 1) {\r\n              return b.averageScore - a.averageScore;\r\n            }\r\n            // Tertiary: Perfect scores count\r\n            return b.perfectScores - a.perfectScores;\r\n          })\r\n          .map((user, index) => ({ ...user, rank: index + 1 }));\r\n\r\n        // Sort quizzes by popularity\r\n        const sortedQuizzes = Array.from(quizStats.values())\r\n          .sort((a, b) => b.totalAttempts - a.totalAttempts);\r\n\r\n        setTopUsers(sortedUsers);\r\n        setTopQuizzes(sortedQuizzes);\r\n\r\n        // Find current user rank\r\n        if (user) {\r\n          const userIndex = sortedUsers.findIndex(u => u.userId === user.uid);\r\n          setCurrentUserRank(userIndex >= 0 ? userIndex + 1 : null);\r\n        }\r\n\r\n        // Calculate overall statistics\r\n        const activeToday = Array.from(userStats.values()).filter(u => {\r\n          const lastActivity = new Date(u.recentActivity);\r\n          return lastActivity >= today;\r\n        }).length;\r\n\r\n        setStats({\r\n          totalUsers: userStats.size,\r\n          totalQuizzes: quizStats.size,\r\n          totalAttempts,\r\n          averageScore: totalAttempts > 0 ? Math.round((totalScore / totalAttempts) * 10) / 10 : 0,\r\n          activeToday,\r\n          perfectScoresCount\r\n        });\r\n\r\n        console.log('‚úÖ Leaderboard data processed successfully');\r\n        \r\n      } catch (error) {\r\n        console.error('‚ùå Error fetching leaderboard data:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchLeaderboardData();\r\n  }, [user, ready, t]);\r\n\r\n  // Don't render until i18n is ready - Moved after hooks\r\n  if (!ready) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">{t('leaderboard.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Filter users by search\r\n  const filteredUsers = topUsers.filter(u => {\r\n    const keyword = search.toLowerCase();\r\n    return (\r\n      (u.displayName && u.displayName.toLowerCase().includes(keyword)) ||\r\n      (u.email && u.email.toLowerCase().includes(keyword)) ||\r\n      (u.userId && u.userId.toLowerCase().includes(keyword))\r\n    );\r\n  });\r\n\r\n  const getBadgeIcon = (badge: string) => {\r\n    switch (badge) {\r\n      case 'legendary': return <FaCrown className=\"w-5 h-5 text-yellow-500\" />;\r\n      case 'expert': return <FaTrophy className=\"w-5 h-5 text-purple-500\" />;\r\n      case 'advanced': return <FaMedal className=\"w-5 h-5 text-blue-500\" />;\r\n      case 'intermediate': return <FaAward className=\"w-5 h-5 text-green-500\" />;\r\n      default: return <FaStar className=\"w-5 h-5 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getBadgeColor = (badge: string) => {\r\n    switch (badge) {\r\n      case 'legendary': return 'bg-yellow-100 text-yellow-800 border-yellow-300';\r\n      case 'expert': return 'bg-purple-100 text-purple-800 border-purple-300';\r\n      case 'advanced': return 'bg-blue-100 text-blue-800 border-blue-300';\r\n      case 'intermediate': return 'bg-green-100 text-green-800 border-green-300';\r\n      default: return 'bg-gray-100 text-gray-800 border-gray-300';\r\n    }\r\n  };\r\n\r\n  const getDifficultyColor = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'easy': return 'bg-green-100 text-green-800';\r\n      case 'hard': return 'bg-red-100 text-red-800';\r\n      default: return 'bg-yellow-100 text-yellow-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8\">\r\n      <div className=\"max-w-6xl mx-auto px-4\">\r\n        <h1 className=\"text-4xl font-bold text-gray-900 mb-8 text-center flex items-center justify-center gap-3\">\r\n          <FaTrophy className=\"text-yellow-500\" />\r\n          {t('leaderboard.title')}\r\n          <FaTrophy className=\"text-yellow-500\" />\r\n        </h1>\r\n        \r\n        {/* Filters and Search */}\r\n        <div className=\"flex flex-col md:flex-row items-center justify-between gap-4 mb-8\">\r\n          <div className=\"flex gap-4 items-center\">\r\n            <label className=\"font-medium text-gray-700\">{t('leaderboard.time')}:</label>\r\n            <select\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 bg-white\"\r\n              value={timeFilter}\r\n              onChange={e => setTimeFilter(e.target.value as any)}\r\n            >\r\n              <option value=\"all\">{t('leaderboard.filters.allTime')}</option>\r\n              <option value=\"week\">{t('leaderboard.filters.thisWeek')}</option>\r\n              <option value=\"month\">{t('leaderboard.filters.thisMonth')}</option>\r\n            </select>\r\n          </div>\r\n          <input\r\n            className=\"border border-gray-300 rounded-lg px-4 py-2 w-full md:w-80 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            placeholder={t('leaderboard.searchPlayers')}\r\n            value={search}\r\n            onChange={e => setSearch(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        {/* Overall Statistics */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8\">\r\n          <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.totalUsers || '--'}</div>\r\n            <div className=\"text-blue-100 text-sm\">{t('leaderboard.players')}</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.totalQuizzes || '--'}</div>\r\n            <div className=\"text-green-100 text-sm\">{t('nav.quizzes')}</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-br from-yellow-500 to-yellow-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.totalAttempts || '--'}</div>\r\n            <div className=\"text-yellow-100 text-sm\">{t('leaderboard.plays')}</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.averageScore || '--'}%</div>\r\n            <div className=\"text-purple-100 text-sm\">{t('leaderboard.avgScore')}</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-br from-red-500 to-red-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.activeToday || '--'}</div>\r\n            <div className=\"text-red-100 text-sm\">{t('leaderboard.activeToday')}</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-br from-indigo-500 to-indigo-600 text-white rounded-xl p-4 text-center shadow-lg\">\r\n            <div className=\"text-2xl font-bold\">{stats?.perfectScoresCount || '--'}</div>\r\n            <div className=\"text-indigo-100 text-sm\">{t('leaderboard.perfectScores')}</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Top Users Section */}\r\n        <div className=\"mb-10\">\r\n            <h2 className=\"text-2xl font-bold mb-6 text-center flex items-center justify-center gap-2\">\r\n            <FaCrown className=\"text-yellow-500\" />\r\n            {t('leaderboard.topPlayers')}\r\n          </h2>\r\n          \r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n            {loading ? (\r\n              <div className=\"space-y-4\">\r\n                {Array.from({length: 5}).map((_, i) => (\r\n                  <div key={i} className=\"animate-pulse flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 bg-gray-300 rounded-full\"></div>\r\n                    <div className=\"flex-1 space-y-2\">\r\n                      <div className=\"h-4 bg-gray-300 rounded w-3/4\"></div>\r\n                      <div className=\"h-3 bg-gray-300 rounded w-1/2\"></div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : filteredUsers.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <FaUserCircle className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\r\n                <h3 className=\"text-lg font-semibold text-gray-600 mb-2\">{t('leaderboard.noData')}</h3>\r\n                <p className=\"text-gray-500\">{t('leaderboard.playToAppear')}</p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {/* Top 5 Winners - Enhanced Display */}\r\n                <div className=\"mb-8\">\r\n                  {/* Top 3 Podium */}\r\n                  <div className=\"flex justify-center items-end gap-6 mb-6\">\r\n                    {filteredUsers.slice(0, 3).map((user, idx) => (\r\n                      <div key={user.userId} className={`text-center ${idx === 0 ? 'order-2' : idx === 1 ? 'order-1' : 'order-3'}`}>\r\n                        <div className={`relative mb-4 ${idx === 0 ? 'transform scale-110' : ''}`}>\r\n                          <div className={`w-16 h-16 rounded-full flex items-center justify-center text-2xl font-bold text-white mx-auto ${\r\n                            idx === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600' :\r\n                            idx === 1 ? 'bg-gradient-to-br from-gray-400 to-gray-600' :\r\n                            'bg-gradient-to-br from-orange-400 to-orange-600'\r\n                          }`}>\r\n                            {user.displayName.charAt(0).toUpperCase()}\r\n                          </div>\r\n                          <div className=\"absolute -top-3 -right-2\">\r\n                            {getBadgeIcon(user.badge)}\r\n                          </div>\r\n                          {idx === 0 && <FaCrown className=\"absolute -top-6 left-1/2 transform -translate-x-1/2 text-2xl text-yellow-500\" />}\r\n                        </div>\r\n                        <div className=\"font-bold text-gray-900 truncate max-w-24\">{user.displayName}</div>\r\n                        <div className={`text-sm font-semibold ${\r\n                          idx === 0 ? 'text-yellow-600' : idx === 1 ? 'text-gray-600' : 'text-orange-600'\r\n                        }`}>\r\n                          üéØ {user.totalAttempts} {t('nav.quizzes')}\r\n                        </div>\r\n                        <div className=\"text-xs text-gray-500\">{Math.round(user.averageScore)}% {t('leaderboard.avgShort')}</div>\r\n                        <div className={`mt-2 px-2 py-1 rounded-full text-xs font-bold ${\r\n                          idx === 0 ? 'bg-yellow-100 text-yellow-800' :\r\n                          idx === 1 ? 'bg-gray-100 text-gray-800' :\r\n                          'bg-orange-100 text-orange-800'\r\n                        }`}>\r\n                          #{idx + 1}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n\r\n                  {/* Top 4-5 in cards */}\r\n                  {filteredUsers.length >= 4 && (\r\n                    <div className=\"flex justify-center gap-4\">\r\n                      {filteredUsers.slice(3, 5).map((user, idx) => (\r\n                        <div key={user.userId} className=\"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-4 flex items-center gap-3 min-w-64\">\r\n                          <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold\">\r\n                            {user.displayName.charAt(0).toUpperCase()}\r\n                          </div>\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-semibold text-gray-900 flex items-center gap-2\">\r\n                              #{idx + 4} {user.displayName}\r\n                              {getBadgeIcon(user.badge)}\r\n                            </div>\r\n                              <div className=\"text-sm text-blue-600 font-medium\">\r\n                              üéØ {user.totalAttempts} {t('nav.quizzes')} ‚Ä¢ {Math.round(user.averageScore)}% {t('leaderboard.avgShort')}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Rest of leaderboard - Starting from 6th place */}\r\n                <div className=\"space-y-2\">\r\n                  {(showAllUsers ? filteredUsers.slice(5) : filteredUsers.slice(5, 20)).map((user, idx) => (\r\n                    <div key={user.userId} className={`flex items-center gap-4 p-3 rounded-lg transition-colors ${\r\n                      currentUserRank === idx + 6 ? 'bg-blue-50 border-2 border-blue-200' : 'hover:bg-gray-50'\r\n                    }`}>\r\n                      <div className=\"flex items-center gap-3 flex-1\">\r\n                        <span className=\"font-bold text-lg text-blue-600 w-8\">#{idx + 6}</span>\r\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold\">\r\n                          {user.displayName.charAt(0).toUpperCase()}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"font-semibold text-gray-900 flex items-center gap-2\">\r\n                            {user.displayName}\r\n                            <span className={`px-2 py-1 rounded-full text-xs border ${getBadgeColor(user.badge)}`}>\r\n                              {t(`leaderboard.badges.${user.badge}`)}\r\n                            </span>\r\n                          </div>\r\n                            <div className=\"text-sm text-gray-500\">\r\n                              üéØ {user.totalAttempts} {t('nav.quizzes')} ‚Ä¢ {user.perfectScores} {t('leaderboard.perfect100')} ‚Ä¢ {t('leaderboard.activity')}: {user.recentActivity}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <div className=\"font-bold text-lg text-blue-600\">üéØ {user.totalAttempts}</div>\r\n                        <div className=\"text-sm text-gray-500\">{Math.round(user.averageScore)}% {t('leaderboard.avgShort')}</div>\r\n                      </div>\r\n                      <div className=\"text-gray-400\">\r\n                        {getBadgeIcon(user.badge)}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Show More Button */}\r\n                {filteredUsers.length > 20 && (\r\n                  <div className=\"text-center mt-6\">\r\n                    <button\r\n                      onClick={() => setShowAllUsers(!showAllUsers)}\r\n                      className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold\"\r\n                    >\r\n                      {showAllUsers ? t('leaderboard.collapse') : t('leaderboard.viewAllCount')}\r\n                    </button>\r\n                    {user && (\r\n                      <div className=\"text-sm text-blue-700 mt-2\">{user.displayName || user.email}</div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Top Quizzes Section */}\r\n        <div>\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n            <h2 className=\"text-2xl font-bold text-center flex items-center gap-2\">\r\n              <FaFire className=\"text-red-500\" />\r\n                {t('leaderboard.topQuizzes')}\r\n            </h2>\r\n            {topQuizzes.length > 12 && (\r\n              <button\r\n                onClick={() => setShowAllQuizzes(!showAllQuizzes)}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold\"\r\n              >\r\n                {showAllQuizzes ? t('leaderboard.collapse') : t('leaderboard.viewAllCount')}\r\n              </button>\r\n            )}\r\n            </div>\r\n            {topQuizzes.length === 0 ? (\r\n              <div className=\"text-center text-gray-500\">\r\n                <p className=\"text-gray-500\">{t('leaderboard.createFirstQuiz')}</p>\r\n              </div>\r\n            ) : (\r\n              (showAllQuizzes ? topQuizzes : topQuizzes.slice(0, 12)).map((quiz, idx) => (\r\n                <div key={quiz.id} className=\"bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow border-l-4 border-blue-500\">\r\n                  <div className=\"flex items-start justify-between mb-4\">\r\n                    <div className=\"flex-1\">\r\n                      <h3 className=\"font-bold text-lg text-gray-900 mb-2 line-clamp-2\">{quiz.title}</h3>\r\n                      <p className=\"text-gray-600 text-sm line-clamp-2 mb-3\">{quiz.description}</p>\r\n                    </div>\r\n                    <span className=\"bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded-full\">\r\n                      #{idx + 1}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center justify-between mb-4\">\r\n                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${getDifficultyColor(quiz.difficulty)}`}>\r\n                      {quiz.difficulty === 'easy' ? t('difficulty.easy') : quiz.difficulty === 'hard' ? t('difficulty.hard') : t('difficulty.medium')}\r\n                    </span>\r\n                    <span className=\"text-gray-500 text-sm capitalize\">{quiz.category}</span>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-gray-600 text-sm\">{t('leaderboard.plays')}:</span>\r\n                      <span className=\"font-semibold text-blue-600\">{quiz.totalAttempts}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-gray-600 text-sm\">{t('leaderboard.avgScore')}:</span>\r\n                      <span className=\"font-semibold text-green-600\">{Math.round(quiz.averageScore)}%</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-gray-600 text-sm\">{t('leaderboard.activity')}:</span>\r\n                      <span className=\"text-gray-500 text-xs\">{quiz.recentActivity}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default LeaderboardPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\LearningMaterialsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1246,1249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1246,1249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1312,1315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1312,1315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2706,2709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2706,2709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":134,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4129,4132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4129,4132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { toast } from 'react-toastify';\r\nimport { \r\n  Play, \r\n  FileText, \r\n  Image as ImageIcon, \r\n  Link as LinkIcon, \r\n  CheckCircle2, \r\n  Lock, \r\n  AlertCircle,\r\n  ArrowRight,\r\n  Clock\r\n} from 'lucide-react';\r\nimport { Quiz } from '../types';\r\nimport { getQuizById } from '../api';\r\nimport { \r\n  getLearningSession, \r\n  checkGatingStatus,\r\n  updateResourceProgress\r\n} from '../services/learningService';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../lib/store';\r\nimport { VideoViewer, PDFViewer, ImageSlidesViewer, LinkViewer } from '../components/ResourceViewers';\r\n\r\n// Simplified resource type for UI\r\ninterface SimpleResource {\r\n  id: string;\r\n  type: 'video' | 'pdf' | 'image' | 'link' | 'slides';\r\n  title: string;\r\n  description?: string;\r\n  url: string;\r\n  required: boolean;\r\n  thumbnailUrl?: string;\r\n  whyWatch?: string;\r\n  estimatedTime?: number;\r\n  order?: number;\r\n}\r\n\r\ninterface GatingResult {\r\n  ready: boolean;\r\n  requiredCount: number;\r\n  completedCount: number;\r\n  completionPercent: number;\r\n  missingResources: any[];\r\n  warnings: string[];\r\n  viewedResources?: Record<string, any>;\r\n}\r\n\r\nconst LearningMaterialsPage: React.FC = () => {\r\n  const { id: quizId } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation();\r\n  const currentUser = useSelector((state: RootState) => state.auth.user);\r\n  \r\n  const [quiz, setQuiz] = useState<Quiz | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [gatingStatus, setGatingStatus] = useState<GatingResult | null>(null);\r\n  const [selectedResource, setSelectedResource] = useState<SimpleResource | null>(null);\r\n\r\n  const loadQuizAndSession = useCallback(async () => {\r\n    if (!quizId || !currentUser?.uid) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Load quiz data\r\n      const quizData = await getQuizById(quizId);\r\n      if (!quizData) {\r\n        toast.error(t('quiz.errors.notFound'));\r\n        navigate('/quizzes');\r\n        return;\r\n      }\r\n      setQuiz(quizData);\r\n\r\n      // Check if quiz has learning resources\r\n      const resources = quizData.resources || [];\r\n      if (resources.length === 0) {\r\n        // No materials - redirect directly to quiz\r\n        navigate(`/quiz/${quizId}/play`);\r\n        return;\r\n      }\r\n\r\n      // Load learning session and check gating\r\n      const session = await getLearningSession(quizId, currentUser.uid);\r\n      const status = await checkGatingStatus(currentUser.uid, quizId, resources as any);\r\n      \r\n      // Add viewedResources and completionPercent\r\n      const completionPercent = status.requiredCount > 0 \r\n        ? Math.round((status.completedCount / status.requiredCount) * 100)\r\n        : 100;\r\n      \r\n      setGatingStatus({\r\n        ...status,\r\n        completionPercent,\r\n        viewedResources: session?.viewedResources\r\n      });\r\n\r\n      // Auto-select first incomplete required resource\r\n      const firstIncomplete = resources.find((r: SimpleResource) => \r\n        r.required && !session?.viewedResources?.[r.id]?.completed\r\n      );\r\n      if (firstIncomplete) {\r\n        setSelectedResource(firstIncomplete);\r\n      } else if (resources.length > 0) {\r\n        setSelectedResource(resources[0]);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Failed to load learning materials:', error);\r\n      toast.error(t('errors.loadFailed'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [quizId, currentUser, t, navigate]);\r\n\r\n  useEffect(() => {\r\n    loadQuizAndSession();\r\n  }, [loadQuizAndSession]);\r\n\r\n  const handleStartQuiz = () => {\r\n    if (!gatingStatus?.ready) {\r\n      toast.warning(t('learning.gating.notReady'));\r\n      return;\r\n    }\r\n    navigate(`/quiz/${quizId}/play`);\r\n  };\r\n\r\n  const handleResourceClick = (resource: SimpleResource) => {\r\n    setSelectedResource(resource);\r\n  };\r\n\r\n  const handleResourceProgressUpdate = async (resourceId: string, progress: any) => {\r\n    if (!quizId || !currentUser?.uid) return;\r\n    \r\n    try {\r\n      await updateResourceProgress(quizId, currentUser.uid, resourceId, progress);\r\n      // Reload gating status after progress update\r\n      await loadQuizAndSession();\r\n    } catch (error) {\r\n      console.error('Failed to update resource progress:', error);\r\n    }\r\n  };\r\n\r\n  const getResourceIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'video': return <Play className=\"w-5 h-5\" />;\r\n      case 'pdf': return <FileText className=\"w-5 h-5\" />;\r\n      case 'image':\r\n      case 'slides': return <ImageIcon className=\"w-5 h-5\" />;\r\n      case 'link': return <LinkIcon className=\"w-5 h-5\" />;\r\n      default: return <FileText className=\"w-5 h-5\" />;\r\n    }\r\n  };\r\n\r\n  const getResourceTypeBadge = (type: string) => {\r\n    const colors: Record<string, string> = {\r\n      video: 'bg-red-100 text-red-700 border-red-300',\r\n      pdf: 'bg-blue-100 text-blue-700 border-blue-300',\r\n      image: 'bg-green-100 text-green-700 border-green-300',\r\n      slides: 'bg-purple-100 text-purple-700 border-purple-300',\r\n      link: 'bg-yellow-100 text-yellow-700 border-yellow-300'\r\n    };\r\n    return colors[type] || 'bg-gray-100 text-gray-700 border-gray-300';\r\n  };\r\n\r\n  const formatEstimatedTime = (minutes?: number) => {\r\n    if (!minutes) return null;\r\n    if (minutes < 60) return `${minutes} min`;\r\n    const hours = Math.floor(minutes / 60);\r\n    const mins = minutes % 60;\r\n    return mins > 0 ? `${hours}h ${mins}min` : `${hours}h`;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">{t('common.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!quiz) return null;\r\n\r\n  const resources = quiz.resources || [];\r\n  const requiredResources = resources.filter((r: SimpleResource) => r.required);\r\n  const optionalResources = resources.filter((r: SimpleResource) => !r.required);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white border-b border-gray-200 sticky top-0 z-10\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex-1\">\r\n              <h1 className=\"text-2xl font-bold text-gray-900\">{quiz.title}</h1>\r\n              <p className=\"text-sm text-gray-600 mt-1\">{t('learning.materials.title')}</p>\r\n            </div>\r\n            \r\n            {/* Progress & Start Button */}\r\n            <div className=\"flex items-center gap-4\">\r\n              {gatingStatus && (\r\n                <div className=\"text-right\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"text-sm font-medium text-gray-700\">\r\n                      {t('learning.progress')}: {gatingStatus.completionPercent}%\r\n                    </div>\r\n                    {gatingStatus.ready ? (\r\n                      <CheckCircle2 className=\"w-5 h-5 text-green-500\" />\r\n                    ) : (\r\n                      <Lock className=\"w-5 h-5 text-gray-400\" />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"w-32 bg-gray-200 rounded-full h-2 mt-1\">\r\n                    <div \r\n                      className={`h-2 rounded-full transition-all ${\r\n                        gatingStatus.ready ? 'bg-green-500' : 'bg-blue-500'\r\n                      }`}\r\n                      style={{ width: `${gatingStatus.completionPercent}%` }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              <button\r\n                onClick={handleStartQuiz}\r\n                disabled={!gatingStatus?.ready}\r\n                className={`px-6 py-3 rounded-lg font-semibold flex items-center gap-2 transition-all ${\r\n                  gatingStatus?.ready\r\n                    ? 'bg-blue-600 text-white hover:bg-blue-700'\r\n                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                }`}\r\n              >\r\n                {gatingStatus?.ready ? (\r\n                  <>\r\n                    {t('quiz.start')}\r\n                    <ArrowRight className=\"w-5 h-5\" />\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Lock className=\"w-5 h-5\" />\r\n                    {t('learning.locked')}\r\n                  </>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          {/* Sidebar - Resource List */}\r\n          <div className=\"lg:col-span-1\">\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 sticky top-24\">\r\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n                {t('learning.materials.list')}\r\n              </h2>\r\n\r\n              {/* Required Resources */}\r\n              {requiredResources.length > 0 && (\r\n                <div className=\"mb-6\">\r\n                  <h3 className=\"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\r\n                    <AlertCircle className=\"w-4 h-4 text-red-500\" />\r\n                    {t('learning.required')} ({requiredResources.length})\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    {requiredResources.map((resource: SimpleResource, index: number) => {\r\n                      const progress = gatingStatus?.viewedResources?.[resource.id];\r\n                      const isCompleted = progress?.completed || false;\r\n                      const isSelected = selectedResource?.id === resource.id;\r\n                      \r\n                      return (\r\n                        <button\r\n                          key={resource.id}\r\n                          onClick={() => handleResourceClick(resource)}\r\n                          className={`w-full text-left p-3 rounded-lg border-2 transition-all ${\r\n                            isSelected\r\n                              ? 'border-blue-500 bg-blue-50'\r\n                              : 'border-gray-200 hover:border-gray-300'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-start gap-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              isCompleted ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-600'\r\n                            }`}>\r\n                              {isCompleted ? (\r\n                                <CheckCircle2 className=\"w-4 h-4\" />\r\n                              ) : (\r\n                                getResourceIcon(resource.type)\r\n                              )}\r\n                            </div>\r\n                            <div className=\"flex-1 min-w-0\">\r\n                              <p className=\"font-medium text-sm text-gray-900 truncate\">\r\n                                {index + 1}. {resource.title}\r\n                              </p>\r\n                              {resource.estimatedTime && (\r\n                                <div className=\"flex items-center gap-1 text-xs text-gray-500 mt-1\">\r\n                                  <Clock className=\"w-3 h-3\" />\r\n                                  {formatEstimatedTime(resource.estimatedTime)}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Optional Resources */}\r\n              {optionalResources.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"text-sm font-medium text-gray-700 mb-3\">\r\n                    {t('learning.optional')} ({optionalResources.length})\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    {optionalResources.map((resource: SimpleResource) => {\r\n                      const progress = gatingStatus?.viewedResources?.[resource.id];\r\n                      const isCompleted = progress?.completed || false;\r\n                      const isSelected = selectedResource?.id === resource.id;\r\n                      \r\n                      return (\r\n                        <button\r\n                          key={resource.id}\r\n                          onClick={() => handleResourceClick(resource)}\r\n                          className={`w-full text-left p-3 rounded-lg border transition-all ${\r\n                            isSelected\r\n                              ? 'border-blue-500 bg-blue-50'\r\n                              : 'border-gray-200 hover:border-gray-300'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-start gap-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              isCompleted ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-600'\r\n                            }`}>\r\n                              {isCompleted ? (\r\n                                <CheckCircle2 className=\"w-4 h-4\" />\r\n                              ) : (\r\n                                getResourceIcon(resource.type)\r\n                              )}\r\n                            </div>\r\n                            <div className=\"flex-1 min-w-0\">\r\n                              <p className=\"font-medium text-sm text-gray-900 truncate\">\r\n                                {resource.title}\r\n                              </p>\r\n                              {resource.estimatedTime && (\r\n                                <div className=\"flex items-center gap-1 text-xs text-gray-500 mt-1\">\r\n                                  <Clock className=\"w-3 h-3\" />\r\n                                  {formatEstimatedTime(resource.estimatedTime)}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Main Content - Resource Viewer */}\r\n          <div className=\"lg:col-span-2\">\r\n            {selectedResource ? (\r\n              <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\r\n                {/* Resource Header */}\r\n                <div className=\"border-b border-gray-200 p-6\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-3 mb-2\">\r\n                        <span className={`px-3 py-1 rounded-lg text-xs font-semibold border-2 uppercase ${\r\n                          getResourceTypeBadge(selectedResource.type)\r\n                        }`}>\r\n                          {selectedResource.type}\r\n                        </span>\r\n                        {selectedResource.required && (\r\n                          <span className=\"px-3 py-1 rounded-lg text-xs font-semibold border-2 bg-red-100 text-red-700 border-red-300 uppercase\">\r\n                            {t('learning.required')}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n                        {selectedResource.title}\r\n                      </h2>\r\n                      {selectedResource.description && (\r\n                        <p className=\"text-gray-600\">{selectedResource.description}</p>\r\n                      )}\r\n                      {selectedResource.whyWatch && (\r\n                        <div className=\"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                          <p className=\"text-sm text-blue-900\">\r\n                            <strong>{t('learning.whyWatch')}:</strong> {selectedResource.whyWatch}\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Resource Content */}\r\n                <div className=\"p-6\">\r\n                  {selectedResource.type === 'video' && (\r\n                    <VideoViewer\r\n                      url={selectedResource.url}\r\n                      title={selectedResource.title}\r\n                      onProgressUpdate={(progress) => \r\n                        handleResourceProgressUpdate(selectedResource.id, progress)\r\n                      }\r\n                      initialProgress={gatingStatus?.viewedResources?.[selectedResource.id]}\r\n                    />\r\n                  )}\r\n                  \r\n                  {selectedResource.type === 'pdf' && (\r\n                    <PDFViewer\r\n                      url={selectedResource.url}\r\n                      title={selectedResource.title}\r\n                      onProgressUpdate={(progress) => \r\n                        handleResourceProgressUpdate(selectedResource.id, progress)\r\n                      }\r\n                      initialProgress={gatingStatus?.viewedResources?.[selectedResource.id]}\r\n                    />\r\n                  )}\r\n                  \r\n                  {(selectedResource.type === 'image' || selectedResource.type === 'slides') && (\r\n                    <ImageSlidesViewer\r\n                      urls={[selectedResource.url]} // TODO: Support multiple images\r\n                      title={selectedResource.title}\r\n                      onProgressUpdate={(progress) => \r\n                        handleResourceProgressUpdate(selectedResource.id, progress)\r\n                      }\r\n                      initialProgress={gatingStatus?.viewedResources?.[selectedResource.id]}\r\n                    />\r\n                  )}\r\n                  \r\n                  {selectedResource.type === 'link' && (\r\n                    <LinkViewer\r\n                      url={selectedResource.url}\r\n                      title={selectedResource.title}\r\n                      description={selectedResource.description}\r\n                      estimatedTime={selectedResource.estimatedTime}\r\n                      onProgressUpdate={(progress) => \r\n                        handleResourceProgressUpdate(selectedResource.id, progress)\r\n                      }\r\n                      initialProgress={gatingStatus?.viewedResources?.[selectedResource.id]}\r\n                    />\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center\">\r\n                <FileText className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\r\n                <p className=\"text-gray-600\">{t('learning.selectResource')}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LearningMaterialsPage;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\MyQuizzesPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizDetailedStats.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":36012,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect, useCallback } from 'react';import { useParams, useNavigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { ROUTES } from '../../../config/routes';import { doc, getDoc, collection, query, where, getDocs, orderBy } from 'firebase/firestore';import { db } from '../../../lib/firebase/config';import {   TrendingUp,   Users,   Target,   Clock,   Award,   BarChart3,  PieChart,  Calendar,  Eye,  CheckCircle,  XCircle,  ArrowLeft,  Download,  Lock,  BookOpen,  Brain,  Star,  Trophy,  Activity} from 'lucide-react';/* import { Line, Bar, Doughnut } from 'react-chartjs-2';import {  Chart as ChartJS,  CategoryScale,  LinearScale,  PointElement,  LineElement,  BarElement,  ArcElement,  RadialLinearScale,  Title,  Tooltip,  Legend,  Filler} from 'chart.js';// Register ChartJS componentsChartJS.register(  CategoryScale,  LinearScale,  PointElement,  LineElement,  BarElement,  ArcElement,  RadialLinearScale,  Title,  Tooltip,  Legend,  Filler);*/interface Quiz {  id: string;  title: string;  description: string;  category: string;  difficulty: string;  questions: any[];  createdBy: string;  createdAt: any;  status: string;  havePassword?: 'public' | 'password';  quizType?: 'with-materials' | 'standard';  imageUrl?: string;  views?: number;  attempts?: number;  completions?: number;  averageScore?: number;}interface QuizResult {  id: string;  userId: string;  userName?: string;  score: number;  totalQuestions: number;  correctAnswers: number;  timeSpent: number;  completedAt: any;  answers: any[];}interface Stats {  totalViews: number;  totalAttempts: number;  totalCompletions: number;  completionRate: number;  averageScore: number;  averageTimeSpent: number;  highestScore: number;  lowestScore: number;  passRate: number;  recentResults: QuizResult[];  scoreDistribution: { range: string; count: number }[];  dailyAttempts: { date: string; count: number }[];  questionStats: { questionId: string; correctRate: number; question: string }[];  topPerformers: { userName: string; score: number; date: string }[];}const QuizDetailedStats: React.FC = () => {  const { id } = useParams<{ id: string }>();  const navigate = useNavigate();  const { user } = useSelector((state: RootState) => state.auth);    const [quiz, setQuiz] = useState<Quiz | null>(null);  const [stats, setStats] = useState<Stats | null>(null);  const [loading, setLoading] = useState(true);  const [timeRange, setTimeRange] = useState<'7days' | '30days' | 'all'>('30days');  const fetchQuizAndStats = useCallback(async () => {    if (!id || !user) return;        setLoading(true);    try {      // Fetch quiz      const quizDoc = await getDoc(doc(db, 'quizzes', id));      if (!quizDoc.exists()) {        throw new Error('Quiz not found');      }            const quizData = { id: quizDoc.id, ...quizDoc.data() } as Quiz;            // Check if user owns this quiz      if (quizData.createdBy !== user.uid) {        throw new Error('Unauthorized');      }            setQuiz(quizData);      // Fetch results - with fallback if index is still building      let results: QuizResult[] = [];            try {        let resultsQuery;                if (timeRange !== 'all') {          const days = timeRange === '7days' ? 7 : 30;          const startDate = new Date();          startDate.setDate(startDate.getDate() - days);                    resultsQuery = query(            collection(db, 'quizResults'),            where('quizId', '==', id),            where('completedAt', '>=', startDate),            orderBy('completedAt', 'desc')          );        } else {          resultsQuery = query(            collection(db, 'quizResults'),            where('quizId', '==', id),            orderBy('completedAt', 'desc')          );        }        const resultsSnapshot = await getDocs(resultsQuery);        results = resultsSnapshot.docs.map(doc => ({          id: doc.id,          ...doc.data()        })) as QuizResult[];              } catch (indexError: any) {        // If index is still building, fall back to fetching all results and filtering client-side        console.warn('Index still building, using fallback query:', indexError.message);                const fallbackQuery = query(          collection(db, 'quizResults'),          where('quizId', '==', id)        );                const resultsSnapshot = await getDocs(fallbackQuery);        let allResults = resultsSnapshot.docs.map(doc => ({          id: doc.id,          ...doc.data()        })) as QuizResult[];                // Filter by time range client-side        if (timeRange !== 'all') {          const days = timeRange === '7days' ? 7 : 30;          const startDate = new Date();          startDate.setDate(startDate.getDate() - days);                    allResults = allResults.filter(result =>             result.completedAt && new Date(result.completedAt) >= startDate          );        }                // Sort client-side        results = allResults.sort((a, b) => {          const dateA = a.completedAt ? new Date(a.completedAt).getTime() : 0;          const dateB = b.completedAt ? new Date(b.completedAt).getTime() : 0;          return dateB - dateA;        });      }      // Calculate stats      const calculatedStats = calculateStats(results, quizData);      setStats(calculatedStats);          } catch (error) {      console.error('Error fetching quiz stats:', error);      navigate(ROUTES.CREATOR_MY_QUIZZES);    } finally {      setLoading(false);    }  }, [id, user, timeRange, navigate]); // eslint-disable-line react-hooks/exhaustive-deps  // calculateStats is a stable function defined below, doesn't need to be in dependencies  useEffect(() => {    if (id && user) {      fetchQuizAndStats();    }  }, [id, user, timeRange, fetchQuizAndStats]);  const calculateStats = (results: QuizResult[], quizData: Quiz): Stats => {    // Default score ranges    const defaultScoreDistribution = [      { range: '0-20%', count: 0 },      { range: '21-40%', count: 0 },      { range: '41-60%', count: 0 },      { range: '61-80%', count: 0 },      { range: '81-100%', count: 0 }    ];    // Default daily attempts (last 30 days)    const defaultDailyAttempts: { date: string; count: number }[] = [];    for (let i = 29; i >= 0; i--) {      const date = new Date();      date.setDate(date.getDate() - i);      const dateStr = date.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit' });      defaultDailyAttempts.push({ date: dateStr, count: 0 });    }    if (results.length === 0) {      return {        totalViews: quizData.views || 0,        totalAttempts: 0,        totalCompletions: 0,        completionRate: 0,        averageScore: 0,        averageTimeSpent: 0,        highestScore: 0,        lowestScore: 0,        passRate: 0,        recentResults: [],        scoreDistribution: defaultScoreDistribution,        dailyAttempts: defaultDailyAttempts,        questionStats: [],        topPerformers: []      };    }    const totalAttempts = results.length;    const completedResults = results.filter(r => r.score !== undefined);    const totalCompletions = completedResults.length;        const scores = completedResults.map(r => (r.score / r.totalQuestions) * 100);    const averageScore = scores.reduce((a, b) => a + b, 0) / scores.length || 0;    const highestScore = Math.max(...scores, 0);    const lowestScore = Math.min(...scores, 100);        const passRate = (scores.filter(s => s >= 60).length / scores.length) * 100 || 0;        const timeSpents = completedResults.map(r => r.timeSpent || 0).filter(t => t > 0);    const averageTimeSpent = timeSpents.reduce((a, b) => a + b, 0) / timeSpents.length || 0;    // Score distribution    const scoreRanges = [      { range: '0-20%', min: 0, max: 20 },      { range: '21-40%', min: 21, max: 40 },      { range: '41-60%', min: 41, max: 60 },      { range: '61-80%', min: 61, max: 80 },      { range: '81-100%', min: 81, max: 100 }    ];        const scoreDistribution = scoreRanges.map(range => ({      range: range.range,      count: scores.filter(s => s >= range.min && s <= range.max).length    }));    // Daily attempts (last 7 or 30 days)    const days = timeRange === '7days' ? 7 : timeRange === '30days' ? 30 : 90;    const dailyAttempts: { date: string; count: number }[] = [];        for (let i = days - 1; i >= 0; i--) {      const date = new Date();      date.setDate(date.getDate() - i);      const dateStr = date.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit' });            const count = results.filter(r => {        const resultDate = r.completedAt?.toDate ? r.completedAt.toDate() : new Date(r.completedAt);        return resultDate.toDateString() === date.toDateString();      }).length;            dailyAttempts.push({ date: dateStr, count });    }    // Question stats    const questionStats = quizData.questions.map((q, index) => {      const questionId = q.id || `q${index}`;      const answersForQuestion = results.flatMap(r =>         r.answers?.filter((a: any) => a.questionId === questionId) || []      );            const correctCount = answersForQuestion.filter((a: any) => a.isCorrect).length;      const correctRate = answersForQuestion.length > 0         ? (correctCount / answersForQuestion.length) * 100         : 0;            return {        questionId,        question: q.text || 'Untitled Question',        correctRate: Math.round(correctRate)      };    }).sort((a, b) => a.correctRate - b.correctRate);    // Top performers    const topPerformers = completedResults      .sort((a, b) => b.score - a.score)      .slice(0, 10)      .map(r => ({        userName: r.userName || 'Anonymous',        score: Math.round((r.score / r.totalQuestions) * 100),        date: r.completedAt?.toDate ? r.completedAt.toDate().toLocaleDateString('vi-VN') : 'N/A'      }));    return {      totalViews: quizData.views || 0,      totalAttempts,      totalCompletions,      completionRate: (totalCompletions / totalAttempts) * 100 || 0,      averageScore: Math.round(averageScore),      averageTimeSpent: Math.round(averageTimeSpent),      highestScore: Math.round(highestScore),      lowestScore: Math.round(lowestScore),      passRate: Math.round(passRate),      recentResults: results.slice(0, 20),      scoreDistribution,      dailyAttempts,      questionStats,      topPerformers    };  };  const formatTime = (seconds: number) => {    const mins = Math.floor(seconds / 60);    const secs = seconds % 60;    return `${mins}:${secs.toString().padStart(2, '0')}`;  };  const handleExport = () => {    // TODO: Implement export to CSV/Excel    alert('T√≠nh nƒÉng xu·∫•t b√°o c√°o ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');  };  if (loading) {    return (      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50 flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4\"></div>          <p className=\"text-gray-600 font-medium\">ƒêang t·∫£i th·ªëng k√™...</p>        </div>      </div>    );  }  if (!quiz || !stats) {    return (      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50 flex items-center justify-center\">        <div className=\"text-center\">          // eslint-disable-next-line i18next/no-literal-string          <p className=\"text-gray-600 mb-4\">Kh√¥ng t√¨m th·∫•y quiz</p>          <button            onClick={() => navigate(ROUTES.CREATOR_MY_QUIZZES)}            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"          // eslint-disable-next-line i18next/no-literal-string          >            Quay l·∫°i          </button>        </div>      </div>    );  }  // Chart data (commented - using tables instead)  /*  const lineChartData = {    labels: stats.dailyAttempts.map(d => d.date),    datasets: [      {        label: 'L∆∞·ª£t l√†m b√†i',        data: stats.dailyAttempts.map(d => d.count),        borderColor: 'rgb(59, 130, 246)',        backgroundColor: 'rgba(59, 130, 246, 0.1)',        tension: 0.4,        fill: true,      }    ]  };  const scoreDistributionData = {    labels: stats.scoreDistribution.map(d => d.range),    datasets: [      {        label: 'S·ªë h·ªçc vi√™n',        data: stats.scoreDistribution.map(d => d.count),        backgroundColor: [          'rgba(239, 68, 68, 0.8)',          'rgba(249, 115, 22, 0.8)',          'rgba(234, 179, 8, 0.8)',          'rgba(34, 197, 94, 0.8)',          'rgba(59, 130, 246, 0.8)',        ],        borderColor: [          'rgb(239, 68, 68)',          'rgb(249, 115, 22)',          'rgb(234, 179, 8)',          'rgb(34, 197, 94)',          'rgb(59, 130, 246)',        ],        borderWidth: 2      }    ]  };  const questionDifficultyData = {    labels: stats.questionStats.slice(0, 10).map(q => `C√¢u ${stats.questionStats.indexOf(q) + 1}`),    datasets: [      {        label: 'T·ª∑ l·ªá ƒë√∫ng (%)',        data: stats.questionStats.slice(0, 10).map(q => q.correctRate),        backgroundColor: 'rgba(139, 92, 246, 0.8)',        borderColor: 'rgb(139, 92, 246)',        borderWidth: 2      }    ]  };  */  return (    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50 py-8\">      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">        {/* Header */}        <div className=\"mb-8\">          <button            onClick={() => navigate(ROUTES.CREATOR_MY_QUIZZES)}            className=\"mb-4 flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors group\"          >            <ArrowLeft className=\"w-5 h-5 group-hover:-translate-x-1 transition-transform\" />            // eslint-disable-next-line i18next/no-literal-string            <span className=\"font-medium\">Quay l·∫°i My Quizzes</span>          </button>          <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">            <div className=\"flex items-start justify-between\">              <div className=\"flex-1\">                <div className=\"flex items-center gap-3 mb-3\">                  <h1 className=\"text-3xl font-bold text-gray-900\">{quiz.title}</h1>                  {quiz.havePassword === 'password' && (                    <span className=\"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium flex items-center gap-1\">                      // eslint-disable-next-line i18next/no-literal-string                      <Lock className=\"w-4 h-4\" />                      Password                    </span>                  )}                  {quiz.quizType === 'with-materials' && (                    <span className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium flex items-center gap-1\">                      // eslint-disable-next-line i18next/no-literal-string                      <BookOpen className=\"w-4 h-4\" />                      With Materials                    </span>                  )}                </div>                <p className=\"text-gray-600 mb-4\">{quiz.description}</p>                <div className=\"flex items-center gap-4 text-sm\">                  <span className=\"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg font-medium\">                    üìö {quiz.category}                  </span>                  <span className={`px-3 py-1 rounded-lg font-medium ${                    quiz.difficulty === 'easy' ? 'bg-green-100 text-green-700' :                    quiz.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-700' :                    'bg-red-100 text-red-700'                  }`}>                    {quiz.difficulty === 'easy' ? '‚≠ê D·ªÖ' : quiz.difficulty === 'medium' ? '‚≠ê‚≠ê Trung b√¨nh' : '‚≠ê‚≠ê‚≠ê Kh√≥'}                  </span>                  <span className=\"text-gray-600\">                    <Brain className=\"w-4 h-4 inline mr-1\" />                    // eslint-disable-next-line i18next/no-literal-string                    {quiz.questions.length} c√¢u h·ªèi                  </span>                </div>              </div>              {quiz.imageUrl && (                <img                  src={quiz.imageUrl}                  alt={quiz.title}                  className=\"w-32 h-32 rounded-xl object-cover ml-6\"                />              )}            </div>            {/* Quick Actions */}            <div className=\"flex gap-3 mt-6 pt-6 border-t border-gray-200\">              <button                onClick={() => navigate(`/quiz-preview/${quiz.id}`)}                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 font-medium\"              >                // eslint-disable-next-line i18next/no-literal-string                <Eye className=\"w-4 h-4\" />                Xem Quiz              </button>              <button                onClick={handleExport}                className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 font-medium\"              >                // eslint-disable-next-line i18next/no-literal-string                <Download className=\"w-4 h-4\" />                Xu·∫•t b√°o c√°o              </button>              <select                value={timeRange}                onChange={(e) => setTimeRange(e.target.value as any)}                className=\"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white\"              >                // eslint-disable-next-line i18next/no-literal-string                <option value=\"7days\">7 ng√†y qua</option>                // eslint-disable-next-line i18next/no-literal-string                <option value=\"30days\">30 ng√†y qua</option>                // eslint-disable-next-line i18next/no-literal-string                <option value=\"all\">T·∫•t c·∫£ th·ªùi gian</option>              </select>            </div>          </div>        </div>        {/* Stats Grid */}        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">          {/* Total Views */}          <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <Eye className=\"w-8 h-8 opacity-80\" />              <Activity className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.totalViews.toLocaleString()}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-blue-100 text-sm font-medium\">L∆∞·ª£t xem</p>          </div>          {/* Total Attempts */}          <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <Users className=\"w-8 h-8 opacity-80\" />              <TrendingUp className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.totalAttempts.toLocaleString()}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-purple-100 text-sm font-medium\">L∆∞·ª£t l√†m b√†i</p>          </div>          {/* Completion Rate */}          <div className=\"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <CheckCircle className=\"w-8 h-8 opacity-80\" />              <Target className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.completionRate.toFixed(1)}%</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-green-100 text-sm font-medium\">T·ª∑ l·ªá ho√†n th√†nh</p>          </div>          {/* Average Score */}          <div className=\"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <Award className=\"w-8 h-8 opacity-80\" />              <Star className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.averageScore}%</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-orange-100 text-sm font-medium\">ƒêi·ªÉm trung b√¨nh</p>          </div>          {/* Pass Rate */}          <div className=\"bg-gradient-to-br from-teal-500 to-teal-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <Trophy className=\"w-8 h-8 opacity-80\" />              <CheckCircle className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.passRate}%</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-teal-100 text-sm font-medium\">T·ª∑ l·ªá ƒë·∫°t (‚â•60%)</p>          </div>          {/* Highest Score */}          <div className=\"bg-gradient-to-br from-pink-500 to-pink-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <TrendingUp className=\"w-8 h-8 opacity-80\" />              <Star className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.highestScore}%</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-pink-100 text-sm font-medium\">ƒêi·ªÉm cao nh·∫•t</p>          </div>          {/* Average Time */}          <div className=\"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <Clock className=\"w-8 h-8 opacity-80\" />              <Activity className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{formatTime(stats.averageTimeSpent)}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-indigo-100 text-sm font-medium\">Th·ªùi gian TB</p>          </div>          {/* Completions */}          <div className=\"bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-2xl p-6 text-white shadow-lg\">            <div className=\"flex items-center justify-between mb-4\">              <BarChart3 className=\"w-8 h-8 opacity-80\" />              <CheckCircle className=\"w-6 h-6 opacity-60\" />            </div>            <h3 className=\"text-3xl font-bold mb-1\">{stats.totalCompletions.toLocaleString()}</h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-cyan-100 text-sm font-medium\">Ho√†n th√†nh</p>          </div>        </div>        {/* Stats Visualization */}        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">          {/* Daily Attempts Bar Chart */}          <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">            <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">              // eslint-disable-next-line i18next/no-literal-string              <TrendingUp className=\"w-6 h-6 text-blue-600\" />              Xu h∆∞·ªõng l√†m b√†i theo ng√†y            </h3>            <div className=\"space-y-3\">              {stats.dailyAttempts.map((day, index) => {                const maxCount = Math.max(...stats.dailyAttempts.map(d => d.count), 1);                const widthPercent = day.count > 0 ? Math.max((day.count / maxCount) * 100, 10) : 0;                                return (                  <div key={index} className=\"flex items-center gap-3\">                    <span className=\"text-sm font-medium text-gray-600 w-16\">{day.date}</span>                    <div className=\"flex-1 bg-gray-100 rounded-full h-8 overflow-hidden\">                      <div                         className=\"bg-gradient-to-r from-blue-500 to-blue-600 h-full flex items-center justify-end px-3 text-white text-sm font-semibold transition-all duration-500\"                        style={{ width: `${widthPercent}%` }}                      >                        {day.count > 0 && day.count}                      </div>                    </div>                  </div>                );              })}            </div>          </div>          {/* Score Distribution */}          <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">            <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">              // eslint-disable-next-line i18next/no-literal-string              <PieChart className=\"w-6 h-6 text-purple-600\" />              Ph√¢n b·ªë ƒëi·ªÉm s·ªë            </h3>            <div className=\"space-y-4\">              {stats.scoreDistribution.map((range, index) => {                const colors = [                  { bg: 'bg-red-500', text: 'text-red-700', light: 'bg-red-100' },                  { bg: 'bg-orange-500', text: 'text-orange-700', light: 'bg-orange-100' },                  { bg: 'bg-yellow-500', text: 'text-yellow-700', light: 'bg-yellow-100' },                  { bg: 'bg-green-500', text: 'text-green-700', light: 'bg-green-100' },                  { bg: 'bg-blue-500', text: 'text-blue-700', light: 'bg-blue-100' }                ];                const color = colors[index];                const percentage = stats.totalCompletions > 0 ? (range.count / stats.totalCompletions * 100).toFixed(1) : 0;                const maxCount = Math.max(...stats.scoreDistribution.map(r => r.count), 1);                const widthPercent = range.count > 0 ? Math.max((range.count / maxCount) * 100, 15) : 0;                                return (                  <div key={range.range} className=\"flex items-center gap-3\">                    <span className={`text-sm font-medium w-20 px-3 py-1 rounded-lg ${color.light} ${color.text}`}>                      {range.range}                    </span>                    <div className=\"flex-1 bg-gray-100 rounded-full h-10 overflow-hidden\">                      <div                         className={`${color.bg} h-full flex items-center justify-between px-4 text-white text-sm font-semibold transition-all duration-500`}                        style={{ width: `${widthPercent}%` }}                      >                        <span>{range.count} HV</span>                        <span>{percentage}%</span>                      </div>                    </div>                  </div>                );              })}            </div>          </div>        </div>        {/* Analysis Row 2 */}        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">          {/* Question Difficulty Analysis */}          <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">            <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">              // eslint-disable-next-line i18next/no-literal-string              <BarChart3 className=\"w-6 h-6 text-green-600\" />              ƒê·ªô kh√≥ c√¢u h·ªèi (Top 10 kh√≥ nh·∫•t)            </h3>            <div className=\"space-y-3 max-h-96 overflow-y-auto\">              {stats.questionStats.length > 0 ? (                stats.questionStats.slice(0, 10).map((q, index) => (                  <div key={q.questionId} className=\"border-b border-gray-100 pb-3 last:border-0\">                    <div className=\"flex items-start justify-between mb-2\">                      <p className=\"text-sm text-gray-700 font-medium flex-1 pr-4\">                        // eslint-disable-next-line i18next/no-literal-string                        <span className=\"text-blue-600 font-bold\">C√¢u {index + 1}:</span> {q.question}                      </p>                      <span className={`text-sm font-bold px-3 py-1 rounded-lg ${                        q.correctRate >= 80 ? 'bg-green-100 text-green-700' :                        q.correctRate >= 60 ? 'bg-blue-100 text-blue-700' :                        q.correctRate >= 40 ? 'bg-yellow-100 text-yellow-700' :                        'bg-red-100 text-red-700'                      }`}>                        {q.correctRate}%                      </span>                    </div>                    <div className=\"w-full bg-gray-200 rounded-full h-2\">                      <div                         className={`h-full rounded-full transition-all duration-500 ${                          q.correctRate >= 80 ? 'bg-green-500' :                          q.correctRate >= 60 ? 'bg-blue-500' :                          q.correctRate >= 40 ? 'bg-yellow-500' :                          'bg-red-500'                        }`}                        style={{ width: `${q.correctRate}%` }}                      />                    </div>                  </div>                ))              ) : (                <div className=\"text-center py-8 text-gray-500\">                  <BarChart3 className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />                  // eslint-disable-next-line i18next/no-literal-string                  <p>Ch∆∞a c√≥ d·ªØ li·ªáu ph√¢n t√≠ch c√¢u h·ªèi</p>                </div>              )}            </div>          </div>          {/* Top Performers */}          <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">            <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">              // eslint-disable-next-line i18next/no-literal-string              <Trophy className=\"w-6 h-6 text-yellow-600\" />              Top 10 h·ªçc vi√™n xu·∫•t s·∫Øc            </h3>            <div className=\"space-y-3 max-h-96 overflow-y-auto\">              {stats.topPerformers.length > 0 ? (                stats.topPerformers.map((performer, index) => (                  <div                     key={index}                    className=\"flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl border border-yellow-200 hover:shadow-md transition-shadow\"                  >                    <div className=\"flex items-center gap-3\">                      <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ${                        index === 0 ? 'bg-yellow-500' :                        index === 1 ? 'bg-gray-400' :                        index === 2 ? 'bg-orange-600' :                        'bg-blue-500'                      }`}>                        {index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : index + 1}                      </div>                      <div>                        <p className=\"font-semibold text-gray-900\">{performer.userName}</p>                        <p className=\"text-sm text-gray-600\">{performer.date}</p>                      </div>                    </div>                    <div className=\"text-right\">                      <p className=\"text-2xl font-bold text-gray-900\">{performer.score}%</p>                    </div>                  </div>                ))              ) : (                // eslint-disable-next-line i18next/no-literal-string                <p className=\"text-center text-gray-500 py-8\">Ch∆∞a c√≥ d·ªØ li·ªáu</p>              )}            </div>          </div>        </div>        {/* Recent Results Table */}        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-200 p-6\">          <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">            // eslint-disable-next-line i18next/no-literal-string            <Calendar className=\"w-6 h-6 text-blue-600\" />            20 k·∫øt qu·∫£ g·∫ßn nh·∫•t          </h3>          <div className=\"overflow-x-auto\">            <table className=\"w-full\">              <thead>                <tr className=\"border-b-2 border-gray-200\">                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700\">H·ªçc vi√™n</th>                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">ƒêi·ªÉm</th>                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">ƒê√∫ng/T·ªïng</th>                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">Th·ªùi gian</th>                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">Ng√†y l√†m</th>                  // eslint-disable-next-line i18next/no-literal-string                  <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">K·∫øt qu·∫£</th>                </tr>              </thead>              <tbody>                {stats.recentResults.length > 0 ? (                  stats.recentResults.map((result, index) => {                    const scorePercent = Math.round((result.score / result.totalQuestions) * 100);                    const passed = scorePercent >= 60;                                        return (                      <tr key={result.id} className={`border-b border-gray-100 hover:bg-gray-50 transition-colors ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}`}>                        <td className=\"px-4 py-4 text-sm text-gray-900 font-medium\">                          {result.userName || 'Anonymous'}                        </td>                        <td className=\"px-4 py-4 text-center\">                          <span className={`px-3 py-1 rounded-full text-sm font-bold ${                            scorePercent >= 80 ? 'bg-green-100 text-green-700' :                            scorePercent >= 60 ? 'bg-blue-100 text-blue-700' :                            scorePercent >= 40 ? 'bg-yellow-100 text-yellow-700' :                            'bg-red-100 text-red-700'                          }`}>                            {scorePercent}%                          </span>                        </td>                        <td className=\"px-4 py-4 text-center text-sm text-gray-600\">                          {result.correctAnswers}/{result.totalQuestions}                        </td>                        <td className=\"px-4 py-4 text-center text-sm text-gray-600\">                          {formatTime(result.timeSpent || 0)}                        </td>                        <td className=\"px-4 py-4 text-center text-sm text-gray-600\">                          {result.completedAt?.toDate ? result.completedAt.toDate().toLocaleString('vi-VN') : 'N/A'}                        </td>                        <td className=\"px-4 py-4 text-center\">                          {passed ? (                            <span className=\"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold\">                              // eslint-disable-next-line i18next/no-literal-string                              <CheckCircle className=\"w-3.5 h-3.5\" />                              ƒê·∫°t                            </span>                          ) : (                            <span className=\"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold\">                              // eslint-disable-next-line i18next/no-literal-string                              <XCircle className=\"w-3.5 h-3.5\" />                              Ch∆∞a ƒë·∫°t                            </span>                          )}                        </td>                      </tr>                    );                  })                ) : (                  <tr>                    // eslint-disable-next-line i18next/no-literal-string                    <td colSpan={6} className=\"px-4 py-8 text-center text-gray-500\">                      Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o                    </td>                  </tr>                )}              </tbody>            </table>          </div>        </div>      </div>    </div>  );};export default QuizDetailedStats;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1011,1014],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1011,1014],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { AppDispatch, RootState } from '../../../lib/store';\r\nimport { ROUTES } from '../../../config/routes';\r\nimport QuizCard, { QuizCardSkeleton } from '../components/QuizCard';\r\nimport QuizStats from '../components/QuizStats';\r\nimport { Quiz } from '../types';\r\nimport { fetchQuizzes } from '../store';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport PasswordModal from '../../../shared/components/ui/PasswordModal';\r\n\r\nconst QuizList: React.FC<{ quizzes?: Quiz[]; title?: string }> = ({ quizzes: propQuizzes, title }) => {\r\n  // Always call hooks at the top - Fix React Hooks rules\r\n  const { t } = useTranslation();\r\n  const translate = useCallback(\r\n    (key: string, fallback: string, options?: Record<string, unknown>): string => {\r\n      const value = t(key, options as any);\r\n      if (typeof value === 'string') {\r\n        return value === key ? fallback : value;\r\n      }\r\n      return fallback;\r\n    },\r\n    [t]\r\n  );\r\n\r\n  const resultsFoundLabel = useMemo(\r\n    () => translate('quiz.resultsFound', 'ƒê√£ t√¨m th·∫•y'),\r\n    [translate]\r\n  );\r\n\r\n  const itemLabel = useMemo(\r\n    () => translate('quiz.itemLabel', 'quiz'),\r\n    [translate]\r\n  );\r\n\r\n  const searchPlaceholder = useMemo(\r\n    () => translate('quiz.searchPlaceholder', 'üîç T√¨m ki·∫øm quiz, danh m·ª•c, th·∫ª...'),\r\n    [translate]\r\n  );\r\n\r\n  const dispatch = useDispatch<AppDispatch>();\r\n  const navigate = useNavigate();\r\n  const storeQuizzes = useSelector((state: RootState) => state.quiz.quizzes);\r\n  const loading = useSelector((state: RootState) => state.quiz.loading || state.quiz.isLoading);\r\n  const error = useSelector((state: RootState) => state.quiz.error);\r\n  const user = useSelector((state: RootState) => state.auth.user);\r\n\r\n  // Use propQuizzes if provided, otherwise use store quizzes\r\n  const quizzes = propQuizzes || storeQuizzes;\r\n\r\n  const quizHasResources = useCallback(\r\n    (quiz: Quiz) => Array.isArray(quiz.resources) && quiz.resources.length > 0,\r\n    []\r\n  );\r\n\r\n  const approvedQuizzes = useMemo(\r\n    () => quizzes.filter(q => q.status === 'approved'),\r\n    [quizzes]\r\n  );\r\n\r\n  // Show specific error message for Firestore connection issues\r\n  const showFirestoreError = error && (\r\n    error.includes('ad blocker') || \r\n    error.includes('ERR_BLOCKED_BY_CLIENT') ||\r\n    error.includes('Kh√¥ng th·ªÉ k·∫øt n·ªëi Firestore')\r\n  );\r\n\r\n  const [retryCount, setRetryCount] = useState(0);\r\n  const maxRetries = 3;\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      if (!propQuizzes && quizzes.length === 0 && !loading) {\r\n        try {\r\n          await dispatch(fetchQuizzes({})).unwrap();\r\n        } catch (err) {\r\n          console.error('Quiz fetch error:', err);\r\n          if (err instanceof Error) {\r\n            console.error('Error message:', err.message);\r\n            const errorWithCode = err as { code?: string };\r\n            if (errorWithCode.code) {\r\n              console.error('Error code:', errorWithCode.code);\r\n            }\r\n          } else if (typeof err === 'object' && err !== null && 'code' in err) {\r\n            const errorWithCode = err as { code?: string };\r\n            if (errorWithCode.code) {\r\n              console.error('Error code:', errorWithCode.code);\r\n            }\r\n          }\r\n\r\n          if (retryCount < maxRetries) {\r\n            const delay = Math.min(1000 * Math.pow(2, retryCount), 10000);\r\n            setTimeout(() => {\r\n              setRetryCount(prev => prev + 1);\r\n            }, delay);\r\n          } else {\r\n            toast.error(translate('messages.serverError', 'Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. Vui l√≤ng th·ª≠ l·∫°i sau.'));\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [dispatch, propQuizzes, quizzes.length, loading, retryCount, translate]);\r\n  const [search, setSearch] = useState('');\r\n  const [category, setCategory] = useState('all');\r\n  const [difficulty, setDifficulty] = useState('all');\r\n  const [sortBy, setSortBy] = useState('newest'); // newest, oldest, popular, difficulty\r\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid'); // grid, list\r\n  const [showCompleted, setShowCompleted] = useState(true);\r\n  const [showStats, setShowStats] = useState(false);\r\n  const [resourceFilter, setResourceFilter] = useState<'all' | 'with-resources' | 'no-resources'>('all'); // üÜï Filter for resources\r\n  \r\n  // üîí Password modal state\r\n  const [showPasswordModal, setShowPasswordModal] = useState(false);\r\n  const [selectedQuiz, setSelectedQuiz] = useState<Quiz | null>(null);\r\n\r\n  const handleQuizStart = (quiz: Quiz) => {\r\n    // üîí Check if quiz requires password\r\n    const requiresPassword = quiz.visibility === 'password' || quiz.havePassword === 'password';\r\n    \r\n    if (requiresPassword) {\r\n      // Show password modal immediately\r\n      setSelectedQuiz(quiz);\r\n      setShowPasswordModal(true);\r\n    } else {\r\n      // Navigate to preview page for public quizzes\r\n      navigate(`/quiz/${quiz.id}/preview`);\r\n    }\r\n  };\r\n  \r\n  // üîí Handle successful password verification\r\n  const handlePasswordSuccess = () => {\r\n    if (selectedQuiz) {\r\n      setShowPasswordModal(false);\r\n      // Navigate to preview page after successful password entry\r\n      navigate(`/quiz/${selectedQuiz.id}/preview`);\r\n    }\r\n  };\r\n  \r\n  // üîí Handle password modal close\r\n  const handlePasswordClose = () => {\r\n    setShowPasswordModal(false);\r\n    setSelectedQuiz(null);\r\n  };\r\n  \r\n  const categories = Array.from(new Set(quizzes.map(q => q.category)));\r\n  const difficulties = Array.from(new Set(quizzes.map(q => q.difficulty)));\r\n  const difficultyOrder: Record<Quiz['difficulty'], number> = {\r\n    easy: 1,\r\n    medium: 2,\r\n    hard: 3,\r\n  };\r\n  const difficultyOptionFallback = useCallback((level: Quiz['difficulty']) => {\r\n    switch (level) {\r\n      case 'easy':\r\n        return 'üòä D·ªÖ';\r\n      case 'medium':\r\n        return 'üòê Trung b√¨nh';\r\n      case 'hard':\r\n        return 'üò§ Kh√≥';\r\n      default:\r\n        return level;\r\n    }\r\n  }, []);\r\n  \r\n  // Ch·ªâ hi·ªÉn th·ªã quiz ƒë√£ ƒë∆∞·ª£c duy·ªát - C·∫¢ PUBLIC V√Ä PASSWORD ƒê·ªÄU HI·ªÇN TH·ªä üîí\r\n  let filtered = approvedQuizzes.filter(q => {\r\n    const hasResources = quizHasResources(q);\r\n\r\n    return (\r\n      (category === 'all' || q.category === category) &&\r\n      (difficulty === 'all' || q.difficulty === difficulty) &&\r\n      (showCompleted || !q.isCompleted) &&\r\n      q.title.toLowerCase().includes(search.toLowerCase()) &&\r\n      (resourceFilter === 'all' ||\r\n        (resourceFilter === 'with-resources' && hasResources) ||\r\n        (resourceFilter === 'no-resources' && !hasResources))\r\n    );\r\n  });\r\n\r\n  // Sorting logic\r\n  filtered = filtered.sort((a, b) => {\r\n    switch (sortBy) {\r\n      case 'newest':\r\n        return new Date(b.createdAt || 0).getTime() - new Date(a.createdAt || 0).getTime();\r\n      case 'oldest':\r\n        return new Date(a.createdAt || 0).getTime() - new Date(b.createdAt || 0).getTime();\r\n      case 'popular':\r\n        return (b.totalPlayers || 0) - (a.totalPlayers || 0);\r\n      case 'difficulty': {\r\n        return (difficultyOrder[a.difficulty] || 2) - (difficultyOrder[b.difficulty] || 2);\r\n      }\r\n      default:\r\n        return 0;\r\n    }\r\n  });\r\n\r\n  // Retry connection handler\r\n  const handleRetry = () => {\r\n    setRetryCount(0);\r\n    dispatch(fetchQuizzes({}));\r\n  };\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 py-8\">\r\n        <div className=\"max-w-5xl mx-auto px-4\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-red-600 text-xl mb-4\">\r\n              {error}\r\n            </div>\r\n            <button\r\n              onClick={handleRetry}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors\"\r\n            >\r\n              {t('quiz.retryConnection')}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 py-8\">\r\n        <div className=\"max-w-5xl mx-auto px-4\">\r\n          <div className=\"flex justify-center items-center space-x-2\">\r\n            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\r\n            <span className=\"text-gray-600\">{t('quiz.loadingData')}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-7xl mx-auto px-4\">\r\n        {/* Header Section */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-4xl font-bold text-gray-900 mb-2\">{title || t('quiz.discoverTitle')}</h1>\r\n              <p className=\"text-gray-600 text-lg\">{t('quiz.discoverDescription')}</p>\r\n            </div>\r\n            <div className=\"flex items-center gap-4\">\r\n              <button\r\n                onClick={() => setShowStats(!showStats)}\r\n                className={`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${\r\n                  showStats ? 'bg-blue-50 border-blue-200 text-blue-700' : 'border-gray-300 text-gray-600 hover:bg-gray-50'\r\n                }`}\r\n              >\r\n                <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                  <path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/>\r\n                </svg>\r\n                {showStats\r\n                  ? translate('quiz.hideStats', '·∫®n th·ªëng k√™')\r\n                  : translate('quiz.showStats', 'Hi·ªán th·ªëng k√™')}\r\n              </button>\r\n              {/* Multiplayer Button - N·ªïi b·∫≠t */}\r\n              <button \r\n                onClick={() => navigate('/multiplayer')}\r\n                className=\"group relative flex items-center gap-2 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 text-white px-5 py-2.5 rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 font-semibold overflow-hidden\"\r\n              >\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\r\n                <svg className=\"w-5 h-5 relative z-10 group-hover:rotate-12 transition-transform\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path d=\"M8 3C4.13 3 1 6.13 1 10c0 2.38 1.19 4.47 3 5.74V21l6-3h2c3.87 0 7-3.13 7-7s-3.13-7-7-7H8zm13 0v6l3 3-3 3v6l-5.5-4.5L18 13l3-3-3-3V1l3 2z\"/>\r\n                </svg>\r\n                <span className=\"relative z-10\">üéÆ {t('quiz.playWithFriends')}</span>\r\n                <span className=\"absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-0.5 rounded-bl-lg rounded-tr-lg\">{t('quiz.hotBadge')}</span>\r\n              </button>\r\n              {(user?.role === 'creator' || user?.role === 'admin') && (\r\n                <button \r\n                  onClick={() => navigate(ROUTES.CREATOR_NEW_QUIZ)}\r\n                  className=\"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n                  </svg>\r\n                  {t('quiz.createNew')}\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Statistics Panel */}\r\n        {showStats && quizzes.length > 0 && (\r\n          <QuizStats quizzes={quizzes} />\r\n        )}\r\n\r\n        {/* Enhanced Filter Section */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8\">\r\n          {/* üÜï Resource Filter Tabs */}\r\n          <div className=\"flex items-center gap-2 mb-6 p-1 bg-gray-100 rounded-lg w-fit\">\r\n            <button\r\n              onClick={() => setResourceFilter('all')}\r\n              className={`px-6 py-2.5 rounded-lg font-semibold transition-all ${\r\n                resourceFilter === 'all'\r\n                  ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md'\r\n                  : 'text-gray-600 hover:text-gray-900'\r\n              }`}\r\n            >\r\n              üìö {translate('quiz.resourceFilter.all', 'T·∫•t c·∫£ Quiz')} ({approvedQuizzes.length})\r\n            </button>\r\n            <button\r\n              onClick={() => setResourceFilter('with-resources')}\r\n              className={`px-6 py-2.5 rounded-lg font-semibold transition-all flex items-center gap-2 ${\r\n                resourceFilter === 'with-resources'\r\n                  ? 'bg-gradient-to-r from-emerald-600 to-teal-600 text-white shadow-md'\r\n                  : 'text-gray-600 hover:text-gray-900'\r\n              }`}\r\n            >\r\n              <span className=\"text-lg\">üìñ</span>\r\n              {translate('quiz.resourceFilter.withResources', 'C√≥ t√†i li·ªáu h·ªçc t·∫≠p')} ({approvedQuizzes.filter(quizHasResources).length})\r\n            </button>\r\n            <button\r\n              onClick={() => setResourceFilter('no-resources')}\r\n              className={`px-6 py-2.5 rounded-lg font-semibold transition-all flex items-center gap-2 ${\r\n                resourceFilter === 'no-resources'\r\n                  ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-md'\r\n                  : 'text-gray-600 hover:text-gray-900'\r\n              }`}\r\n            >\r\n              <span className=\"text-lg\">‚ö°</span>\r\n              {translate('quiz.resourceFilter.noResources', 'L√†m tr·ª±c ti·∫øp')} ({approvedQuizzes.filter(q => !quizHasResources(q)).length})\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">\r\n            {/* Enhanced Search */}\r\n            <div className=\"lg:col-span-2 relative\">\r\n              <div className=\"relative\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder={searchPlaceholder}\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"w-full border border-gray-300 rounded-lg p-3 pl-10 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                />\r\n                <svg className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n                </svg>\r\n                {search && (\r\n                  <button\r\n                    onClick={() => setSearch('')}\r\n                    className=\"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 hover:text-gray-600\"\r\n                  >\r\n                    <svg fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                    </svg>\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Category Filter */}\r\n            <select \r\n              className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\" \r\n              value={category} \r\n              onChange={e => setCategory(e.target.value)}\r\n            >\r\n              <option value=\"all\">{translate('quiz.filters.allCategoriesOption', 'üè∑Ô∏è T·∫•t c·∫£ danh m·ª•c')}</option>\r\n              {categories.map(c => <option key={c} value={c}>{c}</option>)}\r\n            </select>\r\n            \r\n            {/* Difficulty Filter */}\r\n            <select \r\n              className=\"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\" \r\n              value={difficulty} \r\n              onChange={e => setDifficulty(e.target.value)}\r\n            >\r\n              <option value=\"all\">{translate('quiz.filters.allDifficultiesOption', 'üìä T·∫•t c·∫£ ƒë·ªô kh√≥')}</option>\r\n              {difficulties.map(d => (\r\n                <option key={d} value={d}>\r\n                  {translate(`quiz.difficultyOptions.${d}`, difficultyOptionFallback(d))}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Advanced Controls */}\r\n          <div className=\"flex flex-wrap items-center justify-between gap-4 pt-4 border-t border-gray-100\">\r\n            <div className=\"flex items-center gap-4\">\r\n              {/* Sort Options */}\r\n              <select \r\n                className=\"border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\" \r\n                value={sortBy} \r\n                onChange={e => setSortBy(e.target.value)}\r\n              >\r\n                <option value=\"newest\">üÜï {t('quiz.sort.newest')}</option>\r\n                <option value=\"oldest\">üìÖ {t('quiz.sort.oldest')}</option>\r\n                <option value=\"popular\">üî• {t('quiz.sort.popular')}</option>\r\n                <option value=\"difficulty\">üìà {t('quiz.sort.byDifficulty')}</option>\r\n              </select>\r\n\r\n              {/* Show Completed Toggle */}\r\n              <label className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={showCompleted}\r\n                  onChange={e => setShowCompleted(e.target.checked)}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                {t('quiz.showCompleted')}\r\n              </label>\r\n            </div>\r\n\r\n            {/* View Mode Toggle */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-600\">{t('quiz.viewMode.label')}:</span>\r\n              <div className=\"flex border border-gray-300 rounded-lg overflow-hidden\">\r\n                <button\r\n                  onClick={() => setViewMode('grid')}\r\n                  className={`p-2 ${viewMode === 'grid' ? 'bg-blue-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}\r\n                  title={t('quiz.viewMode.grid')}\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path d=\"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\r\n                  </svg>\r\n                </button>\r\n                <button\r\n                  onClick={() => setViewMode('list')}\r\n                  className={`p-2 ${viewMode === 'list' ? 'bg-blue-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}\r\n                  title={t('quiz.viewMode.list')}\r\n                >\r\n                  <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Results Summary */}\r\n          <div className=\"mt-4 text-sm text-gray-600\">\r\n            {resultsFoundLabel} <span className=\"font-semibold text-blue-600\">{filtered.length}</span> {itemLabel}\r\n            {search && (\r\n              <span>\r\n                {' '}\r\n                {translate('quiz.resultsSummary.searchTerm', 'cho \"{{term}}\"', { term: search })}\r\n              </span>\r\n            )}\r\n            {category !== 'all' && (\r\n              <span>\r\n                {' '}\r\n                {translate('quiz.resultsSummary.category', 'trong danh m·ª•c \"{{category}}\"', { category })}\r\n              </span>\r\n            )}\r\n            {difficulty !== 'all' && (\r\n              <span>\r\n                {' '}\r\n                {translate('quiz.resultsSummary.difficulty', 'v·ªõi ƒë·ªô kh√≥ \"{{difficulty}}\"', { difficulty })}\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Quiz Grid/List */}\r\n        <div className={viewMode === 'grid' \r\n          ? \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\" \r\n          : \"space-y-4\"\r\n        }>\r\n          {loading ? (\r\n            Array.from({length: 8}).map((_,i) => <QuizCardSkeleton key={i} />)\r\n          ) : showFirestoreError ? (\r\n            <div className=\"col-span-full bg-red-50 border border-red-200 rounded-xl p-8 text-center\">\r\n              <div className=\"text-red-600 text-xl font-semibold mb-3\">üö´ {t('quiz.errors.connection')}</div>\r\n              <div className=\"text-red-700 mb-6\">{error}</div>\r\n              <div className=\"text-sm text-gray-600 mb-6 max-w-md mx-auto\">\r\n                <div className=\"mb-3\"><strong>{t('quiz.errors.troubleshoot')}:</strong></div>\r\n                <div className=\"space-y-1\">\r\n                  <div>{t('1TatAdBlockerChoLocalhost5174')}</div>\r\n                  <div>{t('2ThemGoogleapiscomVaoWhitelist')}</div>\r\n                  <div>{t('3ThuCheDoIncognitoprivate')}</div>\r\n                  <div>{t('4KiemTraFirewallantivirus')}</div>\r\n                </div>\r\n              </div>\r\n              <button \r\n                className=\"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\" \r\n                onClick={() => dispatch(fetchQuizzes({}))}\r\n              >\r\n                üîÑ {t('quiz.retryConnection')}\r\n              </button>\r\n            </div>\r\n          ) : error ? (\r\n            <div className=\"col-span-full text-center\">\r\n              <div className=\"bg-red-50 border border-red-200 rounded-xl p-8\">\r\n                <div className=\"text-red-600 text-lg font-medium mb-4\">‚ùå {t('quiz.errors.generic')}</div>\r\n                <div className=\"text-red-700 mb-6\">{error}</div>\r\n                <button \r\n                  className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\" \r\n                  onClick={() => dispatch(fetchQuizzes({}))}\r\n                >\r\n                  üîÑ {t('quiz.retryConnection')}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : filtered.length === 0 ? (\r\n            <div className=\"col-span-full text-center\">\r\n              <div className=\"bg-gray-50 border border-gray-200 rounded-xl p-12\">\r\n                <svg className='w-16 h-16 mx-auto text-gray-300 mb-4' fill='none' stroke='currentColor' viewBox='0 0 24 24'>\r\n                  <path strokeLinecap='round' strokeLinejoin='round' strokeWidth={1.5} d='M9.75 17L9 21m6-4l.75 4M4 4v16c0 1.104.896 2 2 2h12a2 2 0 002-2V4M4 4l8 8m0 0l8-8' />\r\n                </svg>\r\n                <h3 className=\"text-xl font-medium text-gray-900 mb-2\">{t('quiz.noResults.title')}</h3>\r\n                <p className=\"text-gray-600 mb-6\">{t('quiz.noResults.description')}</p>\r\n                <div className=\"flex justify-center gap-4\">\r\n                  <button \r\n                    onClick={() => {\r\n                      setSearch('');\r\n                      setCategory('all');\r\n                      setDifficulty('all');\r\n                    }}\r\n                    className=\"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n                  >\r\n                    üîÑ {t('quiz.clearFilters')}\r\n                  </button>\r\n                  {(user?.role === 'creator' || user?.role === 'admin') && (\r\n                    <button \r\n                      className=\"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\" \r\n                      onClick={()=>navigate(ROUTES.CREATOR_NEW_QUIZ)}\r\n                    >\r\n                      ‚ûï {t('quiz.createNew')}\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            filtered.map(quiz => (\r\n              <QuizCard \r\n                key={quiz.id} \r\n                quiz={quiz} \r\n                viewMode={viewMode}\r\n                onStartQuiz={handleQuizStart}\r\n              />\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      {/* üîí Password Modal */}\r\n      {selectedQuiz && showPasswordModal && (\r\n        <PasswordModal\r\n          isOpen={showPasswordModal}\r\n          onClose={handlePasswordClose}\r\n          onSuccess={handlePasswordSuccess}\r\n          passwordData={selectedQuiz.pwd}\r\n          quizTitle={selectedQuiz.title}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuizList;\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\ConfirmationModals.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '/' expected.","line":1,"column":3920,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { Question } from '../../../types';import { useTranslation } from 'react-i18next';import ConfirmDialog from '../../../../../shared/components/ui/ConfirmDialog';interface ConfirmationModalsProps {  modalControls: {    showExitModal: boolean;    setShowExitModal: React.Dispatch<React.SetStateAction<boolean>>;    showSubmitModal: boolean;    setShowSubmitModal: React.Dispatch<React.SetStateAction<boolean>>;    showUnansweredModal: boolean;    setShowUnansweredModal: React.Dispatch<React.SetStateAction<boolean>>;  };  onConfirmExit: () => void;  onConfirmSubmit: () => void;  unansweredQuestions: Question[];  onGoToQuestion: (index: number) => void;}const ConfirmationModals: React.FC<ConfirmationModalsProps> = ({  modalControls,  onConfirmExit,  onConfirmSubmit,  unansweredQuestions,  onGoToQuestion,}) => {  const { t } = useTranslation();  return (    <>      {/* Exit Confirmation Modal */}      <ConfirmDialog        isOpen={modalControls.showExitModal}        onClose={() => modalControls.setShowExitModal(false)}        onConfirm={onConfirmExit}        title=\"‚ö†Ô∏è Tho√°t kh·ªèi b√†i Quiz?\"        message=\"Ti·∫øn ƒë·ªô l√†m b√†i c·ªßa b·∫°n s·∫Ω b·ªã m·∫•t n·∫øu tho√°t b√¢y gi·ªù. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ti·∫øp t·ª•c?\"        confirmText=\"Tho√°t\"        cancelText=\"Ti·∫øp t·ª•c l√†m b√†i\"        type=\"danger\"      />      {/* Submit Confirmation Modal */}      <ConfirmDialog        isOpen={modalControls.showSubmitModal}        onClose={() => modalControls.setShowSubmitModal(false)}        onConfirm={onConfirmSubmit}        title=\"‚úÖ N·ªôp b√†i Quiz?\"        message=\"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i? Sau khi n·ªôp s·∫Ω kh√¥ng th·ªÉ thay ƒë·ªïi ƒë√°p √°n.\"        confirmText=\"N·ªôp b√†i\"        cancelText={t(\"common.cancel\")}        type=\"info\"      />      {/* Unanswered Questions Modal */}      {modalControls.showUnansweredModal && (        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">          <div className=\"bg-white rounded-lg p-6 max-w-lg mx-4\">            // eslint-disable-next-line i18next/no-literal-string            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">              C√≤n c√¢u h·ªèi ch∆∞a tr·∫£ l·ªùi            </h3>            // eslint-disable-next-line i18next/no-literal-string            <p className=\"text-gray-600 mb-4\">              // eslint-disable-next-line i18next/no-literal-string              B·∫°n c√≤n {unansweredQuestions.length} c√¢u h·ªèi ch∆∞a tr·∫£ l·ªùi:            </p>            <div className=\"max-h-40 overflow-y-auto mb-6\">              {unansweredQuestions.map((question, index) => (                <button                  key={question.id}                  onClick={() => {                    modalControls.setShowUnansweredModal(false);                    onGoToQuestion(index);                  }}                  className=\"block w-full text-left p-2 hover:bg-gray-100 rounded text-blue-600 hover:text-blue-800\"                // eslint-disable-next-line i18next/no-literal-string                >                  C√¢u {index + 1}: {question.text.slice(0, 50)}...                </button>              ))}            </div>            <div className=\"flex gap-3\">              <button                onClick={() => modalControls.setShowUnansweredModal(false)}                className=\"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors\"              // eslint-disable-next-line i18next/no-literal-string              >                Ti·∫øp t·ª•c l√†m b√†i              </button>              <button                onClick={onConfirmSubmit}                className=\"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors\"              // eslint-disable-next-line i18next/no-literal-string              >                N·ªôp b√†i lu√¥n              </button>            </div>          </div>        </div>      )}    </>  );};export default ConfirmationModals;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\LearningResourcesView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\ProgressIndicator.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';interface ProgressIndicatorProps {  current: number;  total: number;  percentage: number;}const ProgressIndicator: React.FC<ProgressIndicatorProps> = ({   current","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';interface ProgressIndicatorProps {  current: number;  total: number;  percentage: number;}const ProgressIndicator: React.FC<ProgressIndicatorProps> = ({   current' was not found.","line":1,"column":1,"endLine":1,"endColumn":925,"severity":2,"nodeType":null},{"ruleId":"total","message":"Definition for rule 'total' was not found.","line":1,"column":1,"endLine":1,"endColumn":925,"severity":2,"nodeType":null},{"ruleId":"percentage}) => {  return (    <div className=\"bg-white rounded-lg shadow-md p-4\">      <div className=\"flex items-center justify-between mb-3\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-sm font-medium text-gray-600\">Ti·∫øn ƒë·ªô</span>        <span className=\"text-sm font-bold text-gray-900\">          {current} / {total}        </span>      </div>            <div className=\"w-full bg-gray-200 rounded-full h-2\">        <div           className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"          style={{ width: `${percentage}%` }}        ></div>      </div>    </div>  );};export default ProgressIndicator;","message":"Definition for rule 'percentage}) => {  return (    <div className=\"bg-white rounded-lg shadow-md p-4\">      <div className=\"flex items-center justify-between mb-3\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-sm font-medium text-gray-600\">Ti·∫øn ƒë·ªô</span>        <span className=\"text-sm font-bold text-gray-900\">          {current} / {total}        </span>      </div>            <div className=\"w-full bg-gray-200 rounded-full h-2\">        <div           className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"          style={{ width: `${percentage}%` }}        ></div>      </div>    </div>  );};export default ProgressIndicator;' was not found.","line":1,"column":1,"endLine":1,"endColumn":925,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';interface ProgressIndicatorProps {  current: number;  total: number;  percentage: number;}const ProgressIndicator: React.FC<ProgressIndicatorProps> = ({   current,   total,   percentage}) => {  return (    <div className=\"bg-white rounded-lg shadow-md p-4\">      <div className=\"flex items-center justify-between mb-3\">        // eslint-disable-next-line i18next/no-literal-string        <span className=\"text-sm font-medium text-gray-600\">Ti·∫øn ƒë·ªô</span>        <span className=\"text-sm font-bold text-gray-900\">          {current} / {total}        </span>      </div>            <div className=\"w-full bg-gray-200 rounded-full h-2\">        <div           className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"          style={{ width: `${percentage}%` }}        ></div>      </div>    </div>  );};export default ProgressIndicator;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\QuestionRenderer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\QuickNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\components\\Timer.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":3035,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';interface TimerProps {  timeLeft: string;  isWarning: boolean;  isCritical: boolean;  percentage?: number;}const Timer: React.FC<TimerProps> = ({ timeLeft, isWarning, isCritical, percentage = 0 }) => {  const getTimerColor = () => {    if (isCritical) return 'text-red-600';    if (isWarning) return 'text-amber-600';    return 'text-blue-600'; // Changed to blue for better aesthetics  };  const getBackgroundColor = () => {    if (isCritical) return 'bg-red-50 border-red-200';    if (isWarning) return 'bg-amber-50 border-amber-200';    return 'bg-blue-50 border-blue-200'; // Changed to blue theme  };  const getProgressColor = () => {    if (isCritical) return 'bg-red-500';    if (isWarning) return 'bg-amber-500';    return 'bg-blue-500'; // Changed to blue for consistency  };  return (    <div className={`rounded-md border p-3 transition-all duration-300 ${getBackgroundColor()} ${isCritical ? 'animate-pulse' : ''}`}>      <div className=\"flex items-center justify-between mb-2\">        <span className=\"text-xs font-medium text-gray-600 flex items-center\">          <svg className=\"w-3 h-3 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />          // eslint-disable-next-line i18next/no-literal-string          </svg>          Th·ªùi gian c√≤n l·∫°i        </span>        <span className={`text-lg font-bold font-mono ${getTimerColor()}`}>          {timeLeft}        </span>      </div>            {/* Compact progress bar */}      <div className=\"w-full bg-gray-200 rounded-full h-1.5\">        <div           className={`h-1.5 rounded-full transition-all duration-1000 ${getProgressColor()}`}          style={{ width: `${Math.min(percentage, 100)}%` }}        ></div>      </div>            {/* Subtle warning messages */}      {isCritical && (        <div className=\"text-xs text-red-600 font-medium mt-1 flex items-center\">          <svg className=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">            <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />          // eslint-disable-next-line i18next/no-literal-string          </svg>          S·∫Øp h·∫øt gi·ªù!        </div>      )}            {isWarning && !isCritical && (        <div className=\"text-xs text-amber-600 font-medium mt-1 flex items-center\">          <svg className=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />          // eslint-disable-next-line i18next/no-literal-string          </svg>          C√≤n √≠t th·ªùi gian        </div>      )}    </div>  );};export default Timer;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\hooks\\useQuizData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\hooks\\useQuizNavigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\hooks\\useQuizSession.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\hooks\\useQuizTimer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\index.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":10747,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { useSelector } from 'react-redux';import { RootState } from '../../../../lib/store';import { useQuizData, useQuizSession, useQuizTimer, useQuizNavigation } from './hooks';import Timer from './components/Timer';import ProgressIndicator from './components/ProgressIndicator';import QuestionRenderer from './components/QuestionRenderer';import QuickNavigation from './components/QuickNavigation';import ConfirmationModals from './components/ConfirmationModals';import LearningResourcesView from './components/LearningResourcesView';import QuizPasswordModal from '../../../../shared/components/ui/QuizPasswordModal';import { unlockQuiz } from '../../../../lib/services/quizAccessService';import { toast } from 'react-toastify';import { Quiz, AnswerValue } from '../../types';const QuizPage: React.FC = () => {  const { quiz, loading, error, needsPassword, quizMetadata, retryLoad } = useQuizData();  const user = useSelector((state: RootState) => state.auth.user);  const [showResources, setShowResources] = useState(true);  const [hasViewedResources, setHasViewedResources] = useState(false);  // Handle password submission  const handlePasswordSubmit = async (password: string): Promise<boolean> => {    if (!quizMetadata || !user) {      toast.error('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p quiz');      return false;    }    try {      const success = await unlockQuiz(        quizMetadata.id,        user.uid,        password,        quizMetadata      );      if (success) {        toast.success('üéâ ƒê√£ m·ªü kh√≥a quiz th√†nh c√¥ng!');        // Retry loading questions        retryLoad();        return true;      }      return false;    } catch (err) {      console.error('Error unlocking quiz:', err);      toast.error('C√≥ l·ªói x·∫£y ra khi m·ªü kh√≥a quiz');      return false;    }  };  if (loading) {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>          <p className=\"mt-4 text-gray-600\">ƒêang t·∫£i quiz...</p>        </div>      </div>    );  }  // Show password modal if needed  if (needsPassword && quizMetadata) {    return (      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50\">        <QuizPasswordModal          isOpen={true}          quizTitle={quizMetadata.title}          onClose={() => window.history.back()}          onSubmit={handlePasswordSubmit}        />      </div>    );  }  if (error || !quiz) {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          // eslint-disable-next-line i18next/no-literal-string          <div className=\"text-red-500 text-6xl mb-4\">‚ö†Ô∏è</div>          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Kh√¥ng th·ªÉ t·∫£i quiz</h2>          <p className=\"text-gray-600\">{error || 'Quiz kh√¥ng t·ªìn t·∫°i'}</p>        </div>      </div>    );  }  // Check if quiz has learning resources  const hasResources = quiz.resources && quiz.resources.length > 0;  // Show resources view first if available and not viewed yet  if (hasResources && showResources && !hasViewedResources) {    return (      <LearningResourcesView        resources={quiz.resources || []}        onComplete={() => {          setHasViewedResources(true);          setShowResources(false);        }}        onSkip={() => {          setShowResources(false);        }}      />    );  }  return <QuizPageContent quiz={quiz} />;};interface QuizPageContentProps {  quiz: Quiz;}const QuizPageContent: React.FC<QuizPageContentProps> = ({ quiz }) => {  // const navigate = useNavigate();  const {    session,    updateAnswer,    setCurrentQuestion,    completeQuiz,    getUnansweredQuestions,    progress  } = useQuizSession({ quiz });  const {    formattedTime,    isTimeRunningOut,    isTimeCritical,    percentage  } = useQuizTimer({    onTimeUp: completeQuiz,    isActive: !session.isCompleted  });  const {    goToNextQuestion,    goToPreviousQuestion,    goToQuestion,    handleExitQuiz,    confirmExitQuiz,    handleSubmitQuiz,    isFirstQuestion,    isLastQuestion,    modalControls  } = useQuizNavigation({    questions: quiz.questions,    currentQuestionIndex: session.currentQuestionIndex,    onQuestionChange: setCurrentQuestion,    answers: session.answers  });  const currentQuestion = quiz.questions[session.currentQuestionIndex];  if (session.isCompleted) {    return (      <div className=\"min-h-screen flex items-center justify-center\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto\"></div>          <p className=\"mt-4 text-gray-600\">ƒêang x·ª≠ l√Ω k·∫øt qu·∫£...</p>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8\">      {/* Header v·ªõi Timer v√† Progress */}      <div className=\"bg-white shadow-sm border-b\">        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">          <div className=\"flex items-center justify-between\">            <div className=\"flex items-center space-x-4\">              <button                onClick={handleExitQuiz}                className=\"flex items-center space-x-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors\"              >                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />                </svg>                // eslint-disable-next-line i18next/no-literal-string                <span>Tho√°t</span>              </button>              <div className=\"h-6 w-px bg-gray-300\"></div>              <h1 className=\"text-xl font-semibold text-gray-800\">{quiz.title}</h1>            </div>                        <div className=\"flex items-center space-x-3\">              <ProgressIndicator                current={session.currentQuestionIndex + 1}                total={quiz.questions.length}                percentage={progress}              />              <Timer                timeLeft={formattedTime}                isWarning={isTimeRunningOut}                isCritical={isTimeCritical}                percentage={percentage}              />            </div>          </div>        </div>      </div>      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">          {/* Navigation Panel */}          <div className=\"lg:col-span-1\">            <QuickNavigation              questions={quiz.questions}              currentQuestionIndex={session.currentQuestionIndex}              answers={session.answers}              onQuestionSelect={goToQuestion}            />          </div>          {/* Main Quiz Content */}          <div className=\"lg:col-span-3\">            <div className=\"bg-white rounded-lg shadow-sm border p-8\">              <QuestionRenderer                question={currentQuestion}                questionNumber={session.currentQuestionIndex + 1}                value={session.answers[currentQuestion.id]}                onChange={(answer: AnswerValue) => updateAnswer(currentQuestion.id, answer)}              />              {/* Navigation Buttons */}              <div className=\"flex items-center justify-between mt-8 pt-6 border-t\">                <button                  onClick={goToPreviousQuestion}                  disabled={isFirstQuestion}                  className={`flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition-all ${                    isFirstQuestion                      ? 'bg-gray-100 text-gray-400 cursor-not-allowed'                      : 'bg-gray-600 text-white hover:bg-gray-700 shadow-sm hover:shadow-md'                  }`}                >                  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />                  </svg>                  // eslint-disable-next-line i18next/no-literal-string                  <span>C√¢u tr∆∞·ªõc</span>                </button>                <div className=\"flex space-x-3\">                  {isLastQuestion ? (                    <button                      onClick={handleSubmitQuiz}                      className=\"flex items-center space-x-2 px-8 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 shadow-sm hover:shadow-md transition-all\"                    >                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />                      </svg>                      // eslint-disable-next-line i18next/no-literal-string                      <span>N·ªôp b√†i</span>                    </button>                  ) : (                    <button                      onClick={goToNextQuestion}                      className=\"flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 shadow-sm hover:shadow-md transition-all\"                    >                      // eslint-disable-next-line i18next/no-literal-string                      <span>C√¢u ti·∫øp</span>                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />                      </svg>                    </button>                  )}                </div>              </div>            </div>          </div>        </div>      </div>      {/* Modals */}      <ConfirmationModals        modalControls={modalControls}        onConfirmExit={confirmExitQuiz}        onConfirmSubmit={completeQuiz}        unansweredQuestions={getUnansweredQuestions()}        onGoToQuestion={goToQuestion}      />      {/* Th√™m c·∫£nh b√°o h·∫øt gi·ªù n·∫øu c·∫ßn thi·∫øt - hi·ªán khi c√≤n <= 10% t·ªïng th·ªùi gian */}      {isTimeRunningOut && (        <div className=\"mb-4 p-3 bg-red-100 border border-red-300 text-red-600 rounded-lg flex items-center gap-2\">          <span className=\"text-xl\">‚è∞</span>          <span className=\"font-medium\">            {isTimeCritical               ? \"Ch·ªâ c√≤n √≠t h∆°n 1 ph√∫t! H√£y ho√†n th√†nh ngay.\"               : \"S·∫Øp h·∫øt gi·ªù! Ch·ªâ c√≤n 10% th·ªùi gian.\"}          </span>        </div>      )}    </div>  );};export default QuizPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPage\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizPreviewPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizResultViewer\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizResultViewer\\index.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":5816,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState, useEffect } from 'react';import { useParams, useNavigate } from 'react-router-dom';import { getQuizResultById } from '../../api/base';import { getQuizById } from '../../services/quiz';import { QuizResult, Quiz } from '../../types';import { toast } from 'react-toastify';import QuizReviewSystem from '../../../../shared/components/QuizReviewSystem';import {  Confetti,  LoadingSpinner,  ResultSummary,  StatsGrid,  PerformanceAnalysis,  AnswerReview,  ActionButtons} from '../ResultPage/components';import { useLeaderboard } from '../ResultPage/hooks';import { Leaderboard } from '../ResultPage/components';interface QuizResultViewerProps {}export const QuizResultViewer: React.FC<QuizResultViewerProps> = () => {  const { resultId } = useParams<{ resultId: string }>();  const navigate = useNavigate();    const [result, setResult] = useState<QuizResult | null>(null);  const [quiz, setQuiz] = useState<Quiz | null>(null);  const [loading, setLoading] = useState(true);  useEffect(() => {    const loadData = async () => {      if (!resultId) {        console.error('‚ùå No resultId provided');        navigate('/profile');        return;      }      try {        setLoading(true);        console.log('üîç Loading quiz result:', resultId);        // Fetch quiz result        const resultData = await getQuizResultById(resultId);        if (!resultData) {          console.error('‚ùå Quiz result not found:', resultId);          toast.error('Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ quiz!');          navigate('/profile');          return;        }        console.log('‚úÖ Loaded quiz result:', resultData);        setResult(resultData as QuizResult);        // Fetch quiz details        if (resultData.quizId) {          console.log('üîç Loading quiz details:', resultData.quizId);          const quizData = await getQuizById(resultData.quizId);          if (quizData) {            console.log('‚úÖ Loaded quiz details:', quizData.title);            setQuiz(quizData);          }        }      } catch (error) {        console.error('‚ùå Error loading data:', error);        toast.error('Kh√¥ng th·ªÉ t·∫£i k·∫øt qu·∫£ quiz!');        navigate('/profile');      } finally {        setLoading(false);      }    };    loadData();  }, [resultId, navigate]);  // Calculate percentage with unified logic (same as before)  const getPercentage = () => {    if (!result) return 0;        // Primary: Use correctAnswers/totalQuestions if available    if (typeof result.correctAnswers === 'number' && typeof result.totalQuestions === 'number' && result.totalQuestions > 0) {      return Math.round((result.correctAnswers / result.totalQuestions) * 100);    }     // Fallback: Use score field    else if (typeof result.score === 'number' && !isNaN(result.score)) {      return result.score <= 1 ? Math.round(result.score * 100) : Math.round(result.score);    }    return 0;  };  const percentage = getPercentage();  const correct = result?.correctAnswers || 0;  const total = result?.totalQuestions || 0;  // Transform result to match ResultPage format  const transformedResult = result ? {    score: percentage, // Use calculated percentage as score    correct: correct,    total: total,    timeSpent: result.timeSpent,    answers: result.answers?.reduce((acc, answer) => {      acc[answer.questionId] = answer.selectedAnswerId || '';      return acc;    }, {} as Record<string, string>) || {},    completedAt: result.completedAt,    isTimeUp: false, // Can add this field if needed    quizId: result.quizId  } : null;  // Pass current result to leaderboard  const currentResult = transformedResult ? {    score: { percentage },    correct,    total,    timeSpent: transformedResult.timeSpent  } : undefined;    const { leaderboard, userRank, loadingStats } = useLeaderboard(quiz?.id || null, currentResult);  if (loading) {    return <LoadingSpinner />;  }  if (!result || !quiz || !transformedResult) {    return (      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">        <div className=\"text-center\">          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£</h2>          <button            onClick={() => navigate('/profile')}            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"          // eslint-disable-next-line i18next/no-literal-string          >            Quay l·∫°i Profile          </button>        </div>      </div>    );  }  const isExcellent = percentage >= 80;  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8\">      {isExcellent && <Confetti />}            <div className=\"max-w-4xl mx-auto px-4\">        {/* K·∫øt qu·∫£ t·ªïng quan */}        <ResultSummary           result={transformedResult}           percentage={percentage}           correct={correct}           total={total}         />        {/* Stats Grid */}        <StatsGrid           correct={correct}           total={total}           percentage={percentage}         />        {/* Performance Analysis */}        <PerformanceAnalysis           quiz={quiz}           result={transformedResult}           percentage={percentage}         />        {/* Review Answers Section */}        <AnswerReview           quiz={quiz}           result={transformedResult}         />        {/* Leaderboard */}        <Leaderboard           leaderboard={leaderboard}           userRank={userRank}           loadingStats={loadingStats}         />        {/* Quiz Review System */}        <QuizReviewSystem           quizId={quiz.id}          quizTitle={quiz.title}          showSubmitForm={true}        />        {/* Action Buttons */}        <ActionButtons           quiz={quiz}           percentage={percentage}         />      </div>    </div>  );};export default QuizResultViewer;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\QuizReviewsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":24,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1137,1140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1137,1140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1187,1190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1187,1190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4117,4120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4117,4120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4315,4318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4315,4318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4386,4389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4386,4389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4457,4460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4457,4460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4528,4531],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4528,4531],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4599,4602],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4599,4602],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { reviewService } from '../services/reviewService';\r\nimport ReviewForm from '../components/ReviewForm';\r\nimport ReviewList from '../components/ReviewList';\r\nimport { Quiz } from '../types';\r\nimport { getQuizById } from '../api';\r\nimport { Star, Users, TrendingUp, MessageSquare, BarChart3, RefreshCw } from 'lucide-react';\r\nimport { toast } from 'react-toastify';\r\nimport { doc, updateDoc, arrayUnion, arrayRemove, getDoc } from 'firebase/firestore';\r\nimport { db } from '../../../firebase/config';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../lib/store';\r\n\r\nimport { useTranslation } from 'react-i18next';\r\nimport SafeHTML from '../../../shared/components/ui/SafeHTML';\r\n\r\nconst QuizReviewsPage: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const currentUser = useSelector((state: RootState) => state.auth.user);\r\n\r\n  const { id: quizId } = useParams<{ id: string }>();\r\n  const [quiz, setQuiz] = useState<Quiz | null>(null);\r\n  const [reviews, setReviews] = useState<any[]>([]);\r\n  const [stats, setStats] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showReviewForm, setShowReviewForm] = useState(false);\r\n\r\n  const loadQuizAndReviews = useCallback(async () => {\r\n    if (!quizId) {\r\n      console.error('‚ùå No quizId provided');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    console.log('üîÑ Starting to load quiz and reviews for:', quizId);\r\n    \r\n    try {\r\n      // Step 1: Load quiz details (REQUIRED)\r\n      console.log('üìù Loading quiz details...');\r\n      let quizData;\r\n      try {\r\n        quizData = await getQuizById(quizId);\r\n        console.log('üîç Raw quiz data from API:', quizData);\r\n        \r\n        if (!quizData) {\r\n          console.error('‚ùå Quiz not found in database for ID:', quizId);\r\n          \r\n          // Create a fallback quiz object for testing\r\n          console.log('üîß Creating fallback quiz for testing...');\r\n          const fallbackQuiz: Quiz = {\r\n            id: quizId,\r\n            title: `Quiz Sample ${quizId}`,\r\n            description: 'ƒê√¢y l√† quiz m·∫´u ƒë·ªÉ test h·ªá th·ªëng ƒë√°nh gi√°',\r\n            category: 'General',\r\n            difficulty: 'easy' as const,\r\n            questions: [\r\n              {\r\n                id: '1',\r\n                text: 'C√¢u h·ªèi m·∫´u?',\r\n                type: 'multiple',\r\n                answers: [\r\n                  { id: '1', text: 'ƒê√°p √°n A', isCorrect: true },\r\n                  { id: '2', text: 'ƒê√°p √°n B', isCorrect: false },\r\n                  { id: '3', text: 'ƒê√°p √°n C', isCorrect: false },\r\n                  { id: '4', text: 'ƒê√°p √°n D', isCorrect: false }\r\n                ],\r\n                explanation: 'Gi·∫£i th√≠ch m·∫´u',\r\n                points: 10\r\n              }\r\n            ],\r\n            duration: 300,\r\n            createdBy: 'system',\r\n            createdAt: new Date(),\r\n            updatedAt: new Date(),\r\n            isPublished: true,\r\n            tags: ['sample', 'test']\r\n          };\r\n          setQuiz(fallbackQuiz);\r\n          console.log('‚úÖ Using fallback quiz for testing');\r\n        } else {\r\n          console.log('‚úÖ Quiz data loaded successfully:', quizData.title);\r\n          setQuiz(quizData);\r\n        }\r\n      } catch (quizError) {\r\n        console.error('‚ùå Failed to load quiz:', quizError);\r\n        toast.error(t('quizReviews.errors.notFound'));\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Step 2: Load reviews (OPTIONAL - don't fail if reviews fail)\r\n      console.log('üìä Loading reviews...');\r\n      try {\r\n        // Try simple query first to avoid index issues\r\n        const reviewsData = await reviewService.getQuizReviewsSimple(quizId);\r\n        console.log(`‚úÖ Reviews loaded: ${reviewsData.length} reviews found`);\r\n        setReviews(reviewsData || []);\r\n\r\n        // Calculate stats from reviews\r\n        if (reviewsData && reviewsData.length > 0) {\r\n          const totalRating = reviewsData.reduce((sum: number, review: any) => sum + (review.rating || 0), 0);\r\n          const averageRating = totalRating / reviewsData.length;\r\n          \r\n          const ratingDistribution = {\r\n            5: reviewsData.filter((r: any) => r.rating === 5).length,\r\n            4: reviewsData.filter((r: any) => r.rating === 4).length,\r\n            3: reviewsData.filter((r: any) => r.rating === 3).length,\r\n            2: reviewsData.filter((r: any) => r.rating === 2).length,\r\n            1: reviewsData.filter((r: any) => r.rating === 1).length\r\n          };\r\n\r\n          setStats({\r\n            totalReviews: reviewsData.length,\r\n            averageRating: Math.round(averageRating * 10) / 10,\r\n            ratingDistribution\r\n          });\r\n          console.log(`üìà Stats calculated: ${reviewsData.length} reviews, ${averageRating.toFixed(1)} avg rating`);\r\n        } else {\r\n          console.log('üìä No reviews found, setting empty stats');\r\n          setStats({\r\n            totalReviews: 0,\r\n            averageRating: 0,\r\n            ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 }\r\n          });\r\n        }\r\n      } catch (reviewError) {\r\n        console.error('‚ö†Ô∏è Error loading reviews:', reviewError);\r\n        \r\n        // Set empty state on error\r\n        setReviews([]);\r\n        setStats({\r\n          totalReviews: 0,\r\n          averageRating: 0,\r\n          ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 }\r\n        });\r\n        toast.error(t('quizReviews.errors.loadFailed'));\r\n      }\r\n\r\n      console.log('üéâ Page loading completed successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Critical error in loadQuizAndReviews:', error);\r\n      toast.error(t('quizReviews.errors.pageLoadFailed'));\r\n    } finally {\r\n      // ALWAYS set loading to false\r\n      setLoading(false);\r\n      console.log('‚úÖ Loading state set to false');\r\n    }\r\n  }, [quizId, t]);\r\n\r\n  useEffect(() => {\r\n    if (quizId) {\r\n      console.log('üéØ QuizReviewsPage mounted with quizId:', quizId);\r\n      loadQuizAndReviews();\r\n    } else {\r\n      console.error('‚ùå No quizId provided in URL params');\r\n      setLoading(false);\r\n    }\r\n  }, [quizId, loadQuizAndReviews]);\r\n\r\n  const handleReviewSubmitted = async () => {\r\n    console.log('üîÑ Review submitted, refreshing data...');\r\n    setShowReviewForm(false);\r\n    \r\n    // Clear current reviews to show loading state\r\n    setReviews([]);\r\n    setLoading(true);\r\n    \r\n    // Add delay to ensure Firebase has processed the write\r\n    setTimeout(() => {\r\n      console.log('‚è∞ Delay completed, reloading reviews with cache bypass...');\r\n      loadQuizAndReviews();\r\n    }, 1500); // Increased delay to 1.5 seconds\r\n  };\r\n\r\n  const handleHelpfulClick = async (reviewId: string) => {\r\n    if (!currentUser?.uid) {\r\n      toast.error('Please login to mark reviews as helpful');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const reviewRef = doc(db, 'quiz_reviews', reviewId);\r\n      const reviewDoc = await getDoc(reviewRef);\r\n      \r\n      if (!reviewDoc.exists()) {\r\n        toast.error('Review not found');\r\n        return;\r\n      }\r\n\r\n      const reviewData = reviewDoc.data();\r\n      const helpfulBy = reviewData.helpfulBy || [];\r\n      \r\n      // Toggle helpful status\r\n      if (helpfulBy.includes(currentUser.uid)) {\r\n        // Remove from helpful\r\n        await updateDoc(reviewRef, {\r\n          helpful: (reviewData.helpful || 1) - 1,\r\n          helpfulBy: arrayRemove(currentUser.uid)\r\n        });\r\n        toast.success('Removed from helpful');\r\n      } else {\r\n        // Add to helpful\r\n        await updateDoc(reviewRef, {\r\n          helpful: (reviewData.helpful || 0) + 1,\r\n          helpfulBy: arrayUnion(currentUser.uid)\r\n        });\r\n        toast.success('Marked as helpful');\r\n      }\r\n\r\n      // Reload reviews to show updated count\r\n      setTimeout(() => loadQuizAndReviews(), 500);\r\n    } catch (error) {\r\n      console.error('Error marking review as helpful:', error);\r\n      toast.error('Failed to update helpful status');\r\n    }\r\n  };\r\n\r\n  const handleReportClick = async (reviewId: string) => {\r\n    if (!currentUser?.uid) {\r\n      toast.error('Please login to report reviews');\r\n      return;\r\n    }\r\n\r\n    const reason = prompt('Please provide a reason for reporting this review:');\r\n    if (!reason || reason.trim() === '') {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const reviewRef = doc(db, 'quiz_reviews', reviewId);\r\n      const reviewDoc = await getDoc(reviewRef);\r\n      \r\n      if (!reviewDoc.exists()) {\r\n        toast.error('Review not found');\r\n        return;\r\n      }\r\n\r\n      const reviewData = reviewDoc.data();\r\n      const reportedBy = reviewData.reportedBy || [];\r\n      \r\n      // Check if user already reported\r\n      if (reportedBy.includes(currentUser.uid)) {\r\n        toast.warning('You have already reported this review');\r\n        return;\r\n      }\r\n\r\n      // Add report\r\n      await updateDoc(reviewRef, {\r\n        reports: (reviewData.reports || 0) + 1,\r\n        reportedBy: arrayUnion(currentUser.uid),\r\n        reportReasons: arrayUnion({\r\n          userId: currentUser.uid,\r\n          reason: reason.trim(),\r\n          reportedAt: new Date().toISOString()\r\n        })\r\n      });\r\n\r\n      toast.success('Review reported successfully. Admins will review it.');\r\n    } catch (error) {\r\n      console.error('Error reporting review:', error);\r\n      toast.error('Failed to report review');\r\n    }\r\n  };\r\n\r\n  const renderRatingDistribution = () => {\r\n    if (!stats) return null;\r\n\r\n    return (\r\n      <div className=\"bg-white rounded-lg p-6 shadow-sm border border-gray-100\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\r\n          <BarChart3 className=\"w-5 h-5 mr-2\" />{t(\"admin.stats.ratingDistribution\")}\r\n        </h3>\r\n        <div className=\"space-y-3\">\r\n          {[5, 4, 3, 2, 1].map(rating => {\r\n            const count = stats.ratingDistribution[rating] || 0;\r\n            const percentage = stats.totalReviews > 0 ? (count / stats.totalReviews) * 100 : 0;\r\n            \r\n            return (\r\n              <div key={rating} className=\"flex items-center space-x-3\">\r\n                <div className=\"flex items-center space-x-1 w-16\">\r\n                  <span className=\"text-sm font-medium\">{rating}</span>\r\n                  <Star className=\"w-3 h-3 fill-yellow-400 text-yellow-400\" />\r\n                </div>\r\n                <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\r\n                  <div \r\n                    className=\"bg-yellow-400 h-2 rounded-full transition-all duration-300\"\r\n                    style={{ width: `${percentage}%` }}\r\n                  />\r\n                </div>\r\n                <span className=\"text-sm text-gray-600 w-12\">{count}</span>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">{t('quizReviews.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!quiz) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"text-6xl mb-4\">üòî</div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('quizReviews.empty.notFound')}</h2>\r\n          <p className=\"text-gray-600 mb-4\">{t('quizReviews.empty.notFoundDesc')}</p>\r\n          <button \r\n            onClick={() => window.history.back()}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n          >{t(\"common.back\")}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {/* Header */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex-1\">\r\n              <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">{quiz.title}</h1>\r\n              <SafeHTML content={quiz.description} className=\"text-gray-600 mb-4\" />\r\n              <div className=\"flex items-center space-x-6 text-sm text-gray-500\">\r\n                <span className=\"flex items-center space-x-1\">\r\n                  <Users className=\"w-4 h-4\" />\r\n                  <span>{quiz.category}</span>\r\n                </span>\r\n                <span className=\"flex items-center space-x-1\">\r\n                  <TrendingUp className=\"w-4 h-4\" />\r\n                  <span className=\"capitalize\">{quiz.difficulty}</span>\r\n                </span>\r\n                <span className=\"flex items-center space-x-1\">\r\n                  <MessageSquare className=\"w-4 h-4\" />\r\n                  <span>{quiz.questions.length} {t('quizReviews.questions')}</span>\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                onClick={() => {\r\n                  loadQuizAndReviews();\r\n                }}\r\n                disabled={loading}\r\n                className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium disabled:opacity-50\"\r\n                title={t('quizReviews.refreshReviews')}\r\n              >\r\n                <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />\r\n              </button>\r\n              <button\r\n                onClick={() => setShowReviewForm(true)}\r\n                className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\r\n              >\r\n                {t('quizReviews.writeReview')}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        {stats && (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n            <div className=\"bg-white rounded-lg p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"flex items-center space-x-4\">\r\n                <div className=\"p-3 bg-blue-100 rounded-full\">\r\n                  <Star className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-2xl font-bold text-gray-900\">\r\n                    {stats.averageRating.toFixed(1)}\r\n                  </p>\r\n                  <p className=\"text-sm text-gray-600\">{t(\"multiplayer.avgScore\")}</p>\r\n                  <div className=\"flex items-center mt-1\">\r\n                    {[1, 2, 3, 4, 5].map(star => (\r\n                      <Star\r\n                        key={star}\r\n                        className={`w-4 h-4 ${\r\n                          star <= Math.round(stats.averageRating)\r\n                            ? 'fill-yellow-400 text-yellow-400'\r\n                            : 'text-gray-300'\r\n                        }`}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-lg p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"flex items-center space-x-4\">\r\n                <div className=\"p-3 bg-green-100 rounded-full\">\r\n                  <MessageSquare className=\"w-6 h-6 text-green-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-2xl font-bold text-gray-900\">\r\n                    {stats?.totalReviews || 0}\r\n                  </p>\r\n                  <p className=\"text-sm text-gray-600\">{t(\"admin.stats.totalReviews\")}</p>\r\n                  <p className=\"text-xs text-gray-500 mt-1\">\r\n                    {stats?.totalReviews === 0 ? t('quizReviews.noReviewsYet') : t('quizReviews.peopleReviewed')}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-lg p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"flex items-center space-x-4\">\r\n                <div className=\"p-3 bg-purple-100 rounded-full\">\r\n                  <TrendingUp className=\"w-6 h-6 text-purple-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-2xl font-bold text-gray-900\">\r\n                    {stats.totalReviews > 0 ? Math.round((stats.ratingDistribution[5] + stats.ratingDistribution[4]) / stats.totalReviews * 100) : 0}%\r\n                  </p>\r\n                  <p className=\"text-sm text-gray-600\">{t('quizReviews.positiveReviews')}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          {/* Rating Distribution */}\r\n          <div className=\"lg:col-span-1\">\r\n            {renderRatingDistribution()}\r\n          </div>\r\n\r\n          {/* Reviews List */}\r\n          <div className=\"lg:col-span-2\">\r\n            <div className=\"bg-white rounded-lg shadow-sm border border-gray-100\">\r\n              <div className=\"p-6 border-b border-gray-100\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                    {t('quizReviews.userReviews', { count: reviews.length })}\r\n                  </h3>\r\n                  <button\r\n                    onClick={() => setShowReviewForm(true)}\r\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\r\n                  >\r\n                    {t('quizReviews.writeReview')}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"p-6\">\r\n                {reviews.length === 0 ? (\r\n                  // Empty State - No Reviews\r\n                  <div className=\"text-center py-12\">\r\n                    <div className=\"text-6xl mb-4\">üí≠</div>\r\n                    <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                      {t('quizReviews.empty.noReviews')}\r\n                    </h3>\r\n                    <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\r\n                      {t('quizReviews.empty.noReviewsDesc')}\r\n                    </p>\r\n                    <button\r\n                      onClick={() => setShowReviewForm(true)}\r\n                      className=\"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\r\n                    >\r\n                      <MessageSquare className=\"w-5 h-5 mr-2\" />\r\n                      {t('quizReviews.empty.writeFirstReview')}\r\n                    </button>\r\n                    \r\n                    {/* Decorative Elements */}\r\n                    <div className=\"mt-8 flex justify-center space-x-4\">\r\n                      <div className=\"w-2 h-2 bg-blue-200 rounded-full animate-pulse\"></div>\r\n                      <div className=\"w-2 h-2 bg-blue-300 rounded-full animate-pulse delay-75\"></div>\r\n                      <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-pulse delay-150\"></div>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  // Reviews List\r\n                  <ReviewList \r\n                    reviews={reviews} \r\n                    loading={false}\r\n                    onHelpfulClick={handleHelpfulClick}\r\n                    onReportClick={handleReportClick}\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Review Form Modal */}\r\n        {showReviewForm && quizId && (\r\n          <ReviewForm\r\n            quizId={quizId}\r\n            onReviewSubmitted={handleReviewSubmitted}\r\n            onClose={() => setShowReviewForm(false)}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuizReviewsPage;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\RealQuizListPage.tsx","messages":[{"ruleId":"102","message":"Definition for rule '102' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"130","message":"Definition for rule '130' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"241","message":"Definition for rule '241' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"246","message":"Definition for rule '246' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"i18next/no-literal-stringimport React","message":"Definition for rule 'i18next/no-literal-stringimport React' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"{ useState","message":"Definition for rule '{ useState' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"useEffect } from 'react';import { getRealQuizData } from '../services/realDataService';import { Link } from 'react-router-dom';import { ArrowLeft","message":"Definition for rule 'useEffect } from 'react';import { getRealQuizData } from '../services/realDataService';import { Link } from 'react-router-dom';import { ArrowLeft' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"RefreshCw","message":"Definition for rule 'RefreshCw' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"Eye","message":"Definition for rule 'Eye' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"MessageSquare } from 'lucide-react';import { useTranslation } from 'react-i18next';import SafeHTML from '../../../shared/components/ui/SafeHTML';const RealQuizListPage: React.FC = () => {  const { t } = useTranslation();  const [quizzes","message":"Definition for rule 'MessageSquare } from 'lucide-react';import { useTranslation } from 'react-i18next';import SafeHTML from '../../../shared/components/ui/SafeHTML';const RealQuizListPage: React.FC = () => {  const { t } = useTranslation();  const [quizzes' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"setQuizzes] = useState<any[]>([]);  const [loading","message":"Definition for rule 'setQuizzes] = useState<any[]>([]);  const [loading' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"setLoading] = useState(true);  useEffect(() => {    loadRealQuizzes();  }","message":"Definition for rule 'setLoading] = useState(true);  useEffect(() => {    loadRealQuizzes();  }' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"[]);  const loadRealQuizzes = async () => {    setLoading(true);    try {      const realQuizzes = await getRealQuizData();      setQuizzes(realQuizzes);      console.log('Loaded real quizzes:'","message":"Definition for rule '[]);  const loadRealQuizzes = async () => {    setLoading(true);    try {      const realQuizzes = await getRealQuizData();      setQuizzes(realQuizzes);      console.log('Loaded real quizzes:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"realQuizzes);    } catch (error) {      console.error('Error loading real quizzes:'","message":"Definition for rule 'realQuizzes);    } catch (error) {      console.error('Error loading real quizzes:'' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"error);    } finally {      setLoading(false);    }  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <RefreshCw className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">{t('quiz.loadingRealQuizzes')}</span>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-5xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <Link            to=\"/admin\"            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            <ArrowLeft className=\"w-4 h-4 mr-2\" />            {t('back')}          </Link>                    <div className=\"relative overflow-hidden rounded-2xl p-6 shadow-sm bg-gradient-to-r from-indigo-50 via-blue-50 to-sky-50 border border-gray-100\">            <div className=\"absolute inset-0 pointer-events-none opacity-40\" style={{backgroundImage:'radial-gradient(circle at 20% 20%","message":"Definition for rule 'error);    } finally {      setLoading(false);    }  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <RefreshCw className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">{t('quiz.loadingRealQuizzes')}</span>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-5xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <Link            to=\"/admin\"            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            <ArrowLeft className=\"w-4 h-4 mr-2\" />            {t('back')}          </Link>                    <div className=\"relative overflow-hidden rounded-2xl p-6 shadow-sm bg-gradient-to-r from-indigo-50 via-blue-50 to-sky-50 border border-gray-100\">            <div className=\"absolute inset-0 pointer-events-none opacity-40\" style={{backgroundImage:'radial-gradient(circle at 20% 20%' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"rgba(59","message":"Definition for rule 'rgba(59' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"0.15)","message":"Definition for rule '0.15)' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"transparent 35%)","message":"Definition for rule 'transparent 35%)' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"radial-gradient(circle at 80% 0%","message":"Definition for rule 'radial-gradient(circle at 80% 0%' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"rgba(99","message":"Definition for rule 'rgba(99' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null},{"ruleId":"transparent 35%)'}} />            <div className=\"relative flex items-center justify-between\">              <div>                <h1 className=\"text-2xl md:text-3xl font-extrabold tracking-tight text-gray-900 mb-1\">                  üìö {t('quizList.title')}                </h1>                <div className=\"flex items-center gap-3 text-gray-600\">                  <span className=\"px-2.5 py-1 rounded-full bg-white/70 border border-gray-200 text-sm\">                    {quizzes.length} {t('quizList.results.quizzes')}                  </span>                </div>              </div>              <button                onClick={loadRealQuizzes}                className=\"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow hover:from-blue-700 hover:to-indigo-700 transition-colors\"              >                <RefreshCw className=\"w-4 h-4 mr-2\" />{t('refresh')}              </button>            </div>          </div>        </div>        {/* Quiz List */}        {quizzes.length === 0 ? (          <div className=\"bg-white rounded-lg p-8 shadow-sm text-center\">            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">              {t('quiz.noQuizzesInDatabase')}            </h3>            <p className=\"text-gray-600\">              {t('quiz.createQuizzesToTest')}            </p>          </div>        ) : (          <div className=\"space-y-4\">            {quizzes.map((quiz) => (              <div key={quiz.id} className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-lg hover:border-blue-200 transition-all\">                <div className=\"flex items-start justify-between gap-6\">                  <div className=\"flex-1\">                    <h3 className=\"text-xl font-bold text-gray-900 mb-2 tracking-tight\">                      {quiz.title || t('quiz.noTitle')}                    </h3>                                        <SafeHTML content={quiz.description || String(t('quiz.noDescription'))} className=\"text-gray-600 mb-4 line-clamp-2\" as=\"div\" />                                        <div className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"flex items-center gap-1\">ID: <code className=\"bg-gray-100 px-2 py-0.5 rounded\">{quiz.id}</code></span>                      {quiz.category && (                        <span className=\"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700\">{t('quiz.category')}: {quiz.category}</span>                      )}                      {quiz.status && (                        <span className={`px-2.5 py-1 rounded-full text-xs font-medium border ${                          quiz.status === 'approved' ? 'bg-green-50 text-green-700 border-green-200' :                          quiz.status === 'pending' ? 'bg-yellow-50 text-yellow-700 border-yellow-200' :                          'bg-red-50 text-red-700 border-red-200'                        }`}>                          {quiz.status === 'approved' ? t('admin.quizManagement.filter.approved') :                           quiz.status === 'pending' ? t('admin.quizManagement.filter.pending') : t('status.rejected')}                        </span>                      )}                    </div>                  </div>                                    <div className=\"flex items-center space-x-3\">                    <Link                       to={`/quiz/${quiz.id}/preview`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 text-sm shadow\"                    >                      <Eye className=\"w-4 h-4 mr-2\" />                       {t('quiz.preview')}                    </Link>                                        <Link                      to={`/quiz/${quiz.id}/reviews`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 text-sm shadow\"                    >                      <MessageSquare className=\"w-4 h-4 mr-2\" />                       {t('quiz.reviewsTitle')}                    </Link>                  </div>                </div>              </div>            ))}          </div>        )}        {/* Quick Stats */}        {quizzes.length > 0 && (          <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä {t('dashboard.realTimeData')}</h3>                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">              <div className=\"text-center\">                <p className=\"text-2xl font-bold text-blue-600\">{quizzes.length}</p>                <p className=\"text-sm text-gray-600\">{t('dashboard.totalQuizzes')}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-green-600\">                  {quizzes.filter(q => q.status === 'approved').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.approved\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-yellow-600\">                  {quizzes.filter(q => q.status === 'pending').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.pending\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-purple-600\">                  {new Set(quizzes.map(q => q.category).filter(Boolean)).size}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.preview.category\")}</p>              </div>            </div>          </div>        )}      </div>    </div>  );};export default RealQuizListPage;","message":"Definition for rule 'transparent 35%)'}} />            <div className=\"relative flex items-center justify-between\">              <div>                <h1 className=\"text-2xl md:text-3xl font-extrabold tracking-tight text-gray-900 mb-1\">                  üìö {t('quizList.title')}                </h1>                <div className=\"flex items-center gap-3 text-gray-600\">                  <span className=\"px-2.5 py-1 rounded-full bg-white/70 border border-gray-200 text-sm\">                    {quizzes.length} {t('quizList.results.quizzes')}                  </span>                </div>              </div>              <button                onClick={loadRealQuizzes}                className=\"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow hover:from-blue-700 hover:to-indigo-700 transition-colors\"              >                <RefreshCw className=\"w-4 h-4 mr-2\" />{t('refresh')}              </button>            </div>          </div>        </div>        {/* Quiz List */}        {quizzes.length === 0 ? (          <div className=\"bg-white rounded-lg p-8 shadow-sm text-center\">            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">              {t('quiz.noQuizzesInDatabase')}            </h3>            <p className=\"text-gray-600\">              {t('quiz.createQuizzesToTest')}            </p>          </div>        ) : (          <div className=\"space-y-4\">            {quizzes.map((quiz) => (              <div key={quiz.id} className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-lg hover:border-blue-200 transition-all\">                <div className=\"flex items-start justify-between gap-6\">                  <div className=\"flex-1\">                    <h3 className=\"text-xl font-bold text-gray-900 mb-2 tracking-tight\">                      {quiz.title || t('quiz.noTitle')}                    </h3>                                        <SafeHTML content={quiz.description || String(t('quiz.noDescription'))} className=\"text-gray-600 mb-4 line-clamp-2\" as=\"div\" />                                        <div className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"flex items-center gap-1\">ID: <code className=\"bg-gray-100 px-2 py-0.5 rounded\">{quiz.id}</code></span>                      {quiz.category && (                        <span className=\"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700\">{t('quiz.category')}: {quiz.category}</span>                      )}                      {quiz.status && (                        <span className={`px-2.5 py-1 rounded-full text-xs font-medium border ${                          quiz.status === 'approved' ? 'bg-green-50 text-green-700 border-green-200' :                          quiz.status === 'pending' ? 'bg-yellow-50 text-yellow-700 border-yellow-200' :                          'bg-red-50 text-red-700 border-red-200'                        }`}>                          {quiz.status === 'approved' ? t('admin.quizManagement.filter.approved') :                           quiz.status === 'pending' ? t('admin.quizManagement.filter.pending') : t('status.rejected')}                        </span>                      )}                    </div>                  </div>                                    <div className=\"flex items-center space-x-3\">                    <Link                       to={`/quiz/${quiz.id}/preview`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 text-sm shadow\"                    >                      <Eye className=\"w-4 h-4 mr-2\" />                       {t('quiz.preview')}                    </Link>                                        <Link                      to={`/quiz/${quiz.id}/reviews`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 text-sm shadow\"                    >                      <MessageSquare className=\"w-4 h-4 mr-2\" />                       {t('quiz.reviewsTitle')}                    </Link>                  </div>                </div>              </div>            ))}          </div>        )}        {/* Quick Stats */}        {quizzes.length > 0 && (          <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä {t('dashboard.realTimeData')}</h3>                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">              <div className=\"text-center\">                <p className=\"text-2xl font-bold text-blue-600\">{quizzes.length}</p>                <p className=\"text-sm text-gray-600\">{t('dashboard.totalQuizzes')}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-green-600\">                  {quizzes.filter(q => q.status === 'approved').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.approved\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-yellow-600\">                  {quizzes.filter(q => q.status === 'pending').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.pending\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-purple-600\">                  {new Set(quizzes.map(q => q.category).filter(Boolean)).size}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.preview.category\")}</p>              </div>            </div>          </div>        )}      </div>    </div>  );};export default RealQuizListPage;' was not found.","line":1,"column":1,"endLine":1,"endColumn":8131,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":21,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React, { useState, useEffect } from 'react';import { getRealQuizData } from '../services/realDataService';import { Link } from 'react-router-dom';import { ArrowLeft, RefreshCw, Eye, MessageSquare } from 'lucide-react';import { useTranslation } from 'react-i18next';import SafeHTML from '../../../shared/components/ui/SafeHTML';const RealQuizListPage: React.FC = () => {  const { t } = useTranslation();  const [quizzes, setQuizzes] = useState<any[]>([]);  const [loading, setLoading] = useState(true);  useEffect(() => {    loadRealQuizzes();  }, []);  const loadRealQuizzes = async () => {    setLoading(true);    try {      const realQuizzes = await getRealQuizData();      setQuizzes(realQuizzes);      console.log('Loaded real quizzes:', realQuizzes);    } catch (error) {      console.error('Error loading real quizzes:', error);    } finally {      setLoading(false);    }  };  if (loading) {    return (      <div className=\"min-h-screen bg-gray-50 py-8\">        <div className=\"max-w-4xl mx-auto px-4\">          <div className=\"flex items-center justify-center py-12\">            <RefreshCw className=\"w-8 h-8 animate-spin text-blue-600 mr-3\" />            <span className=\"text-lg text-gray-600\">{t('quiz.loadingRealQuizzes')}</span>          </div>        </div>      </div>    );  }  return (    <div className=\"min-h-screen bg-gray-50 py-8\">      <div className=\"max-w-5xl mx-auto px-4\">        {/* Header */}        <div className=\"mb-8\">          <Link            to=\"/admin\"            className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\"          >            <ArrowLeft className=\"w-4 h-4 mr-2\" />            {t('back')}          </Link>                    <div className=\"relative overflow-hidden rounded-2xl p-6 shadow-sm bg-gradient-to-r from-indigo-50 via-blue-50 to-sky-50 border border-gray-100\">            <div className=\"absolute inset-0 pointer-events-none opacity-40\" style={{backgroundImage:'radial-gradient(circle at 20% 20%, rgba(59,130,246,0.15), transparent 35%), radial-gradient(circle at 80% 0%, rgba(99,102,241,0.15), transparent 35%)'}} />            <div className=\"relative flex items-center justify-between\">              <div>                <h1 className=\"text-2xl md:text-3xl font-extrabold tracking-tight text-gray-900 mb-1\">                  üìö {t('quizList.title')}                </h1>                <div className=\"flex items-center gap-3 text-gray-600\">                  <span className=\"px-2.5 py-1 rounded-full bg-white/70 border border-gray-200 text-sm\">                    {quizzes.length} {t('quizList.results.quizzes')}                  </span>                </div>              </div>              <button                onClick={loadRealQuizzes}                className=\"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow hover:from-blue-700 hover:to-indigo-700 transition-colors\"              >                <RefreshCw className=\"w-4 h-4 mr-2\" />{t('refresh')}              </button>            </div>          </div>        </div>        {/* Quiz List */}        {quizzes.length === 0 ? (          <div className=\"bg-white rounded-lg p-8 shadow-sm text-center\">            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">              {t('quiz.noQuizzesInDatabase')}            </h3>            <p className=\"text-gray-600\">              {t('quiz.createQuizzesToTest')}            </p>          </div>        ) : (          <div className=\"space-y-4\">            {quizzes.map((quiz) => (              <div key={quiz.id} className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-lg hover:border-blue-200 transition-all\">                <div className=\"flex items-start justify-between gap-6\">                  <div className=\"flex-1\">                    <h3 className=\"text-xl font-bold text-gray-900 mb-2 tracking-tight\">                      {quiz.title || t('quiz.noTitle')}                    </h3>                                        <SafeHTML content={quiz.description || String(t('quiz.noDescription'))} className=\"text-gray-600 mb-4 line-clamp-2\" as=\"div\" />                                        <div className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"flex items-center gap-1\">ID: <code className=\"bg-gray-100 px-2 py-0.5 rounded\">{quiz.id}</code></span>                      {quiz.category && (                        <span className=\"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700\">{t('quiz.category')}: {quiz.category}</span>                      )}                      {quiz.status && (                        <span className={`px-2.5 py-1 rounded-full text-xs font-medium border ${                          quiz.status === 'approved' ? 'bg-green-50 text-green-700 border-green-200' :                          quiz.status === 'pending' ? 'bg-yellow-50 text-yellow-700 border-yellow-200' :                          'bg-red-50 text-red-700 border-red-200'                        }`}>                          {quiz.status === 'approved' ? t('admin.quizManagement.filter.approved') :                           quiz.status === 'pending' ? t('admin.quizManagement.filter.pending') : t('status.rejected')}                        </span>                      )}                    </div>                  </div>                                    <div className=\"flex items-center space-x-3\">                    <Link                       to={`/quiz/${quiz.id}/preview`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 text-sm shadow\"                    >                      <Eye className=\"w-4 h-4 mr-2\" />                       {t('quiz.preview')}                    </Link>                                        <Link                      to={`/quiz/${quiz.id}/reviews`}                      className=\"inline-flex items-center px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 text-sm shadow\"                    >                      <MessageSquare className=\"w-4 h-4 mr-2\" />                       {t('quiz.reviewsTitle')}                    </Link>                  </div>                </div>              </div>            ))}          </div>        )}        {/* Quick Stats */}        {quizzes.length > 0 && (          <div className=\"mt-8 bg-white rounded-lg p-6 shadow-sm\">            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">üìä {t('dashboard.realTimeData')}</h3>                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">              <div className=\"text-center\">                <p className=\"text-2xl font-bold text-blue-600\">{quizzes.length}</p>                <p className=\"text-sm text-gray-600\">{t('dashboard.totalQuizzes')}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-green-600\">                  {quizzes.filter(q => q.status === 'approved').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.approved\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-yellow-600\">                  {quizzes.filter(q => q.status === 'pending').length}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.quizManagement.filter.pending\")}</p>              </div>                            <div className=\"text-center\">                <p className=\"text-2xl font-bold text-purple-600\">                  {new Set(quizzes.map(q => q.category).filter(Boolean)).size}                </p>                <p className=\"text-sm text-gray-600\">{t(\"admin.preview.category\")}</p>              </div>            </div>          </div>        )}      </div>    </div>  );};export default RealQuizListPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":25009,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useEffect, useState } from 'react';import { useParams, useLocation, useNavigate } from 'react-router-dom';import { useSelector } from 'react-redux';import { RootState } from '../../../lib/store';import { Quiz } from '../types';import Button from '../../../shared/components/ui/Button';import { getQuizResults, getQuizResultById, getQuizById } from '../services/quizService';import { toast } from 'react-toastify';import QuickReviewSection from '../../../shared/components/QuickReviewSection';import { quizStatsService } from '../../../services/quizStatsService';import SafeHTML from '../../../shared/components/ui/SafeHTML';interface ResultState {  score: number;  correct: number;  total: number;  answers: Record<string, string>;  isTimeUp?: boolean;  timeSpent?: number;  quizId?: string;  tracked?: boolean; // Add this to prevent duplicate tracking}interface LeaderboardEntry {  id: string;  userId: string;  userName: string;  userEmail: string;  score: number;  correctAnswers: number;  totalQuestions: number;  timeSpent: number;  completedAt: Date;}// **TH√äM M·ªöI**: Confetti animation componentconst Confetti: React.FC = () => {  return (    <div className=\"fixed inset-0 pointer-events-none overflow-hidden\">      {[...Array(50)].map((_, i) => (        <div          key={i}          className=\"absolute animate-bounce\"          style={{            left: `${Math.random() * 100}%`,            animationDelay: `${Math.random() * 3}s`,            animationDuration: `${2 + Math.random() * 3}s`          }}        >          <div             className=\"w-2 h-2 bg-yellow-400 rounded-full\"            style={{              backgroundColor: ['#f59e0b', '#10b981', '#3b82f6', '#8b5cf6', '#ef4444'][Math.floor(Math.random() * 5)]            }}          />        </div>      ))}    </div>  );};// **TH√äM M·ªöI**: Score circle componentconst ScoreCircle: React.FC<{ score: number }> = ({ score }) => {  const [animatedScore, setAnimatedScore] = useState(0);    useEffect(() => {    const timer = setTimeout(() => {      let current = 0;      const increment = score / 50; // Animation in 50 steps      const stepTimer = setInterval(() => {        current += increment;        if (current >= score) {          setAnimatedScore(score);          clearInterval(stepTimer);        } else {          setAnimatedScore(Math.floor(current));        }      }, 20);    }, 500);        return () => clearTimeout(timer);  }, [score]);  const getScoreColor = (score: number) => {    if (score >= 80) return 'text-green-600';    if (score >= 60) return 'text-yellow-600';    return 'text-red-600';  };  const circumference = 2 * Math.PI * 45;  const strokeDasharray = circumference;  const strokeDashoffset = circumference - (animatedScore / 100) * circumference;  return (    <div className=\"relative w-32 h-32\">      <svg className=\"w-32 h-32 transform -rotate-90\" viewBox=\"0 0 100 100\">        <circle          cx=\"50\"          cy=\"50\"          r=\"45\"          stroke=\"currentColor\"          strokeWidth=\"6\"          fill=\"transparent\"          className=\"text-gray-200\"        />        <circle          cx=\"50\"          cy=\"50\"          r=\"45\"          stroke=\"currentColor\"          strokeWidth=\"6\"          fill=\"transparent\"          strokeDasharray={strokeDasharray}          strokeDashoffset={strokeDashoffset}          strokeLinecap=\"round\"          className={`transition-all duration-1000 ease-out ${            animatedScore >= 80 ? 'text-green-500' :            animatedScore >= 60 ? 'text-yellow-500' : 'text-red-500'          }`}        />      </svg>      <div className=\"absolute inset-0 flex items-center justify-center\">        <div className=\"text-center\">          <div className={`text-2xl font-bold ${getScoreColor(animatedScore)}`}>            {animatedScore}%          </div>        </div>      </div>    </div>  );};// Helper: format seconds to mm:ssconst formatTime = (seconds: number) => {  const m = Math.floor(seconds / 60);  const s = seconds % 60;  return `${m}:${s.toString().padStart(2, '0')}`;};// Helper √©p ki·ªÉu an to√†n cho s·ªëconst safeNumber = (val: any, fallback = 0) => {  const n = Number(val);  return isNaN(n) ? fallback : n;};export const ResultPage: React.FC = () => {  const { attemptId } = useParams<{ attemptId: string }>();  const location = useLocation();  const navigate = useNavigate();  const { quizzes } = useSelector((state: RootState) => state.quiz);  const { user } = useSelector((state: RootState) => state.auth);    const [result, setResult] = useState<ResultState | null>(location.state as ResultState || null);  const [quizId, setQuizId] = useState<string | null>(null);  const [quiz, setQuiz] = useState<Quiz | null>(null);  const [showAnswers, setShowAnswers] = useState(false);  const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);  const [userRank, setUserRank] = useState<number | null>(null);  const [loadingStats, setLoadingStats] = useState(true);  useEffect(() => {    console.log('üîç ResultPage useEffect - attemptId:', attemptId, 'location.state:', location.state);        if (location.state) {      // C√≥ state t·ª´ navigation - s·ª≠ d·ª•ng ngay      const resultData = location.state as ResultState;      console.log('‚úÖ Using state from navigation:', resultData);      setResult(resultData);      setQuizId(resultData.quizId || attemptId || null);    } else if (attemptId) {      // Kh√¥ng c√≥ state, c·∫ßn fetch t·ª´ Firestore      console.log('üì° Fetching result from Firestore for attemptId:', attemptId);      getQuizResultById(attemptId).then((res: any) => {        if (res) {          console.log('‚úÖ Fetched result from Firestore:', res);          const resultData = res as ResultState;          setResult(resultData);          setQuizId(resultData.quizId || null);        } else {          console.error('‚ùå No result found for attemptId:', attemptId);          toast.error('Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ quiz!');          navigate('/quiz-list');        }      }).catch(error => {        console.error('‚ùå Error fetching result:', error);        toast.error('Kh√¥ng th·ªÉ t·∫£i k·∫øt qu·∫£ quiz!');        navigate('/quiz-list');      });    } else {      console.error('‚ùå No attemptId or state provided');      navigate('/quiz-list');    }  }, [attemptId, location.state, navigate]);  useEffect(() => {    if (!quizId) return;        console.log('üîç Looking for quiz with ID:', quizId);    const foundQuiz = quizzes.find(q => q.id === quizId);        if (foundQuiz) {      console.log('‚úÖ Found quiz in store:', foundQuiz.title);      setQuiz(foundQuiz);    } else {      console.log('üì° Quiz not in store, fetching from Firestore...');      // N·∫øu kh√¥ng c√≥ trong store, fetch t·ª´ Firestore      getQuizById(quizId).then(qz => {        if (qz) {          console.log('‚úÖ Fetched quiz from Firestore:', qz.title);          setQuiz(qz);        } else {          console.error('‚ùå Quiz not found:', quizId);          toast.error('Kh√¥ng t√¨m th·∫•y quiz!');          navigate('/quiz-list');        }      }).catch(error => {        console.error('‚ùå Error fetching quiz:', error);        toast.error('Kh√¥ng th·ªÉ t·∫£i quiz!');        navigate('/quiz-list');      });    }  }, [quizId, quizzes, navigate]);  // Track completion when result and quiz are both available  useEffect(() => {    if (result && quiz && user && !result.tracked) {      console.log('üìä Tracking quiz completion for user:', user.uid);      const score = safeNumber(result.correct, 0);      const total = safeNumber(result.total, quiz.questions.length);            quizStatsService.trackCompletion(quiz.id, user.uid, score, total);            // Mark as tracked to prevent duplicate tracking      setResult(prev => prev ? { ...prev, tracked: true } : null);    }  }, [result, quiz, user]);  useEffect(() => {    const fetchLeaderboard = async () => {      if (!quizId) return;            try {        setLoadingStats(true);        console.log('üìä Fetching leaderboard for quiz:', quizId);        const results = await getQuizResults(quizId);        console.log('üìä Raw results from Firebase:', results);                // Transform results to leaderboard entries with user info        const leaderboardData: LeaderboardEntry[] = results.map((result: any) => {          console.log('üîç Processing result:', result);          return {            id: result.id,            userId: result.userId,            userName: result.userName || result.userEmail?.split('@')[0] || 'Anonymous',            userEmail: result.userEmail || '',            score: result.score,            correctAnswers: result.correctAnswers,            totalQuestions: result.totalQuestions,            timeSpent: result.timeSpent || 0,            completedAt: result.completedAt?.toDate?.() || new Date(result.completedAt)          };        });        console.log('üìä Leaderboard data processed:', leaderboardData);        // Sort by score (descending) then by time (ascending) for same scores        const sortedLeaderboard = leaderboardData.sort((a, b) => {          if (a.score !== b.score) {            return b.score - a.score; // Higher score first          }          return a.timeSpent - b.timeSpent; // Faster time first if same score        });        console.log('üìä Sorted leaderboard:', sortedLeaderboard);        setLeaderboard(sortedLeaderboard.slice(0, 10)); // Top 10        // Find current user's rank        if (user) {          const userResultIndex = sortedLeaderboard.findIndex(r => r.userId === user.uid);          setUserRank(userResultIndex >= 0 ? userResultIndex + 1 : null);          console.log('üë§ User rank:', userResultIndex >= 0 ? userResultIndex + 1 : 'Not found');        }        console.log('üìä Leaderboard loaded:', sortedLeaderboard.length, 'entries');      } catch (error) {        console.error('‚ùå Failed to fetch leaderboard:', error);        toast.error('Kh√¥ng th·ªÉ t·∫£i b·∫£ng x·∫øp h·∫°ng!');      } finally {        setLoadingStats(false);      }    };    fetchLeaderboard();  }, [quizId, user]);  if (!result || !quiz) {    return (      <div className=\"flex items-center justify-center min-h-screen\">        <div className=\"text-center\">          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mb-4\"></div>          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Loading results...</h2>          // eslint-disable-next-line i18next/no-literal-string          <Button onClick={() => navigate('/quiz-list')}>            Back to Quiz List          </Button>        </div>      </div>    );  }  // T√≠nh to√°n ƒëi·ªÉm s·ªë, ki·ªÉm tra h·ª£p l·ªá  const correct = safeNumber(result.correct);  const total = safeNumber(result.total);  const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;  const isExcellent = percentage >= 80;  return (    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8\">      {isExcellent && <Confetti />}            <div className=\"max-w-4xl mx-auto px-4\">        {/* K·∫øt qu·∫£ t·ªïng quan */}        <div className=\"text-center mb-8\">          <div className=\"bg-white rounded-2xl shadow-xl p-8 mb-6\">            {result.isTimeUp && (              // eslint-disable-next-line i18next/no-literal-string              <div className=\"bg-yellow-100 border border-yellow-300 text-yellow-800 px-4 py-3 rounded-lg mb-6\">                ‚è∞ Time's up! Quiz was automatically submitted.              </div>            )}            <div className=\"flex flex-col items-center\">              <ScoreCircle score={percentage} />              // eslint-disable-next-line i18next/no-literal-string              <h1 className=\"text-3xl font-bold text-gray-900 mt-4 mb-2\">                Quiz Completed!              </h1>              <p className=\"text-xl text-gray-600 mb-4\">                {percentage >= 90 ? 'Outstanding! üèÜ' :                 percentage >= 80 ? 'Excellent! üåü' :                 percentage >= 70 ? 'Great Job! üëè' :                 percentage >= 60 ? 'Good Work! üëç' :                 percentage >= 50 ? 'Not Bad! üìö' :                 'Keep Practicing! üí™'}              </p>              // eslint-disable-next-line i18next/no-literal-string              <div className=\"text-lg text-gray-700 mb-2\">                // eslint-disable-next-line i18next/no-literal-string                You got <span className=\"font-bold text-blue-600\">{correct}</span> out of{' '}                // eslint-disable-next-line i18next/no-literal-string                <span className=\"font-bold\">{total}</span> questions correct              </div>              {/* Hi·ªÉn th·ªã th·ªùi gian l√†m b√†i */}              {typeof result.timeSpent === 'number' && (                // eslint-disable-next-line i18next/no-literal-string                <div className=\"text-md text-gray-500 mt-2\">                  ‚è±Ô∏è Time taken: <span className=\"font-semibold text-blue-700\">{formatTime(safeNumber(result.timeSpent))}</span>                </div>              )}            </div>          </div>        </div>        {/* **TH√äM M·ªöI**: Stats Grid */}        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">          <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">            <div className=\"text-3xl font-bold text-green-600 mb-2\">{correct}</div>            // eslint-disable-next-line i18next/no-literal-string            <div className=\"text-gray-600\">Correct Answers</div>          </div>                    <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">            <div className=\"text-3xl font-bold text-red-600 mb-2\">{total - correct}</div>            // eslint-disable-next-line i18next/no-literal-string            <div className=\"text-gray-600\">Incorrect Answers</div>          </div>                    <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">            <div className=\"text-3xl font-bold text-blue-600 mb-2\">{percentage}%</div>            // eslint-disable-next-line i18next/no-literal-string            <div className=\"text-gray-600\">Final Score</div>          </div>        </div>        {/* **TH√äM M·ªöI**: Performance Analysis */}        <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Performance Analysis</h2>                    <div className=\"space-y-4\">            <div className=\"flex items-center justify-between\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"text-gray-600\">Accuracy Rate</span>              <div className=\"flex items-center\">                <div className=\"w-32 bg-gray-200 rounded-full h-2 mr-3\">                  <div                     className=\"bg-blue-500 h-2 rounded-full transition-all duration-1000\"                    style={{ width: `${percentage}%` }}                  ></div>                </div>                <span className=\"font-semibold\">{percentage}%</span>              </div>            </div>                        <div className=\"flex items-center justify-between\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"text-gray-600\">Quiz Difficulty</span>              <span className={`px-3 py-1 rounded-full text-sm font-medium ${                quiz.difficulty === 'easy' ? 'bg-green-100 text-green-800' :                quiz.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :                'bg-red-100 text-red-800'              }`}>                {quiz.difficulty.charAt(0).toUpperCase() + quiz.difficulty.slice(1)}              </span>            </div>                        <div className=\"flex items-center justify-between\">              // eslint-disable-next-line i18next/no-literal-string              <span className=\"text-gray-600\">Time Management</span>              <span className=\"font-semibold text-green-600\">                {result.isTimeUp ? 'Used full time' : 'Completed early'}              </span>            </div>          </div>        </div>        {/* **TH√äM M·ªöI**: Review Answers Section */}        <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">          <div className=\"flex items-center justify-between mb-6\">            // eslint-disable-next-line i18next/no-literal-string            <h2 className=\"text-xl font-bold text-gray-900\">Review Answers</h2>            <Button              variant=\"outline\"              onClick={() => setShowAnswers(!showAnswers)}            >              // eslint-disable-next-line i18next/no-literal-string              {showAnswers ? 'Hide' : 'Show'} Detailed Review            </Button>          </div>          {showAnswers && (            <div className=\"space-y-6\">              {quiz.questions.map((question, index) => {                const userAnswerId = result.answers[question.id];                const userAnswer = question.answers.find(a => a.id === userAnswerId);                const isCorrect = userAnswer?.isCorrect || false;                return (                  <div key={question.id} className=\"border border-gray-200 rounded-lg p-4\">                    <div className=\"flex items-start justify-between mb-3\">                      <h3 className=\"text-lg font-medium text-gray-900\">                        {index + 1}. {question.text}                      </h3>                      <span className={`px-3 py-1 rounded-full text-sm font-medium ${                        isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'                      }`}>                        {isCorrect ? '‚úì Correct' : '‚úó Incorrect'}                      </span>                    </div>                                        <div className=\"space-y-2\">                      {question.answers.map(answer => (                        <div                          key={answer.id}                          className={`p-3 rounded-lg border ${                            answer.isCorrect                               ? 'border-green-300 bg-green-50'                               : answer.id === userAnswerId                               ? 'border-red-300 bg-red-50'                              : 'border-gray-200 bg-gray-50'                          }`}                        >                          <div className=\"flex items-center\">                            <span className=\"font-medium mr-3\">                              {String.fromCharCode(65 + question.answers.indexOf(answer))}.                            </span>                            <span>{answer.text}</span>                            {answer.isCorrect && (                              // eslint-disable-next-line i18next/no-literal-string                              <span className=\"ml-auto text-green-600 font-medium\">                                ‚úì Correct Answer                              </span>                            )}                            {answer.id === userAnswerId && !answer.isCorrect && (                              // eslint-disable-next-line i18next/no-literal-string                              <span className=\"ml-auto text-red-600 font-medium\">                                Your Answer                              </span>                            )}                          </div>                        </div>                      ))}                    </div>                                        {question.explanation && (                      <div className=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">                        // eslint-disable-next-line i18next/no-literal-string                        <span className=\"font-medium text-blue-800\">Explanation: </span>                        <SafeHTML content={question.explanation} className=\"text-blue-700\" />                      </div>                    )}                  </div>                );              })}            </div>          )}        </div>        {/* Leaderboard */}        <div className=\"bg-white rounded-2xl shadow-xl p-8 mb-8\">          // eslint-disable-next-line i18next/no-literal-string          <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">üèÜ Leaderboard</h2>          {loadingStats ? (            <div className=\"flex justify-center items-center h-24\">              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>              <span className=\"ml-3 text-gray-600\">Loading leaderboard...</span>            </div>          ) : leaderboard.length > 0 ? (            <div className=\"space-y-3\">              {leaderboard.map((entry, index) => (                <div                   key={entry.id}                  className={`flex items-center justify-between p-4 rounded-lg border ${                    entry.userId === user?.uid                       ? 'bg-blue-50 border-blue-200 shadow-md'                       : 'bg-gray-50 border-gray-200'                  }`}                >                  <div className=\"flex items-center space-x-4\">                    <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${                      index === 0 ? 'bg-yellow-400 text-yellow-900' :                      index === 1 ? 'bg-gray-300 text-gray-700' :                      index === 2 ? 'bg-amber-600 text-amber-100' :                      'bg-gray-200 text-gray-600'                    }`}>                      {index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : index + 1}                    </div>                    <div>                      <div className=\"font-medium text-gray-900\">                        {entry.userName}                        // eslint-disable-next-line i18next/no-literal-string                        {entry.userId === user?.uid && <span className=\"text-blue-600 ml-2\">(You)</span>}                      </div>                      <div className=\"text-sm text-gray-500\">                        // eslint-disable-next-line i18next/no-literal-string                        {entry.correctAnswers}/{entry.totalQuestions} correct                      </div>                    </div>                  </div>                  <div className=\"text-right\">                    <div className=\"font-bold text-xl text-gray-900\">{safeNumber(entry.score)}%</div>                    // eslint-disable-next-line i18next/no-literal-string                    <div className=\"text-sm text-gray-500\">                      ‚è±Ô∏è {formatTime(safeNumber(entry.timeSpent))}                    </div>                  </div>                </div>              ))}                            {/* Show user rank if not in top 10 */}              {user && userRank && userRank > 10 && (                <div className=\"mt-6 pt-4 border-t border-gray-200\">                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">                    <div className=\"text-center\">                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-blue-800 font-medium\">Your Rank: #{userRank}</span>                    </div>                  </div>                </div>              )}            </div>          ) : (            <div className=\"text-center py-12 text-gray-500\">              <div className=\"text-6xl mb-4\">üèÜ</div>              // eslint-disable-next-line i18next/no-literal-string              <p className=\"text-lg\">No results yet!</p>              // eslint-disable-next-line i18next/no-literal-string              <p>Be the first to complete this quiz and claim the top spot!</p>            </div>          )}        </div>        {/* Quiz Review Section */}        {quiz && (          <div className=\"mb-8\">            <QuickReviewSection               quizId={quiz.id}               quizTitle={quiz.title}            />          </div>        )}        {/* Action Buttons */}        <div className=\"flex flex-wrap gap-4 justify-center\">          <Button            onClick={() => navigate(`/quiz/${quiz.id}`)}            className=\"bg-blue-600 hover:bg-blue-700\"          // eslint-disable-next-line i18next/no-literal-string          >            Retake Quiz          </Button>                    <Button            onClick={() => navigate('/quizzes')}            variant=\"outline\"          // eslint-disable-next-line i18next/no-literal-string          >            More Quizzes          </Button>                    <Button            variant=\"outline\"            onClick={() => {              // Share functionality              navigator.clipboard.writeText(                `I scored ${percentage}% on \"${quiz.title}\" quiz! üéØ`              );              toast.success('Result copied to clipboard!');            }}          // eslint-disable-next-line i18next/no-literal-string          >            Share Result          </Button>                    <Button            onClick={() => navigate('/profile')}            variant=\"outline\"          // eslint-disable-next-line i18next/no-literal-string          >            View All Results          </Button>        </div>      </div>    </div>  );};export default ResultPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\ActionButtons.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '/' expected.","line":1,"column":1726,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { useNavigate } from 'react-router-dom';import { Quiz } from '../../../types';import Button from '../../../../../shared/components/ui/Button';import { toast } from 'react-toastify';interface ActionButtonsProps {  quiz: Quiz;  percentage: number;}export const ActionButtons: React.FC<ActionButtonsProps> = ({ quiz, percentage }) => {  const navigate = useNavigate();  const handleShareResult = () => {    navigator.clipboard.writeText(      `I scored ${percentage}% on \"${quiz.title}\" quiz! üéØ`    );    toast.success('Result copied to clipboard!');  };  return (    <div className=\"flex flex-wrap gap-4 justify-center\">      <Button        onClick={() => navigate(`/quiz/${quiz.id}`)}        className=\"bg-blue-600 hover:bg-blue-700\"      // eslint-disable-next-line i18next/no-literal-string      >        üîÑ L√†m l·∫°i Quiz      </Button>      <Button        onClick={() => {          console.log('üìö Navigating to /quizzes...');          navigate('/quizzes');        }}        variant=\"outline\"      // eslint-disable-next-line i18next/no-literal-string      >        üìö Xem th√™m Quiz      </Button>            <Button        onClick={() => navigate('/dashboard')}        variant=\"outline\"      // eslint-disable-next-line i18next/no-literal-string      >        üè† V·ªÅ Dashboard      </Button>            <Button        variant=\"outline\"        onClick={handleShareResult}      // eslint-disable-next-line i18next/no-literal-string      >        üì§ Chia s·∫ª k·∫øt qu·∫£      </Button>            <Button        onClick={() => navigate('/profile')}        variant=\"outline\"      // eslint-disable-next-line i18next/no-literal-string      >        üë§ Xem t·∫•t c·∫£ k·∫øt qu·∫£      </Button>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\AnswerReview.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":9801,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React, { useState } from 'react';import { Quiz } from '../../../types';import { ResultState } from '../types';import Button from '../../../../../shared/components/ui/Button';import SafeHTML from '../../../../../shared/components/ui/SafeHTML';interface AnswerReviewProps {  quiz: Quiz;  result: ResultState;}export const AnswerReview: React.FC<AnswerReviewProps> = ({ quiz, result }) => {  const [showAnswers, setShowAnswers] = useState(false);  return (    <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">      <div className=\"flex items-center justify-between mb-6\">        // eslint-disable-next-line i18next/no-literal-string        <h2 className=\"text-xl font-bold text-gray-900\">Review Answers</h2>        <Button          variant=\"outline\"          onClick={() => setShowAnswers(!showAnswers)}        >          // eslint-disable-next-line i18next/no-literal-string          {showAnswers ? 'Hide' : 'Show'} Detailed Review        </Button>      </div>      {showAnswers && (        <div className=\"space-y-6\">          {quiz.questions.map((question, index) => {            const userAnswerValue = result.answers[question.id];                        // Logic ƒë·ªÉ x√°c ƒë·ªãnh ƒë√°p √°n ƒë√∫ng sai d·ª±a tr√™n lo·∫°i c√¢u h·ªèi            let isCorrect = false;            let userAnswerText = '';                        switch (question.type) {              case 'boolean':              case 'multiple':              case 'image': {                const userAnswer = question.answers.find(a => a.id === userAnswerValue);                isCorrect = userAnswer?.isCorrect || false;                userAnswerText = userAnswer?.text || 'Ch∆∞a tr·∫£ l·ªùi';                break;              }              case 'short_answer': {                // Import checkShortAnswer function ho·∫∑c t√≠nh to√°n t·∫°i ƒë√¢y                const normalizeAnswer = (answer: string) =>                   answer.trim().toLowerCase().replace(/\\s+/g, ' ');                                const normalizedUserAnswer = normalizeAnswer(userAnswerValue || '');                                if (question.correctAnswer && normalizeAnswer(question.correctAnswer) === normalizedUserAnswer) {                  isCorrect = true;                } else if (question.acceptedAnswers) {                  isCorrect = question.acceptedAnswers.some(accepted =>                     normalizeAnswer(accepted) === normalizedUserAnswer                  );                }                userAnswerText = userAnswerValue || 'Ch∆∞a tr·∫£ l·ªùi';                break;              }              case 'checkbox': {                const correctIds = question.answers.filter(a => a.isCorrect).map(a => a.id).sort();                const userIds = Array.isArray(userAnswerValue) ? [...userAnswerValue].sort() : [];                isCorrect = JSON.stringify(correctIds) === JSON.stringify(userIds);                const selectedAnswers = question.answers.filter(a => userIds.includes(a.id));                userAnswerText = selectedAnswers.length > 0                   ? selectedAnswers.map(a => a.text).join(', ')                  : 'Ch∆∞a tr·∫£ l·ªùi';                break;              }            }            return (              <div key={question.id} className=\"border border-gray-200 rounded-lg p-4\">                <div className=\"flex items-start justify-between mb-3\">                  <h3 className=\"text-lg font-medium text-gray-900\">                    {index + 1}. {question.text}                  </h3>                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${                    isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'                  }`}>                    {isCorrect ? '‚úì Correct' : '‚úó Incorrect'}                  </span>                </div>                {/* Hi·ªÉn th·ªã c√¢u tr·∫£ l·ªùi c·ªßa user */}                <div className=\"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">                  // eslint-disable-next-line i18next/no-literal-string                  <span className=\"font-medium text-blue-800\">C√¢u tr·∫£ l·ªùi c·ªßa b·∫°n: </span>                  <span className=\"text-blue-700\">{userAnswerText}</span>                </div>                                {/* Hi·ªÉn th·ªã ƒë√°p √°n cho multiple choice, image v√† boolean */}                {(question.type === 'multiple' || question.type === 'image' || question.type === 'boolean') && (                  <div className=\"space-y-2\">                    {question.answers.map(answer => (                      <div                        key={answer.id}                        className={`p-3 rounded-lg border ${                          answer.isCorrect                             ? 'border-green-300 bg-green-50'                             : answer.id === userAnswerValue                             ? 'border-red-300 bg-red-50'                            : 'border-gray-200 bg-gray-50'                        }`}                      >                        <div className=\"flex items-center\">                          <span className=\"font-medium mr-3\">                            {String.fromCharCode(65 + question.answers.indexOf(answer))}.                          </span>                          <span>{answer.text}</span>                          {answer.isCorrect && (                            // eslint-disable-next-line i18next/no-literal-string                            <span className=\"ml-auto text-green-600 font-medium\">                              ‚úì Correct Answer                            </span>                          )}                          {answer.id === userAnswerValue && !answer.isCorrect && (                            // eslint-disable-next-line i18next/no-literal-string                            <span className=\"ml-auto text-red-600 font-medium\">                              Your Answer                            </span>                          )}                        </div>                      </div>                    ))}                  </div>                )}                {/* Hi·ªÉn th·ªã ƒë√°p √°n cho checkbox */}                {question.type === 'checkbox' && (                  <div className=\"space-y-2\">                    {question.answers.map(answer => {                      const userSelectedIds: string[] = Array.isArray(userAnswerValue) ? userAnswerValue : [];                      const isUserSelected = userSelectedIds.includes(answer.id);                                            return (                        <div                          key={answer.id}                          className={`p-3 rounded-lg border ${                            answer.isCorrect                               ? 'border-green-300 bg-green-50'                               : isUserSelected                               ? 'border-red-300 bg-red-50'                              : 'border-gray-200 bg-gray-50'                          }`}                        >                          <div className=\"flex items-center\">                            <span className=\"font-medium mr-3\">                              {String.fromCharCode(65 + question.answers.indexOf(answer))}.                            </span>                            <span>{answer.text}</span>                            {answer.isCorrect && (                              // eslint-disable-next-line i18next/no-literal-string                              <span className=\"ml-auto text-green-600 font-medium\">                                ‚úì Should Select                              </span>                            )}                            {isUserSelected && !answer.isCorrect && (                              // eslint-disable-next-line i18next/no-literal-string                              <span className=\"ml-auto text-red-600 font-medium\">                                Wrong Selection                              </span>                            )}                            {isUserSelected && answer.isCorrect && (                              // eslint-disable-next-line i18next/no-literal-string                              <span className=\"ml-auto text-green-600 font-medium\">                                ‚úì Correct Selection                              </span>                            )}                          </div>                        </div>                      );                    })}                  </div>                )}                {/* Hi·ªÉn th·ªã ƒë√°p √°n cho short answer */}                {question.type === 'short_answer' && (                  <div className=\"space-y-2\">                    <div className=\"p-3 bg-green-50 border border-green-200 rounded-lg\">                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"font-medium text-green-800\">ƒê√°p √°n ƒë√∫ng: </span>                      <span className=\"text-green-700\">                        {question.correctAnswer}                        {question.acceptedAnswers && question.acceptedAnswers.length > 0 && (                          // eslint-disable-next-line i18next/no-literal-string                          <span className=\"text-sm\"> (ho·∫∑c: {question.acceptedAnswers.join(', ')})</span>                        )}                      </span>                    </div>                  </div>                )}                                {question.explanation && (                  <div className=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">                    // eslint-disable-next-line i18next/no-literal-string                    <span className=\"font-medium text-blue-800\">Explanation: </span>                    <SafeHTML content={question.explanation} className=\"text-blue-700\" />                  </div>                )}              </div>            );          })}        </div>      )}    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\Confetti.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\Leaderboard.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: '}' expected.","line":1,"column":5185,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { useSelector } from 'react-redux';import { RootState } from '../../../../../lib/store';import { LeaderboardEntry } from '../types';import { safeNumber, formatDetailedTime, formatDateTime, getRankDisplay, getRankBackgroundColor } from '../utils';interface LeaderboardProps {  leaderboard: LeaderboardEntry[];  userRank: number | null;  loadingStats: boolean;}export const Leaderboard: React.FC<LeaderboardProps> = ({   leaderboard,   userRank,   loadingStats }) => {  const { user } = useSelector((state: RootState) => state.auth);  // Debug logging  console.log('üèÜ Leaderboard render:', {    leaderboardLength: leaderboard.length,    loadingStats,    userRank,    hasUser: !!user,    leaderboard: leaderboard.slice(0, 3) // Show first 3 entries for debug  });  return (    <div className=\"bg-white rounded-2xl shadow-xl p-8 mb-8\">      // eslint-disable-next-line i18next/no-literal-string      <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">üèÜ Leaderboard</h2>      {loadingStats ? (        <div className=\"flex justify-center items-center h-24\">          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>          <span className=\"ml-3 text-gray-600\">Loading leaderboard...</span>        </div>      ) : leaderboard.length > 0 ? (        <div className=\"space-y-3\">          {leaderboard.map((entry, index) => (            <div               key={entry.id}              className={`flex items-center justify-between p-4 rounded-lg border ${                entry.id === 'current-attempt'                  ? 'bg-gradient-to-r from-green-50 via-emerald-50 to-green-50 border-green-400 shadow-xl ring-4 ring-green-200 ring-opacity-50'                   : entry.userId === user?.uid                     ? 'bg-blue-50 border-blue-200 shadow-md'                     : 'bg-gray-50 border-gray-200'              }`}            >              <div className=\"flex items-center space-x-4\">                <div className={`w-12 h-12 rounded-full flex items-center justify-center font-bold text-sm ${                  entry.id === 'current-attempt'                     ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg transform scale-110'                     : getRankBackgroundColor(index)                }`}>                  {entry.id === 'current-attempt' ? 'ÔøΩ' : getRankDisplay(index)}                </div>                <div>                  <div className=\"font-medium text-gray-900\">                    {entry.userName}                    {entry.id === 'current-attempt' && (                      <div className=\"flex items-center mt-1\">                        // eslint-disable-next-line i18next/no-literal-string                        <span className=\"text-white ml-2 font-bold bg-gradient-to-r from-green-500 to-emerald-600 px-3 py-1 rounded-full text-sm shadow-lg animate-pulse\">                          ÔøΩ L∆Ø·ª¢T M·ªöI NH·∫§T - X·∫æP H·∫†NG #{index + 1}                        </span>                      </div>                    )}                    {entry.userId === user?.uid && entry.id !== 'current-attempt' && (                      // eslint-disable-next-line i18next/no-literal-string                      <span className=\"text-gray-500 ml-2 text-sm\">(L∆∞·ª£t tr∆∞·ªõc ƒë√≥)</span>                    )}                  </div>                  <div className=\"text-sm text-gray-500\">                    // eslint-disable-next-line i18next/no-literal-string                    {entry.correctAnswers}/{entry.totalQuestions} correct                  </div>                  <div className=\"text-xs text-gray-400 mt-1\">                    üìÖ {formatDateTime(entry.completedAt instanceof Date ? entry.completedAt.getTime() : new Date(entry.completedAt).getTime())}                  </div>                </div>              </div>              <div className=\"text-right\">                <div className=\"font-bold text-xl text-gray-900\">{safeNumber(entry.score)}%</div>                // eslint-disable-next-line i18next/no-literal-string                <div className=\"text-sm text-gray-500\">                  ‚è±Ô∏è {formatDetailedTime(safeNumber(entry.timeSpent))}                </div>              </div>            </div>          ))}                    {/* Show user rank if not in top 10 */}          {user && userRank && userRank > 10 && (            <div className=\"mt-6 pt-4 border-t border-gray-200\">              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">                <div className=\"text-center\">                  // eslint-disable-next-line i18next/no-literal-string                  <span className=\"text-blue-800 font-medium\">Your Rank: #{userRank}</span>                </div>              </div>            </div>          )}        </div>      ) : (        <div className=\"text-center py-12 text-gray-500\">          <div className=\"text-6xl mb-4\">üèÜ</div>          // eslint-disable-next-line i18next/no-literal-string          <p className=\"text-lg\">No results yet!</p>          // eslint-disable-next-line i18next/no-literal-string          <p>Be the first to complete this quiz and claim the top spot!</p>        </div>      )}    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\LoadingSpinner.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';import { useNavigate } from 'react-router-dom';import Button from '../../../../../shared/components/ui/Button';export const LoadingSpinner: React.FC = () => {  const navigate = useNavigate();  return (    <div className=\"flex items-center justify-center min-h-screen\">      <div className=\"text-center\">        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mb-4\"></div>        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Loading results...</h2>        // eslint-disable-next-line i18next/no-literal-string        <Button onClick={() => navigate('/quiz-list')}>          Back to Quiz List        </Button>      </div>    </div>  );};","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';import { useNavigate } from 'react-router-dom';import Button from '../../../../../shared/components/ui/Button';export const LoadingSpinner: React.FC = () => {  const navigate = useNavigate();  return (    <div className=\"flex items-center justify-center min-h-screen\">      <div className=\"text-center\">        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mb-4\"></div>        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Loading results...</h2>        // eslint-disable-next-line i18next/no-literal-string        <Button onClick={() => navigate('/quiz-list')}>          Back to Quiz List        </Button>      </div>    </div>  );};' was not found.","line":1,"column":1,"endLine":1,"endColumn":755,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';import { useNavigate } from 'react-router-dom';import Button from '../../../../../shared/components/ui/Button';export const LoadingSpinner: React.FC = () => {  const navigate = useNavigate();  return (    <div className=\"flex items-center justify-center min-h-screen\">      <div className=\"text-center\">        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mb-4\"></div>        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Loading results...</h2>        // eslint-disable-next-line i18next/no-literal-string        <Button onClick={() => navigate('/quiz-list')}>          Back to Quiz List        </Button>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\PerformanceAnalysis.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';import { Quiz } from '../../../types';import { ResultState } from '../types';interface PerformanceAnalysisProps {  quiz: Quiz;  result: ResultState;  percentage: number;}export const PerformanceAnalysis: React.FC<PerformanceAnalysisProps> = ({   quiz","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';import { Quiz } from '../../../types';import { ResultState } from '../types';interface PerformanceAnalysisProps {  quiz: Quiz;  result: ResultState;  percentage: number;}export const PerformanceAnalysis: React.FC<PerformanceAnalysisProps> = ({   quiz' was not found.","line":1,"column":1,"endLine":1,"endColumn":2154,"severity":2,"nodeType":null},{"ruleId":"result","message":"Definition for rule 'result' was not found.","line":1,"column":1,"endLine":1,"endColumn":2154,"severity":2,"nodeType":null},{"ruleId":"percentage }) => {  return (    <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">      // eslint-disable-next-line i18next/no-literal-string      <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Performance Analysis</h2>            <div className=\"space-y-4\">        <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Accuracy Rate</span>          <div className=\"flex items-center\">            <div className=\"w-32 bg-gray-200 rounded-full h-2 mr-3\">              <div                 className=\"bg-blue-500 h-2 rounded-full transition-all duration-1000\"                style={{ width: `${percentage}%` }}              ></div>            </div>            <span className=\"font-semibold\">{percentage}%</span>          </div>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Quiz Difficulty</span>          <span className={`px-3 py-1 rounded-full text-sm font-medium ${            quiz.difficulty === 'easy' ? 'bg-green-100 text-green-800' :            quiz.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :            'bg-red-100 text-red-800'          }`}>            {quiz.difficulty.charAt(0).toUpperCase() + quiz.difficulty.slice(1)}          </span>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Time Management</span>          <span className=\"font-semibold text-green-600\">            {result.isTimeUp ? 'Used full time' : 'Completed early'}          </span>        </div>      </div>    </div>  );};","message":"Definition for rule 'percentage }) => {  return (    <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">      // eslint-disable-next-line i18next/no-literal-string      <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Performance Analysis</h2>            <div className=\"space-y-4\">        <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Accuracy Rate</span>          <div className=\"flex items-center\">            <div className=\"w-32 bg-gray-200 rounded-full h-2 mr-3\">              <div                 className=\"bg-blue-500 h-2 rounded-full transition-all duration-1000\"                style={{ width: `${percentage}%` }}              ></div>            </div>            <span className=\"font-semibold\">{percentage}%</span>          </div>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Quiz Difficulty</span>          <span className={`px-3 py-1 rounded-full text-sm font-medium ${            quiz.difficulty === 'easy' ? 'bg-green-100 text-green-800' :            quiz.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :            'bg-red-100 text-red-800'          }`}>            {quiz.difficulty.charAt(0).toUpperCase() + quiz.difficulty.slice(1)}          </span>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Time Management</span>          <span className=\"font-semibold text-green-600\">            {result.isTimeUp ? 'Used full time' : 'Completed early'}          </span>        </div>      </div>    </div>  );};' was not found.","line":1,"column":1,"endLine":1,"endColumn":2154,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';import { Quiz } from '../../../types';import { ResultState } from '../types';interface PerformanceAnalysisProps {  quiz: Quiz;  result: ResultState;  percentage: number;}export const PerformanceAnalysis: React.FC<PerformanceAnalysisProps> = ({   quiz,   result,   percentage }) => {  return (    <div className=\"bg-white rounded-xl shadow-lg p-6 mb-8\">      // eslint-disable-next-line i18next/no-literal-string      <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Performance Analysis</h2>            <div className=\"space-y-4\">        <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Accuracy Rate</span>          <div className=\"flex items-center\">            <div className=\"w-32 bg-gray-200 rounded-full h-2 mr-3\">              <div                 className=\"bg-blue-500 h-2 rounded-full transition-all duration-1000\"                style={{ width: `${percentage}%` }}              ></div>            </div>            <span className=\"font-semibold\">{percentage}%</span>          </div>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Quiz Difficulty</span>          <span className={`px-3 py-1 rounded-full text-sm font-medium ${            quiz.difficulty === 'easy' ? 'bg-green-100 text-green-800' :            quiz.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :            'bg-red-100 text-red-800'          }`}>            {quiz.difficulty.charAt(0).toUpperCase() + quiz.difficulty.slice(1)}          </span>        </div>                <div className=\"flex items-center justify-between\">          // eslint-disable-next-line i18next/no-literal-string          <span className=\"text-gray-600\">Time Management</span>          <span className=\"font-semibold text-green-600\">            {result.isTimeUp ? 'Used full time' : 'Completed early'}          </span>        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\ResultSummary.tsx","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: Expression expected.","line":1,"column":550,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªøimport React from 'react';import { ScoreCircle } from './ScoreCircle';import { ResultState } from '../types';import { getPerformanceMessage, formatDetailedTime, safeNumber } from '../utils';interface ResultSummaryProps {  result: ResultState;  percentage: number;  correct: number;  total: number;}export const ResultSummary: React.FC<ResultSummaryProps> = ({   result,   percentage,   correct,   total }) => {  return (    <div className=\"text-center mb-8\">      <div className=\"bg-white rounded-2xl shadow-xl p-8 mb-6\">        {result.isTimeUp && (          // eslint-disable-next-line i18next/no-literal-string          <div className=\"bg-yellow-100 border border-yellow-300 text-yellow-800 px-4 py-3 rounded-lg mb-6\">            ‚è∞ Time's up! Quiz was automatically submitted.          </div>        )}        <div className=\"flex flex-col items-center\">          <ScoreCircle score={percentage} />          // eslint-disable-next-line i18next/no-literal-string          <h1 className=\"text-3xl font-bold text-gray-900 mt-4 mb-2\">            Quiz Completed!          </h1>          <p className=\"text-xl text-gray-600 mb-4\">            {getPerformanceMessage(percentage)}          </p>          // eslint-disable-next-line i18next/no-literal-string          <div className=\"text-lg text-gray-700 mb-2\">            // eslint-disable-next-line i18next/no-literal-string            You got <span className=\"font-bold text-blue-600\">{correct}</span> out of{' '}            // eslint-disable-next-line i18next/no-literal-string            <span className=\"font-bold\">{total}</span> questions correct          </div>          {/* Hi·ªÉn th·ªã th·ªùi gian l√†m b√†i - gi·ªëng y h·ªát Leaderboard */}          {typeof result.timeSpent === 'number' && (            // eslint-disable-next-line i18next/no-literal-string            <div className=\"text-md text-gray-500 mt-2\">              ‚è±Ô∏è Time taken: <span className=\"font-semibold text-blue-700\">{formatDetailedTime(safeNumber(result.timeSpent))}</span>            </div>          )}        </div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\ScoreCircle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\StatsGrid.tsx","messages":[{"ruleId":"i18next/no-literal-stringimport React from 'react';interface StatsGridProps {  correct: number;  total: number;  percentage: number;}export const StatsGrid: React.FC<StatsGridProps> = ({ correct","message":"Definition for rule 'i18next/no-literal-stringimport React from 'react';interface StatsGridProps {  correct: number;  total: number;  percentage: number;}export const StatsGrid: React.FC<StatsGridProps> = ({ correct' was not found.","line":1,"column":1,"endLine":1,"endColumn":1202,"severity":2,"nodeType":null},{"ruleId":"total","message":"Definition for rule 'total' was not found.","line":1,"column":1,"endLine":1,"endColumn":1202,"severity":2,"nodeType":null},{"ruleId":"percentage }) => {  return (    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">      <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-green-600 mb-2\">{correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Correct Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-red-600 mb-2\">{total - correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Incorrect Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-blue-600 mb-2\">{percentage}%</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Final Score</div>      </div>    </div>  );};","message":"Definition for rule 'percentage }) => {  return (    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">      <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-green-600 mb-2\">{correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Correct Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-red-600 mb-2\">{total - correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Incorrect Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-blue-600 mb-2\">{percentage}%</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Final Score</div>      </div>    </div>  );};' was not found.","line":1,"column":1,"endLine":1,"endColumn":1202,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø// eslint-disable-next-line i18next/no-literal-stringimport React from 'react';interface StatsGridProps {  correct: number;  total: number;  percentage: number;}export const StatsGrid: React.FC<StatsGridProps> = ({ correct, total, percentage }) => {  return (    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">      <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-green-600 mb-2\">{correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Correct Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-red-600 mb-2\">{total - correct}</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Incorrect Answers</div>      </div>            <div className=\"bg-white rounded-xl shadow-lg p-6 text-center\">        <div className=\"text-3xl font-bold text-blue-600 mb-2\">{percentage}%</div>        // eslint-disable-next-line i18next/no-literal-string        <div className=\"text-gray-600\">Final Score</div>      </div>    </div>  );};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\components\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\hooks\\useLeaderboard.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[304,307],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[304,307],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2136,2139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2136,2139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../../../lib/store';\r\nimport { toast } from 'react-toastify';\r\nimport { LeaderboardEntry } from '../types';\r\n\r\nexport const useLeaderboard = (quizId: string | null, currentResult?: any) => {\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n  const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);\r\n  const [userRank, setUserRank] = useState<number | null>(null);\r\n  const [loadingStats, setLoadingStats] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchLeaderboard = async () => {\r\n      if (!quizId) return;\r\n      \r\n      try {\r\n        setLoadingStats(true);\r\n        console.log('üìä Fetching leaderboard for quiz:', quizId);\r\n        \r\n        // Fetch leaderboard from Firestore using quiz results\r\n        const { getQuizResults } = await import('../../../api/base');\r\n        const quizResults = await getQuizResults(quizId);\r\n        \r\n        console.log('üìä Raw quiz results:', quizResults);\r\n        \r\n        // Use only real data\r\n        const leaderboardData = quizResults;\r\n        \r\n        // Add current result to leaderboard if provided\r\n        if (currentResult && user) {\r\n          console.log('‚ûï Adding current result to leaderboard:', currentResult);\r\n          const currentEntry = {\r\n            id: 'current-attempt',\r\n            userId: user.uid,\r\n            userName: user.displayName || user.email?.split('@')[0] || 'B·∫°n',\r\n            userEmail: user.email || '',\r\n            quizId: quizId,\r\n            score: currentResult.score?.percentage || 0,\r\n            correctAnswers: currentResult.correct || 0,\r\n            totalQuestions: currentResult.total || 0,\r\n            timeSpent: currentResult.timeSpent || 0,\r\n            answers: [],\r\n            completedAt: new Date() // Just completed\r\n          };\r\n          leaderboardData.push(currentEntry);\r\n        }\r\n        \r\n        // Transform QuizResult data to LeaderboardEntry format\r\n        const transformedLeaderboard: LeaderboardEntry[] = leaderboardData.map((result: any) => ({\r\n          id: result.id,\r\n          userId: result.userId,\r\n          userName: result.userName,\r\n          userEmail: result.userEmail,\r\n          score: result.score,\r\n          correctAnswers: result.correctAnswers,\r\n          totalQuestions: result.totalQuestions,\r\n          timeSpent: result.timeSpent,\r\n          completedAt: result.completedAt instanceof Date ? result.completedAt : new Date(result.completedAt)\r\n        }));\r\n        \r\n        // Sort by score (descending) then by time (ascending) for same scores\r\n        const sortedLeaderboard = transformedLeaderboard.sort((a, b) => {\r\n          if (a.score !== b.score) {\r\n            return b.score - a.score; // Higher score first\r\n          }\r\n          return a.timeSpent - b.timeSpent; // Faster time first if same score\r\n        });\r\n\r\n        console.log('üìä Sorted leaderboard:', sortedLeaderboard);\r\n        setLeaderboard(sortedLeaderboard.slice(0, 10)); // Top 10\r\n\r\n        // Find current user's rank\r\n        if (user) {\r\n          const userResultIndex = sortedLeaderboard.findIndex((r: LeaderboardEntry) => r.userId === user.uid);\r\n          setUserRank(userResultIndex >= 0 ? userResultIndex + 1 : null);\r\n          console.log('üë§ User rank:', userResultIndex >= 0 ? userResultIndex + 1 : 'Not found');\r\n        }\r\n\r\n        console.log('üìä Leaderboard loaded:', sortedLeaderboard.length, 'entries');\r\n      } catch (error) {\r\n        console.error('‚ùå Failed to fetch leaderboard:', error);\r\n        toast.error('Kh√¥ng th·ªÉ t·∫£i b·∫£ng x·∫øp h·∫°ng!');\r\n      } finally {\r\n        setLoadingStats(false);\r\n      }\r\n    };\r\n\r\n    fetchLeaderboard();\r\n  }, [quizId, user, currentResult]);\r\n\r\n  return {\r\n    leaderboard,\r\n    userRank,\r\n    loadingStats\r\n  };\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\hooks\\useResultData.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3183,3186],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3183,3186],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":140,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":140,"endColumn":21,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6369,6369],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../../../lib/store';\r\nimport { Quiz } from '../../../types';\r\nimport { getQuizById } from '../../../services/quiz';\r\nimport { toast } from 'react-toastify';\r\nimport { ResultState } from '../types';\r\nimport { getQuizResultById } from '../../../api/base';\r\n\r\nexport const useResultData = () => {\r\n  const { attemptId } = useParams<{ attemptId: string }>();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { quizzes } = useSelector((state: RootState) => state.quiz);\r\n  \r\n  const [result, setResult] = useState<ResultState | null>(location.state as ResultState || null);\r\n  const [quizId, setQuizId] = useState<string | null>(null);\r\n  const [quiz, setQuiz] = useState<Quiz | null>(null);\r\n\r\n  useEffect(() => {\r\n    console.log('üîç ResultPage useEffect - attemptId:', attemptId, 'location.state:', location.state);\r\n    console.log('üîç URL attemptId type and value:', typeof attemptId, attemptId);\r\n    console.log('üîç Current URL:', window.location.href);\r\n    \r\n    if (location.state) {\r\n      // C√≥ state t·ª´ navigation - s·ª≠ d·ª•ng ngay\r\n      const resultData = location.state as ResultState;\r\n      console.log('‚úÖ Using state from navigation:', resultData);\r\n      setResult(resultData);\r\n      setQuizId(resultData.quizId || attemptId || null);\r\n    } else if (attemptId) {\r\n      // Kh√¥ng c√≥ state, fetch t·ª´ Firestore b·∫±ng attemptId (quizResults doc id)\r\n      (async () => {\r\n        try {\r\n          console.log('üì° Fetching quizResult document for attemptId:', attemptId);\r\n          console.log('üì° This should be a Firestore document ID, not a quiz ID');\r\n          const raw = await getQuizResultById(attemptId);\r\n          if (!raw) {\r\n            console.error('‚ùå No quizResult found for attemptId:', attemptId);\r\n            console.error('‚ùå This might mean attemptId is not a valid Firestore document ID');\r\n            navigate('/quiz-list');\r\n            return;\r\n          }\r\n          // Map Firestore quizResult -> ResultState shape\r\n          const totalQuestions = (raw.totalQuestions ?? (raw.answers?.length || 0));\r\n          let correctAnswers = (raw.correctAnswers ?? 0);\r\n          // Heuristic: if correctAnswers missing/zero but score >0, derive from score percentage\r\n          if ((correctAnswers === 0 || correctAnswers === undefined) && typeof raw.score === 'number' && raw.score > 0 && totalQuestions > 0) {\r\n            const derived = Math.round(((raw.score <= 1 ? raw.score * 100 : raw.score) / 100) * totalQuestions);\r\n            console.log('üõ†Ô∏è Deriving correctAnswers from score since legacy record lacks it:', { derived, rawScore: raw.score, totalQuestions });\r\n            correctAnswers = derived;\r\n          }\r\n          const mapped: ResultState = {\r\n            score: typeof raw.score === 'number' ? (raw.score <= 1 ? raw.score * 100 : raw.score) : 0,\r\n            correct: correctAnswers,\r\n            total: totalQuestions,\r\n            answers: (raw.answers || []).reduce((acc: Record<string,string>, ans: any) => {\r\n              acc[ans.questionId] = ans.selectedAnswerId;\r\n              return acc;\r\n            }, {}),\r\n            timeSpent: raw.timeSpent,\r\n            quizId: raw.quizId\r\n          };\r\n          console.log('‚úÖ Mapped quizResult -> ResultState:', mapped);\r\n          setResult(mapped);\r\n          setQuizId(raw.quizId || null);\r\n        } catch (e) {\r\n          console.error('‚ùå Error fetching quiz result by attemptId:', e);\r\n          navigate('/quiz-list');\r\n        }\r\n      })();\r\n    } else {\r\n      console.error('‚ùå No attemptId or state provided');\r\n      navigate('/quiz-list');\r\n    }\r\n  }, [attemptId, location.state, navigate]);\r\n\r\n  useEffect(() => {\r\n    if (!quizId) return;\r\n    \r\n    console.log('üîç Looking for quiz with ID:', quizId);\r\n    const foundQuiz = quizzes.find(q => q.id === quizId);\r\n    \r\n    if (foundQuiz) {\r\n      console.log('‚úÖ Found quiz in store:', foundQuiz.title);\r\n      setQuiz(foundQuiz);\r\n    } else {\r\n      console.log('üì° Quiz not in store, fetching from Firestore...');\r\n      // N·∫øu kh√¥ng c√≥ trong store, fetch t·ª´ Firestore\r\n      getQuizById(quizId).then(qz => {\r\n        if (qz) {\r\n          console.log('‚úÖ Fetched quiz from Firestore:', qz.title);\r\n          setQuiz(qz);\r\n        } else {\r\n          console.error('‚ùå Quiz not found:', quizId);\r\n          toast.error('Kh√¥ng t√¨m th·∫•y quiz!');\r\n          navigate('/quiz-list');\r\n        }\r\n      }).catch(error => {\r\n        console.error('‚ùå Error fetching quiz:', error);\r\n        toast.error('Kh√¥ng th·ªÉ t·∫£i quiz!');\r\n        navigate('/quiz-list');\r\n      });\r\n    }\r\n  }, [quizId, quizzes, navigate]);\r\n\r\n  // Secondary reconciliation: once quiz loaded, if result.correct seems inconsistent with quiz + answers, recompute.\r\n  useEffect(() => {\r\n    if (!quiz || !result) return;\r\n    if (!quiz.questions?.length) return;\r\n    // Only attempt if (a) result.correct is 0 but score > 0 OR (b) percentage mismatch > 5%.\r\n    const currentPct = result.total > 0 ? (result.correct / result.total) * 100 : 0;\r\n    const storedPct = result.score;\r\n    const needsRecompute = (result.correct === 0 && storedPct > 0) || Math.abs(currentPct - storedPct) > 5;\r\n    if (!needsRecompute) return;\r\n    console.log('üõ†Ô∏è Recomputing correct count from quiz questions for legacy result');\r\n    // Build reverse map of user answers\r\n    const userAnswers = result.answers;\r\n    let computedCorrect = 0;\r\n    quiz.questions.forEach(q => {\r\n      const userVal = userAnswers[q.id];\r\n      if (userVal === undefined) return;\r\n      switch (q.type) {\r\n        case 'multiple':\r\n        case 'boolean':\r\n        case 'image': {\r\n          const correctId = q.answers.find(a => a.isCorrect)?.id;\r\n          if (userVal === correctId) computedCorrect++;\r\n          break;\r\n        }\r\n        case 'checkbox': {\r\n          try {\r\n            const parsed = JSON.parse(userVal);\r\n            if (Array.isArray(parsed)) {\r\n              const correctIds = q.answers.filter(a => a.isCorrect).map(a => a.id).sort();\r\n              const userIds = [...parsed].sort();\r\n              if (JSON.stringify(correctIds) === JSON.stringify(userIds)) computedCorrect++;\r\n            }\r\n          } catch {}\r\n          break;\r\n        }\r\n        case 'short_answer': {\r\n          // Simplistic: compare lowercased trimmed text with any correct answer text flagged isCorrect\r\n          const normalized = (val: string) => val?.trim().toLowerCase();\r\n          const userText = normalized(userVal);\r\n            const acceptable = q.answers.filter(a => a.isCorrect).map(a => normalized(a.text));\r\n            if (acceptable.includes(userText)) computedCorrect++;\r\n          break;\r\n        }\r\n      }\r\n    });\r\n    if (computedCorrect !== result.correct && result.total > 0) {\r\n      const recomputedScore = Math.round((computedCorrect / result.total) * 100);\r\n      console.log('‚úÖ Recomputed correctness for legacy result:', { computedCorrect, recomputedScore });\r\n      setResult(prev => prev ? { ...prev, correct: computedCorrect, score: recomputedScore } : prev);\r\n    }\r\n  }, [quiz, result]);\r\n\r\n  return {\r\n    result,\r\n    quiz,\r\n    quizId,\r\n    isLoading: !result || !quiz\r\n  };\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\pages\\ResultPage\\utils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1826,1829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1826,1829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Helper: format time (milliseconds or seconds) to mm:ss\r\nexport const formatTime = (time: number, isMilliseconds = true) => {\r\n  const seconds = isMilliseconds ? Math.floor(time / 1000) : time;\r\n  const m = Math.floor(seconds / 60);\r\n  const s = seconds % 60;\r\n  return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n};\r\n\r\n// Helper: format detailed time with hours, minutes, seconds\r\nexport const formatDetailedTime = (seconds: number) => {\r\n  const hours = Math.floor(seconds / 3600);\r\n  const minutes = Math.floor((seconds % 3600) / 60);\r\n  const remainingSeconds = seconds % 60;\r\n  \r\n  if (hours > 0) {\r\n    return `${hours}h ${minutes}m ${remainingSeconds}s`;\r\n  } else if (minutes > 0) {\r\n    return `${minutes}m ${remainingSeconds}s`;\r\n  } else {\r\n    return `${remainingSeconds}s`;\r\n  }\r\n};\r\n\r\n// Helper: format date and time for leaderboard display\r\nexport const formatDateTime = (timestamp: number) => {\r\n  const date = new Date(timestamp);\r\n  const today = new Date();\r\n  const yesterday = new Date(today);\r\n  yesterday.setDate(yesterday.getDate() - 1);\r\n  \r\n  const isToday = date.toDateString() === today.toDateString();\r\n  const isYesterday = date.toDateString() === yesterday.toDateString();\r\n  \r\n  const timeString = date.toLocaleTimeString('vi-VN', {\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit',\r\n    hour12: false\r\n  });\r\n  \r\n  if (isToday) {\r\n    return `H√¥m nay ${timeString}`;\r\n  } else if (isYesterday) {\r\n    return `H√¥m qua ${timeString}`;\r\n  } else {\r\n    return date.toLocaleString('vi-VN', {\r\n      day: '2-digit',\r\n      month: '2-digit',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n      second: '2-digit',\r\n      hour12: false\r\n    });\r\n  }\r\n};\r\n\r\n// Helper: safe number conversion\r\nexport const safeNumber = (val: any, fallback = 0) => {\r\n  const n = Number(val);\r\n  return isNaN(n) ? fallback : n;\r\n};\r\n\r\n// Helper: get score color based on percentage\r\nexport const getScoreColor = (score: number) => {\r\n  if (score >= 80) return 'text-green-600';\r\n  if (score >= 60) return 'text-yellow-600';\r\n  return 'text-red-600';\r\n};\r\n\r\n// Helper: get performance message\r\nexport const getPerformanceMessage = (percentage: number) => {\r\n  if (percentage >= 90) return 'Outstanding! üèÜ';\r\n  if (percentage >= 80) return 'Excellent! üåü';\r\n  if (percentage >= 70) return 'Great Job! üëè';\r\n  if (percentage >= 60) return 'Good Work! üëç';\r\n  if (percentage >= 50) return 'Not Bad! üìö';\r\n  return 'Keep Practicing! üí™';\r\n};\r\n\r\n// Helper: get rank display with emoji\r\nexport const getRankDisplay = (index: number) => {\r\n  if (index === 0) return 'ü•á';\r\n  if (index === 1) return 'ü•à';\r\n  if (index === 2) return 'ü•â';\r\n  return index + 1;\r\n};\r\n\r\n// Helper: get rank background color\r\nexport const getRankBackgroundColor = (index: number) => {\r\n  if (index === 0) return 'bg-yellow-400 text-yellow-900';\r\n  if (index === 1) return 'bg-gray-300 text-gray-700';\r\n  if (index === 2) return 'bg-amber-600 text-amber-100';\r\n  return 'bg-gray-200 text-gray-600';\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\fileProcessingService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[377,380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[377,380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[496,499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[496,499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2354,2357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2354,2357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// File Processing Services\r\n// C√†i ƒë·∫∑t dependencies: npm install tesseract.js pdf-parse mammoth xlsx\r\n\r\nimport { createWorker } from 'tesseract.js';\r\nimport * as pdfjsLib from 'pdfjs-dist';\r\nimport mammoth from 'mammoth';\r\nimport * as XLSX from 'xlsx';\r\n\r\nexport interface FileProcessingResult {\r\n  extractedText: string;\r\n  success: boolean;\r\n  error?: string;\r\n  metadata?: any;\r\n}\r\n\r\n/**\r\n * OCR Service - Tr√≠ch xu·∫•t text t·ª´ h√¨nh ·∫£nh\r\n */\r\nexport class OCRService {\r\n  private static worker: any = null;\r\n\r\n  static async initializeWorker() {\r\n    if (!this.worker) {\r\n      this.worker = await createWorker();\r\n      await this.worker.loadLanguage('eng+vie');\r\n      await this.worker.initialize('eng+vie');\r\n    }\r\n    return this.worker;\r\n  }\r\n\r\n  static async extractTextFromImage(file: File): Promise<FileProcessingResult> {\r\n    try {\r\n      const worker = await this.initializeWorker();\r\n      \r\n      // ƒê·ªçc file th√†nh blob URL ƒë·ªÉ OCR\r\n      const imageUrl = URL.createObjectURL(file);\r\n      \r\n      const { data: { text, confidence } } = await worker.recognize(imageUrl);\r\n      \r\n      // Clean up\r\n      URL.revokeObjectURL(imageUrl);\r\n      \r\n      return {\r\n        extractedText: text,\r\n        success: true,\r\n        metadata: { confidence, fileSize: file.size }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `OCR Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n\r\n  static async terminateWorker() {\r\n    if (this.worker) {\r\n      await this.worker.terminate();\r\n      this.worker = null;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * PDF Service - Tr√≠ch xu·∫•t text t·ª´ PDF\r\n */\r\nexport class PDFService {\r\n  static async extractTextFromPDF(file: File): Promise<FileProcessingResult> {\r\n    try {\r\n      // ƒê·ªçc file PDF\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      \r\n      // Load PDF document\r\n      const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\r\n      \r\n      let fullText = '';\r\n      const totalPages = pdf.numPages;\r\n      \r\n      // Tr√≠ch xu·∫•t text t·ª´ t·∫•t c·∫£ c√°c trang\r\n      for (let i = 1; i <= totalPages; i++) {\r\n        const page = await pdf.getPage(i);\r\n        const textContent = await page.getTextContent();\r\n        \r\n        const pageText = textContent.items\r\n          .map((item: any) => item.str)\r\n          .join(' ');\r\n        \r\n        fullText += `\\n--- Trang ${i} ---\\n${pageText}\\n`;\r\n      }\r\n      \r\n      return {\r\n        extractedText: fullText.trim(),\r\n        success: true,\r\n        metadata: { \r\n          totalPages, \r\n          fileSize: file.size,\r\n          fileName: file.name \r\n        }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `PDF Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Word Document Service - Tr√≠ch xu·∫•t text t·ª´ .docx\r\n */\r\nexport class WordService {\r\n  static async extractTextFromWord(file: File): Promise<FileProcessingResult> {\r\n    try {\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      \r\n      // S·ª≠ d·ª•ng mammoth ƒë·ªÉ ƒë·ªçc .docx\r\n      const result = await mammoth.extractRawText({ arrayBuffer });\r\n      \r\n      return {\r\n        extractedText: result.value,\r\n        success: true,\r\n        metadata: {\r\n          fileSize: file.size,\r\n          fileName: file.name,\r\n          messages: result.messages // Warnings t·ª´ mammoth\r\n        }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `Word Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Excel/Spreadsheet Service - Tr√≠ch xu·∫•t data t·ª´ Excel/CSV\r\n */\r\nexport class SpreadsheetService {\r\n  static async extractTextFromSpreadsheet(file: File): Promise<FileProcessingResult> {\r\n    try {\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      const workbook = XLSX.read(arrayBuffer, { type: 'array' });\r\n      \r\n      let fullText = '';\r\n      \r\n      // ƒê·ªçc t·∫•t c·∫£ worksheets\r\n      workbook.SheetNames.forEach(sheetName => {\r\n        const worksheet = workbook.Sheets[sheetName];\r\n        const csvText = XLSX.utils.sheet_to_csv(worksheet);\r\n        fullText += `\\n=== Sheet: ${sheetName} ===\\n${csvText}\\n`;\r\n      });\r\n      \r\n      return {\r\n        extractedText: fullText.trim(),\r\n        success: true,\r\n        metadata: {\r\n          fileSize: file.size,\r\n          fileName: file.name,\r\n          sheetCount: workbook.SheetNames.length,\r\n          sheetNames: workbook.SheetNames\r\n        }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `Spreadsheet Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Text File Service - ƒê·ªçc plain text files\r\n */\r\nexport class TextService {\r\n  static async extractTextFromTextFile(file: File): Promise<FileProcessingResult> {\r\n    try {\r\n      const text = await file.text();\r\n      \r\n      return {\r\n        extractedText: text,\r\n        success: true,\r\n        metadata: {\r\n          fileSize: file.size,\r\n          fileName: file.name\r\n        }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `Text Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Main File Processor - Router ƒë·ªÉ x·ª≠ l√Ω c√°c lo·∫°i file kh√°c nhau\r\n */\r\nexport class FileProcessor {\r\n  static getSupportedTypes() {\r\n    return {\r\n      images: ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp'],\r\n      documents: ['.pdf', '.doc', '.docx', '.txt', '.rtf'],\r\n      spreadsheets: ['.csv', '.xlsx', '.xls']\r\n    };\r\n  }\r\n\r\n  static isFileSupported(fileName: string): boolean {\r\n    const lowercaseName = fileName.toLowerCase();\r\n    const supportedTypes = this.getSupportedTypes();\r\n    \r\n    return Object.values(supportedTypes)\r\n      .flat()\r\n      .some(ext => lowercaseName.endsWith(ext));\r\n  }\r\n\r\n  static async processFile(file: File): Promise<FileProcessingResult> {\r\n    const fileName = file.name.toLowerCase();\r\n    const supportedTypes = this.getSupportedTypes();\r\n    \r\n    try {\r\n      // Check file size (limit 50MB)\r\n      if (file.size > 50 * 1024 * 1024) {\r\n        return {\r\n          extractedText: '',\r\n          success: false,\r\n          error: 'File qu√° l·ªõn. Vui l√≤ng ch·ªçn file nh·ªè h∆°n 50MB.'\r\n        };\r\n      }\r\n\r\n      // Route to appropriate service\r\n      if (supportedTypes.images.some(ext => fileName.endsWith(ext))) {\r\n        return await OCRService.extractTextFromImage(file);\r\n      }\r\n      \r\n      if (fileName.endsWith('.pdf')) {\r\n        return await PDFService.extractTextFromPDF(file);\r\n      }\r\n      \r\n      if (fileName.endsWith('.docx') || fileName.endsWith('.doc')) {\r\n        return await WordService.extractTextFromWord(file);\r\n      }\r\n      \r\n      if (supportedTypes.spreadsheets.some(ext => fileName.endsWith(ext))) {\r\n        return await SpreadsheetService.extractTextFromSpreadsheet(file);\r\n      }\r\n      \r\n      if (fileName.endsWith('.txt') || fileName.endsWith('.rtf')) {\r\n        return await TextService.extractTextFromTextFile(file);\r\n      }\r\n      \r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: 'ƒê·ªãnh d·∫°ng file kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£.'\r\n      };\r\n      \r\n    } catch (error) {\r\n      return {\r\n        extractedText: '',\r\n        success: false,\r\n        error: `Processing Error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      };\r\n    }\r\n  }\r\n\r\n  // Cleanup resources\r\n  static async cleanup() {\r\n    await OCRService.terminateWorker();\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\firebaseAIService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1912,1915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1912,1915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3620,3623],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3620,3623],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3993,3996],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3993,3996],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Firebase AI Service using Google Generative AI (Gemini)\r\n// Service ƒë·ªÉ t·∫°o c√¢u h·ªèi t·ª± ƒë·ªông b·∫±ng AI\r\n\r\nimport { Question } from '../types';\r\nimport { getFunctions, httpsCallable } from 'firebase/functions';\r\nimport { getAuth } from 'firebase/auth';\r\n\r\nexport interface FirebaseAIConfig {\r\n  model?: 'gemini-2.0-flash-exp' | 'gemini-pro' | 'gemini-pro-vision';\r\n  temperature?: number;\r\n  maxTokens?: number;\r\n}\r\n\r\nexport interface QuestionGenerationOptions {\r\n  content: string;\r\n  customPrompt?: string;\r\n  numQuestions?: number;\r\n  difficulty?: 'easy' | 'medium' | 'hard' | 'mixed';\r\n  language?: 'vi' | 'en';\r\n  questionTypes?: ('multiple' | 'true-false' | 'fill-in-blank')[];\r\n}\r\n\r\n/**\r\n * Firebase AI Service using Google Generative AI (Gemini)\r\n */\r\nexport class FirebaseAIService {\r\n  private static functions = getFunctions();\r\n  \r\n  static async generateQuestions(\r\n    config: FirebaseAIConfig = {},\r\n    options: QuestionGenerationOptions\r\n  ): Promise<Question[]> {\r\n    const { \r\n      content, \r\n      customPrompt, \r\n      numQuestions = 5, \r\n      difficulty = 'mixed', \r\n      language = 'vi' \r\n    } = options;\r\n\r\n    // Ki·ªÉm tra x√°c th·ª±c\r\n    const auth = getAuth();\r\n    if (!auth.currentUser) {\r\n      throw new Error('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ s·ª≠ d·ª•ng t√≠nh nƒÉng AI');\r\n    }\r\n\r\n    try {\r\n      // T·∫°o system prompt\r\n      const systemPrompt = customPrompt || this.getDefaultPrompt(numQuestions, difficulty, language);\r\n      \r\n      // G·ªçi Firebase Function\r\n      const generateQuestions = httpsCallable(this.functions, 'generateQuestions');\r\n      \r\n      const result = await generateQuestions({\r\n        prompt: systemPrompt,\r\n        content: content,\r\n        config: {\r\n          model: config.model || 'gemini-2.0-flash-exp',\r\n          temperature: config.temperature || 0.7,\r\n          maxTokens: config.maxTokens || 2000\r\n        }\r\n      });\r\n\r\n      const data = result.data as any;\r\n      \r\n      if (!data.success) {\r\n        throw new Error(data.error || 'AI generation failed');\r\n      }\r\n\r\n      return this.parseQuestionsFromResponse(data.questions);\r\n    } catch (error) {\r\n      console.error('Firebase AI Service Error:', error);\r\n      throw new Error(`Kh√¥ng th·ªÉ t·∫°o c√¢u h·ªèi: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * T·∫°o prompt m·∫∑c ƒë·ªãnh cho vi·ªác generate c√¢u h·ªèi\r\n   */\r\n  private static getDefaultPrompt(numQuestions: number, difficulty: string, language: string): string {\r\n    const lang = language === 'vi' ? 'ti·∫øng Vi·ªát' : 'English';\r\n    \r\n    return `\r\nB·∫°n l√† m·ªôt chuy√™n gia t·∫°o c√¢u h·ªèi tr·∫Øc nghi·ªám ch·∫•t l∆∞·ª£ng cao. H√£y t·∫°o ${numQuestions} c√¢u h·ªèi tr·∫Øc nghi·ªám b·∫±ng ${lang} d·ª±a tr√™n n·ªôi dung ƒë∆∞·ª£c cung c·∫•p.\r\n\r\nY√™u c·∫ßu:\r\n- M·ªói c√¢u h·ªèi c√≥ 4 ƒë√°p √°n (A, B, C, D)\r\n- Ch·ªâ c√≥ 1 ƒë√°p √°n ƒë√∫ng\r\n- C√¢u h·ªèi ph·∫£i li√™n quan tr·ª±c ti·∫øp ƒë·∫øn n·ªôi dung\r\n- ƒê·ªô kh√≥: ${difficulty}\r\n- Bao g·ªìm gi·∫£i th√≠ch cho ƒë√°p √°n ƒë√∫ng\r\n- ƒê·∫£m b·∫£o c√¢u h·ªèi c√≥ t√≠nh ph√¢n bi·ªát cao\r\n\r\nTr·∫£ v·ªÅ ƒë·ªãnh d·∫°ng JSON ch√≠nh x√°c nh∆∞ sau:\r\n{\r\n  \"questions\": [\r\n    {\r\n      \"text\": \"C√¢u h·ªèi ·ªü ƒë√¢y\",\r\n      \"answers\": [\r\n        {\"text\": \"ƒê√°p √°n A\", \"isCorrect\": true},\r\n        {\"text\": \"ƒê√°p √°n B\", \"isCorrect\": false},\r\n        {\"text\": \"ƒê√°p √°n C\", \"isCorrect\": false},\r\n        {\"text\": \"ƒê√°p √°n D\", \"isCorrect\": false}\r\n      ],\r\n      \"explanation\": \"Gi·∫£i th√≠ch t·∫°i sao ƒë√°p √°n A ƒë√∫ng\",\r\n      \"points\": 10,\r\n      \"difficulty\": \"${difficulty}\"\r\n    }\r\n  ]\r\n}\r\n\r\nQUAN TR·ªåNG: Ch·ªâ tr·∫£ v·ªÅ JSON thu·∫ßn t√∫y, kh√¥ng th√™m text ho·∫∑c markdown n√†o kh√°c.\r\n`;\r\n  }\r\n\r\n  /**\r\n   * Parse questions t·ª´ Firebase Function response\r\n   */\r\n  private static parseQuestionsFromResponse(questionsData: any[]): Question[] {\r\n    try {\r\n      const questions: Question[] = [];\r\n      \r\n      for (const questionData of questionsData) {\r\n        const question: Question = {\r\n          id: `q_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          text: questionData.text || '',\r\n          type: 'multiple',\r\n          answers: questionData.answers?.map((answer: any, index: number) => ({\r\n            id: `a_${index + 1}`,\r\n            text: answer.text || '',\r\n            isCorrect: answer.isCorrect === true\r\n          })) || [],\r\n          explanation: questionData.explanation || '',\r\n          points: questionData.points || 10,\r\n          difficulty: questionData.difficulty || 'medium'\r\n        };\r\n\r\n        // Validate question\r\n        if (question.text && question.answers.length >= 2) {\r\n          questions.push(question);\r\n        }\r\n      }\r\n\r\n      return questions;\r\n    } catch (error) {\r\n      console.error('Error parsing questions from response:', error);\r\n      throw new Error('Kh√¥ng th·ªÉ ph√¢n t√≠ch c√¢u h·ªèi t·ª´ AI');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ki·ªÉm tra availability c·ªßa Firebase AI\r\n   */\r\n  static async checkAvailability(): Promise<boolean> {\r\n    try {\r\n      const auth = getAuth();\r\n      if (!auth.currentUser) {\r\n        return false;\r\n      }\r\n\r\n      // Test v·ªõi m·ªôt request ƒë∆°n gi·∫£n\r\n      const testGenerate = httpsCallable(this.functions, 'testAI');\r\n      const result = await testGenerate({ test: true });\r\n      \r\n      return result.data ? true : false;\r\n    } catch (error) {\r\n      console.error('Firebase AI not available:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nexport default FirebaseAIService;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\geminiAIService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\learningService.ts","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":174,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":174,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Learning Materials Service\r\n * Qu·∫£n l√Ω ti·∫øn ƒë·ªô xem t√†i li·ªáu v√† gating logic\r\n */\r\n\r\nimport {\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  setDoc,\r\n  updateDoc,\r\n  serverTimestamp,\r\n  Timestamp\r\n} from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport {\r\n  LearningResource,\r\n  LearningSession,\r\n  ResourceViewProgress,\r\n  LearningEvent\r\n} from '../types/learning';\r\n\r\n/**\r\n * L·∫•y learning session c·ªßa user cho m·ªôt quiz\r\n */\r\nexport const getLearningSession = async (\r\n  userId: string,\r\n  quizId: string\r\n): Promise<LearningSession | null> => {\r\n  try {\r\n    const sessionId = `${quizId}_${userId}`;\r\n    const sessionRef = doc(db, 'userQuizSessions', sessionId);\r\n    const sessionDoc = await getDoc(sessionRef);\r\n\r\n    if (!sessionDoc.exists()) {\r\n      return null;\r\n    }\r\n\r\n    const data = sessionDoc.data();\r\n    return {\r\n      id: sessionDoc.id,\r\n      userId,\r\n      quizId,\r\n      viewedResources: data.viewedResources || {},\r\n      ready: data.ready || false,\r\n      readyAt: data.readyAt?.toDate(),\r\n      totalResourcesRequired: data.totalResourcesRequired || 0,\r\n      completedResourcesRequired: data.completedResourcesRequired || 0,\r\n      completionPercent: data.completionPercent || 0,\r\n      startedAt: data.startedAt?.toDate() || new Date(),\r\n      lastActivityAt: data.lastActivityAt?.toDate() || new Date(),\r\n      updatedAt: data.updatedAt?.toDate() || new Date()\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting learning session:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * T·∫°o ho·∫∑c c·∫≠p nh·∫≠t learning session\r\n */\r\nexport const initializeLearningSession = async (\r\n  userId: string,\r\n  quizId: string,\r\n  resources: LearningResource[]\r\n): Promise<LearningSession> => {\r\n  const sessionId = `${quizId}_${userId}`;\r\n  const sessionRef = doc(db, 'userQuizSessions', sessionId);\r\n\r\n  const requiredResources = resources.filter(r => r.required);\r\n  const now = new Date();\r\n\r\n  const session: Partial<LearningSession> = {\r\n    userId,\r\n    quizId,\r\n    viewedResources: {},\r\n    ready: requiredResources.length === 0, // N·∫øu kh√¥ng c√≥ required ‚Üí ready lu√¥n\r\n    totalResourcesRequired: requiredResources.length,\r\n    completedResourcesRequired: 0,\r\n    completionPercent: 0,\r\n    startedAt: now,\r\n    lastActivityAt: now,\r\n    updatedAt: now\r\n  };\r\n\r\n  await setDoc(sessionRef, {\r\n    ...session,\r\n    startedAt: Timestamp.fromDate(now),\r\n    lastActivityAt: Timestamp.fromDate(now),\r\n    updatedAt: serverTimestamp()\r\n  }, { merge: true });\r\n\r\n  return session as LearningSession;\r\n};\r\n\r\n/**\r\n * C·∫≠p nh·∫≠t ti·∫øn ƒë·ªô xem t√†i li·ªáu\r\n */\r\nexport const updateResourceProgress = async (\r\n  userId: string,\r\n  quizId: string,\r\n  resourceId: string,\r\n  progress: Partial<ResourceViewProgress>\r\n): Promise<void> => {\r\n  try {\r\n    const sessionId = `${quizId}_${userId}`;\r\n    const sessionRef = doc(db, 'userQuizSessions', sessionId);\r\n\r\n    // Get current session\r\n    const sessionDoc = await getDoc(sessionRef);\r\n    if (!sessionDoc.exists()) {\r\n      throw new Error('Session not found');\r\n    }\r\n\r\n    const sessionData = sessionDoc.data();\r\n    const viewedResources = sessionData.viewedResources || {};\r\n    const currentProgress = viewedResources[resourceId] || {};\r\n\r\n    // Merge progress\r\n    const updatedProgress: ResourceViewProgress = {\r\n      ...currentProgress,\r\n      ...progress,\r\n      resourceId,\r\n      lastActivityAt: new Date()\r\n    };\r\n\r\n    // Update session\r\n    await updateDoc(sessionRef, {\r\n      [`viewedResources.${resourceId}`]: {\r\n        ...updatedProgress,\r\n        startedAt: updatedProgress.startedAt ? Timestamp.fromDate(updatedProgress.startedAt) : serverTimestamp(),\r\n        lastActivityAt: serverTimestamp(),\r\n        completedAt: updatedProgress.completedAt ? Timestamp.fromDate(updatedProgress.completedAt) : null\r\n      },\r\n      lastActivityAt: serverTimestamp(),\r\n      updatedAt: serverTimestamp()\r\n    });\r\n\r\n    console.log('‚úÖ Resource progress updated:', resourceId, progress);\r\n  } catch (error) {\r\n    console.error('‚ùå Error updating resource progress:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Ki·ªÉm tra resource ƒë√£ ho√†n th√†nh threshold ch∆∞a\r\n */\r\nexport const validateResourceCompletion = (\r\n  resource: LearningResource,\r\n  progress: ResourceViewProgress\r\n): { completed: boolean; reason?: string } => {\r\n  const threshold = resource.threshold;\r\n\r\n  switch (resource.type) {\r\n    case 'video':\r\n      // Check video completion\r\n      if (threshold.minWatchSec && (!progress.secondsWatched || progress.secondsWatched < threshold.minWatchSec)) {\r\n        return {\r\n          completed: false,\r\n          reason: `C·∫ßn xem t·ªëi thi·ªÉu ${Math.ceil(threshold.minWatchSec / 60)} ph√∫t`\r\n        };\r\n      }\r\n      if (threshold.minWatchPercent && (!progress.watchPercent || progress.watchPercent < threshold.minWatchPercent)) {\r\n        return {\r\n          completed: false,\r\n          reason: `C·∫ßn xem t·ªëi thi·ªÉu ${threshold.minWatchPercent}% video`\r\n        };\r\n      }\r\n      return { completed: true };\r\n\r\n    case 'pdf':\r\n      const minTimePerPage = threshold.minTimePerPage || 1.5; // Default 1.5s per page\r\n      \r\n      if (threshold.mustReachLastPage) {\r\n        const lastPage = resource.totalPages || 1;\r\n        if (!progress.pagesViewed?.includes(lastPage)) {\r\n          return {\r\n            completed: false,\r\n            reason: 'C·∫ßn ƒë·ªçc ƒë·∫øn trang cu·ªëi'\r\n          };\r\n        }\r\n      }\r\n\r\n      if (threshold.minPages) {\r\n        const viewedCount = progress.pagesViewed?.length || 0;\r\n        if (viewedCount < threshold.minPages) {\r\n          return {\r\n            completed: false,\r\n            reason: `C·∫ßn xem t·ªëi thi·ªÉu ${threshold.minPages} trang`\r\n          };\r\n        }\r\n\r\n        // Check time per page (anti-skip)\r\n        if (progress.pageViewTimes) {\r\n          const validPages = Object.values(progress.pageViewTimes).filter(\r\n            time => time >= minTimePerPage\r\n          ).length;\r\n          \r\n          if (validPages < threshold.minPages) {\r\n            return {\r\n              completed: false,\r\n              reason: `C·∫ßn d√†nh √≠t nh·∫•t ${minTimePerPage}s cho m·ªói trang`\r\n            };\r\n          }\r\n        }\r\n      }\r\n      return { completed: true };\r\n\r\n    case 'image':\r\n    case 'slides':\r\n      if (threshold.minViewedCount) {\r\n        const viewedCount = progress.imagesViewed?.length || 0;\r\n        if (viewedCount < threshold.minViewedCount) {\r\n          return {\r\n            completed: false,\r\n            reason: `C·∫ßn xem t·ªëi thi·ªÉu ${threshold.minViewedCount} ·∫£nh/slide`\r\n          };\r\n        }\r\n\r\n        // Check min view time per image\r\n        if (threshold.minViewTime && progress.imageViewTimes) {\r\n          const validImages = Object.values(progress.imageViewTimes).filter(\r\n            time => time >= (threshold.minViewTime || 0)\r\n          ).length;\r\n          \r\n          if (validImages < threshold.minViewedCount) {\r\n            return {\r\n              completed: false,\r\n              reason: `C·∫ßn xem m·ªói ·∫£nh √≠t nh·∫•t ${threshold.minViewTime}s`\r\n            };\r\n          }\r\n        }\r\n      }\r\n      return { completed: true };\r\n\r\n    case 'link':\r\n      if (threshold.requireConfirm && !progress.confirmed) {\r\n        return {\r\n          completed: false,\r\n          reason: 'C·∫ßn x√°c nh·∫≠n ƒë√£ ƒë·ªçc'\r\n        };\r\n      }\r\n\r\n      if (threshold.miniCheck) {\r\n        const passingScore = threshold.miniCheck.passingScore;\r\n        if (!progress.miniCheckScore || progress.miniCheckScore < passingScore) {\r\n          return {\r\n            completed: false,\r\n            reason: `C·∫ßn ƒë·∫°t t·ªëi thi·ªÉu ${passingScore} ƒëi·ªÉm mini-check`\r\n          };\r\n        }\r\n      }\r\n      return { completed: true };\r\n\r\n    default:\r\n      return { completed: false, reason: 'Unknown resource type' };\r\n  }\r\n};\r\n\r\n/**\r\n * Ki·ªÉm tra gating - user c√≥ th·ªÉ b·∫Øt ƒë·∫ßu quiz kh√¥ng\r\n */\r\nexport const checkGatingStatus = async (\r\n  userId: string,\r\n  quizId: string,\r\n  resources: LearningResource[]\r\n): Promise<{\r\n  ready: boolean;\r\n  requiredCount: number;\r\n  completedCount: number;\r\n  missingResources: LearningResource[];\r\n  warnings: string[];\r\n}> => {\r\n  try {\r\n    const session = await getLearningSession(userId, quizId);\r\n    \r\n    if (!session) {\r\n      // Ch∆∞a c√≥ session ‚Üí init\r\n      await initializeLearningSession(userId, quizId, resources);\r\n      const requiredResources = resources.filter(r => r.required);\r\n      return {\r\n        ready: requiredResources.length === 0,\r\n        requiredCount: requiredResources.length,\r\n        completedCount: 0,\r\n        missingResources: requiredResources,\r\n        warnings: requiredResources.length > 0 \r\n          ? ['B·∫°n ch∆∞a xem t√†i li·ªáu b·∫Øt bu·ªôc']\r\n          : []\r\n      };\r\n    }\r\n\r\n    const requiredResources = resources.filter(r => r.required);\r\n    const missingResources: LearningResource[] = [];\r\n    const warnings: string[] = [];\r\n\r\n    for (const resource of requiredResources) {\r\n      const progress = session.viewedResources[resource.id];\r\n      \r\n      if (!progress) {\r\n        missingResources.push(resource);\r\n        warnings.push(`Ch∆∞a xem: ${resource.title}`);\r\n        continue;\r\n      }\r\n\r\n      const validation = validateResourceCompletion(resource, progress);\r\n      if (!validation.completed) {\r\n        missingResources.push(resource);\r\n        warnings.push(`${resource.title}: ${validation.reason}`);\r\n      }\r\n    }\r\n\r\n    const completedCount = requiredResources.length - missingResources.length;\r\n    const ready = missingResources.length === 0;\r\n\r\n    // Update session ready status\r\n    if (ready && !session.ready) {\r\n      const sessionRef = doc(db, 'userQuizSessions', `${quizId}_${userId}`);\r\n      await updateDoc(sessionRef, {\r\n        ready: true,\r\n        readyAt: serverTimestamp(),\r\n        completedResourcesRequired: completedCount,\r\n        completionPercent: 100,\r\n        updatedAt: serverTimestamp()\r\n      });\r\n    } else {\r\n      const completionPercent = requiredResources.length > 0\r\n        ? Math.round((completedCount / requiredResources.length) * 100)\r\n        : 100;\r\n        \r\n      const sessionRef = doc(db, 'userQuizSessions', `${quizId}_${userId}`);\r\n      await updateDoc(sessionRef, {\r\n        ready,\r\n        completedResourcesRequired: completedCount,\r\n        completionPercent,\r\n        updatedAt: serverTimestamp()\r\n      });\r\n    }\r\n\r\n    return {\r\n      ready,\r\n      requiredCount: requiredResources.length,\r\n      completedCount,\r\n      missingResources,\r\n      warnings\r\n    };\r\n  } catch (error) {\r\n    console.error('Error checking gating status:', error);\r\n    return {\r\n      ready: false,\r\n      requiredCount: 0,\r\n      completedCount: 0,\r\n      missingResources: [],\r\n      warnings: ['C√≥ l·ªói ki·ªÉm tra tr·∫°ng th√°i']\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Log learning event\r\n */\r\nexport const logLearningEvent = async (event: Omit<LearningEvent, 'id' | 'timestamp'>): Promise<void> => {\r\n  try {\r\n    const eventsRef = collection(db, 'learningEvents');\r\n    await setDoc(doc(eventsRef), {\r\n      ...event,\r\n      timestamp: serverTimestamp()\r\n    });\r\n  } catch (error) {\r\n    console.error('Error logging learning event:', error);\r\n  }\r\n};\r\n\r\n/**\r\n * T√≠nh to√°n completion percentage cho progress bar\r\n */\r\nexport const calculateProgress = (\r\n  resources: LearningResource[],\r\n  viewedResources: Record<string, ResourceViewProgress>\r\n): {\r\n  totalRequired: number;\r\n  completedRequired: number;\r\n  totalRecommended: number;\r\n  completedRecommended: number;\r\n  overallPercent: number;\r\n} => {\r\n  const required = resources.filter(r => r.required);\r\n  const recommended = resources.filter(r => !r.required);\r\n\r\n  const completedRequired = required.filter(r => {\r\n    const progress = viewedResources[r.id];\r\n    if (!progress) return false;\r\n    return validateResourceCompletion(r, progress).completed;\r\n  }).length;\r\n\r\n  const completedRecommended = recommended.filter(r => {\r\n    const progress = viewedResources[r.id];\r\n    if (!progress) return false;\r\n    return validateResourceCompletion(r, progress).completed;\r\n  }).length;\r\n\r\n  const totalResources = resources.length;\r\n  const completedTotal = completedRequired + completedRecommended;\r\n  const overallPercent = totalResources > 0 \r\n    ? Math.round((completedTotal / totalResources) * 100)\r\n    : 0;\r\n\r\n  return {\r\n    totalRequired: required.length,\r\n    completedRequired,\r\n    totalRecommended: recommended.length,\r\n    completedRecommended,\r\n    overallPercent\r\n  };\r\n};\r\n\r\nexport default {\r\n  getLearningSession,\r\n  initializeLearningSession,\r\n  updateResourceProgress,\r\n  validateResourceCompletion,\r\n  checkGatingStatus,\r\n  logLearningEvent,\r\n  calculateProgress\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\quiz.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[318,321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[318,321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[324,327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[324,327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1403,1406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1403,1406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2312,2315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2312,2315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2373,2376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2373,2376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { collection, getDocs, doc, getDoc, query, where, limit } from 'firebase/firestore';\r\nimport { db } from '../../../lib/firebase/config';\r\nimport { Quiz } from '../types';\r\nimport { QUIZZES_COLLECTION } from '../constants';\r\n\r\n// Helper function to convert Firestore Timestamps\r\nconst convertTimestamps = (data: any): any => {\r\n  if (!data || typeof data !== 'object') {\r\n    return data;\r\n  }\r\n\r\n  // Handle arrays\r\n  if (Array.isArray(data)) {\r\n    return data.map(item => convertTimestamps(item));\r\n  }\r\n\r\n  const converted = { ...data };\r\n  \r\n  // Convert all fields recursively\r\n  Object.keys(converted).forEach(key => {\r\n    const value = converted[key];\r\n    \r\n    if (value && typeof value === 'object') {\r\n      // Check if it's a Firestore Timestamp\r\n      if (value.toDate && typeof value.toDate === 'function') {\r\n        // Firestore Timestamp\r\n        converted[key] = value.toDate().toISOString();\r\n      } else if (value instanceof Date) {\r\n        // JavaScript Date\r\n        converted[key] = value.toISOString();\r\n      } else if (Array.isArray(value)) {\r\n        // Recursively handle arrays\r\n        converted[key] = value.map(item => convertTimestamps(item));\r\n      } else {\r\n        // Recursively handle nested objects\r\n        converted[key] = convertTimestamps(value);\r\n      }\r\n    }\r\n  });\r\n  \r\n  return converted;\r\n};\r\n\r\nexport const getQuizzes = async (\r\n  filters?: any,\r\n  pageSize?: number\r\n) => {\r\n  try {\r\n    let q = query(\r\n      collection(db, QUIZZES_COLLECTION),\r\n      where('status', '==', 'approved'), // CH·ªà L·∫§Y QUIZ ƒê√É DUY·ªÜT\r\n      limit(pageSize || 10)\r\n    );\r\n\r\n    if (filters) {\r\n      if (filters.category) {\r\n        q = query(q, where('category', '==', filters.category));\r\n      }\r\n      if (filters.difficulty) {\r\n        q = query(q, where('difficulty', '==', filters.difficulty));\r\n      }\r\n    }\r\n\r\n    const snapshot = await getDocs(q);\r\n    const quizzes = snapshot.docs.map(doc => ({\r\n      id: doc.id,\r\n      ...convertTimestamps(doc.data())\r\n    })) as Quiz[];\r\n\r\n    return {\r\n      quizzes,\r\n      lastDoc: snapshot.docs[snapshot.docs.length - 1]\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching quizzes:', error);\r\n    if (error instanceof Error) {\r\n      console.error('Error message:', error.message);\r\n      if ((error as any).code) {\r\n        console.error('Error code:', (error as any).code);\r\n      }\r\n    } else {\r\n      console.error('Unknown error:', error);\r\n    }\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getQuizById = async (id: string): Promise<Quiz> => {\r\n  try {\r\n    const docRef = doc(db, QUIZZES_COLLECTION, id);\r\n    const docSnap = await getDoc(docRef);\r\n    \r\n    if (!docSnap.exists()) {\r\n      throw new Error('Quiz not found');\r\n    }\r\n    \r\n    const data = docSnap.data();\r\n    const convertedData = convertTimestamps(data);\r\n    \r\n    return {\r\n      id: docSnap.id,\r\n      ...convertedData\r\n    } as Quiz;\r\n  } catch (error) {\r\n    console.error('Error fetching quiz:', error);\r\n    throw error;\r\n  }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\quizService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[661,664],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[661,664],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  DocumentSnapshot,\r\n} from 'firebase/firestore';\r\nimport { Quiz, QuizFilters } from '../types';\r\n\r\n// Import role-based quiz services\r\nimport { getAdminQuizzes, getUserQuizzesAdmin } from '../api/admin';\r\nimport { getCreatorQuizzes, getCreatorOwnQuizzes } from '../api/creator';\r\nimport { getUserQuizzes as getUserRoleQuizzes, getAnonymousQuizzes } from '../api/user';\r\n\r\n// Export all base functions\r\nexport * from '../api/base';\r\nexport * from '../api/shared';\r\n\r\n/**\r\n * Main function to get quizzes based on user role\r\n */\r\nexport const getQuizzes = async (\r\n  filters?: QuizFilters, \r\n  pageSize = 20, \r\n  lastDoc?: DocumentSnapshot, \r\n  user?: any\r\n): Promise<{\r\n  quizzes: Quiz[];\r\n  lastDoc: DocumentSnapshot | null;\r\n  hasMore: boolean;\r\n}> => {\r\n  try {\r\n    console.log('üîç [MAIN] getQuizzes called with user:', {\r\n      uid: user?.uid,\r\n      role: user?.role,\r\n      email: user?.email\r\n    });\r\n\r\n    if (!user) {\r\n      // Anonymous user\r\n      console.log('ÔøΩ [MAIN] Routing to anonymous quiz service');\r\n      return await getAnonymousQuizzes(filters, pageSize, lastDoc);\r\n    }\r\n\r\n    switch (user.role) {\r\n      case 'admin':\r\n        console.log('üîç [MAIN] Routing to admin quiz service');\r\n        return await getAdminQuizzes(filters, pageSize, lastDoc);\r\n        \r\n      case 'creator':\r\n        console.log('üîç [MAIN] Routing to creator quiz service');\r\n        return await getCreatorQuizzes(user.uid, filters, pageSize, lastDoc);\r\n        \r\n      case 'user':\r\n      default:\r\n        console.log('üîç [MAIN] Routing to user quiz service');\r\n        return await getUserRoleQuizzes(filters, pageSize, lastDoc);\r\n    }\r\n  } catch (error) {\r\n    console.error('‚ùå [MAIN] Error in getQuizzes:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get quizzes created by a specific user (role-aware)\r\n */\r\nexport const getUserQuizzes = async (userId: string, userRole?: string): Promise<Quiz[]> => {\r\n  try {\r\n    if (userRole === 'admin') {\r\n      return await getUserQuizzesAdmin(userId);\r\n    } else {\r\n      return await getCreatorOwnQuizzes(userId);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching user quizzes:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport { \r\n  getQuizById, \r\n  createQuiz, \r\n  updateQuiz, \r\n  deleteQuiz, \r\n  getQuizResults, \r\n  getQuizResultById \r\n} from '../api/base';\r\nexport { \r\n  getQuizCategories, \r\n  getPopularQuizzes, \r\n  searchQuizzes, \r\n  applyQuizFilters, \r\n  getUserQuizResults \r\n} from '../api/shared';\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\realDataService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\reviewService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\services\\simpleAIService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\store.ts","messages":[{"ruleId":"@typescript-eslint/ban-types","severity":1,"message":"Don't use `{}` as a type. `{}` actually means \"any non-nullish value\".\n- If you want a type meaning \"any object\", you probably want `object` instead.\n- If you want a type meaning \"any value\", you probably want `unknown` instead.\n- If you want a type meaning \"empty object\", you probably want `Record<string, never>` instead.\n- If you really want a type meaning \"any non-nullish value\", you probably want `NonNullable<unknown>` instead.","line":9,"column":13,"nodeType":"TSTypeLiteral","messageId":"bannedTypeMessage","endLine":9,"endColumn":15,"suggestions":[{"messageId":"bannedTypeReplacement","data":{"name":"{}","replacement":"object"},"fix":{"range":[343,345],"text":"object"},"desc":"Replace `{}` with `object`."},{"messageId":"bannedTypeReplacement","data":{"name":"{}","replacement":"unknown"},"fix":{"range":[343,345],"text":"unknown"},"desc":"Replace `{}` with `unknown`."},{"messageId":"bannedTypeReplacement","data":{"name":"{}","replacement":"Record<string, never>"},"fix":{"range":[343,345],"text":"Record<string, never>"},"desc":"Replace `{}` with `Record<string, never>`."},{"messageId":"bannedTypeReplacement","data":{"name":"{}","replacement":"NonNullable<unknown>"},"fix":{"range":[343,345],"text":"NonNullable<unknown>"},"desc":"Replace `{}` with `NonNullable<unknown>`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[509,512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[509,512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createSlice, PayloadAction, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport { Quiz, QuizResult, QuizFilters } from './types';\r\nimport * as quizService from './services/quiz';\r\nimport { getUserQuizResults } from './api/shared';\r\n\r\n// Async thunks\r\nexport const fetchQuizzes = createAsyncThunk(\r\n  'quiz/fetchQuizzes',\r\n  async (_: {}, { rejectWithValue }) => {\r\n    try {\r\n      const result = await quizService.getQuizzes(undefined, undefined);\r\n      return result.quizzes;\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch quizzes:', error);\r\n      \r\n      if (error.type === 'CONNECTION_ERROR') {\r\n        return rejectWithValue('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi m·∫°ng c·ªßa b·∫°n.');\r\n      }\r\n      \r\n      if (error.type === 'TIMEOUT_ERROR') {\r\n        return rejectWithValue('Server kh√¥ng ph·∫£n h·ªìi. Vui l√≤ng th·ª≠ l·∫°i sau.');\r\n      }\r\n      \r\n      return rejectWithValue('ƒê√£ c√≥ l·ªói x·∫£y ra khi t·∫£i danh s√°ch quiz. Vui l√≤ng th·ª≠ l·∫°i.');\r\n    }\r\n  }\r\n);\r\n\r\nexport const fetchQuizById = createAsyncThunk(\r\n  'quiz/fetchQuizById',\r\n  async (quizId: string) => {\r\n    const quiz = await quizService.getQuizById(quizId);\r\n    return quiz;\r\n  }\r\n);\r\n\r\nexport const fetchUserQuizResults = createAsyncThunk(\r\n  'quiz/fetchUserQuizResults',\r\n  async (userId: string) => {\r\n    const results = await getUserQuizResults(userId);\r\n    return results;\r\n  }\r\n);\r\n\r\n// Th√™m isTimeWarning v√† totalTime v√†o QuizState\r\ninterface QuizState {\r\n  quizzes: Quiz[];\r\n  currentQuiz: Quiz | null;\r\n  userResults: QuizResult[];\r\n  loading: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  connectionError: boolean;\r\n  filters: QuizFilters;\r\n  currentQuestionIndex: number;\r\n  userAnswers: Record<string, string>;\r\n  timeLeft: number;\r\n  quizStartTime: number | null;\r\n  retryCount: number;\r\n  lastError: string | null;\r\n  isTimeWarning: boolean;\r\n  totalTime: number;\r\n}\r\n\r\nconst initialState: QuizState = {\r\n  quizzes: [],\r\n  currentQuiz: null,\r\n  userResults: [],\r\n  loading: false,\r\n  isLoading: false,\r\n  error: null,\r\n  connectionError: false,\r\n  filters: {\r\n    category: 'all',\r\n    difficulty: undefined,\r\n    searchTerm: '',\r\n  },\r\n  currentQuestionIndex: 0,\r\n  userAnswers: {},\r\n  timeLeft: 0,\r\n  quizStartTime: null,\r\n  retryCount: 0,\r\n  lastError: null,\r\n  isTimeWarning: false,\r\n  totalTime: 0,\r\n};\r\n\r\n// Fixed Redux store configuration - v2\r\nconst quizSlice = createSlice({\r\n  name: 'quiz',\r\n  initialState,\r\n  reducers: {\r\n    // Quiz loading states\r\n    setLoading: (state, action: PayloadAction<boolean>) => {\r\n      state.isLoading = action.payload;\r\n    },\r\n    setError: (state, action: PayloadAction<string | null>) => {\r\n      state.error = action.payload;\r\n    },\r\n    \r\n    // Quiz data management\r\n    setQuizzes: (state, action: PayloadAction<Quiz[]>) => {\r\n      state.quizzes = action.payload;\r\n    },\r\n    addQuiz: (state, action: PayloadAction<Quiz>) => {\r\n      state.quizzes.unshift(action.payload);\r\n    },\r\n    updateQuiz: (state, action: PayloadAction<Quiz>) => {\r\n      const index = state.quizzes.findIndex(q => q.id === action.payload.id);\r\n      if (index !== -1) {\r\n        state.quizzes[index] = action.payload;\r\n      }\r\n    },\r\n    removeQuiz: (state, action: PayloadAction<string>) => {\r\n      state.quizzes = state.quizzes.filter(q => q.id !== action.payload);\r\n    },\r\n    \r\n    // Current quiz management\r\n    setCurrentQuiz: (state, action: PayloadAction<Quiz | null>) => {\r\n      state.currentQuiz = action.payload;\r\n      if (action.payload) {\r\n        state.currentQuestionIndex = 0;\r\n        state.userAnswers = {};\r\n        state.totalTime = action.payload.duration * 60; // T·ªïng th·ªùi gian (gi√¢y)\r\n        state.timeLeft = state.totalTime;\r\n        state.quizStartTime = Date.now();\r\n        state.isTimeWarning = false;\r\n      } else {\r\n        state.currentQuestionIndex = 0;\r\n        state.userAnswers = {};\r\n        state.timeLeft = 0;\r\n        state.quizStartTime = null;\r\n        state.totalTime = 0;\r\n        state.isTimeWarning = false;\r\n      }\r\n    },\r\n\r\n    // C·∫≠p nh·∫≠t timeLeft d·ª±a tr√™n th·ªùi gian th·ª±c t·∫ø ƒë√£ tr√¥i qua\r\n    updateTimeLeft: (state) => {\r\n      if (state.quizStartTime && state.totalTime > 0) {\r\n        const elapsed = Math.floor((Date.now() - state.quizStartTime) / 1000);\r\n        const newTimeLeft = Math.max(state.totalTime - elapsed, 0);\r\n        state.timeLeft = newTimeLeft;\r\n        // C·∫£nh b√°o khi c√≤n <= 10% t·ªïng th·ªùi gian\r\n        state.isTimeWarning = newTimeLeft <= Math.ceil(state.totalTime * 0.1);\r\n      }\r\n    },\r\n\r\n    // Gi·ªØ decrementTime cho tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát\r\n    decrementTime: (state) => {\r\n      if (state.timeLeft > 0) {\r\n        state.timeLeft -= 1;\r\n        // C·∫£nh b√°o khi c√≤n <= 10% t·ªïng th·ªùi gian\r\n        state.isTimeWarning = state.timeLeft <= Math.ceil(state.totalTime * 0.1);\r\n      }\r\n    },\r\n    \r\n    // Answer management\r\n    setUserAnswer: (state, action: PayloadAction<{ questionId: string; answerId: string }>) => {\r\n      state.userAnswers[action.payload.questionId] = action.payload.answerId;\r\n    },\r\n    clearUserAnswers: (state) => {\r\n      state.userAnswers = {};\r\n    },\r\n    \r\n    // Timer management\r\n    setTimeLeft: (state, action: PayloadAction<number>) => {\r\n      state.timeLeft = action.payload;\r\n    },\r\n    \r\n    // Results management\r\n    setUserResults: (state, action: PayloadAction<QuizResult[]>) => {\r\n      state.userResults = action.payload;\r\n    },\r\n    addUserResult: (state, action: PayloadAction<QuizResult>) => {\r\n      state.userResults.unshift(action.payload);\r\n    },\r\n    \r\n    // Filters\r\n    setFilters: (state, action: PayloadAction<QuizFilters>) => {\r\n      state.filters = action.payload;\r\n    },\r\n    updateFilter: (state, action: PayloadAction<Partial<QuizFilters>>) => {\r\n      state.filters = { ...state.filters, ...action.payload };\r\n    },\r\n    clearFilters: (state) => {\r\n      state.filters = {};\r\n    },\r\n    \r\n    // Reset quiz state\r\n    resetQuizState: (state) => {\r\n      state.currentQuiz = null;\r\n      state.currentQuestionIndex = 0;\r\n      state.userAnswers = {};\r\n      state.timeLeft = 0;\r\n      state.quizStartTime = null;\r\n      state.totalTime = 0;\r\n      state.isTimeWarning = false;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(fetchQuizzes.pending, (state) => {\r\n        state.loading = true;\r\n        state.isLoading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchQuizzes.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.isLoading = false;\r\n        // Now action.payload is just the quizzes array\r\n        state.quizzes = action.payload;\r\n      })\r\n      .addCase(fetchQuizzes.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.isLoading = false;\r\n        state.error = action.error.message || 'L·ªói khi t·∫£i quiz';\r\n      })\r\n      // Handle single quiz fetch\r\n      .addCase(fetchQuizById.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchQuizById.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        if (action.payload) {\r\n          state.currentQuiz = action.payload;\r\n          // Also add to quizzes array if not exists\r\n          const exists = state.quizzes.find(q => q.id === action.payload!.id);\r\n          if (!exists) {\r\n            state.quizzes.push(action.payload);\r\n          }\r\n        }\r\n      })\r\n      .addCase(fetchQuizById.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.error.message || 'L·ªói khi t·∫£i quiz';\r\n      })\r\n      .addCase(fetchUserQuizResults.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(fetchUserQuizResults.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.userResults = action.payload;\r\n      })\r\n      .addCase(fetchUserQuizResults.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.error.message || 'L·ªói khi t·∫£i k·∫øt qu·∫£ quiz';\r\n      });\r\n  },\r\n});\r\n\r\nexport const {\r\n  setQuizzes,\r\n  setCurrentQuiz,\r\n  decrementTime,\r\n  updateTimeLeft,\r\n  resetQuizState,\r\n  addUserResult,\r\n  setFilters,\r\n  updateFilter,\r\n  clearFilters,\r\n  setUserResults,\r\n  setUserAnswer,\r\n  clearUserAnswers,\r\n  setTimeLeft,\r\n  setLoading,\r\n  setError,\r\n  addQuiz,\r\n  updateQuiz,\r\n  removeQuiz,\r\n} = quizSlice.actions;\r\n\r\nexport default quizSlice.reducer;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\types\\learning.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":218,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5400,5403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5400,5403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":268,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6494,6497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6494,6497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Learning Materials System Types\r\n * H·ªó tr·ª£ xem t√†i li·ªáu tr∆∞·ªõc khi l√†m b√†i tr·∫Øc nghi·ªám\r\n */\r\n\r\n/**\r\n * Lo·∫°i t√†i li·ªáu h·ªçc t·∫≠p\r\n */\r\nexport type ResourceType = 'video' | 'pdf' | 'image' | 'audio' | 'link' | 'slides';\r\n\r\n/**\r\n * Learning Outcome - M·ª•c ti√™u h·ªçc t·∫≠p\r\n */\r\nexport interface LearningOutcome {\r\n  id: string;\r\n  code: string; // LO1, LO2, LO3...\r\n  title: string;\r\n  description: string;\r\n}\r\n\r\n/**\r\n * Ng∆∞·ª°ng ho√†n th√†nh cho t·ª´ng lo·∫°i t√†i li·ªáu\r\n */\r\nexport interface ResourceThreshold {\r\n  // Video thresholds\r\n  minWatchSec?: number; // T·ªëi thi·ªÉu X gi√¢y\r\n  minWatchPercent?: number; // T·ªëi thi·ªÉu X% video (0-100)\r\n  \r\n  // PDF thresholds\r\n  minPages?: number; // T·ªëi thi·ªÉu X trang\r\n  mustReachLastPage?: boolean; // Ph·∫£i ƒë·ªçc ƒë·∫øn trang cu·ªëi\r\n  minTimePerPage?: number; // T·ªëi thi·ªÉu X gi√¢y/trang (default: 1.5s)\r\n  \r\n  // Image/Slides thresholds\r\n  minViewedCount?: number; // T·ªëi thi·ªÉu X ·∫£nh/slide\r\n  minViewTime?: number; // T·ªëi thi·ªÉu X gi√¢y xem m·ªói ·∫£nh\r\n  \r\n  // Link thresholds\r\n  requireConfirm?: boolean; // Y√™u c·∫ßu tick \"ƒë√£ ƒë·ªçc\"\r\n  miniCheck?: MiniCheck; // C√¢u h·ªèi ki·ªÉm tra nhanh\r\n}\r\n\r\n/**\r\n * C√¢u h·ªèi ki·ªÉm tra nhanh cho external links\r\n */\r\nexport interface MiniCheck {\r\n  questions: MiniCheckQuestion[];\r\n  passingScore: number; // ƒêi·ªÉm t·ªëi thi·ªÉu ƒë·ªÉ pass (v√≠ d·ª•: 1/1, 2/3)\r\n}\r\n\r\nexport interface MiniCheckQuestion {\r\n  id: string;\r\n  question: string;\r\n  options: string[];\r\n  correctAnswer: number; // Index c·ªßa ƒë√°p √°n ƒë√∫ng\r\n}\r\n\r\n/**\r\n * T√†i li·ªáu h·ªçc t·∫≠p\r\n */\r\nexport interface LearningResource {\r\n  id: string;\r\n  type: ResourceType;\r\n  title: string;\r\n  description?: string;\r\n  url: string;\r\n  \r\n  // C·∫•u h√¨nh\r\n  required: boolean; // B·∫Øt bu·ªôc ph·∫£i xem\r\n  threshold: ResourceThreshold;\r\n  learningOutcomes: string[]; // LO IDs li√™n quan\r\n  \r\n  // Metadata\r\n  duration?: number; // Video duration (seconds)\r\n  totalPages?: number; // PDF total pages\r\n  totalSlides?: number; // Slide count\r\n  estimatedTime?: number; // Th·ªùi gian ∆∞·ªõc t√≠nh (ph√∫t)\r\n  \r\n  // Display\r\n  order: number; // Th·ª© t·ª± hi·ªÉn th·ªã\r\n  thumbnailUrl?: string;\r\n  whyWatch?: string; // \"V√¨ sao xem ph·∫ßn n√†y?\" - g·ª£i √Ω cho learner\r\n  \r\n  // Timestamps\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\n/**\r\n * Ti·∫øn ƒë·ªô xem t√†i li·ªáu c·ªßa c√° nh√¢n\r\n */\r\nexport interface ResourceViewProgress {\r\n  resourceId: string;\r\n  \r\n  // Completion status\r\n  completed: boolean;\r\n  completedAt?: Date;\r\n  \r\n  // Video tracking\r\n  secondsWatched?: number;\r\n  watchPercent?: number; // 0-100\r\n  lastWatchPosition?: number; // Last video position (seconds)\r\n  playbackSpeeds?: number[]; // T·ªëc ƒë·ªô ph√°t (ƒë·ªÉ detect >2x)\r\n  \r\n  // PDF tracking\r\n  pagesViewed?: number[]; // Array of page numbers viewed\r\n  pageViewTimes?: Record<number, number>; // Page number ‚Üí time spent (seconds)\r\n  \r\n  // Image/Slides tracking\r\n  imagesViewed?: number[]; // Array of image indices viewed\r\n  imageViewTimes?: Record<number, number>; // Image index ‚Üí time spent\r\n  \r\n  // Link tracking\r\n  confirmed?: boolean; // ƒê√£ tick \"ƒë√£ ƒë·ªçc\"\r\n  miniCheckScore?: number; // ƒêi·ªÉm mini-check (0-100)\r\n  miniCheckAnswers?: number[]; // User answers\r\n  \r\n  // Anti-cheating\r\n  tabFocusTime?: number; // T·ªïng th·ªùi gian tab ·ªü foreground\r\n  totalTime?: number; // T·ªïng th·ªùi gian (bao g·ªìm background)\r\n  suspiciousActivity?: string[]; // Log c√°c h√†nh vi ƒë√°ng ng·ªù\r\n  \r\n  // Timestamps\r\n  startedAt: Date;\r\n  lastActivityAt: Date;\r\n}\r\n\r\n/**\r\n * Session h·ªçc t·∫≠p c·ªßa user cho m·ªôt quiz\r\n */\r\nexport interface LearningSession {\r\n  id: string;\r\n  userId: string;\r\n  quizId: string;\r\n  \r\n  // Progress\r\n  viewedResources: Record<string, ResourceViewProgress>; // resourceId ‚Üí progress\r\n  \r\n  // Gating status\r\n  ready: boolean; // ƒê·ªß ƒëi·ªÅu ki·ªán b·∫Øt ƒë·∫ßu quiz\r\n  readyAt?: Date;\r\n  \r\n  // Stats\r\n  totalResourcesRequired: number;\r\n  completedResourcesRequired: number;\r\n  completionPercent: number; // 0-100\r\n  \r\n  // Timestamps\r\n  startedAt: Date;\r\n  lastActivityAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\n/**\r\n * K·∫øt qu·∫£ ph√¢n t√≠ch sau khi l√†m b√†i\r\n */\r\nexport interface LearningAnalytics {\r\n  userId: string;\r\n  quizId: string;\r\n  \r\n  // Correlation gi·ªØa xem t√†i li·ªáu v√† ƒëi·ªÉm\r\n  watchedAllRequired: boolean;\r\n  watchedAllRecommended: boolean;\r\n  quizScore: number;\r\n  \r\n  // LO Performance\r\n  loPerformance: Record<string, {\r\n    loId: string;\r\n    correct: number;\r\n    total: number;\r\n    percentage: number;\r\n    relatedResources: string[]; // Resource IDs\r\n  }>;\r\n  \r\n  // Recommendations\r\n  recommendedReview: string[]; // Resource IDs n√™n xem l·∫°i\r\n  \r\n  // Timestamps\r\n  completedAt: Date;\r\n}\r\n\r\n/**\r\n * Instructor Analytics - Dashboard cho gi·∫£ng vi√™n\r\n */\r\nexport interface InstructorAnalytics {\r\n  quizId: string;\r\n  \r\n  // Resource completion stats\r\n  resourceStats: Record<string, {\r\n    resourceId: string;\r\n    totalViews: number;\r\n    completionRate: number; // %\r\n    avgTimeSpent: number; // seconds\r\n    avgScore?: number; // Score c·ªßa users ƒë√£ xem resource n√†y\r\n  }>;\r\n  \r\n  // LO correlation\r\n  loCorrelation: Record<string, {\r\n    loId: string;\r\n    relatedResources: string[];\r\n    avgScoreWithResources: number;\r\n    avgScoreWithoutResources: number;\r\n    improvement: number; // % improvement\r\n  }>;\r\n  \r\n  // Heatmap data\r\n  heatmap: {\r\n    resourceId: string;\r\n    loId: string;\r\n    errorReduction: number; // % gi·∫£m t·ª∑ l·ªá sai\r\n  }[];\r\n  \r\n  // A/B Testing results\r\n  abTests?: {\r\n    testId: string;\r\n    variants: {\r\n      variant: string;\r\n      threshold: any;\r\n      avgScore: number;\r\n      completionRate: number;\r\n    }[];\r\n  }[];\r\n  \r\n  updatedAt: Date;\r\n}\r\n\r\n/**\r\n * Config cho gating behavior\r\n */\r\nexport interface GatingConfig {\r\n  mode: 'strict' | 'soft' | 'none';\r\n  // strict: Kh√¥ng th·ªÉ v√†o b√†i n·∫øu ch∆∞a ƒë·∫°t required\r\n  // soft: C√≥ th·ªÉ v√†o nh∆∞ng c√≥ c·∫£nh b√°o + ƒëi·ªÉm tr·ª´ nh·ªè\r\n  // none: Ch·ªâ khuy·∫øn ngh·ªã, kh√¥ng √©p bu·ªôc\r\n  \r\n  softPenalty?: number; // ƒêi·ªÉm tr·ª´ n·∫øu v√†o m√† ch∆∞a ƒë·∫°t (soft mode)\r\n  showWarning?: boolean; // Hi·ªÉn th·ªã c·∫£nh b√°o\r\n  warningMessage?: string;\r\n}\r\n\r\n/**\r\n * Event tracking cho analytics\r\n */\r\nexport interface LearningEvent {\r\n  id: string;\r\n  userId: string;\r\n  quizId: string;\r\n  resourceId: string;\r\n  \r\n  eventType: \r\n    | 'resource_started'\r\n    | 'resource_viewed'\r\n    | 'resource_completed'\r\n    | 'video_play'\r\n    | 'video_pause'\r\n    | 'video_seek'\r\n    | 'video_speed_change'\r\n    | 'pdf_page_view'\r\n    | 'pdf_scroll'\r\n    | 'image_view'\r\n    | 'link_visit'\r\n    | 'link_confirm'\r\n    | 'mini_check_attempt'\r\n    | 'mini_check_pass'\r\n    | 'tab_blur'\r\n    | 'tab_focus';\r\n  \r\n  metadata?: Record<string, any>;\r\n  timestamp: Date;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\types\\quiz.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[100,103],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[100,103],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[147,150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[147,150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Quiz type stub for build\r\nexport interface Quiz {\r\n  id: string;\r\n  title: string;\r\n  questions: any[];\r\n  duration?: number;\r\n  [key: string]: any;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\features\\quiz\\types\\review.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\firebase\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\locales\\resources.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\fileProcessor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\collections.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\dataModels.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":335,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":335,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7210,7213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7210,7213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":382,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":382,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8157,8160],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8157,8160],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":385,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":385,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8294,8297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8294,8297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":388,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":388,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8436,8439],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8436,8439],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * üìä Firestore Data Models\r\n * Type-safe data structures cho t·∫•t c·∫£ collections\r\n */\r\n\r\nimport { Timestamp } from 'firebase/firestore';\r\n\r\n// ============= USER MODELS =============\r\nexport interface UserProfile {\r\n  uid: string;\r\n  email: string;\r\n  displayName: string;\r\n  photoURL: string | null;\r\n  role: 'user' | 'admin' | 'creator';\r\n  emailVerified: boolean;\r\n  isActive: boolean;\r\n  createdAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n  lastLoginAt: Timestamp | null;\r\n  \r\n  // Preferences\r\n  preferences: {\r\n    language: string;\r\n    theme: 'light' | 'dark' | 'auto';\r\n    notifications: boolean;\r\n  };\r\n}\r\n\r\nexport interface UserStats {\r\n  userId: string;\r\n  quizzesCreated: number;\r\n  quizzesCompleted: number;\r\n  totalScore: number;\r\n  totalTimeSpent: number; // seconds\r\n  averageScore: number;\r\n  streak: number;\r\n  lastActivityAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n}\r\n\r\nexport interface UserQuizActivity {\r\n  userId: string;\r\n  quizId: string;\r\n  attempts: number;\r\n  bestScore: number;\r\n  lastAttemptAt: Timestamp;\r\n  totalTimeSpent: number;\r\n  completed: boolean;\r\n}\r\n\r\n// ============= QUIZ MODELS =============\r\nexport interface Quiz {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  duration: number; // minutes\r\n  \r\n  // Media\r\n  imageUrl: string | null; // ‚úÖ Storage URL\r\n  \r\n  // Content\r\n  questions: Question[];\r\n  resources: LearningResource[]; // üÜï\r\n  \r\n  // Metadata\r\n  tags: string[];\r\n  language: string;\r\n  \r\n  // Creator\r\n  createdBy: string; // User ID\r\n  creatorName: string; // Denormalized\r\n  creatorAvatar: string | null; // Denormalized\r\n  \r\n  // Status\r\n  status: 'draft' | 'pending' | 'approved' | 'rejected';\r\n  isPublished: boolean;\r\n  isPublic: boolean;\r\n  \r\n  // Settings\r\n  allowRetake: boolean;\r\n  showAnswers: boolean;\r\n  randomizeQuestions: boolean;\r\n  randomizeAnswers: boolean;\r\n  passingScore: number;\r\n  \r\n  // Stats\r\n  attempts: number;\r\n  completions: number;\r\n  averageScore: number;\r\n  totalPlayers: number;\r\n  rating: number;\r\n  reviewCount: number;\r\n  \r\n  // Timestamps\r\n  createdAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n  publishedAt: Timestamp | null;\r\n}\r\n\r\nexport interface Question {\r\n  id: string;\r\n  text: string;\r\n  type: 'multiple' | 'boolean' | 'text' | 'image';\r\n  imageUrl: string | null; // ‚úÖ Storage URL\r\n  \r\n  answers: Answer[];\r\n  correctAnswer: string | null;\r\n  acceptedAnswers: string[];\r\n  \r\n  explanation: string;\r\n  points: number;\r\n  timeLimit: number | null; // seconds\r\n  order: number;\r\n}\r\n\r\nexport interface Answer {\r\n  id: string;\r\n  text: string;\r\n  imageUrl: string | null; // ‚úÖ Storage URL\r\n  isCorrect: boolean;\r\n}\r\n\r\n// ============= LEARNING RESOURCE MODELS =============\r\nexport interface LearningResource {\r\n  id: string;\r\n  type: 'video' | 'pdf' | 'image' | 'audio' | 'link';\r\n  title: string;\r\n  description: string;\r\n  url: string; // ‚úÖ Storage URL or external URL\r\n  \r\n  // Metadata\r\n  duration: number | null; // seconds (for video/audio)\r\n  size: number | null; // bytes\r\n  mimeType: string | null;\r\n  thumbnailUrl: string | null;\r\n  \r\n  // Requirements\r\n  required: boolean;\r\n  threshold: ResourceThreshold;\r\n  estimatedTime: number; // minutes\r\n  \r\n  // Organization\r\n  order: number;\r\n  category: string | null;\r\n}\r\n\r\nexport interface ResourceThreshold {\r\n  type: 'percentage' | 'pages' | 'time';\r\n  value: number;\r\n  unit: string;\r\n}\r\n\r\n// ============= QUIZ RESULTS =============\r\nexport interface QuizResult {\r\n  id: string;\r\n  quizId: string;\r\n  quizTitle: string; // Denormalized\r\n  userId: string;\r\n  userName: string; // Denormalized\r\n  userAvatar: string | null; // Denormalized\r\n  \r\n  // Scores\r\n  score: number;\r\n  percentage: number;\r\n  totalQuestions: number;\r\n  correctAnswers: number;\r\n  wrongAnswers: number;\r\n  skippedAnswers: number;\r\n  \r\n  // Timing\r\n  timeSpent: number; // seconds\r\n  startedAt: Timestamp;\r\n  completedAt: Timestamp;\r\n  \r\n  // Details\r\n  answers: QuestionAnswer[];\r\n  \r\n  // Context\r\n  mode: 'normal' | 'multiplayer' | 'practice';\r\n  multiplayerRoomId: string | null;\r\n}\r\n\r\nexport interface QuestionAnswer {\r\n  questionId: string;\r\n  selectedAnswerId: string | null;\r\n  selectedAnswer: string | null; // For text answers\r\n  isCorrect: boolean;\r\n  points: number;\r\n  timeSpent: number; // seconds\r\n}\r\n\r\n// ============= REVIEW & RATING =============\r\nexport interface QuizReview {\r\n  id: string;\r\n  quizId: string;\r\n  userId: string;\r\n  userName: string; // Denormalized\r\n  userAvatar: string | null; // Denormalized\r\n  \r\n  rating: number; // 1-5\r\n  comment: string;\r\n  \r\n  // Moderation\r\n  isApproved: boolean;\r\n  isFlagged: boolean;\r\n  \r\n  // Engagement\r\n  helpfulCount: number;\r\n  reportCount: number;\r\n  \r\n  createdAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n}\r\n\r\n// ============= MULTIPLAYER MODELS =============\r\nexport interface MultiplayerRoom {\r\n  id: string;\r\n  code: string;\r\n  quizId: string;\r\n  quizTitle: string; // Denormalized\r\n  \r\n  // Host\r\n  hostId: string;\r\n  hostName: string; // Denormalized\r\n  \r\n  // Settings\r\n  maxPlayers: number;\r\n  isPrivate: boolean;\r\n  allowLateJoin: boolean;\r\n  \r\n  // Status\r\n  status: 'waiting' | 'playing' | 'finished';\r\n  currentQuestionIndex: number;\r\n  \r\n  // Stats\r\n  playerCount: number;\r\n  \r\n  // Timestamps\r\n  createdAt: Timestamp;\r\n  startedAt: Timestamp | null;\r\n  finishedAt: Timestamp | null;\r\n  expiresAt: Timestamp;\r\n}\r\n\r\nexport interface MultiplayerPlayer {\r\n  userId: string;\r\n  userName: string;\r\n  userAvatar: string | null;\r\n  \r\n  isReady: boolean;\r\n  isHost: boolean;\r\n  isOnline: boolean;\r\n  \r\n  score: number;\r\n  correctAnswers: number;\r\n  \r\n  joinedAt: Timestamp;\r\n  lastActivityAt: Timestamp;\r\n}\r\n\r\nexport interface MultiplayerMessage {\r\n  id: string;\r\n  userId: string;\r\n  userName: string;\r\n  userAvatar: string | null;\r\n  \r\n  type: 'chat' | 'system' | 'reaction';\r\n  content: string;\r\n  \r\n  createdAt: Timestamp;\r\n}\r\n\r\n// ============= LEARNING SESSION =============\r\nexport interface UserQuizSession {\r\n  id: string; // Format: `${quizId}_${userId}`\r\n  userId: string;\r\n  quizId: string;\r\n  \r\n  // Progress\r\n  viewedResources: Record<string, ResourceProgress>;\r\n  completionPercent: number;\r\n  ready: boolean; // Can start quiz\r\n  \r\n  // Timestamps\r\n  startedAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n  lastActivityAt: Timestamp;\r\n}\r\n\r\nexport interface ResourceProgress {\r\n  resourceId: string;\r\n  completed: boolean;\r\n  \r\n  // Video/Audio tracking\r\n  secondsWatched: number;\r\n  watchPercent: number;\r\n  playbackSpeed: number;\r\n  tabBlurred: boolean;\r\n  \r\n  // PDF tracking\r\n  pagesViewed: number[];\r\n  totalPages: number;\r\n  \r\n  // Image tracking\r\n  viewCount: number;\r\n  timeSpent: number;\r\n  \r\n  // Link tracking\r\n  visited: boolean;\r\n  confirmChecked: boolean;\r\n  miniCheckPassed: boolean;\r\n  \r\n  lastActivityAt: Timestamp;\r\n}\r\n\r\n// ============= ANALYTICS =============\r\nexport interface LearningEvent {\r\n  id: string;\r\n  userId: string;\r\n  quizId: string;\r\n  resourceId: string;\r\n  \r\n  eventType: \r\n    | 'video_play' \r\n    | 'video_pause' \r\n    | 'video_complete'\r\n    | 'pdf_page_view'\r\n    | 'pdf_complete'\r\n    | 'image_view'\r\n    | 'link_visit'\r\n    | 'resource_completed';\r\n  \r\n  metadata: Record<string, any>;\r\n  \r\n  timestamp: Timestamp;\r\n  sessionId: string;\r\n}\r\n\r\n// ============= SYSTEM =============\r\nexport interface SystemNotification {\r\n  id: string;\r\n  type: 'info' | 'warning' | 'error' | 'success';\r\n  title: string;\r\n  message: string;\r\n  \r\n  isActive: boolean;\r\n  priority: number;\r\n  \r\n  targetUsers: string[] | null; // null = all users\r\n  \r\n  createdBy: string;\r\n  createdAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n  expiresAt: Timestamp | null;\r\n}\r\n\r\nexport interface Category {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  iconUrl: string; // ‚úÖ Storage URL\r\n  color: string;\r\n  \r\n  quizCount: number;\r\n  order: number;\r\n  isActive: boolean;\r\n  \r\n  createdAt: Timestamp;\r\n  updatedAt: Timestamp;\r\n}\r\n\r\n// ============= FAVORITES =============\r\nexport interface UserFavorites {\r\n  userId: string;\r\n  quizIds: string[];\r\n  updatedAt: Timestamp;\r\n}\r\n\r\n// ============= TYPE GUARDS =============\r\nexport const isQuiz = (data: any): data is Quiz =>\r\n  data && typeof data.title === 'string' && Array.isArray(data.questions);\r\n\r\nexport const isUserProfile = (data: any): data is UserProfile =>\r\n  data && typeof data.uid === 'string' && typeof data.email === 'string';\r\n\r\nexport const isQuizResult = (data: any): data is QuizResult =>\r\n  data && typeof data.quizId === 'string' && typeof data.userId === 'string' && typeof data.score === 'number';\r\n\r\n// ============= DATA CLEANERS =============\r\n/**\r\n * Clean data before saving to Firestore\r\n * Removes undefined values and applies defaults\r\n */\r\nexport const cleanQuizData = (quiz: Partial<Quiz>): Partial<Quiz> => ({\r\n  ...quiz,\r\n  title: quiz.title || '',\r\n  description: quiz.description || '',\r\n  category: quiz.category || '',\r\n  difficulty: quiz.difficulty || 'medium',\r\n  duration: quiz.duration || 15,\r\n  imageUrl: quiz.imageUrl || null,\r\n  questions: quiz.questions || [],\r\n  resources: quiz.resources || [],\r\n  tags: quiz.tags || [],\r\n  language: quiz.language || 'vi',\r\n  status: quiz.status || 'draft',\r\n  isPublished: quiz.isPublished ?? false,\r\n  isPublic: quiz.isPublic ?? true,\r\n  allowRetake: quiz.allowRetake ?? true,\r\n  showAnswers: quiz.showAnswers ?? true,\r\n  randomizeQuestions: quiz.randomizeQuestions ?? false,\r\n  randomizeAnswers: quiz.randomizeAnswers ?? false,\r\n  passingScore: quiz.passingScore ?? 60,\r\n  attempts: quiz.attempts ?? 0,\r\n  completions: quiz.completions ?? 0,\r\n  averageScore: quiz.averageScore ?? 0,\r\n  totalPlayers: quiz.totalPlayers ?? 0,\r\n  rating: quiz.rating ?? 0,\r\n  reviewCount: quiz.reviewCount ?? 0,\r\n});\r\n\r\nexport const cleanQuestionData = (question: Partial<Question>): Partial<Question> => ({\r\n  ...question,\r\n  text: question.text || '',\r\n  type: question.type || 'multiple',\r\n  imageUrl: question.imageUrl || null,\r\n  answers: question.answers || [],\r\n  correctAnswer: question.correctAnswer || null,\r\n  acceptedAnswers: question.acceptedAnswers || [],\r\n  explanation: question.explanation || '',\r\n  points: question.points ?? 1,\r\n  timeLimit: question.timeLimit || null,\r\n  order: question.order ?? 0,\r\n});\r\n\r\nexport const cleanResourceData = (resource: Partial<LearningResource>): Partial<LearningResource> => ({\r\n  ...resource,\r\n  title: resource.title || '',\r\n  description: resource.description || '',\r\n  url: resource.url || '',\r\n  duration: resource.duration || null,\r\n  size: resource.size || null,\r\n  mimeType: resource.mimeType || null,\r\n  thumbnailUrl: resource.thumbnailUrl || null,\r\n  required: resource.required ?? false,\r\n  threshold: resource.threshold || { type: 'percentage', value: 80, unit: '%' },\r\n  estimatedTime: resource.estimatedTime ?? 5,\r\n  order: resource.order ?? 0,\r\n  category: resource.category || null,\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\firestoreService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2549,2552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2549,2552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":123,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":123,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3101,3104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3101,3104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4257,4260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4257,4260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":354,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":354,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9621,9624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9621,9624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":358,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":358,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9757,9760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9757,9760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9970,9973],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9970,9973],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":394,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10754,10757],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10754,10757],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":401,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":401,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10874,10877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10874,10877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":407,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":407,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11110,11113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11110,11113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":457,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":457,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12380,12383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12380,12383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":463,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":463,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12498,12501],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12498,12501],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":474,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":474,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12819,12822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12819,12822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":515,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":515,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14165,14168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14165,14168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":515,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":515,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14171,14174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14171,14174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":516,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":516,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14198,14201],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14198,14201],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * üî• Unified Firestore Service\r\n * Centralized service layer cho t·∫•t c·∫£ Firestore operations\r\n * H·ªó tr·ª£: Type-safety, Offline mode, Cache management\r\n */\r\n\r\nimport {\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  setDoc,\r\n  addDoc,\r\n  updateDoc,\r\n  deleteDoc,\r\n  collection,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  limit,\r\n  startAfter,\r\n  DocumentSnapshot,\r\n  QueryConstraint,\r\n  serverTimestamp,\r\n  writeBatch,\r\n  DocumentData,\r\n  WithFieldValue,\r\n  PartialWithFieldValue,\r\n} from 'firebase/firestore';\r\nimport { db } from '../../firebase/config';\r\nimport { COLLECTIONS, compositeKeys } from './collections';\r\nimport type {\r\n  Quiz,\r\n  UserProfile,\r\n  QuizResult,\r\n  QuizReview,\r\n  UserQuizSession,\r\n  MultiplayerRoom,\r\n  SystemNotification,\r\n  Category,\r\n  UserFavorites,\r\n} from './dataModels';\r\n\r\n// ============= GENERIC CRUD OPERATIONS =============\r\n\r\nexport class FirestoreService<T extends DocumentData> {\r\n  protected collectionName: string;\r\n  \r\n  constructor(collectionName: string) {\r\n    this.collectionName = collectionName;\r\n  }\r\n\r\n  /**\r\n   * Get single document by ID\r\n   */\r\n  async getById(docId: string): Promise<T | null> {\r\n    try {\r\n      const docRef = doc(db, this.collectionName, docId);\r\n      const docSnap = await getDoc(docRef);\r\n      \r\n      if (!docSnap.exists()) {\r\n        return null;\r\n      }\r\n      \r\n      return { id: docSnap.id, ...docSnap.data() } as unknown as T;\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error getting document from ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get multiple documents with query constraints\r\n   */\r\n  async getMany(constraints: QueryConstraint[] = []): Promise<T[]> {\r\n    try {\r\n      const collectionRef = collection(db, this.collectionName);\r\n      const q = query(collectionRef, ...constraints);\r\n      const snapshot = await getDocs(q);\r\n      \r\n      return snapshot.docs.map(doc => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      })) as unknown as T[];\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error getting documents from ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all documents (use with caution!)\r\n   */\r\n  async getAll(): Promise<T[]> {\r\n    return this.getMany();\r\n  }\r\n\r\n  /**\r\n   * Create new document with auto-generated ID\r\n   */\r\n  async create(data: WithFieldValue<Partial<T>>): Promise<string> {\r\n    try {\r\n      const collectionRef = collection(db, this.collectionName);\r\n      const docRef = await addDoc(collectionRef, {\r\n        ...(data as any),\r\n        createdAt: serverTimestamp(),\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n      \r\n      return docRef.id;\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error creating document in ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set document with specific ID (overwrites existing)\r\n   */\r\n  async set(docId: string, data: WithFieldValue<Partial<T>>): Promise<void> {\r\n    try {\r\n      const docRef = doc(db, this.collectionName, docId);\r\n      await setDoc(docRef, {\r\n        ...(data as any),\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error setting document in ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update existing document (merge)\r\n   */\r\n  async update(docId: string, data: PartialWithFieldValue<T>): Promise<void> {\r\n    try {\r\n      const docRef = doc(db, this.collectionName, docId);\r\n      await updateDoc(docRef, {\r\n        ...data,\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error updating document in ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete document\r\n   */\r\n  async delete(docId: string): Promise<void> {\r\n    try {\r\n      const docRef = doc(db, this.collectionName, docId);\r\n      await deleteDoc(docRef);\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error deleting document in ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Batch write operations\r\n   */\r\n  async batchWrite(operations: Array<{\r\n    type: 'set' | 'update' | 'delete';\r\n    docId: string;\r\n    data?: any;\r\n  }>): Promise<void> {\r\n    try {\r\n      const batch = writeBatch(db);\r\n      \r\n      for (const op of operations) {\r\n        const docRef = doc(db, this.collectionName, op.docId);\r\n        \r\n        switch (op.type) {\r\n          case 'set':\r\n            batch.set(docRef, { ...op.data, updatedAt: serverTimestamp() });\r\n            break;\r\n          case 'update':\r\n            batch.update(docRef, { ...op.data, updatedAt: serverTimestamp() });\r\n            break;\r\n          case 'delete':\r\n            batch.delete(docRef);\r\n            break;\r\n        }\r\n      }\r\n      \r\n      await batch.commit();\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error in batch write for ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Paginated query\r\n   */\r\n  async getPaginated(\r\n    constraints: QueryConstraint[] = [],\r\n    pageSize: number = 20,\r\n    lastDoc?: DocumentSnapshot\r\n  ): Promise<{ data: T[]; lastDoc: DocumentSnapshot | null }> {\r\n    try {\r\n      const collectionRef = collection(db, this.collectionName);\r\n      const queryConstraints = [\r\n        ...constraints,\r\n        limit(pageSize),\r\n      ];\r\n      \r\n      if (lastDoc) {\r\n        queryConstraints.push(startAfter(lastDoc));\r\n      }\r\n      \r\n      const q = query(collectionRef, ...queryConstraints);\r\n      const snapshot = await getDocs(q);\r\n      \r\n      const data = snapshot.docs.map(doc => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      })) as unknown as T[];\r\n      \r\n      const newLastDoc = snapshot.docs[snapshot.docs.length - 1] || null;\r\n      \r\n      return { data, lastDoc: newLastDoc };\r\n    } catch (error) {\r\n      console.error(`[Firestore] Error in paginated query for ${this.collectionName}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\n// ============= SPECIALIZED SERVICES =============\r\n\r\n/**\r\n * Quiz Service\r\n */\r\nexport class QuizService extends FirestoreService<Quiz> {\r\n  constructor() {\r\n    super(COLLECTIONS.QUIZZES);\r\n  }\r\n\r\n  async getPublishedQuizzes(): Promise<Quiz[]> {\r\n    return this.getMany([\r\n      where('isPublished', '==', true),\r\n      orderBy('createdAt', 'desc'),\r\n    ]);\r\n  }\r\n\r\n  async getQuizzesByCategory(category: string): Promise<Quiz[]> {\r\n    return this.getMany([\r\n      where('category', '==', category),\r\n      where('isPublished', '==', true),\r\n      orderBy('createdAt', 'desc'),\r\n    ]);\r\n  }\r\n\r\n  async getQuizzesByCreator(userId: string): Promise<Quiz[]> {\r\n    return this.getMany([\r\n      where('createdBy', '==', userId),\r\n      orderBy('createdAt', 'desc'),\r\n    ]);\r\n  }\r\n\r\n  async searchQuizzes(searchTerm: string): Promise<Quiz[]> {\r\n    // Note: Firestore doesn't support full-text search\r\n    // Use Algolia or implement client-side filtering\r\n    const allQuizzes = await this.getPublishedQuizzes();\r\n    const lowerSearch = searchTerm.toLowerCase();\r\n    \r\n    return allQuizzes.filter(quiz =>\r\n      quiz.title.toLowerCase().includes(lowerSearch) ||\r\n      quiz.description.toLowerCase().includes(lowerSearch) ||\r\n      quiz.tags.some(tag => tag.toLowerCase().includes(lowerSearch))\r\n    );\r\n  }\r\n\r\n  async incrementAttempts(quizId: string): Promise<void> {\r\n    const quizRef = doc(db, this.collectionName, quizId);\r\n    const quizDoc = await getDoc(quizRef);\r\n    \r\n    if (quizDoc.exists()) {\r\n      const currentAttempts = quizDoc.data().attempts || 0;\r\n      await updateDoc(quizRef, {\r\n        attempts: currentAttempts + 1,\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n    }\r\n  }\r\n\r\n  async updateStats(quizId: string, score: number): Promise<void> {\r\n    const quizRef = doc(db, this.collectionName, quizId);\r\n    const quizDoc = await getDoc(quizRef);\r\n    \r\n    if (quizDoc.exists()) {\r\n      const data = quizDoc.data();\r\n      const currentTotal = (data.averageScore || 0) * (data.completions || 0);\r\n      const newCompletions = (data.completions || 0) + 1;\r\n      const newAverage = (currentTotal + score) / newCompletions;\r\n      \r\n      await updateDoc(quizRef, {\r\n        completions: newCompletions,\r\n        averageScore: Math.round(newAverage * 100) / 100,\r\n        totalPlayers: (data.totalPlayers || 0) + 1,\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Quiz Results Service\r\n */\r\nexport class QuizResultsService extends FirestoreService<QuizResult> {\r\n  constructor() {\r\n    super(COLLECTIONS.QUIZ_RESULTS);\r\n  }\r\n\r\n  async getUserResults(userId: string, limitCount: number = 50): Promise<QuizResult[]> {\r\n    return this.getMany([\r\n      where('userId', '==', userId),\r\n      orderBy('completedAt', 'desc'),\r\n      limit(limitCount),\r\n    ]);\r\n  }\r\n\r\n  async getQuizLeaderboard(quizId: string, limitCount: number = 10): Promise<QuizResult[]> {\r\n    return this.getMany([\r\n      where('quizId', '==', quizId),\r\n      orderBy('score', 'desc'),\r\n      limit(limitCount),\r\n    ]);\r\n  }\r\n\r\n  async getGlobalLeaderboard(limitCount: number = 100): Promise<QuizResult[]> {\r\n    return this.getMany([\r\n      orderBy('score', 'desc'),\r\n      orderBy('completedAt', 'desc'),\r\n      limit(limitCount),\r\n    ]);\r\n  }\r\n}\r\n\r\n/**\r\n * User Service\r\n */\r\nexport class UserService extends FirestoreService<UserProfile> {\r\n  constructor() {\r\n    super(COLLECTIONS.USERS);\r\n  }\r\n\r\n  async updateLastLogin(userId: string): Promise<void> {\r\n    await this.update(userId, {\r\n      lastLoginAt: serverTimestamp(),\r\n    } as any);\r\n  }\r\n\r\n  async updateRole(userId: string, role: UserProfile['role']): Promise<void> {\r\n    await this.update(userId, { role } as any);\r\n  }\r\n\r\n  async toggleActive(userId: string): Promise<void> {\r\n    const user = await this.getById(userId);\r\n    if (user) {\r\n      await this.update(userId, {\r\n        isActive: !user.isActive,\r\n      } as any);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Learning Session Service\r\n */\r\nexport class LearningSessionService extends FirestoreService<UserQuizSession> {\r\n  constructor() {\r\n    super(COLLECTIONS.USER_QUIZ_SESSIONS);\r\n  }\r\n\r\n  async getSession(quizId: string, userId: string): Promise<UserQuizSession | null> {\r\n    const sessionId = compositeKeys.userQuizSession(quizId, userId);\r\n    return this.getById(sessionId);\r\n  }\r\n\r\n  async initSession(quizId: string, userId: string): Promise<void> {\r\n    const sessionId = compositeKeys.userQuizSession(quizId, userId);\r\n    await this.set(sessionId, {\r\n      userId,\r\n      quizId,\r\n      viewedResources: {},\r\n      completionPercent: 0,\r\n      ready: false,\r\n      startedAt: serverTimestamp(),\r\n      lastActivityAt: serverTimestamp(),\r\n    } as any);\r\n  }\r\n\r\n  async updateProgress(\r\n    quizId: string,\r\n    userId: string,\r\n    resourceId: string,\r\n    progress: any\r\n  ): Promise<void> {\r\n    const sessionId = compositeKeys.userQuizSession(quizId, userId);\r\n    await this.update(sessionId, {\r\n      [`viewedResources.${resourceId}`]: progress,\r\n      lastActivityAt: serverTimestamp(),\r\n    } as any);\r\n  }\r\n}\r\n\r\n/**\r\n * Multiplayer Room Service\r\n */\r\nexport class MultiplayerRoomService extends FirestoreService<MultiplayerRoom> {\r\n  constructor() {\r\n    super(COLLECTIONS.MULTIPLAYER_ROOMS);\r\n  }\r\n\r\n  async getRoomByCode(code: string): Promise<MultiplayerRoom | null> {\r\n    const rooms = await this.getMany([\r\n      where('code', '==', code),\r\n      limit(1),\r\n    ]);\r\n    \r\n    return rooms[0] || null;\r\n  }\r\n\r\n  async getActiveRooms(): Promise<MultiplayerRoom[]> {\r\n    return this.getMany([\r\n      where('status', 'in', ['waiting', 'playing']),\r\n      orderBy('createdAt', 'desc'),\r\n    ]);\r\n  }\r\n}\r\n\r\n/**\r\n * Favorites Service\r\n */\r\nexport class FavoritesService extends FirestoreService<UserFavorites> {\r\n  constructor() {\r\n    super(COLLECTIONS.USER_FAVORITES);\r\n  }\r\n\r\n  async getUserFavorites(userId: string): Promise<string[]> {\r\n    const favDoc = await this.getById(userId);\r\n    return favDoc?.quizIds || [];\r\n  }\r\n\r\n  async addFavorite(userId: string, quizId: string): Promise<void> {\r\n    const favDoc = await this.getById(userId);\r\n    \r\n    if (favDoc) {\r\n      const currentFavs = favDoc.quizIds || [];\r\n      if (!currentFavs.includes(quizId)) {\r\n        await this.update(userId, {\r\n          quizIds: [...currentFavs, quizId],\r\n        } as any);\r\n      }\r\n    } else {\r\n      await this.set(userId, {\r\n        userId,\r\n        quizIds: [quizId],\r\n      } as any);\r\n    }\r\n  }\r\n\r\n  async removeFavorite(userId: string, quizId: string): Promise<void> {\r\n    const favDoc = await this.getById(userId);\r\n    \r\n    if (favDoc) {\r\n      const currentFavs = favDoc.quizIds || [];\r\n      await this.update(userId, {\r\n        quizIds: currentFavs.filter(id => id !== quizId),\r\n      } as any);\r\n    }\r\n  }\r\n}\r\n\r\n// ============= EXPORT INSTANCES =============\r\nexport const quizService = new QuizService();\r\nexport const quizResultsService = new QuizResultsService();\r\nexport const userService = new UserService();\r\nexport const learningSessionService = new LearningSessionService();\r\nexport const multiplayerRoomService = new MultiplayerRoomService();\r\nexport const favoritesService = new FavoritesService();\r\n\r\n// Generic services for other collections\r\nexport const reviewService = new FirestoreService<QuizReview>(COLLECTIONS.QUIZ_REVIEWS);\r\nexport const categoryService = new FirestoreService<Category>(COLLECTIONS.CATEGORIES);\r\nexport const notificationService = new FirestoreService<SystemNotification>(COLLECTIONS.SYSTEM_NOTIFICATIONS);\r\n\r\n// ============= UTILITY FUNCTIONS =============\r\n\r\n/**\r\n * Check if user has permission\r\n */\r\nexport const hasPermission = async (\r\n  userId: string,\r\n  resourceOwnerId: string,\r\n  requiredRole?: UserProfile['role']\r\n): Promise<boolean> => {\r\n  const user = await userService.getById(userId);\r\n  \r\n  if (!user) return false;\r\n  if (user.role === 'admin') return true;\r\n  if (requiredRole && user.role !== requiredRole) return false;\r\n  if (userId === resourceOwnerId) return true;\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Clean data helper\r\n */\r\nexport const cleanDataForFirestore = (data: any): any => {\r\n  const cleaned: any = {};\r\n  \r\n  for (const [key, value] of Object.entries(data)) {\r\n    if (value === undefined) {\r\n      // Skip undefined values\r\n      continue;\r\n    } else if (value === null) {\r\n      cleaned[key] = null;\r\n    } else if (Array.isArray(value)) {\r\n      cleaned[key] = value.map(item =>\r\n        typeof item === 'object' ? cleanDataForFirestore(item) : item\r\n      );\r\n    } else if (typeof value === 'object' && value !== null) {\r\n      cleaned[key] = cleanDataForFirestore(value);\r\n    } else {\r\n      cleaned[key] = value;\r\n    }\r\n  }\r\n  \r\n  return cleaned;\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\storage.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3179,3182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3179,3182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3289,3292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3289,3292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3395,3398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3395,3398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3505,3508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3505,3508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4033,4036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4033,4036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * üìÅ Cloud Storage Paths Constants\r\n * Centralized storage paths ƒë·ªÉ tr√°nh typo v√† d·ªÖ maintain\r\n */\r\n\r\n// ============= STORAGE FOLDERS =============\r\nexport const STORAGE_PATHS = {\r\n  // User uploads\r\n  AVATARS: 'avatars',\r\n  \r\n  // Quiz assets\r\n  QUIZ_COVERS: 'covers',\r\n  \r\n  // Questions\r\n  QUESTION_IMAGES: 'questions',\r\n  \r\n  // Learning Resources\r\n  RESOURCES: {\r\n    ROOT: 'resources',\r\n    VIDEOS: 'resources/videos',\r\n    PDFS: 'resources/pdfs',\r\n    IMAGES: 'resources/images',\r\n    AUDIOS: 'resources/audios',\r\n  },\r\n  \r\n  // Thumbnails (auto-generated by Extension)\r\n  THUMBNAILS: 'thumbnails',\r\n  \r\n  // Temporary uploads (cleanup after 24h)\r\n  TEMP: 'temp',\r\n} as const;\r\n\r\n// ============= PATH BUILDERS =============\r\nexport const storagePaths = {\r\n  // User avatar\r\n  userAvatar: (userId: string, ext: string = 'jpg') => \r\n    `${STORAGE_PATHS.AVATARS}/${userId}.${ext}`,\r\n  \r\n  // Quiz cover\r\n  quizCover: (quizId: string, ext: string = 'jpg') => \r\n    `${STORAGE_PATHS.QUIZ_COVERS}/${quizId}.${ext}`,\r\n  \r\n  // Question image\r\n  questionImage: (quizId: string, questionId: string, ext: string = 'jpg') => \r\n    `${STORAGE_PATHS.QUESTION_IMAGES}/${quizId}/${questionId}.${ext}`,\r\n  \r\n  // Learning resources\r\n  learningVideo: (quizId: string, resourceId: string, ext: string = 'mp4') =>\r\n    `${STORAGE_PATHS.RESOURCES.VIDEOS}/${quizId}/${resourceId}.${ext}`,\r\n  \r\n  learningPDF: (quizId: string, resourceId: string) =>\r\n    `${STORAGE_PATHS.RESOURCES.PDFS}/${quizId}/${resourceId}.pdf`,\r\n  \r\n  learningImage: (quizId: string, resourceId: string, ext: string = 'jpg') =>\r\n    `${STORAGE_PATHS.RESOURCES.IMAGES}/${quizId}/${resourceId}.${ext}`,\r\n  \r\n  learningAudio: (quizId: string, resourceId: string, ext: string = 'mp3') =>\r\n    `${STORAGE_PATHS.RESOURCES.AUDIOS}/${quizId}/${resourceId}.${ext}`,\r\n  \r\n  // Thumbnail (generated)\r\n  thumbnail: (originalPath: string, size: '200x200' | '400x400' | '800x800') => {\r\n    const fileName = originalPath.split('/').pop()?.split('.')[0];\r\n    const ext = originalPath.split('.').pop();\r\n    return `${STORAGE_PATHS.THUMBNAILS}/${fileName}_${size}.${ext}`;\r\n  },\r\n  \r\n  // Temporary upload\r\n  tempFile: (userId: string, filename: string) =>\r\n    `${STORAGE_PATHS.TEMP}/${userId}/${filename}`,\r\n};\r\n\r\n// ============= FILE TYPES =============\r\nexport const FILE_TYPES = {\r\n  IMAGE: {\r\n    mimeTypes: ['image/jpeg', 'image/png', 'image/webp', 'image/gif'],\r\n    extensions: ['.jpg', '.jpeg', '.png', '.webp', '.gif'],\r\n    maxSize: 10 * 1024 * 1024, // 10MB\r\n  },\r\n  VIDEO: {\r\n    mimeTypes: ['video/mp4', 'video/webm', 'video/quicktime'],\r\n    extensions: ['.mp4', '.webm', '.mov'],\r\n    maxSize: 100 * 1024 * 1024, // 100MB\r\n  },\r\n  PDF: {\r\n    mimeTypes: ['application/pdf'],\r\n    extensions: ['.pdf'],\r\n    maxSize: 20 * 1024 * 1024, // 20MB\r\n  },\r\n  AUDIO: {\r\n    mimeTypes: ['audio/mpeg', 'audio/wav', 'audio/ogg'],\r\n    extensions: ['.mp3', '.wav', '.ogg'],\r\n    maxSize: 20 * 1024 * 1024, // 20MB\r\n  },\r\n} as const;\r\n\r\n// ============= VALIDATION HELPERS =============\r\nexport const storageValidation = {\r\n  isValidImageType: (file: File): boolean =>\r\n    FILE_TYPES.IMAGE.mimeTypes.includes(file.type as any),\r\n  \r\n  isValidVideoType: (file: File): boolean =>\r\n    FILE_TYPES.VIDEO.mimeTypes.includes(file.type as any),\r\n  \r\n  isValidPDFType: (file: File): boolean =>\r\n    FILE_TYPES.PDF.mimeTypes.includes(file.type as any),\r\n  \r\n  isValidAudioType: (file: File): boolean =>\r\n    FILE_TYPES.AUDIO.mimeTypes.includes(file.type as any),\r\n  \r\n  isValidFileSize: (file: File, type: keyof typeof FILE_TYPES): boolean =>\r\n    file.size <= FILE_TYPES[type].maxSize,\r\n  \r\n  getFileExtension: (filename: string): string =>\r\n    filename.slice(filename.lastIndexOf('.')),\r\n};\r\n\r\n// ============= CLEANUP RULES =============\r\nexport const CLEANUP_RULES = {\r\n  TEMP_FILES_LIFETIME: 24 * 60 * 60 * 1000, // 24 hours\r\n  ORPHANED_FILES_CHECK_INTERVAL: 7 * 24 * 60 * 60 * 1000, // 7 days\r\n};\r\n\r\nexport type StoragePath = string;\r\nexport type StoragePathBuilder = (...args: any[]) => StoragePath;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\firebase\\storageService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4608,4611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4608,4611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":209,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5523,5526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5523,5526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":222,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5840,5843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5840,5843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * üìÅ Unified Storage Service\r\n * Centralized service layer cho t·∫•t c·∫£ Cloud Storage operations\r\n * H·ªó tr·ª£: Upload, Download, Delete, URL generation\r\n */\r\n\r\nimport {\r\n  ref,\r\n  uploadBytes,\r\n  uploadBytesResumable,\r\n  getDownloadURL,\r\n  deleteObject,\r\n  listAll,\r\n  getMetadata,\r\n  updateMetadata,\r\n  StorageReference,\r\n} from 'firebase/storage';\r\nimport { storage } from '../../firebase/config';\r\nimport { storagePaths, storageValidation, FILE_TYPES } from './storage';\r\n\r\n// ============= UPLOAD OPTIONS =============\r\nexport interface UploadOptions {\r\n  onProgress?: (progress: number) => void;\r\n  onComplete?: (url: string) => void;\r\n  onError?: (error: Error) => void;\r\n  \r\n  // Compression settings\r\n  compress?: boolean;\r\n  quality?: number; // 0-1 for images\r\n  maxWidth?: number;\r\n  maxHeight?: number;\r\n  \r\n  // Metadata\r\n  metadata?: {\r\n    contentType?: string;\r\n    customMetadata?: Record<string, string>;\r\n  };\r\n}\r\n\r\nexport interface UploadResult {\r\n  url: string;\r\n  path: string;\r\n  size: number;\r\n  contentType: string;\r\n  thumbnails?: {\r\n    small: string;\r\n    medium: string;\r\n    large: string;\r\n  };\r\n}\r\n\r\n// ============= STORAGE SERVICE =============\r\nexport class StorageService {\r\n  /**\r\n   * Upload file to Storage\r\n   */\r\n  async uploadFile(\r\n    file: File,\r\n    path: string,\r\n    options: UploadOptions = {}\r\n  ): Promise<UploadResult> {\r\n    try {\r\n      // Validate file\r\n      this.validateFile(file);\r\n      \r\n      // Compress if needed\r\n      const fileToUpload = options.compress\r\n        ? await this.compressFile(file, options)\r\n        : file;\r\n      \r\n      // Create storage reference\r\n      const storageRef = ref(storage, path);\r\n      \r\n      // Set metadata\r\n      const metadata = {\r\n        contentType: file.type,\r\n        ...options.metadata,\r\n        customMetadata: {\r\n          originalName: file.name,\r\n          uploadedAt: new Date().toISOString(),\r\n          ...options.metadata?.customMetadata,\r\n        },\r\n      };\r\n      \r\n      // Upload\r\n      if (options.onProgress) {\r\n        // Resumable upload with progress\r\n        const uploadTask = uploadBytesResumable(storageRef, fileToUpload, metadata);\r\n        \r\n        return new Promise((resolve, reject) => {\r\n          uploadTask.on(\r\n            'state_changed',\r\n            (snapshot) => {\r\n              const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n              options.onProgress?.(progress);\r\n            },\r\n            (error) => {\r\n              options.onError?.(error);\r\n              reject(error);\r\n            },\r\n            async () => {\r\n              const url = await getDownloadURL(uploadTask.snapshot.ref);\r\n              const result: UploadResult = {\r\n                url,\r\n                path,\r\n                size: uploadTask.snapshot.totalBytes,\r\n                contentType: uploadTask.snapshot.metadata.contentType || file.type,\r\n              };\r\n              \r\n              options.onComplete?.(url);\r\n              resolve(result);\r\n            }\r\n          );\r\n        });\r\n      } else {\r\n        // Simple upload\r\n        const snapshot = await uploadBytes(storageRef, fileToUpload, metadata);\r\n        const url = await getDownloadURL(snapshot.ref);\r\n        \r\n        return {\r\n          url,\r\n          path,\r\n          size: snapshot.metadata.size,\r\n          contentType: snapshot.metadata.contentType || file.type,\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('[Storage] Upload error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Upload with instant preview (WebP compression)\r\n   */\r\n  async uploadWithInstantPreview(\r\n    file: File,\r\n    path: string,\r\n    options: UploadOptions = {}\r\n  ): Promise<{ previewUrl: string; finalUrl: Promise<UploadResult> }> {\r\n    // Create instant preview\r\n    const previewUrl = URL.createObjectURL(file);\r\n    \r\n    // Start background upload\r\n    const finalUrl = this.uploadFile(file, path, {\r\n      ...options,\r\n      compress: true,\r\n      quality: 0.8,\r\n    });\r\n    \r\n    return { previewUrl, finalUrl };\r\n  }\r\n\r\n  /**\r\n   * Get download URL from path\r\n   */\r\n  async getDownloadUrl(path: string): Promise<string> {\r\n    try {\r\n      const storageRef = ref(storage, path);\r\n      return await getDownloadURL(storageRef);\r\n    } catch (error) {\r\n      console.error('[Storage] Get URL error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete file\r\n   */\r\n  async deleteFile(path: string): Promise<void> {\r\n    try {\r\n      const storageRef = ref(storage, path);\r\n      await deleteObject(storageRef);\r\n    } catch (error: any) {\r\n      // Ignore if file doesn't exist\r\n      if (error.code === 'storage/object-not-found') {\r\n        console.warn('[Storage] File not found, already deleted:', path);\r\n        return;\r\n      }\r\n      console.error('[Storage] Delete error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete multiple files\r\n   */\r\n  async deleteFiles(paths: string[]): Promise<void> {\r\n    await Promise.all(paths.map(path => this.deleteFile(path)));\r\n  }\r\n\r\n  /**\r\n   * List all files in folder\r\n   */\r\n  async listFiles(folderPath: string): Promise<StorageReference[]> {\r\n    try {\r\n      const folderRef = ref(storage, folderPath);\r\n      const result = await listAll(folderRef);\r\n      return result.items;\r\n    } catch (error) {\r\n      console.error('[Storage] List files error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get file metadata\r\n   */\r\n  async getMetadata(path: string): Promise<any> {\r\n    try {\r\n      const storageRef = ref(storage, path);\r\n      return await getMetadata(storageRef);\r\n    } catch (error) {\r\n      console.error('[Storage] Get metadata error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update file metadata\r\n   */\r\n  async updateMetadata(path: string, metadata: any): Promise<void> {\r\n    try {\r\n      const storageRef = ref(storage, path);\r\n      await updateMetadata(storageRef, metadata);\r\n    } catch (error) {\r\n      console.error('[Storage] Update metadata error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get thumbnail URLs (from Resize Images Extension)\r\n   */\r\n  async getThumbnailUrls(\r\n    originalPath: string,\r\n    maxRetries: number = 10,\r\n    delayMs: number = 2000\r\n  ): Promise<{ small: string; medium: string; large: string }> {\r\n    const sizes = ['200x200', '400x400', '800x800'] as const;\r\n    \r\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n      try {\r\n        const [small, medium, large] = await Promise.all(\r\n          sizes.map(size => {\r\n            const thumbnailPath = storagePaths.thumbnail(originalPath, size);\r\n            return this.getDownloadUrl(thumbnailPath);\r\n          })\r\n        );\r\n        \r\n        return { small, medium, large };\r\n      } catch (error) {\r\n        if (attempt === maxRetries) {\r\n          console.warn('[Storage] Thumbnails not generated yet, using original');\r\n          const originalUrl = await this.getDownloadUrl(originalPath);\r\n          return {\r\n            small: originalUrl,\r\n            medium: originalUrl,\r\n            large: originalUrl,\r\n          };\r\n        }\r\n        \r\n        // Progressive delay\r\n        const delay = delayMs * Math.pow(1.2, attempt - 1);\r\n        await new Promise(resolve => setTimeout(resolve, delay));\r\n      }\r\n    }\r\n    \r\n    throw new Error('Failed to get thumbnails after max retries');\r\n  }\r\n\r\n  // ============= PRIVATE HELPERS =============\r\n\r\n  /**\r\n   * Validate file before upload\r\n   */\r\n  private validateFile(file: File): void {\r\n    // Check file type\r\n    const isImage = storageValidation.isValidImageType(file);\r\n    const isVideo = storageValidation.isValidVideoType(file);\r\n    const isPDF = storageValidation.isValidPDFType(file);\r\n    const isAudio = storageValidation.isValidAudioType(file);\r\n    \r\n    if (!isImage && !isVideo && !isPDF && !isAudio) {\r\n      throw new Error(`Unsupported file type: ${file.type}`);\r\n    }\r\n    \r\n    // Check file size\r\n    let fileType: keyof typeof FILE_TYPES;\r\n    if (isImage) fileType = 'IMAGE';\r\n    else if (isVideo) fileType = 'VIDEO';\r\n    else if (isPDF) fileType = 'PDF';\r\n    else fileType = 'AUDIO';\r\n    \r\n    if (!storageValidation.isValidFileSize(file, fileType)) {\r\n      const maxSize = FILE_TYPES[fileType].maxSize / (1024 * 1024);\r\n      throw new Error(`File too large. Max size: ${maxSize}MB`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compress image file\r\n   */\r\n  private async compressFile(file: File, options: UploadOptions): Promise<File> {\r\n    if (!file.type.startsWith('image/')) {\r\n      return file; // Only compress images\r\n    }\r\n    \r\n    return new Promise((resolve) => {\r\n      const reader = new FileReader();\r\n      \r\n      reader.onload = (e) => {\r\n        const img = new Image();\r\n        \r\n        img.onload = () => {\r\n          const canvas = document.createElement('canvas');\r\n          const ctx = canvas.getContext('2d')!;\r\n          \r\n          // Calculate dimensions\r\n          let width = img.width;\r\n          let height = img.height;\r\n          \r\n          if (options.maxWidth && width > options.maxWidth) {\r\n            height = (height * options.maxWidth) / width;\r\n            width = options.maxWidth;\r\n          }\r\n          \r\n          if (options.maxHeight && height > options.maxHeight) {\r\n            width = (width * options.maxHeight) / height;\r\n            height = options.maxHeight;\r\n          }\r\n          \r\n          canvas.width = width;\r\n          canvas.height = height;\r\n          \r\n          // Draw and compress\r\n          ctx.drawImage(img, 0, 0, width, height);\r\n          \r\n          canvas.toBlob(\r\n            (blob) => {\r\n              if (blob) {\r\n                const compressedFile = new File([blob], file.name, {\r\n                  type: 'image/webp',\r\n                  lastModified: Date.now(),\r\n                });\r\n                resolve(compressedFile);\r\n              } else {\r\n                resolve(file); // Fallback to original\r\n              }\r\n            },\r\n            'image/webp',\r\n            options.quality || 0.8\r\n          );\r\n        };\r\n        \r\n        img.src = e.target?.result as string;\r\n      };\r\n      \r\n      reader.readAsDataURL(file);\r\n    });\r\n  }\r\n}\r\n\r\n// ============= SPECIALIZED UPLOAD SERVICES =============\r\n\r\n/**\r\n * Avatar Upload Service\r\n */\r\nexport class AvatarUploadService extends StorageService {\r\n  async uploadAvatar(userId: string, file: File): Promise<string> {\r\n    const path = storagePaths.userAvatar(userId, 'jpg');\r\n    \r\n    const result = await this.uploadFile(file, path, {\r\n      compress: true,\r\n      quality: 0.85,\r\n      maxWidth: 400,\r\n      maxHeight: 400,\r\n    });\r\n    \r\n    return result.url;\r\n  }\r\n}\r\n\r\n/**\r\n * Quiz Cover Upload Service\r\n */\r\nexport class QuizCoverUploadService extends StorageService {\r\n  async uploadCover(quizId: string, file: File): Promise<UploadResult> {\r\n    const path = storagePaths.quizCover(quizId, 'jpg');\r\n    \r\n    return await this.uploadFile(file, path, {\r\n      compress: true,\r\n      quality: 0.85,\r\n      maxWidth: 1200,\r\n      maxHeight: 630,\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Learning Resource Upload Service\r\n */\r\nexport class ResourceUploadService extends StorageService {\r\n  async uploadVideo(\r\n    quizId: string,\r\n    resourceId: string,\r\n    file: File,\r\n    onProgress?: (progress: number) => void\r\n  ): Promise<UploadResult> {\r\n    const ext = storageValidation.getFileExtension(file.name);\r\n    const path = storagePaths.learningVideo(quizId, resourceId, ext.slice(1));\r\n    \r\n    return await this.uploadFile(file, path, {\r\n      onProgress,\r\n      compress: false, // Don't compress videos\r\n    });\r\n  }\r\n\r\n  async uploadPDF(\r\n    quizId: string,\r\n    resourceId: string,\r\n    file: File,\r\n    onProgress?: (progress: number) => void\r\n  ): Promise<UploadResult> {\r\n    const path = storagePaths.learningPDF(quizId, resourceId);\r\n    \r\n    return await this.uploadFile(file, path, {\r\n      onProgress,\r\n    });\r\n  }\r\n\r\n  async uploadImage(\r\n    quizId: string,\r\n    resourceId: string,\r\n    file: File,\r\n    onProgress?: (progress: number) => void\r\n  ): Promise<UploadResult> {\r\n    const ext = storageValidation.getFileExtension(file.name);\r\n    const path = storagePaths.learningImage(quizId, resourceId, ext.slice(1));\r\n    \r\n    return await this.uploadFile(file, path, {\r\n      onProgress,\r\n      compress: true,\r\n      quality: 0.85,\r\n    });\r\n  }\r\n\r\n  async uploadAudio(\r\n    quizId: string,\r\n    resourceId: string,\r\n    file: File,\r\n    onProgress?: (progress: number) => void\r\n  ): Promise<UploadResult> {\r\n    const ext = storageValidation.getFileExtension(file.name);\r\n    const path = storagePaths.learningAudio(quizId, resourceId, ext.slice(1));\r\n    \r\n    return await this.uploadFile(file, path, {\r\n      onProgress,\r\n    });\r\n  }\r\n}\r\n\r\n// ============= EXPORT INSTANCES =============\r\nexport const storageService = new StorageService();\r\nexport const avatarUploadService = new AvatarUploadService();\r\nexport const quizCoverUploadService = new QuizCoverUploadService();\r\nexport const resourceUploadService = new ResourceUploadService();\r\n\r\n// ============= CLEANUP UTILITIES =============\r\n\r\n/**\r\n * Delete quiz and all related files\r\n */\r\nexport async function deleteQuizFiles(quizId: string): Promise<void> {\r\n  const paths = [\r\n    storagePaths.quizCover(quizId),\r\n    // Add more paths as needed\r\n  ];\r\n  \r\n  await storageService.deleteFiles(paths);\r\n  \r\n  // Delete resource folders\r\n  const resourceFolders = [\r\n    `${quizId}`,\r\n  ];\r\n  \r\n  for (const folder of resourceFolders) {\r\n    try {\r\n      const files = await storageService.listFiles(`resources/videos/${folder}`);\r\n      await Promise.all(files.map(file => storageService.deleteFile(file.fullPath)));\r\n    } catch (error) {\r\n      console.warn('[Storage] No files found in folder:', folder);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Clean up temporary files older than 24h\r\n */\r\nexport async function cleanupTempFiles(): Promise<void> {\r\n  try {\r\n    const files = await storageService.listFiles('temp');\r\n    const now = Date.now();\r\n    const maxAge = 24 * 60 * 60 * 1000; // 24 hours\r\n    \r\n    for (const fileRef of files) {\r\n      const metadata = await storageService.getMetadata(fileRef.fullPath);\r\n      const uploadTime = new Date(metadata.timeCreated).getTime();\r\n      \r\n      if (now - uploadTime > maxAge) {\r\n        await storageService.deleteFile(fileRef.fullPath);\r\n        console.log('[Storage] Deleted temp file:', fileRef.name);\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('[Storage] Cleanup error:', error);\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\geminiAI.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[567,570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[567,570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-constant-condition","severity":1,"message":"Unexpected constant condition.","line":35,"column":12,"nodeType":"Literal","messageId":"unexpected","endLine":35,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1666,1669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1666,1669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2777,2780],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2777,2780],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3728,3731],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3728,3731],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4374,4377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4374,4377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4656,4659],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4656,4659],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4894,4897],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4894,4897],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\n// API Key - s·ª≠ d·ª•ng environment variable n·∫øu c√≥, fallback v·ªÅ hardcoded\r\nconst API_KEY = import.meta.env.VITE_GEMINI_API_KEY || \"AIzaSyB7vFdW8BKswDq0TEjKvoLemzWCSk6b5Xg\";\r\n\r\nclass GeminiAIService {\r\n  private genAI: GoogleGenerativeAI;\r\n\r\n  constructor() {\r\n    this.genAI = new GoogleGenerativeAI(API_KEY);\r\n  }\r\n\r\n  private async sleep(ms: number) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  private isRetriableError(error: unknown): boolean {\r\n    const anyErr = error as any;\r\n    const status = anyErr?.status || anyErr?.statusCode || anyErr?.response?.status;\r\n    const code = String(status || '').toLowerCase();\r\n    const msg = (error instanceof Error ? error.message : String(error)).toLowerCase();\r\n    return (\r\n      code === '503' || code === '429' ||\r\n      msg.includes('503') ||\r\n      msg.includes('overloaded') ||\r\n      msg.includes('timeout') ||\r\n      msg.includes('429') ||\r\n      msg.includes('rate') ||\r\n      msg.includes('unavailable')\r\n    );\r\n  }\r\n\r\n  private async callWithRetry<T>(fn: () => Promise<T>, retries = 2, baseDelayMs = 800): Promise<T> {\r\n    let attempt = 0;\r\n    while (true) {\r\n      try {\r\n        return await fn();\r\n      } catch (e) {\r\n        if (attempt >= retries || !this.isRetriableError(e)) {\r\n          throw e;\r\n        }\r\n        const jitter = Math.floor(Math.random() * 200);\r\n        const delay = Math.min(8000, baseDelayMs * Math.pow(2, attempt)) + jitter;\r\n        await this.sleep(delay);\r\n        attempt++;\r\n      }\r\n    }\r\n  }\r\n\r\n  private async generateViaRest(modelName: string, prompt: string): Promise<any[]> {\r\n    const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${API_KEY}`;\r\n    const res = await fetch(url, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        contents: [{ parts: [{ text: prompt }] }],\r\n        generationConfig: { temperature: 0.7, maxOutputTokens: 2000 }\r\n      })\r\n    });\r\n    if (!res.ok) {\r\n      const text = await res.text().catch(() => '');\r\n      throw new Error(`Gemini REST ${res.status} ${res.statusText} ${text}`);\r\n    }\r\n    const data = await res.json();\r\n    const generatedText = data?.candidates?.[0]?.content?.parts?.[0]?.text || '';\r\n    const cleaned = (generatedText as string).replace(/```json\\n?/g, '').replace(/```\\n?/g, '').trim();\r\n    const jsonMatch = cleaned.match(/\\{[\\s\\S]*\\}/);\r\n    const clean = jsonMatch ? jsonMatch[0] : cleaned;\r\n    const parsed = JSON.parse(clean);\r\n    if (!parsed.questions || !Array.isArray(parsed.questions)) {\r\n      throw new Error('Invalid REST response structure');\r\n    }\r\n    return parsed.questions as any[];\r\n  }\r\n\r\n  async generateQuestions(topic: string, difficulty: string, numQuestions: number) {\r\n    try {\r\n      const prompt = `\r\nT·∫°o ${numQuestions} c√¢u h·ªèi tr·∫Øc nghi·ªám v·ªÅ ch·ªß ƒë·ªÅ \"${topic}\" v·ªõi ƒë·ªô kh√≥ ${difficulty}.\r\n\r\nY√™u c·∫ßu ƒë·ªãnh d·∫°ng JSON ch√≠nh x√°c:\r\n{\r\n  \"questions\": [\r\n    {\r\n      \"text\": \"C√¢u h·ªèi...\",\r\n      \"answers\": [\r\n        {\"text\": \"ƒê√°p √°n A\", \"isCorrect\": false},\r\n        {\"text\": \"ƒê√°p √°n B\", \"isCorrect\": true},\r\n        {\"text\": \"ƒê√°p √°n C\", \"isCorrect\": false},\r\n        {\"text\": \"ƒê√°p √°n D\", \"isCorrect\": false}\r\n      ]\r\n    }\r\n  ]\r\n}\r\n\r\nL∆∞u √Ω:\r\n- M·ªói c√¢u h·ªèi ph·∫£i c√≥ ƒë√∫ng 4 ƒë√°p √°n\r\n- Ch·ªâ c√≥ 1 ƒë√°p √°n ƒë√∫ng (isCorrect: true)\r\n- C√¢u h·ªèi ph·∫£i r√µ r√†ng, ch√≠nh x√°c\r\n- ƒê√°p √°n ph·∫£i h·ª£p l√Ω v√† ƒëa d·∫°ng\r\n- Tr·∫£ v·ªÅ CH√çNH X√ÅC ƒë·ªãnh d·∫°ng JSON, kh√¥ng th√™m text kh√°c\r\n`;\r\n\r\n      const models = [\r\n        'gemini-1.5-flash',\r\n        'gemini-1.5-flash-8b',\r\n        'gemini-1.5-pro',\r\n        'gemini-pro'\r\n      ];\r\n\r\n      let lastError: any = null;\r\n      for (const name of models) {\r\n        try {\r\n          const model = this.genAI.getGenerativeModel({ model: name });\r\n          const run = async () => {\r\n            const result = await model.generateContent(prompt);\r\n            const response = await result.response;\r\n            let text = response.text();\r\n            text = text.replace(/```json\\n?/g, '').replace(/```\\n?/g, '').trim();\r\n            const data = JSON.parse(text);\r\n            if (!data.questions || !Array.isArray(data.questions)) {\r\n              throw new Error('Invalid response structure');\r\n            }\r\n            data.questions.forEach((q: any, index: number) => {\r\n              if (!q.text || !q.answers || !Array.isArray(q.answers) || q.answers.length !== 4) {\r\n                throw new Error(`Invalid question structure at index ${index}`);\r\n              }\r\n              const correctAnswers = q.answers.filter((a: any) => a.isCorrect);\r\n              if (correctAnswers.length !== 1) {\r\n                throw new Error(`Question ${index + 1} must have exactly 1 correct answer`);\r\n              }\r\n            });\r\n            return data.questions as any[];\r\n          };\r\n\r\n          const questions = await this.callWithRetry(run, 2, 800);\r\n          return {\r\n            success: true,\r\n            questions,\r\n            message: `ƒê√£ t·∫°o th√†nh c√¥ng ${questions.length} c√¢u h·ªèi`\r\n          };\r\n        } catch (err) {\r\n          lastError = err;\r\n          // Lu√¥n th·ª≠ model k·∫ø ti·∫øp khi l·ªói, ∆∞u ti√™n chuy·ªÉn model khi flash qu√° t·∫£i\r\n          continue;\r\n        }\r\n      }\r\n\r\n      // If SDK attempts failed, try REST fallback with a stable model\r\n      try {\r\n        const questions = await this.callWithRetry(() => this.generateViaRest('gemini-pro', prompt), 1, 1000);\r\n        return {\r\n          success: true,\r\n          questions,\r\n          message: `ƒê√£ t·∫°o th√†nh c√¥ng ${questions.length} c√¢u h·ªèi`\r\n        };\r\n      } catch (e) {\r\n        lastError = e;\r\n      }\r\n\r\n      throw lastError || new Error('Gemini unavailable');\r\n\r\n    } catch (error) {\r\n      console.error('Gemini AI Error:', error);\r\n      \r\n      if (error instanceof SyntaxError) {\r\n        return {\r\n          success: false,\r\n          error: 'L·ªói ƒë·ªãnh d·∫°ng JSON t·ª´ AI. Vui l√≤ng th·ª≠ l·∫°i.',\r\n          questions: []\r\n        };\r\n      }\r\n      \r\n      const msg = (error instanceof Error ? error.message : 'C√≥ l·ªói x·∫£y ra khi t·∫°o c√¢u h·ªèi');\r\n      const friendly = /503|overloaded|429|rate|unavailable/i.test(msg)\r\n        ? 'M√°y ch·ªß AI ƒëang qu√° t·∫£i ho·∫∑c t·∫°m th·ªùi kh√¥ng ph·∫£n h·ªìi. Vui l√≤ng th·ª≠ l·∫°i sau m·ªôt l√∫c.'\r\n        : msg;\r\n      return {\r\n        success: false,\r\n        error: friendly,\r\n        questions: []\r\n      };\r\n    }\r\n  }\r\n\r\n  async testConnection() {\r\n    try {\r\n      const model = this.genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n      const result = await model.generateContent(\"Ch√†o b·∫°n! H√£y tr·∫£ l·ªùi ng·∫Øn g·ªçn b·∫±ng ti·∫øng Vi·ªát: AI ƒëang ho·∫°t ƒë·ªông t·ªët kh√¥ng?\");\r\n      const response = await result.response;\r\n      const text = response.text();\r\n      \r\n      return {\r\n        success: true,\r\n        message: \"K·∫øt n·ªëi AI th√†nh c√¥ng!\",\r\n        response: text\r\n      };\r\n    } catch (error) {\r\n      console.error('Test connection error:', error);\r\n      return {\r\n        success: false,\r\n        message: \"Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn AI\",\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const geminiAI = new GeminiAIService();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\imageUploadService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2802,2805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2802,2805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3439,3442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3439,3442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":252,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7759,7762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7759,7762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":261,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":261,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7968,7971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7968,7971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":394,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12077,12080],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12077,12080],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":406,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":406,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12308,12311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12308,12311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":495,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":495,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14916,14919],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14916,14919],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Image Upload Service v·ªõi t√≠ch h·ª£p Resize Images Extension\r\n * \r\n * Extension s·∫Ω t·ª± ƒë·ªông resize ·∫£nh khi upload v√†o Storage\r\n * - Original image: /images/original/{filename}\r\n * - Thumbnails: /thumbnails/{filename}_200x200, _400x400, _800x800\r\n */\r\n\r\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL, deleteObject, UploadMetadata } from 'firebase/storage';\r\nimport { getAuth } from 'firebase/auth';\r\n\r\nconst storage = getStorage();\r\n\r\nexport interface ImageUploadOptions {\r\n  folder?: 'avatars' | 'quizzes' | 'covers' | 'temp';\r\n  maxSizeKB?: number;\r\n  allowedTypes?: string[];\r\n  generateThumbnails?: boolean;\r\n}\r\n\r\nexport interface ImageUploadResult {\r\n  success: boolean;\r\n  originalUrl?: string;\r\n  thumbnailUrls?: {\r\n    small?: string;    // 200x200\r\n    medium?: string;   // 400x400\r\n    large?: string;    // 800x800\r\n  };\r\n  fileName?: string;\r\n  filePath?: string;\r\n  error?: string;\r\n}\r\n\r\nexport interface UploadProgress {\r\n  progress: number;\r\n  bytesTransferred: number;\r\n  totalBytes: number;\r\n  state: 'running' | 'paused' | 'success' | 'error';\r\n}\r\n\r\n/**\r\n * Validate image file\r\n */\r\nconst validateImage = (\r\n  file: File,\r\n  maxSizeKB: number = 5120, // 5MB default\r\n  allowedTypes: string[] = ['image/jpeg', 'image/png', 'image/webp', 'image/gif']\r\n): { valid: boolean; error?: string } => {\r\n  // Check file type\r\n  if (!allowedTypes.includes(file.type)) {\r\n    return {\r\n      valid: false,\r\n      error: `Ch·ªâ ch·∫•p nh·∫≠n c√°c ƒë·ªãnh d·∫°ng: ${allowedTypes.map(t => t.split('/')[1]).join(', ')}`\r\n    };\r\n  }\r\n\r\n  // Check file size\r\n  const fileSizeKB = file.size / 1024;\r\n  if (fileSizeKB > maxSizeKB) {\r\n    return {\r\n      valid: false,\r\n      error: `K√≠ch th∆∞·ªõc file v∆∞·ª£t qu√° ${maxSizeKB}KB (${Math.round(fileSizeKB)}KB)`\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n};\r\n\r\n/**\r\n * Generate unique filename with timestamp\r\n */\r\nconst generateFileName = (originalName: string, userId: string): string => {\r\n  const timestamp = Date.now();\r\n  const randomStr = Math.random().toString(36).substring(2, 8);\r\n  const extension = originalName.split('.').pop();\r\n  const cleanName = originalName.replace(/[^a-zA-Z0-9]/g, '_').substring(0, 20);\r\n  \r\n  return `${cleanName}_${userId}_${timestamp}_${randomStr}.${extension}`;\r\n};\r\n\r\n/**\r\n * Get thumbnail URLs based on original filename\r\n * Extension t·ª± ƒë·ªông t·∫°o thumbnails v·ªõi format: {filename}_200x200.{ext}\r\n * Retry multiple times v√¨ extension c·∫ßn th·ªùi gian x·ª≠ l√Ω\r\n */\r\nconst getThumbnailUrls = async (\r\n  fileName: string\r\n): Promise<{ small?: string; medium?: string; large?: string }> => {\r\n  const thumbnailSizes = [\r\n    { key: 'small', size: '200x200', maxRetries: 8 },\r\n    { key: 'medium', size: '400x400', maxRetries: 8 },\r\n    { key: 'large', size: '800x800', maxRetries: 10 }\r\n  ];\r\n\r\n  const thumbnailUrls: any = {};\r\n  const nameWithoutExt = fileName.substring(0, fileName.lastIndexOf('.'));\r\n  const extension = fileName.split('.').pop();\r\n\r\n  // Function ƒë·ªÉ retry l·∫•y thumbnail URL\r\n  const getThumbnailWithRetry = async (\r\n    thumbnailPath: string,\r\n    maxRetries: number,\r\n    size: string\r\n  ): Promise<string | null> => {\r\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n      try {\r\n        const thumbnailRef = ref(storage, thumbnailPath);\r\n        const url = await getDownloadURL(thumbnailRef);\r\n        console.log(`‚úÖ Thumbnail ${size} ready after ${attempt} attempts`);\r\n        return url;\r\n      } catch (error: any) {\r\n        if (attempt < maxRetries) {\r\n          // ƒê·ª£i l√¢u h∆°n cho m·ªói l·∫ßn retry (2s, 3s, 4s, ...)\r\n          const waitTime = 2000 + (attempt * 1000);\r\n          console.log(`‚è≥ Waiting for thumbnail ${size}... attempt ${attempt}/${maxRetries}`);\r\n          await new Promise(resolve => setTimeout(resolve, waitTime));\r\n        } else {\r\n          console.log(`‚ö†Ô∏è Thumbnail ${size} not available after ${maxRetries} attempts (Extension may still be processing)`);\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  // L·∫•y t·∫•t c·∫£ thumbnails song song\r\n  const thumbnailPromises = thumbnailSizes.map(async ({ key, size, maxRetries }) => {\r\n    const thumbnailFileName = `${nameWithoutExt}_${size}.${extension}`;\r\n    const thumbnailPath = `thumbnails/${thumbnailFileName}`;\r\n    const url = await getThumbnailWithRetry(thumbnailPath, maxRetries, size);\r\n    return { key, url };\r\n  });\r\n\r\n  const results = await Promise.all(thumbnailPromises);\r\n  \r\n  // Map results to object\r\n  results.forEach(({ key, url }) => {\r\n    if (url) {\r\n      thumbnailUrls[key] = url;\r\n    }\r\n  });\r\n\r\n  return thumbnailUrls;\r\n};\r\n\r\n/**\r\n * Upload image to Firebase Storage v·ªõi Progress Callback\r\n */\r\nexport const uploadImage = async (\r\n  file: File,\r\n  options: ImageUploadOptions = {},\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  const auth = getAuth();\r\n  const currentUser = auth.currentUser;\r\n\r\n  if (!currentUser) {\r\n    return {\r\n      success: false,\r\n      error: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ upload ·∫£nh'\r\n    };\r\n  }\r\n\r\n  const {\r\n    folder = 'temp',\r\n    maxSizeKB = 5120,\r\n    allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'],\r\n    generateThumbnails = true\r\n  } = options;\r\n\r\n  // Validate image\r\n  const validation = validateImage(file, maxSizeKB, allowedTypes);\r\n  if (!validation.valid) {\r\n    return {\r\n      success: false,\r\n      error: validation.error\r\n    };\r\n  }\r\n\r\n  try {\r\n    // Generate unique filename\r\n    const fileName = generateFileName(file.name, currentUser.uid);\r\n    const filePath = `images/${folder}/${fileName}`;\r\n    const storageRef = ref(storage, filePath);\r\n\r\n    // Metadata cho image\r\n    const metadata: UploadMetadata = {\r\n      contentType: file.type,\r\n      customMetadata: {\r\n        uploadedBy: currentUser.uid,\r\n        uploadedAt: new Date().toISOString(),\r\n        originalName: file.name,\r\n        folder: folder\r\n      },\r\n      cacheControl: 'public, max-age=31536000' // Cache 1 nƒÉm\r\n    };\r\n\r\n    // Upload with progress tracking\r\n    const uploadTask = uploadBytesResumable(storageRef, file, metadata);\r\n\r\n    return new Promise((resolve, _reject) => {\r\n      uploadTask.on(\r\n        'state_changed',\r\n        (snapshot) => {\r\n          // Progress callback\r\n          if (onProgress) {\r\n            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n            onProgress({\r\n              progress: Math.round(progress),\r\n              bytesTransferred: snapshot.bytesTransferred,\r\n              totalBytes: snapshot.totalBytes,\r\n              state: snapshot.state as 'running' | 'paused'\r\n            });\r\n          }\r\n        },\r\n        (error) => {\r\n          // Error handling\r\n          console.error('Upload error:', error);\r\n          resolve({\r\n            success: false,\r\n            error: 'L·ªói khi upload ·∫£nh: ' + error.message\r\n          });\r\n        },\r\n        async () => {\r\n          // Upload completed\r\n          try {\r\n            const originalUrl = await getDownloadURL(uploadTask.snapshot.ref);\r\n            \r\n            let thumbnailUrls = {};\r\n            \r\n            // ƒê·ª£i Extension t·∫°o thumbnails (n·∫øu enabled)\r\n            if (generateThumbnails) {\r\n              thumbnailUrls = await getThumbnailUrls(fileName);\r\n            }\r\n\r\n            resolve({\r\n              success: true,\r\n              originalUrl,\r\n              thumbnailUrls,\r\n              fileName,\r\n              filePath\r\n            });\r\n\r\n            if (onProgress) {\r\n              onProgress({\r\n                progress: 100,\r\n                bytesTransferred: uploadTask.snapshot.totalBytes,\r\n                totalBytes: uploadTask.snapshot.totalBytes,\r\n                state: 'success'\r\n              });\r\n            }\r\n          } catch (error: any) {\r\n            resolve({\r\n              success: false,\r\n              error: 'Kh√¥ng th·ªÉ l·∫•y URL download: ' + error.message\r\n            });\r\n          }\r\n        }\r\n      );\r\n    });\r\n  } catch (error: any) {\r\n    console.error('Upload image error:', error);\r\n    return {\r\n      success: false,\r\n      error: 'C√≥ l·ªói x·∫£y ra: ' + error.message\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * üöÄ INSTANT UPLOAD - Upload ngay l·∫≠p t·ª©c (1-3s) kh√¥ng ƒë·ª£i compression\r\n * \r\n * Strategy:\r\n * 1. Upload file g·ªëc ngay l·∫≠p t·ª©c ‚Üí User th·∫•y k·∫øt qu·∫£ trong 1-3s\r\n * 2. Compress trong background ‚Üí Kh√¥ng block UI\r\n * 3. Thay th·∫ø b·∫±ng file compressed ‚Üí Ti·∫øt ki·ªám bandwidth sau\r\n * \r\n * Trade-off:\r\n * + Upload c·ª±c nhanh (1-3s)\r\n * + UX m∆∞·ª£t m√†\r\n * - Storage t·∫°m th·ªùi l·ªõn h∆°n (s·∫Ω ƒë∆∞·ª£c thay th·∫ø sau)\r\n */\r\nexport const instantUploadImage = async (\r\n  file: File,\r\n  options: ImageUploadOptions = {},\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  const auth = getAuth();\r\n  const currentUser = auth.currentUser;\r\n\r\n  if (!currentUser) {\r\n    return {\r\n      success: false,\r\n      error: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ upload ·∫£nh'\r\n    };\r\n  }\r\n\r\n  try {\r\n    const {\r\n      folder = 'temp',\r\n      maxSizeKB = 5120,\r\n      allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'],\r\n      generateThumbnails = true\r\n    } = options;\r\n\r\n    // Validate\r\n    const validation = validateImage(file, maxSizeKB, allowedTypes);\r\n    if (!validation.valid) {\r\n      return {\r\n        success: false,\r\n        error: validation.error\r\n      };\r\n    }\r\n\r\n    const fileName = generateFileName(file.name, currentUser.uid);\r\n    const filePath = `images/${folder}/${fileName}`;\r\n    const storageRef = ref(storage, filePath);\r\n\r\n    // Metadata\r\n    const metadata: UploadMetadata = {\r\n      contentType: file.type,\r\n      customMetadata: {\r\n        uploadedBy: currentUser.uid,\r\n        uploadedAt: new Date().toISOString(),\r\n        originalName: file.name,\r\n        instant: 'true' // ƒê√°nh d·∫•u ƒë√¢y l√† instant upload\r\n      }\r\n    };\r\n\r\n    console.log('‚ö° INSTANT UPLOAD START:', {\r\n      file: file.name,\r\n      size: `${Math.round(file.size / 1024)}KB`,\r\n      type: file.type\r\n    });\r\n\r\n    // üöÄ UPLOAD NGAY - Kh√¥ng ƒë·ª£i compression\r\n    const uploadTask = uploadBytesResumable(storageRef, file, metadata);\r\n\r\n    const uploadResult = await new Promise<ImageUploadResult>((resolve, _reject) => {\r\n      uploadTask.on(\r\n        'state_changed',\r\n        (snapshot) => {\r\n          if (onProgress) {\r\n            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n            onProgress({\r\n              progress: Math.round(progress),\r\n              bytesTransferred: snapshot.bytesTransferred,\r\n              totalBytes: snapshot.totalBytes,\r\n              state: snapshot.state as 'running' | 'paused'\r\n            });\r\n          }\r\n        },\r\n        (error) => {\r\n          console.error('‚ùå Instant upload error:', error);\r\n          resolve({\r\n            success: false,\r\n            error: 'L·ªói upload: ' + error.message\r\n          });\r\n        },\r\n        async () => {\r\n          try {\r\n            const originalUrl = await getDownloadURL(uploadTask.snapshot.ref);\r\n            \r\n            console.log('‚úÖ INSTANT UPLOAD DONE:', {\r\n              time: '1-3s',\r\n              url: originalUrl.substring(0, 50) + '...'\r\n            });\r\n\r\n            // Return ngay - kh√¥ng ƒë·ª£i thumbnails\r\n            resolve({\r\n              success: true,\r\n              originalUrl,\r\n              fileName,\r\n              filePath,\r\n              thumbnailUrls: {} // S·∫Ω c√≥ sau 5-30s\r\n            });\r\n\r\n            // üîÑ Background: ƒê·ª£i thumbnails sau (kh√¥ng block)\r\n            if (generateThumbnails) {\r\n              setTimeout(async () => {\r\n                const thumbnails = await getThumbnailUrls(fileName);\r\n                console.log('üñºÔ∏è Thumbnails ready (background):', Object.keys(thumbnails));\r\n              }, 10000); // ƒê·ª£i 10s r·ªìi check\r\n            }\r\n\r\n            if (onProgress) {\r\n              onProgress({\r\n                progress: 100,\r\n                bytesTransferred: uploadTask.snapshot.totalBytes,\r\n                totalBytes: uploadTask.snapshot.totalBytes,\r\n                state: 'success'\r\n              });\r\n            }\r\n          } catch (error: any) {\r\n            resolve({\r\n              success: false,\r\n              error: 'Kh√¥ng l·∫•y ƒë∆∞·ª£c URL: ' + error.message\r\n            });\r\n          }\r\n        }\r\n      );\r\n    });\r\n\r\n    return uploadResult;\r\n\r\n  } catch (error: any) {\r\n    console.error('‚ùå Instant upload error:', error);\r\n    return {\r\n      success: false,\r\n      error: 'C√≥ l·ªói x·∫£y ra: ' + error.message\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Upload avatar v·ªõi optimization cho profile pictures\r\n */\r\nexport const uploadAvatar = async (\r\n  file: File,\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  return uploadImage(file, {\r\n    folder: 'avatars',\r\n    maxSizeKB: 2048, // 2MB max for avatars\r\n    allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],\r\n    generateThumbnails: true\r\n  }, onProgress);\r\n};\r\n\r\n/**\r\n * Upload quiz cover image\r\n */\r\nexport const uploadQuizCover = async (\r\n  file: File,\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  return uploadImage(file, {\r\n    folder: 'covers',\r\n    maxSizeKB: 3072, // 3MB max for covers\r\n    allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],\r\n    generateThumbnails: true\r\n  }, onProgress);\r\n};\r\n\r\n/**\r\n * Upload quiz question image\r\n */\r\nexport const uploadQuizImage = async (\r\n  file: File,\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  return uploadImage(file, {\r\n    folder: 'quizzes',\r\n    maxSizeKB: 2048, // 2MB max for quiz images\r\n    allowedTypes: ['image/jpeg', 'image/png', 'image/webp', 'image/gif'],\r\n    generateThumbnails: true\r\n  }, onProgress);\r\n};\r\n\r\n/**\r\n * Delete image from Storage (c·∫£ original v√† thumbnails)\r\n */\r\nexport const deleteImage = async (filePath: string): Promise<{ success: boolean; error?: string }> => {\r\n  try {\r\n    const auth = getAuth();\r\n    if (!auth.currentUser) {\r\n      return { success: false, error: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p' };\r\n    }\r\n\r\n    // Delete original image\r\n    const imageRef = ref(storage, filePath);\r\n    await deleteObject(imageRef);\r\n\r\n    // Try to delete thumbnails\r\n    const fileName = filePath.split('/').pop();\r\n    if (fileName) {\r\n      const nameWithoutExt = fileName.substring(0, fileName.lastIndexOf('.'));\r\n      const extension = fileName.split('.').pop();\r\n\r\n      const thumbnailSizes = ['200x200', '400x400', '800x800'];\r\n      \r\n      for (const size of thumbnailSizes) {\r\n        try {\r\n          const thumbnailPath = `thumbnails/${nameWithoutExt}_${size}.${extension}`;\r\n          const thumbnailRef = ref(storage, thumbnailPath);\r\n          await deleteObject(thumbnailRef);\r\n        } catch (error) {\r\n          // Thumbnail might not exist, ignore error\r\n          console.warn(`Thumbnail ${size} not found, skipping`);\r\n        }\r\n      }\r\n    }\r\n\r\n    return { success: true };\r\n  } catch (error: any) {\r\n    console.error('Delete image error:', error);\r\n    return {\r\n      success: false,\r\n      error: 'Kh√¥ng th·ªÉ x√≥a ·∫£nh: ' + error.message\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get image URL t·ª´ Storage path\r\n */\r\nexport const getImageUrl = async (filePath: string): Promise<string | null> => {\r\n  try {\r\n    const imageRef = ref(storage, filePath);\r\n    return await getDownloadURL(imageRef);\r\n  } catch (error) {\r\n    console.error('Get image URL error:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Compress image si√™u nhanh v·ªõi WebP format\r\n * WebP nh·∫π h∆°n JPEG 25-35%, encode nhanh h∆°n, quality t·ªët h∆°n\r\n */\r\nexport const compressImage = async (\r\n  file: File,\r\n  maxWidth: number = 1920,\r\n  maxHeight: number = 1080,\r\n  quality: number = 0.85,\r\n  useWebP: boolean = true // WebP m·∫∑c ƒë·ªãnh cho t·ªëc ƒë·ªô\r\n): Promise<File> => {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    \r\n    reader.onload = (event) => {\r\n      const img = new Image();\r\n      img.src = event.target?.result as string;\r\n      \r\n      img.onload = () => {\r\n        const canvas = document.createElement('canvas');\r\n        let width = img.width;\r\n        let height = img.height;\r\n\r\n        // Calculate new dimensions\r\n        if (width > maxWidth || height > maxHeight) {\r\n          const ratio = Math.min(maxWidth / width, maxHeight / height);\r\n          width = Math.floor(width * ratio);\r\n          height = Math.floor(height * ratio);\r\n        }\r\n\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        const ctx = canvas.getContext('2d', { alpha: false }); // Disable alpha for better performance\r\n        if (!ctx) {\r\n          reject(new Error('Cannot get canvas context'));\r\n          return;\r\n        }\r\n\r\n        // High quality rendering\r\n        ctx.imageSmoothingEnabled = true;\r\n        ctx.imageSmoothingQuality = 'high';\r\n        ctx.drawImage(img, 0, 0, width, height);\r\n\r\n        // Use WebP for faster compression (25-35% smaller)\r\n        const outputType = useWebP ? 'image/webp' : file.type;\r\n        const outputExtension = useWebP ? '.webp' : file.name.split('.').pop();\r\n        const outputName = file.name.replace(/\\.[^/.]+$/, `.${outputExtension}`);\r\n\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (!blob) {\r\n              reject(new Error('Canvas to Blob failed'));\r\n              return;\r\n            }\r\n            \r\n            const compressedFile = new File([blob], outputName, {\r\n              type: outputType,\r\n              lastModified: Date.now()\r\n            });\r\n            \r\n            console.log(`üóúÔ∏è Compressed: ${Math.round(file.size/1024)}KB ‚Üí ${Math.round(compressedFile.size/1024)}KB (${Math.round((1 - compressedFile.size/file.size) * 100)}% reduction)`);\r\n            \r\n            resolve(compressedFile);\r\n          },\r\n          outputType,\r\n          quality\r\n        );\r\n      };\r\n\r\n      img.onerror = () => {\r\n        reject(new Error('Failed to load image'));\r\n      };\r\n    };\r\n\r\n    reader.onerror = () => {\r\n      reject(new Error('Failed to read file'));\r\n    };\r\n  });\r\n};\r\n\r\n/**\r\n * FAST UPLOAD: Compress + Upload ngay khi ch·ªçn file (kh√¥ng ƒë·ª£i user confirm)\r\n * D√πng cho tr·∫£i nghi·ªám instant upload\r\n */\r\nexport const fastUploadImage = async (\r\n  file: File,\r\n  options: ImageUploadOptions = {},\r\n  onProgress?: (progress: UploadProgress) => void\r\n): Promise<ImageUploadResult> => {\r\n  // Step 1: Compress si√™u nhanh v·ªõi WebP\r\n  console.time('‚ö° FastUpload - Compression');\r\n  const compressed = await compressImage(file, 1920, 1080, 0.8, true); // WebP, quality 0.8 for speed\r\n  console.timeEnd('‚ö° FastUpload - Compression');\r\n  \r\n  // Step 2: Upload ngay kh√¥ng ƒë·ª£i\r\n  console.time('‚ö° FastUpload - Upload');\r\n  const result = await uploadImage(compressed, options, onProgress);\r\n  console.timeEnd('‚ö° FastUpload - Upload');\r\n  \r\n  return result;\r\n};\r\n\r\n/**\r\n * BACKGROUND UPLOAD: Upload trong background, return promise ngay\r\n * User kh√¥ng c·∫ßn ƒë·ª£i, c√≥ th·ªÉ l√†m vi·ªác kh√°c\r\n */\r\nexport const backgroundUploadImage = (\r\n  file: File,\r\n  options: ImageUploadOptions = {},\r\n  onComplete?: (result: ImageUploadResult) => void\r\n): void => {\r\n  // Compress v√† upload trong background\r\n  (async () => {\r\n    try {\r\n      const compressed = await compressImage(file, 1920, 1080, 0.8, true);\r\n      const result = await uploadImage(compressed, options);\r\n      \r\n      if (onComplete) {\r\n        onComplete(result);\r\n      }\r\n    } catch (error) {\r\n      console.error('Background upload failed:', error);\r\n      if (onComplete) {\r\n        onComplete({\r\n          success: false,\r\n          error: 'Upload th·∫•t b·∫°i: ' + (error as Error).message\r\n        });\r\n      }\r\n    }\r\n  })();\r\n  \r\n  console.log('üì§ Background upload started...');\r\n};\r\n\r\nexport default {\r\n  uploadImage,\r\n  instantUploadImage, // üöÄ NEW: Upload ngay 1-3s\r\n  uploadAvatar,\r\n  uploadQuizCover,\r\n  uploadQuizImage,\r\n  deleteImage,\r\n  getImageUrl,\r\n  compressImage,\r\n  fastUploadImage,\r\n  backgroundUploadImage\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\services\\quizStatsService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\setupTests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\AchievementSystem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":16,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[770,773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[770,773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { RootState } from '../../lib/store';\r\nimport { ROUTES } from '../../config/routes';\r\nimport { signOut } from 'firebase/auth';\r\nimport { auth } from '../../lib/firebase/config';\r\nimport { logout } from '../../features/auth/store';\r\nimport { toast } from 'react-toastify';\r\nimport NotificationCenter from './NotificationCenter';\r\nimport LanguageSwitcher from './LanguageSwitcher';\r\nimport { User, LogOut, Settings, Crown, Zap, Home, BookOpen, Heart, Trophy, UserCircle, Plus, ChevronDown } from 'lucide-react';\r\n\r\ninterface HeaderProps {\r\n  user?: any;\r\n}\r\n\r\nconst Header: React.FC<HeaderProps> = () => {\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const user = useSelector((state: RootState) => state.auth.user);\r\n  const { t } = useTranslation();\r\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n  const [isUserMenuOpen, setIsUserMenuOpen] = useState(false);\r\n  const [scrolled, setScrolled] = useState(false);\r\n  const [prevScrollPos, setPrevScrollPos] = useState(0);\r\n  const [visible, setVisible] = useState(true);\r\n  const userMenuRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Handle scroll effect with hide/show\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      const currentScrollPos = window.scrollY;\r\n      \r\n      // Determine if navbar should be visible\r\n      const isVisible = prevScrollPos > currentScrollPos || currentScrollPos < 10;\r\n      \r\n      setVisible(isVisible);\r\n      setScrolled(currentScrollPos > 10);\r\n      setPrevScrollPos(currentScrollPos);\r\n    };\r\n    \r\n    window.addEventListener('scroll', handleScroll);\r\n    return () => window.removeEventListener('scroll', handleScroll);\r\n  }, [prevScrollPos]);\r\n\r\n  // Close menus when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (userMenuRef.current && !userMenuRef.current.contains(event.target as Node)) {\r\n        setIsUserMenuOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  // Close mobile menu on resize\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      if (window.innerWidth >= 1024) {\r\n        setIsMobileMenuOpen(false);\r\n      }\r\n    };\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await signOut(auth);\r\n      dispatch(logout());\r\n      toast.success('ƒêƒÉng xu·∫•t th√†nh c√¥ng!');\r\n      navigate('/login');\r\n    } catch (error) {\r\n      console.error('Logout error:', error);\r\n      toast.error('C√≥ l·ªói x·∫£y ra khi ƒëƒÉng xu·∫•t');\r\n    }\r\n  };\r\n\r\n  const navigationItems = [\r\n    { path: '/', label: t('nav.home'), icon: Home },\r\n    { path: '/quizzes', label: t('nav.quizzes'), icon: BookOpen },\r\n    { path: '/favorites', label: t('nav.favorites'), icon: Heart },\r\n    { path: '/leaderboard', label: t('nav.leaderboard'), icon: Trophy },\r\n  ];\r\n\r\n  if (user?.role === 'creator' || user?.role === 'admin') {\r\n    navigationItems.push({ path: ROUTES.CREATOR, label: t('nav.creator'), icon: Plus });\r\n  }\r\n\r\n  if (user?.role === 'admin') {\r\n    navigationItems.push({ path: '/admin', label: t('nav.admin'), icon: Settings });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <header \r\n        className={`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${\r\n          visible ? 'translate-y-0' : '-translate-y-full'\r\n        } ${\r\n          scrolled \r\n            ? 'bg-white/95 backdrop-blur-xl shadow-lg border-b border-gray-200/50' \r\n            : 'bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 shadow-xl'\r\n        }`}\r\n      >\r\n        <div className=\"max-w-full mx-auto px-3 sm:px-4 lg:px-6 xl:px-8\">\r\n          <div className=\"flex justify-between items-center h-14 sm:h-16 lg:h-18\">\r\n            {/* Logo & Brand - Compact */}\r\n            <div \r\n              className=\"flex items-center space-x-2 cursor-pointer group z-50 flex-shrink-0\"\r\n              onClick={() => navigate('/')}\r\n            >\r\n              <div className={`w-9 h-9 sm:w-10 sm:h-10 rounded-xl flex items-center justify-center ring-2 shadow-md transition-all duration-500 ${\r\n                scrolled \r\n                  ? 'bg-gradient-to-br from-blue-500 to-purple-600 ring-blue-200 group-hover:ring-blue-300' \r\n                  : 'bg-white/20 backdrop-blur-md ring-white/40 group-hover:ring-white/60'\r\n              } group-hover:scale-110 group-hover:rotate-6`}>\r\n                <Zap className={`w-4 h-4 sm:w-5 sm:h-5 transition-colors duration-300 ${\r\n                  scrolled ? 'text-white' : 'text-white group-hover:text-yellow-200'\r\n                }`} />\r\n              </div>\r\n              <div className=\"group-hover:scale-105 transition-transform duration-300 hidden sm:block\">\r\n                <h1 className={`text-base sm:text-lg lg:text-xl font-bold transition-all duration-300 leading-tight ${\r\n                  scrolled \r\n                    ? 'bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent' \r\n                    : 'text-white'\r\n                }`}>\r\n                  {t('header.appName')}\r\n                </h1>\r\n                <p className={`text-xs hidden lg:block transition-colors duration-300 ${\r\n                  scrolled ? 'text-gray-600' : 'text-blue-100/90'\r\n                }`}>\r\n                  {t('landing.hero.title')} ‚ú®\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Desktop Navigation - Compact icons only on medium screens */}\r\n            {user && (\r\n              <nav className=\"hidden lg:flex items-center space-x-1 flex-1 justify-center max-w-3xl mx-4\">\r\n                {navigationItems.map((item) => {\r\n                  const Icon = item.icon;\r\n                  const isActive = window.location.pathname === item.path;\r\n                  return (\r\n                    <button\r\n                      key={item.path}\r\n                      onClick={() => navigate(item.path)}\r\n                      className={`flex items-center px-3 py-2 rounded-lg font-medium transition-all duration-300 hover:scale-105 ${\r\n                        scrolled\r\n                          ? isActive\r\n                            ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-md'\r\n                            : 'text-gray-700 hover:bg-gray-100'\r\n                          : isActive\r\n                            ? 'bg-white/30 text-white shadow-md ring-1 ring-white/30'\r\n                            : 'text-white/90 hover:text-white hover:bg-white/20'\r\n                      }`}\r\n                    >\r\n                      <Icon className=\"w-4 h-4\" />\r\n                      <span className=\"text-xs xl:text-sm ml-1.5 hidden xl:inline whitespace-nowrap\">{item.label}</span>\r\n                    </button>\r\n                  );\r\n                })}\r\n              </nav>\r\n            )}\r\n\r\n            {/* Right Section - Compact */}\r\n            <div className=\"flex items-center space-x-1.5 sm:space-x-2 z-50 flex-shrink-0\">\r\n              {/* Language Switcher - Compact */}\r\n              <div className=\"hidden sm:block\">\r\n                <LanguageSwitcher variant=\"header\" />\r\n              </div>\r\n\r\n              {/* Notification Center - Compact */}\r\n              {user && (\r\n                <div className=\"hidden sm:block\">\r\n                  <NotificationCenter />\r\n                </div>\r\n              )}\r\n\r\n              {/* User Menu - Compact */}\r\n              {user && (\r\n                <div className=\"relative z-[100]\" ref={userMenuRef}>\r\n                  <button\r\n                    onClick={() => setIsUserMenuOpen(!isUserMenuOpen)}\r\n                    className={`flex items-center space-x-2 rounded-xl px-2 sm:px-3 py-2 transition-all duration-300 shadow-md hover:scale-105 group ${\r\n                      scrolled\r\n                        ? 'bg-gray-100 hover:bg-gray-200 border border-gray-200'\r\n                        : 'bg-white/15 hover:bg-white/25 backdrop-blur-md border border-white/30'\r\n                    }`}\r\n                  >\r\n                    <div className={`w-8 h-8 rounded-full flex items-center justify-center ring-2 shadow-sm transition-all duration-300 ${\r\n                      scrolled\r\n                        ? 'bg-gradient-to-br from-blue-500 to-purple-600 ring-blue-200 group-hover:ring-blue-300'\r\n                        : 'bg-white/30 ring-white/40 group-hover:ring-white/60'\r\n                    }`}>\r\n                      <User className=\"w-4 h-4 text-white\" />\r\n                    </div>\r\n                    <div className=\"hidden lg:block text-left\">\r\n                      <p className={`text-sm font-semibold truncate max-w-24 xl:max-w-32 transition-colors leading-tight ${\r\n                        scrolled ? 'text-gray-900' : 'text-white'\r\n                      }`}>\r\n                        {user?.displayName || user?.email || 'User'}\r\n                      </p>\r\n                      {user?.role && (\r\n                        <p className={`text-xs flex items-center font-medium ${\r\n                          scrolled ? 'text-gray-600' : 'text-blue-100/90'\r\n                        }`}>\r\n                          {user.role === 'admin' && <Crown className=\"w-3 h-3 mr-1 text-yellow-500\" />}\r\n                          {user.role === 'admin' ? t('ui.admin') : \r\n                           user.role === 'creator' ? t('ui.creator') : t('ui.user')}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                    <ChevronDown className={`hidden lg:block w-3.5 h-3.5 transition-transform duration-300 ${\r\n                      isUserMenuOpen ? 'rotate-180' : ''\r\n                    } ${scrolled ? 'text-gray-600' : 'text-white/90'}`} />\r\n                  </button>\r\n\r\n                  {/* User Dropdown - Refined */}\r\n                  {isUserMenuOpen && (\r\n                    <div className=\"absolute right-0 mt-2 w-64 sm:w-72 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden z-[200] animate-in slide-in-from-top-2 duration-200\">\r\n                      {/* User Info Header */}\r\n                      <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 px-4 py-3\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-11 h-11 bg-white/20 backdrop-blur-md rounded-lg flex items-center justify-center ring-2 ring-white/50 shadow-md flex-shrink-0\">\r\n                            <User className=\"w-5 h-5 text-white\" />\r\n                          </div>\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"font-bold text-white text-sm truncate\">{user?.displayName || user?.email}</p>\r\n                            <p className=\"text-xs text-blue-100 truncate\">{user?.email}</p>\r\n                          </div>\r\n                        </div>\r\n                        {user?.role && (\r\n                          <div className=\"mt-2\">\r\n                            <span className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold shadow-sm ${\r\n                              user.role === 'admin' ? 'bg-yellow-400 text-yellow-900' :\r\n                              user.role === 'creator' ? 'bg-green-400 text-green-900' :\r\n                              'bg-gray-400 text-gray-900'\r\n                            }`}>\r\n                              {user.role === 'admin' && <Crown className=\"w-3 h-3 mr-1\" />}\r\n                              {user.role === 'admin' ? t('ui.admin') : \r\n                               user.role === 'creator' ? t('ui.creator') : t('ui.user')}\r\n                            </span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Menu Items */}\r\n                      <div className=\"py-1\">\r\n                        <button\r\n                          onClick={() => {\r\n                            navigate('/profile');\r\n                            setIsUserMenuOpen(false);\r\n                          }}\r\n                          className=\"w-full flex items-center px-4 py-2.5 text-gray-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all duration-200 group\"\r\n                        >\r\n                          <UserCircle className=\"w-4 h-4 mr-2.5 text-blue-600 group-hover:scale-110 transition-transform\" />\r\n                          <span className=\"font-medium text-sm\">{t('profile.myProfile')}</span>\r\n                        </button>\r\n                        <button\r\n                          onClick={() => {\r\n                            handleLogout();\r\n                            setIsUserMenuOpen(false);\r\n                          }}\r\n                          className=\"w-full flex items-center px-4 py-2.5 text-red-600 hover:bg-red-50 transition-all duration-200 group\"\r\n                        >\r\n                          <LogOut className=\"w-4 h-4 mr-2.5 group-hover:scale-110 transition-transform\" />\r\n                          <span className=\"font-medium text-sm\">{t('auth.logout')}</span>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Mobile Menu Button - Compact */}\r\n              {user && (\r\n                <button\r\n                  onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\r\n                  className={`lg:hidden p-2 rounded-lg transition-all duration-300 hover:scale-110 ${\r\n                    scrolled\r\n                      ? 'bg-gray-100 hover:bg-gray-200 text-gray-700'\r\n                      : 'bg-white/10 backdrop-blur-md border border-white/20 text-white hover:bg-white/20'\r\n                  }`}\r\n                  aria-label=\"Toggle menu\"\r\n                >\r\n                  <div className=\"relative w-5 h-5\">\r\n                    <span className={`absolute left-0 w-5 h-0.5 rounded-full transition-all duration-300 ${\r\n                      scrolled ? 'bg-gray-700' : 'bg-white'\r\n                    } ${isMobileMenuOpen ? 'top-2.5 rotate-45' : 'top-1'}`} />\r\n                    <span className={`absolute left-0 top-2.5 w-5 h-0.5 rounded-full transition-all duration-300 ${\r\n                      scrolled ? 'bg-gray-700' : 'bg-white'\r\n                    } ${isMobileMenuOpen ? 'opacity-0' : 'opacity-100'}`} />\r\n                    <span className={`absolute left-0 w-5 h-0.5 rounded-full transition-all duration-300 ${\r\n                      scrolled ? 'bg-gray-700' : 'bg-white'\r\n                    } ${isMobileMenuOpen ? 'top-2.5 -rotate-45' : 'top-4'}`} />\r\n                  </div>\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Mobile Menu Overlay - Refined */}\r\n      {user && isMobileMenuOpen && (\r\n        <>\r\n          <div \r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-[60] lg:hidden animate-in fade-in duration-200\"\r\n            onClick={() => setIsMobileMenuOpen(false)}\r\n          />\r\n          <div className=\"fixed top-14 sm:top-16 left-0 right-0 bg-white shadow-2xl z-[70] lg:hidden animate-in slide-in-from-top-4 duration-300 max-h-[calc(100vh-3.5rem)] sm:max-h-[calc(100vh-4rem)] overflow-y-auto\">\r\n            <nav className=\"py-3 px-3 space-y-1\">\r\n              {navigationItems.map((item) => {\r\n                const Icon = item.icon;\r\n                const isActive = window.location.pathname === item.path;\r\n                return (\r\n                  <button\r\n                    key={item.path}\r\n                    onClick={() => {\r\n                      navigate(item.path);\r\n                      setIsMobileMenuOpen(false);\r\n                    }}\r\n                    className={`w-full flex items-center px-4 py-3 rounded-lg font-medium transition-all duration-200 group ${\r\n                      isActive \r\n                        ? 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-md' \r\n                        : 'text-gray-700 hover:bg-gray-100'\r\n                    }`}\r\n                  >\r\n                    <Icon className=\"w-5 h-5 mr-3 group-hover:scale-110 transition-transform\" />\r\n                    <span className=\"text-sm\">{item.label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n              \r\n              {/* Mobile-only items */}\r\n              <div className=\"pt-3 border-t border-gray-200 space-y-2\">\r\n                <div className=\"sm:hidden px-2 py-2\">\r\n                  <LanguageSwitcher variant=\"header\" />\r\n                </div>\r\n                <div className=\"sm:hidden px-2 py-2\">\r\n                  <NotificationCenter />\r\n                </div>\r\n              </div>\r\n            </nav>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Spacer to prevent content jump */}\r\n      <div className=\"h-14 sm:h-16 lg:h-18\" />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\I18nProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\LanguageSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\NotificationBanner.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":11,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[408,411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[408,411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { collection, getDocs, query, where, orderBy, limit } from 'firebase/firestore';\r\nimport { db } from '../../lib/firebase/config';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../lib/store';\r\n\r\ninterface Notification {\r\n  id: string;\r\n  message: string;\r\n  type: 'info' | 'warning' | 'success' | 'error';\r\n  createdAt: any;\r\n  targetRole?: 'all' | 'user' | 'creator' | 'admin';\r\n  isActive: boolean;\r\n}\r\n\r\nconst NotificationBanner: React.FC = () => {\r\n  const [notification, setNotification] = useState<Notification | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n\r\n  // S·ª≠a l·∫°i useEffect ƒë·ªÉ x·ª≠ l√Ω l·ªói ƒë√∫ng c√°ch\r\n  useEffect(() => {\r\n    // H√†m n√†y ƒë∆∞·ª£c khai b√°o trong useEffect ƒë·ªÉ tr√°nh v·∫•n ƒë·ªÅ v·ªõi React Hooks\r\n    const loadActiveNotification = async () => {\r\n      if (!user) {\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        const notificationsRef = collection(db, 'system_notifications');\r\n        \r\n        const q = query(\r\n          notificationsRef,\r\n          where('isActive', '==', true),\r\n          orderBy('createdAt', 'desc'),\r\n          limit(1)\r\n        );\r\n\r\n        const snapshot = await getDocs(q);\r\n        if (snapshot.empty) {\r\n          setNotification(null);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        let activeNotification = null;\r\n        snapshot.forEach(doc => {\r\n          const data = doc.data() as Notification;\r\n          data.id = doc.id;\r\n          if (\r\n            data.targetRole === 'all' || \r\n            !data.targetRole || \r\n            data.targetRole === user.role\r\n          ) {\r\n            activeNotification = data;\r\n          }\r\n        });\r\n\r\n        setNotification(activeNotification);\r\n      } catch (err) {\r\n        console.error('Error loading notifications:', err);\r\n        setError('Error loading notifications');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadActiveNotification().catch(console.error);\r\n  }, [user]);\r\n\r\n  // Kh√¥ng hi·ªÉn th·ªã g√¨ n·∫øu ƒëang t·∫£i ho·∫∑c kh√¥ng c√≥ th√¥ng b√°o\r\n  if (loading || !notification) return null;\r\n\r\n  // N·∫øu c√≥ l·ªói, c√≥ th·ªÉ hi·ªÉn th·ªã m·ªôt th√¥ng b√°o l·ªói ho·∫∑c kh√¥ng hi·ªÉn th·ªã g√¨\r\n  if (error) {\r\n    console.error('NotificationBanner error:', error);\r\n    return null;\r\n  }\r\n\r\n  // X√°c ƒë·ªãnh m√†u s·∫Øc d·ª±a tr√™n lo·∫°i th√¥ng b√°o\r\n  const getBgColor = () => {\r\n    switch (notification.type) {\r\n      case 'info': return 'bg-blue-100 border-blue-500 text-blue-800';\r\n      case 'warning': return 'bg-yellow-100 border-yellow-500 text-yellow-800';\r\n      case 'success': return 'bg-green-100 border-green-500 text-green-800';\r\n      case 'error': return 'bg-red-100 border-red-500 text-red-800';\r\n      default: return 'bg-gray-100 border-gray-500 text-gray-800';\r\n    }\r\n  };\r\n\r\n  // Th√™m h√†m getButtonColor\r\n  const getButtonColor = () => {\r\n    switch (notification?.type) {\r\n      case 'info': return 'text-blue-800 hover:text-blue-600';\r\n      case 'warning': return 'text-yellow-800 hover:text-yellow-600';\r\n      case 'success': return 'text-green-800 hover:text-green-600';\r\n      case 'error': return 'text-red-800 hover:text-red-600';\r\n      default: return 'text-gray-800 hover:text-gray-600';\r\n    }\r\n  };\r\n\r\n  // S·ª≠a l·∫°i n√∫t ƒë√≥ng ƒë·ªÉ s·ª≠ d·ª•ng m√†u ch·ªØ ph√π h·ª£p\r\n  return (\r\n    <div className={`fixed top-0 left-0 right-0 z-50 p-4 border-l-4 ${getBgColor()} w-full shadow-md`}>\r\n      <div className=\"max-w-5xl mx-auto flex justify-between items-center\">\r\n        <p className=\"font-medium\">{notification.message}</p>\r\n        <button \r\n          onClick={() => setNotification(null)}\r\n          className={`ml-4 font-bold text-xl ${getButtonColor()} hover:scale-110 transition-transform`}\r\n          aria-label=\"ƒê√≥ng th√¥ng b√°o\"\r\n        >\r\n          &times;\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationBanner;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\PopularQuizzesRanking.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\QuickReviewSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\QuizReviewSystem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\RoleBasedRedirect.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ScrollToTop.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\SearchComponent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\layout\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\layout\\Loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\layout\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\layout\\Unauthorized.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\AudioPlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\ConfirmDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\ImageViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\Input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\LoadingSpinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\PDFViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\PasswordModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\QuizPasswordModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\RichTextEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\RichTextViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\SafeHTML.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\ShareLinkModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\YouTubePlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\Creator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\Dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\Home.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1589,1592],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1589,1592],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { RootState } from '../../lib/store';\r\nimport { ROUTES } from '../../config/routes';\r\nimport { fetchQuizzes } from '../../features/quiz/store';\r\nimport { Quiz } from '../../features/quiz/types';\r\nimport QuizCard from '../../features/quiz/components/QuizCard';\r\nimport Button from '../components/ui/Button';\r\nimport PopularQuizzesRanking from '../components/PopularQuizzesRanking';\r\nimport { collection, getDocs, query, where } from 'firebase/firestore';\r\nimport { db } from '../../lib/firebase/config';\r\n\r\nimport { useTranslation } from 'react-i18next';\r\n// **TH√äM M·ªöI**: Dashboard stats interface\r\ninterface DashboardStats {\r\n  totalQuizzes: number;\r\n  totalUsers: number;\r\n  completedQuizzes: number;\r\n  totalCreators: number;\r\n}\r\n\r\nconst Home: React.FC = () => {\r\n  const { t } = useTranslation();\r\n\r\n  const dispatch = useDispatch();\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n  const { quizzes, loading } = useSelector((state: RootState) => state.quiz);\r\n  \r\n  // **TH√äM M·ªöI**: Dashboard stats state v·ªõi d·ªØ li·ªáu th·∫≠t\r\n  const [stats, setStats] = useState<DashboardStats>({\r\n    totalQuizzes: 0,\r\n    totalUsers: 0,\r\n    completedQuizzes: 0,\r\n    totalCreators: 0\r\n  });\r\n\r\n  const [featuredQuizzes, setFeaturedQuizzes] = useState<Quiz[]>([]);\r\n  const [statsLoading, setStatsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (quizzes.length === 0) {\r\n      dispatch(fetchQuizzes({ user }) as any);\r\n    }\r\n    loadRealStats();\r\n  }, [dispatch, user, quizzes.length]);\r\n\r\n  const loadRealStats = async () => {\r\n    try {\r\n      setStatsLoading(true);\r\n      \r\n      // L·∫•y d·ªØ li·ªáu th·ª±c t·ª´ Firebase - CH·ªà QUIZ APPROVED\r\n      const [quizzesSnapshot, usersSnapshot] = await Promise.all([\r\n        getDocs(query(collection(db, 'quizzes'), where('status', '==', 'approved'))),\r\n        getDocs(collection(db, 'users'))\r\n      ]);\r\n      \r\n      // ƒê·∫øm ch·ªâ users ACTIVE (kh√¥ng b·ªã xo√° v√† isActive = true)\r\n      const users = usersSnapshot.docs.map(doc => doc.data());\r\n      const activeUsers = users.filter(user => \r\n        user.isActive !== false && \r\n        user.isDeleted !== true\r\n      );\r\n      \r\n      // ƒê·∫øm creators trong s·ªë users ACTIVE\r\n      const creators = activeUsers.filter(user => \r\n        user.role === 'creator' || user.role === 'admin'\r\n      );\r\n      \r\n      // Quiz ho√†n th√†nh t·∫°m th·ªùi = 0 v√¨ ch∆∞a c√≥ data v·ªÅ quiz results\r\n      const completedQuizzes = 0;\r\n      \r\n      setStats({\r\n        totalQuizzes: quizzesSnapshot.size,\r\n        totalUsers: activeUsers.length, // CH·ªà ƒê·∫æM USERS HO·∫†T ƒê·ªòNG\r\n        completedQuizzes: completedQuizzes,\r\n        totalCreators: creators.length // CH·ªà ƒê·∫æM CREATORS HO·∫†T ƒê·ªòNG\r\n      });\r\n      \r\n    } catch (error) {\r\n      console.error('Error loading real stats:', error);\r\n    } finally {\r\n      setStatsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (quizzes.length > 0) {\r\n      // **TH√äM M·ªöI**: Set featured quizzes (trending/popular)\r\n      const trending = quizzes\r\n        .filter(q => q.isPublic)\r\n        .sort((a, b) => (b.attempts || 0) - (a.attempts || 0))\r\n        .slice(0, 6);\r\n      setFeaturedQuizzes(trending);\r\n    }\r\n  }, [quizzes]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-96\">\r\n        {Array.from({length: 4}).map((_,i) => (\r\n          <div key={i} className=\"animate-pulse bg-white rounded-xl shadow-lg h-40 w-80 m-4\" />\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Hero Section */}\r\n      <div className=\"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 rounded-3xl p-8 lg:p-12 text-white shadow-2xl relative overflow-hidden\">\r\n        {/* Background Pattern */}\r\n        <div className=\"absolute inset-0 bg-white/5 backdrop-blur-3xl\"></div>\r\n        <div className=\"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32\"></div>\r\n        <div className=\"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-24 -translate-x-24\"></div>\r\n        \r\n        <div className=\"relative max-w-5xl\">\r\n          <div className=\"flex items-center mb-6\">\r\n            <div className=\"w-16 h-16 lg:w-20 lg:h-20 bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center ring-4 ring-white/30 shadow-2xl mr-6\">\r\n              <span className=\"text-3xl lg:text-4xl\">üéØ</span>\r\n            </div>\r\n            <div>\r\n              <h1 className=\"text-3xl lg:text-5xl font-bold mb-2 drop-shadow-lg\">\r\n                {t('home.hero.welcome', { name: user?.displayName?.split(' ')[0] || 'Quiz Master' })}\r\n              </h1>\r\n              <p className=\"text-blue-100 text-lg lg:text-xl\">\r\n                {t('home.hero.subtitle')}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          \r\n          <p className=\"text-xl lg:text-2xl text-blue-100 mb-8 leading-relaxed\">\r\n            {t('home.hero.description')}\r\n          </p>\r\n          \r\n          <div className=\"flex flex-col sm:flex-row gap-4 lg:gap-6\">\r\n            <Link to=\"/quizzes\">\r\n              <Button className=\"w-full sm:w-auto bg-white text-blue-600 hover:bg-blue-50 font-bold px-8 py-4 text-lg rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105\">\r\n                <span className=\"mr-2\">üìö</span>{t(\"quizList.exploreQuizzes\")}\r\n              </Button>\r\n            </Link>\r\n            <Link to=\"/multiplayer\">\r\n              <Button className=\"w-full sm:w-auto bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 font-bold px-8 py-4 text-lg rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 ring-2 ring-white/50\">\r\n                <span className=\"mr-2\">üéÆ</span>{t('home.playMultiplayer')}\r\n              </Button>\r\n            </Link>\r\n            <Link to={ROUTES.CREATOR}>\r\n              <Button className=\"w-full sm:w-auto border-2 border-white text-white hover:bg-white hover:text-blue-600 font-bold px-8 py-4 text-lg rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105\">\r\n                <span className=\"mr-2\">‚ú®</span>{t(\"creator.createNewQuiz\")}\r\n              </Button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* **TH√äM M·ªöI**: Dashboard Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <div className=\"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100 group hover:border-blue-200\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-gray-600 text-sm font-medium mb-2\">{t(\"dashboard.totalQuizzes\")}</p>\r\n              <p className=\"text-3xl font-bold text-gray-900\">\r\n                {statsLoading ? '...' : stats.totalQuizzes}\r\n              </p>\r\n              <p className=\"text-xs text-green-600 font-medium mt-1\">{t('home.stats.realData')}</p>\r\n            </div>\r\n            <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n              <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100 group hover:border-green-200\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-gray-600 text-sm font-medium mb-2\">{t(\"admin.tabs.users\")}</p>\r\n              <p className=\"text-3xl font-bold text-gray-900\">\r\n                {statsLoading ? '...' : stats.totalUsers}\r\n              </p>\r\n              <p className=\"text-xs text-green-600 font-medium mt-1\">{t('home.stats.registered')}</p>\r\n            </div>\r\n            <div className=\"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n              <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100 group hover:border-purple-200\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-gray-600 text-sm font-medium mb-2\">{t(\"dashboard.completedQuizzes\")}</p>\r\n              <p className=\"text-3xl font-bold text-gray-900\">\r\n                {statsLoading ? '...' : stats.completedQuizzes}\r\n              </p>\r\n              <p className=\"text-xs text-purple-600 font-medium mt-1\">{t('home.stats.pending')}</p>\r\n            </div>\r\n            <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n              <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100 group hover:border-yellow-200\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-gray-600 text-sm font-medium mb-2\">{t(\"admin.quizManagement.table.creator\")}</p>\r\n              <p className=\"text-3xl font-bold text-gray-900\">\r\n                {statsLoading ? '...' : stats.totalCreators}\r\n              </p>\r\n              <p className=\"text-xs text-yellow-600 font-medium mt-1\">{t('home.stats.creatorsAndAdmins')}</p>\r\n            </div>\r\n            <div className=\"bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-2xl p-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n              <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* **TH√äM M·ªöI**: Featured/Trending Quizzes */}\r\n      {featuredQuizzes.length > 0 && (\r\n        <div className=\"bg-white rounded-3xl shadow-xl p-8 border border-gray-100\">\r\n          <div className=\"flex items-center justify-between mb-8\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl flex items-center justify-center mr-4 shadow-lg\">\r\n                <span className=\"text-2xl\">üî•</span>\r\n              </div>\r\n              <div>\r\n                <h2 className=\"text-2xl lg:text-3xl font-bold text-gray-900\">{t('home.trending.title')}</h2>\r\n                <p className=\"text-gray-600\">{t('home.trending.subtitle')}</p>\r\n              </div>\r\n            </div>\r\n            <Link \r\n              to=\"/quizzes\" \r\n              className=\"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-2xl font-semibold hover:from-orange-600 hover:to-red-600 transition-all duration-300 flex items-center shadow-lg hover:shadow-xl transform hover:scale-105\"\r\n            >\r\n              <span>{t('home.trending.viewAll')}</span>\r\n              <svg className=\"w-5 h-5 ml-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\r\n              </svg>\r\n            </Link>\r\n          </div>\r\n          \r\n          {featuredQuizzes.length > 0 ? (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 lg:gap-8\">\r\n              {featuredQuizzes.map((quiz) => (\r\n                <div key={quiz.id} className=\"transform hover:scale-105 transition-all duration-300\">\r\n                  <QuizCard quiz={quiz} />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <div className=\"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6\">\r\n                <span className=\"text-4xl\">üìù</span>\r\n              </div>\r\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-3\">{t('home.trending.noQuizzes')}</h3>\r\n              <p className=\"text-gray-600 mb-6\">{t('home.trending.createFirst')}</p>\r\n              <Link to={ROUTES.CREATOR}>\r\n                <Button className=\"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-2xl font-semibold hover:from-blue-700 hover:to-indigo-700 transition-all duration-300\">\r\n                  {t('home.trending.createNow')}\r\n                </Button>\r\n              </Link>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* **TH√äM M·ªöI**: Quick Actions */}\r\n      <div className=\"bg-white rounded-3xl shadow-xl p-8 border border-gray-100\">\r\n        <div className=\"flex items-center mb-8\">\r\n          <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mr-4 shadow-lg\">\r\n            <span className=\"text-2xl\">‚ö°</span>\r\n          </div>\r\n          <div>\r\n            <h2 className=\"text-2xl lg:text-3xl font-bold text-gray-900\">{t('home.quickActions.title')}</h2>\r\n            <p className=\"text-gray-600\">{t('home.quickActions.subtitle')}</p>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <Link \r\n            to={ROUTES.CREATOR}\r\n            className=\"group bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 rounded-2xl p-8 transition-all duration-300 transform hover:scale-105 hover:shadow-xl border border-blue-200\"\r\n          >\r\n            <div className=\"text-blue-600 mb-6 group-hover:scale-110 transition-transform duration-300\">\r\n              <svg className=\"w-14 h-14\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-xl font-bold text-gray-900 mb-3\">{t(\"creator.createNewQuiz\")}</h3>\r\n            <p className=\"text-gray-600 leading-relaxed\">{t('home.quickActions.createDescription')}</p>\r\n            <div className=\"mt-4 text-blue-600 font-semibold group-hover:translate-x-1 transition-transform duration-300 flex items-center\">\r\n              {t('home.quickActions.startCreating')} <span className=\"ml-2\">‚Üí</span>\r\n            </div>\r\n          </Link>\r\n          \r\n          <Link \r\n            to=\"/quizzes?filter=random\" \r\n            className=\"group bg-gradient-to-br from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 rounded-2xl p-8 transition-all duration-300 transform hover:scale-105 hover:shadow-xl border border-green-200\"\r\n          >\r\n            <div className=\"text-green-600 mb-6 group-hover:scale-110 transition-transform duration-300\">\r\n              <svg className=\"w-14 h-14\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-xl font-bold text-gray-900 mb-3\">{t('home.quickActions.randomQuiz')}</h3>\r\n            <p className=\"text-gray-600 leading-relaxed\">{t('home.quickActions.randomDescription')}</p>\r\n            <div className=\"mt-4 text-green-600 font-semibold group-hover:translate-x-1 transition-transform duration-300 flex items-center\">\r\n              {t('home.quickActions.playNow')} <span className=\"ml-2\">‚Üí</span>\r\n            </div>\r\n          </Link>\r\n          \r\n          <Link \r\n            to=\"/profile\" \r\n            className=\"group bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 rounded-2xl p-8 transition-all duration-300 transform hover:scale-105 hover:shadow-xl border border-purple-200\"\r\n          >\r\n            <div className=\"text-purple-600 mb-6 group-hover:scale-110 transition-transform duration-300\">\r\n              <svg className=\"w-14 h-14\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-xl font-bold text-gray-900 mb-3\">{t('home.quickActions.viewProgress')}</h3>\r\n            <p className=\"text-gray-600 leading-relaxed\">{t('home.quickActions.progressDescription')}</p>\r\n            <div className=\"mt-4 text-purple-600 font-semibold group-hover:translate-x-1 transition-transform duration-300 flex items-center\">\r\n              {t(\"viewDetails\")} <span className=\"ml-2\">‚Üí</span>\r\n            </div>\r\n          </Link>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Popular Quizzes Section */}\r\n      <div className=\"bg-white rounded-3xl shadow-xl p-8 border border-gray-100\">\r\n        <div className=\"flex items-center mb-8\">\r\n          <div className=\"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center mr-4 shadow-lg\">\r\n            <span className=\"text-2xl\">üèÜ</span>\r\n          </div>\r\n          <div>\r\n            <h2 className=\"text-2xl lg:text-3xl font-bold text-gray-900\">{t('home.popular.title')}</h2>\r\n            <p className=\"text-gray-600\">{t('home.popular.subtitle')}</p>\r\n          </div>\r\n        </div>\r\n        <PopularQuizzesRanking />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\LandingPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\pages\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\shared\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\tests\\testStorageUpload.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1738,1741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1738,1741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Test Firebase Storage Upload\r\n * Ch·∫°y script n√†y ƒë·ªÉ test upload PDF/Video/Audio\r\n */\r\n\r\nimport { storage } from '../lib/firebase/config';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\n\r\nasync function testStorageUpload() {\r\n  console.log('üß™ Testing Firebase Storage Upload...\\n');\r\n\r\n  try {\r\n    // Test 1: Create a test text file\r\n    console.log('üìù Test 1: Creating test file...');\r\n    const testContent = 'This is a test file for Firebase Storage';\r\n    const testBlob = new Blob([testContent], { type: 'text/plain' });\r\n    const testFile = new File([testBlob], 'test.txt', { type: 'text/plain' });\r\n\r\n    // Test 2: Upload to Storage\r\n    console.log('‚¨ÜÔ∏è Test 2: Uploading to learning-resources/pdfs/test/...');\r\n    const timestamp = Date.now();\r\n    const storagePath = `learning-resources/pdfs/test_${timestamp}/test.txt`;\r\n    const storageRef = ref(storage, storagePath);\r\n\r\n    const metadata = {\r\n      contentType: 'text/plain',\r\n      customMetadata: {\r\n        uploadedBy: 'test-script',\r\n        uploadedAt: new Date().toISOString()\r\n      }\r\n    };\r\n\r\n    await uploadBytes(storageRef, testFile, metadata);\r\n    console.log('‚úÖ Upload successful!');\r\n\r\n    // Test 3: Get download URL\r\n    console.log('üîó Test 3: Getting download URL...');\r\n    const downloadURL = await getDownloadURL(storageRef);\r\n    console.log('‚úÖ Download URL:', downloadURL);\r\n\r\n    console.log('\\n‚úÖ ALL TESTS PASSED!');\r\n    console.log('\\nüìä Summary:');\r\n    console.log('  ‚úì Firebase Storage initialized');\r\n    console.log('  ‚úì File upload working');\r\n    console.log('  ‚úì Download URL generation working');\r\n    console.log('  ‚úì Storage Rules allowing uploads');\r\n    \r\n    return true;\r\n  } catch (error: any) {\r\n    console.error('\\n‚ùå TEST FAILED:', error.message);\r\n    console.error('\\nüîç Error details:', error);\r\n    \r\n    if (error.code === 'storage/unauthorized') {\r\n      console.error('\\n‚ö†Ô∏è PERMISSION DENIED - Storage Rules ch∆∞a deploy ho·∫∑c ch∆∞a ƒë√∫ng!');\r\n      console.error('   Gi·∫£i ph√°p:');\r\n      console.error('   1. Ch·∫°y: firebase deploy --only storage');\r\n      console.error('   2. Ho·∫∑c deploy qua Firebase Console');\r\n      console.error('   3. ƒê·ª£i 30s cho rules c√≥ hi·ªáu l·ª±c');\r\n    }\r\n    \r\n    return false;\r\n  }\r\n}\r\n\r\n// Run test if this file is executed directly\r\nif (typeof window !== 'undefined') {\r\n  console.log('‚ö†Ô∏è Ch·∫°y test n√†y trong browser console:');\r\n  console.log('import(\"./src/tests/testStorageUpload\").then(m => m.default())');\r\n}\r\n\r\nexport default testStorageUpload;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\utils\\htmlUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\utils\\initializeCategories.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"D:\\Thuctap_WebQuiz\\QuizTrivia-App\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]