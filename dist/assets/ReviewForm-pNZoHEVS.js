import{u as e,r as s,j as t,S as n,y as a,b as i}from"./index-BslwS0KI.js";import{X as l}from"./x-D2adGNFK.js";import{S as r}from"./send-B9CkmnIi.js";const c=({quizId:c,onReviewSubmitted:o,onClose:h,existingReview:d})=>{const{user:x}=e(e=>e.auth),[m,g]=s.useState((null==d?void 0:d.rating)||0),[u,b]=s.useState((null==d?void 0:d.comment)||""),[p,y]=s.useState(!1);return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d?"Chỉnh sửa đánh giá":"Viết đánh giá"}),t.jsx("button",{onClick:h,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:t.jsx(l,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),x)if(0!==m){y(!0);try{d?(await i.updateReview(d.id,{rating:m,comment:u}),a.success("Cập nhật đánh giá thành công!")):(await i.createReview({quizId:c,rating:m,comment:u},x.uid,x.displayName||x.email||""),a.success("Gửi đánh giá thành công!")),o()}catch(s){a.error("Có lỗi khi gửi đánh giá")}finally{y(!1)}}else a.error("Vui lòng chọn số sao");else a.error("Bạn cần đăng nhập để đánh giá")},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Đánh giá của bạn"}),t.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>t.jsx("button",{type:"button",onClick:()=>g(e),className:"p-1 transition-colors "+(e<=m?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"),children:t.jsx(n,{className:"w-8 h-8 "+(e<=m?"fill-current":"")})},e))}),m>0&&t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[1===m&&"Rất không hài lòng",2===m&&"Không hài lòng",3===m&&"Bình thường",4===m&&"Hài lòng",5===m&&"Rất hài lòng"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhận xét (tùy chọn)"}),t.jsx("textarea",{value:u,onChange:e=>b(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Chia sẻ trải nghiệm của bạn về quiz này...",maxLength:500}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u.length,"/500 ký tự"]})]}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Hủy"}),t.jsx("button",{type:"submit",disabled:p||0===m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{children:"Đang gửi..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(r,{className:"w-4 h-4"}),t.jsx("span",{children:d?"Cập nhật":"Gửi đánh giá"})]})})]})]})]})})})};export{c as R};
