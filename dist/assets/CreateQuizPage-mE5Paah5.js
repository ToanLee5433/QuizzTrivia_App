import{e as ln,j as r,B as Bn,S as _n,C as Gn,r as d,R as U,Y as Oe,v as Y,y as ae,Z as bt,X as zn,u as Xn,$ as Vn,V as Kn,h as Hn,a0 as Gt}from"./index-BSJrQLtH.js";import{F as Le,T as zt}from"./tag-M4_GsJT1.js";import{L as Yn}from"./loader-BEpQPyWc.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ft=ln("image",Wn);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Xt=ln("upload",Qn),Vt={title:"",description:"",category:"programming",difficulty:"easy",duration:15,imageUrl:"",questions:[],tags:[],allowRetake:!1},Jn=[{value:"programming",label:"Lập trình"},{value:"math",label:"Toán học"},{value:"science",label:"Khoa học"},{value:"history",label:"Lịch sử"},{value:"language",label:"Ngôn ngữ"},{value:"general",label:"Tổng hợp"}],Zn=[{value:"easy",label:"Dễ"},{value:"medium",label:"Trung bình"},{value:"hard",label:"Khó"}],Ze=["Thông tin Quiz","Câu hỏi","Xem lại & Xuất bản"];function ee(){return Math.random().toString(36).substr(2,9)}const qn=({quiz:e,setQuiz:t})=>{var n;return r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto",children:r.jsx(Bn,{className:"w-8 h-8 text-white"})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Thông tin cơ bản"}),r.jsx("p",{className:"text-gray-600",children:"Điền thông tin để tạo quiz của bạn"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(Le,{className:"w-4 h-4"}),"Tiêu đề quiz *"]}),r.jsx("input",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-lg",placeholder:"Nhập tiêu đề thu hút cho quiz của bạn...",value:e.title,onChange:s=>t(i=>({...i,title:s.target.value}))})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(Le,{className:"w-4 h-4"}),"Mô tả quiz *"]}),r.jsx("textarea",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none",placeholder:"Mô tả ngắn gọn về nội dung quiz...",rows:4,value:e.description,onChange:s=>t(i=>({...i,description:s.target.value}))})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(zt,{className:"w-4 h-4"}),"Danh mục *"]}),r.jsxs("select",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:e.category,onChange:s=>t(i=>({...i,category:s.target.value})),children:[r.jsx("option",{value:"",children:"Chọn danh mục"}),Jn.map(s=>r.jsx("option",{value:s.value,children:s.label},s.value))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(_n,{className:"w-4 h-4"}),"Độ khó *"]}),r.jsxs("select",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:e.difficulty,onChange:s=>t(i=>({...i,difficulty:s.target.value})),children:[r.jsx("option",{value:"",children:"Chọn độ khó"}),Zn.map(s=>r.jsx("option",{value:s.value,children:s.label},s.value))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(Gn,{className:"w-4 h-4"}),"Thời gian (phút) *"]}),r.jsx("input",{type:"number",className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",min:5,max:120,value:e.duration,onChange:s=>t(i=>({...i,duration:parseInt(s.target.value)||15})),placeholder:"15"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Từ 5 đến 120 phút"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(zt,{className:"w-4 h-4"}),"Tags (tùy chọn)"]}),r.jsx("input",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Nhập tags, cách nhau bằng dấu phẩy...",value:((n=e.tags)==null?void 0:n.join(", "))||"",onChange:s=>t(i=>({...i,tags:s.target.value.split(",").map(o=>o.trim()).filter(o=>o)}))}),r.jsx("p",{className:"text-sm text-gray-500",children:"Ví dụ: javascript, react, frontend"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[r.jsx(Le,{className:"w-4 h-4"}),"Hình ảnh minh họa (tùy chọn)"]}),r.jsx("input",{className:"w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Nhập URL hình ảnh...",value:e.imageUrl||"",onChange:s=>t(i=>({...i,imageUrl:s.target.value}))})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-2xl border border-blue-200",children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"📋 Xem trước thông tin quiz"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Tiêu đề:"})," ",e.title||"Chưa có tiêu đề"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Mô tả:"})," ",e.description||"Chưa có mô tả"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Danh mục:"})," ",e.category||"Chưa chọn"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Độ khó:"})," ",e.difficulty||"Chưa chọn"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Thời gian:"})," ",e.duration," phút"]}),e.tags&&e.tags.length>0&&r.jsxs("p",{children:[r.jsx("strong",{children:"Tags:"})," ",e.tags.join(", ")]}),e.imageUrl&&r.jsxs("div",{className:"mt-3",children:[r.jsx("p",{children:r.jsx("strong",{children:"Hình ảnh:"})}),r.jsx("img",{src:e.imageUrl,alt:"Preview",className:"mt-2 w-32 h-20 object-cover rounded-lg"})]})]})]})]})};function er(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>s=>{t.forEach(i=>i(s))},t)}const ot=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ce(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Nt(e){return"nodeType"in e}function F(e){var t,n;return e?Ce(e)?e:Nt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function St(e){const{Document:t}=F(e);return e instanceof t}function ze(e){return Ce(e)?!1:e instanceof F(e).HTMLElement}function cn(e){return e instanceof F(e).SVGElement}function Ne(e){return e?Ce(e)?e.document:Nt(e)?St(e)?e:ze(e)||cn(e)?e.ownerDocument:document:document:document}const te=ot?d.useLayoutEffect:d.useEffect;function Dt(e){const t=d.useRef(e);return te(()=>{t.current=e}),d.useCallback(function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t.current==null?void 0:t.current(...s)},[])}function tr(){const e=d.useRef(null),t=d.useCallback((s,i)=>{e.current=setInterval(s,i)},[]),n=d.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Fe(e,t){t===void 0&&(t=[e]);const n=d.useRef(e);return te(()=>{n.current!==e&&(n.current=e)},t),n}function Xe(e,t){const n=d.useRef();return d.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function nt(e){const t=Dt(e),n=d.useRef(null),s=d.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,s]}function vt(e){const t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}let gt={};function Ve(e,t){return d.useMemo(()=>{if(t)return t;const n=gt[e]==null?0:gt[e]+1;return gt[e]=n,e+"-"+n},[e,t])}function dn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((o,l)=>{const c=Object.entries(l);for(const[u,p]of c){const g=o[u];g!=null&&(o[u]=g+e*p)}return o},{...t})}}const je=dn(1),Be=dn(-1);function nr(e){return"clientX"in e&&"clientY"in e}function Rt(e){if(!e)return!1;const{KeyboardEvent:t}=F(e.target);return t&&e instanceof t}function rr(e){if(!e)return!1;const{TouchEvent:t}=F(e.target);return t&&e instanceof t}function yt(e){if(rr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return nr(e)?{x:e.clientX,y:e.clientY}:null}const _e=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[_e.Translate.toString(e),_e.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Kt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function sr(e){return e.matches(Kt)?e:e.querySelector(Kt)}const ir={display:"none"};function or(e){let{id:t,value:n}=e;return U.createElement("div",{id:t,style:ir},n)}function ar(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return U.createElement("div",{id:t,style:i,role:"status","aria-live":s,"aria-atomic":!0},n)}function lr(){const[e,t]=d.useState("");return{announce:d.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const un=d.createContext(null);function cr(e){const t=d.useContext(un);d.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function dr(){const[e]=d.useState(()=>new Set),t=d.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[d.useCallback(s=>{let{type:i,event:o}=s;e.forEach(l=>{var c;return(c=l[i])==null?void 0:c.call(l,o)})},[e]),t]}const ur={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},hr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function fr(e){let{announcements:t=hr,container:n,hiddenTextDescribedById:s,screenReaderInstructions:i=ur}=e;const{announce:o,announcement:l}=lr(),c=Ve("DndLiveRegion"),[u,p]=d.useState(!1);if(d.useEffect(()=>{p(!0)},[]),cr(d.useMemo(()=>({onDragStart(a){let{active:h}=a;o(t.onDragStart({active:h}))},onDragMove(a){let{active:h,over:f}=a;t.onDragMove&&o(t.onDragMove({active:h,over:f}))},onDragOver(a){let{active:h,over:f}=a;o(t.onDragOver({active:h,over:f}))},onDragEnd(a){let{active:h,over:f}=a;o(t.onDragEnd({active:h,over:f}))},onDragCancel(a){let{active:h,over:f}=a;o(t.onDragCancel({active:h,over:f}))}}),[o,t])),!u)return null;const g=U.createElement(U.Fragment,null,U.createElement(or,{id:s,value:i.draggable}),U.createElement(ar,{id:c,announcement:l}));return n?Oe.createPortal(g,n):g}var T;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(T||(T={}));function rt(){}function Ht(e,t){return d.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function gr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Q=Object.freeze({x:0,y:0});function hn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function fn(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function pr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Yt(e){let{left:t,top:n,height:s,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+s},{x:t+i,y:n+s}]}function gn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Wt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const mr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=Wt(t,t.left,t.top),o=[];for(const l of s){const{id:c}=l,u=n.get(c);if(u){const p=hn(Wt(u),i);o.push({id:c,data:{droppableContainer:l,value:p}})}}return o.sort(fn)},xr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=Yt(t),o=[];for(const l of s){const{id:c}=l,u=n.get(c);if(u){const p=Yt(u),g=i.reduce((h,f,y)=>h+hn(p[y],f),0),a=Number((g/4).toFixed(4));o.push({id:c,data:{droppableContainer:l,value:a}})}}return o.sort(fn)};function br(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),l=i-s,c=o-n;if(s<i&&n<o){const u=t.width*t.height,p=e.width*e.height,g=l*c,a=g/(u+p-g);return Number(a.toFixed(4))}return 0}const vr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const u=br(c,t);u>0&&i.push({id:l,data:{droppableContainer:o,value:u}})}}return i.sort(pr)};function yr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function pn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Q}function wr(e){return function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return i.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const jr=wr(1);function Cr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Nr(e,t,n){const s=Cr(t);if(!s)return e;const{scaleX:i,scaleY:o,x:l,y:c}=s,u=e.left-l-(1-i)*parseFloat(n),p=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),g=i?e.width/i:e.width,a=o?e.height/o:e.height;return{width:g,height:a,top:p,right:u+g,bottom:p+a,left:u}}const Sr={ignoreTransform:!1};function Se(e,t){t===void 0&&(t=Sr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:p,transformOrigin:g}=F(e).getComputedStyle(e);p&&(n=Nr(n,p,g))}const{top:s,left:i,width:o,height:l,bottom:c,right:u}=n;return{top:s,left:i,width:o,height:l,bottom:c,right:u}}function Qt(e){return Se(e,{ignoreTransform:!0})}function Dr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Rr(e,t){return t===void 0&&(t=F(e).getComputedStyle(e)),t.position==="fixed"}function Ar(e,t){t===void 0&&(t=F(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=t[i];return typeof o=="string"?n.test(o):!1})}function at(e,t){const n=[];function s(i){if(t!=null&&n.length>=t||!i)return n;if(St(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!ze(i)||cn(i)||n.includes(i))return n;const o=F(e).getComputedStyle(i);return i!==e&&Ar(i,o)&&n.push(i),Rr(i,o)?n:s(i.parentNode)}return e?s(e):n}function mn(e){const[t]=at(e,1);return t??null}function pt(e){return!ot||!e?null:Ce(e)?e:Nt(e)?St(e)||e===Ne(e).scrollingElement?window:ze(e)?e:null:null}function xn(e){return Ce(e)?e.scrollX:e.scrollLeft}function bn(e){return Ce(e)?e.scrollY:e.scrollTop}function wt(e){return{x:xn(e),y:bn(e)}}var M;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(M||(M={}));function vn(e){return!ot||!e?!1:e===document.scrollingElement}function yn(e){const t={x:0,y:0},n=vn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:i,isLeft:o,isBottom:l,isRight:c,maxScroll:s,minScroll:t}}const Ir={x:.2,y:.2};function Er(e,t,n,s,i){let{top:o,left:l,right:c,bottom:u}=n;s===void 0&&(s=10),i===void 0&&(i=Ir);const{isTop:p,isBottom:g,isLeft:a,isRight:h}=yn(e),f={x:0,y:0},y={x:0,y:0},m={height:t.height*i.y,width:t.width*i.x};return!p&&o<=t.top+m.height?(f.y=M.Backward,y.y=s*Math.abs((t.top+m.height-o)/m.height)):!g&&u>=t.bottom-m.height&&(f.y=M.Forward,y.y=s*Math.abs((t.bottom-m.height-u)/m.height)),!h&&c>=t.right-m.width?(f.x=M.Forward,y.x=s*Math.abs((t.right-m.width-c)/m.width)):!a&&l<=t.left+m.width&&(f.x=M.Backward,y.x=s*Math.abs((t.left+m.width-l)/m.width)),{direction:f,speed:y}}function kr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:l}=window;return{top:0,left:0,right:o,bottom:l,width:o,height:l}}const{top:t,left:n,right:s,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:i,width:e.clientWidth,height:e.clientHeight}}function wn(e){return e.reduce((t,n)=>je(t,wt(n)),Q)}function Tr(e){return e.reduce((t,n)=>t+xn(n),0)}function Mr(e){return e.reduce((t,n)=>t+bn(n),0)}function Or(e,t){if(t===void 0&&(t=Se),!e)return;const{top:n,left:s,bottom:i,right:o}=t(e);mn(e)&&(i<=0||o<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Lr=[["x",["left","right"],Tr],["y",["top","bottom"],Mr]];class At{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=at(n),i=wn(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,l,c]of Lr)for(const u of l)Object.defineProperty(this,u,{get:()=>{const p=c(s),g=i[o]-p;return this.rect[u]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class $e{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var i;(i=this.target)==null||i.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function $r(e){const{EventTarget:t}=F(e);return e instanceof t?e:Ne(e)}function mt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var W;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(W||(W={}));function Jt(e){e.preventDefault()}function Pr(e){e.stopPropagation()}var A;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(A||(A={}));const jn={start:[A.Space,A.Enter],cancel:[A.Esc],end:[A.Space,A.Enter,A.Tab]},Ur=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case A.Right:return{...n,x:n.x+25};case A.Left:return{...n,x:n.x-25};case A.Down:return{...n,y:n.y+25};case A.Up:return{...n,y:n.y-25}}};class It{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new $e(Ne(n)),this.windowListeners=new $e(F(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(W.Resize,this.handleCancel),this.windowListeners.add(W.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(W.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Or(s),n(Q)}handleKeyDown(t){if(Rt(t)){const{active:n,context:s,options:i}=this.props,{keyboardCodes:o=jn,coordinateGetter:l=Ur,scrollBehavior:c="smooth"}=i,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:p}=s.current,g=p?{x:p.left,y:p.top}:Q;this.referenceCoordinates||(this.referenceCoordinates=g);const a=l(t,{active:n,context:s.current,currentCoordinates:g});if(a){const h=Be(a,g),f={x:0,y:0},{scrollableAncestors:y}=s.current;for(const m of y){const x=t.code,{isTop:v,isRight:w,isLeft:j,isBottom:R,maxScroll:S,minScroll:I}=yn(m),D=kr(m),b={x:Math.min(x===A.Right?D.right-D.width/2:D.right,Math.max(x===A.Right?D.left:D.left+D.width/2,a.x)),y:Math.min(x===A.Down?D.bottom-D.height/2:D.bottom,Math.max(x===A.Down?D.top:D.top+D.height/2,a.y))},C=x===A.Right&&!w||x===A.Left&&!j,E=x===A.Down&&!R||x===A.Up&&!v;if(C&&b.x!==a.x){const N=m.scrollLeft+h.x,L=x===A.Right&&N<=S.x||x===A.Left&&N>=I.x;if(L&&!h.y){m.scrollTo({left:N,behavior:c});return}L?f.x=m.scrollLeft-N:f.x=x===A.Right?m.scrollLeft-S.x:m.scrollLeft-I.x,f.x&&m.scrollBy({left:-f.x,behavior:c});break}else if(E&&b.y!==a.y){const N=m.scrollTop+h.y,L=x===A.Down&&N<=S.y||x===A.Up&&N>=I.y;if(L&&!h.x){m.scrollTo({top:N,behavior:c});return}L?f.y=m.scrollTop-N:f.y=x===A.Down?m.scrollTop-S.y:m.scrollTop-I.y,f.y&&m.scrollBy({top:-f.y,behavior:c});break}}this.handleMove(t,je(Be(a,this.referenceCoordinates),f))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}It.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=jn,onActivation:i}=t,{active:o}=n;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function Zt(e){return!!(e&&"distance"in e)}function qt(e){return!!(e&&"delay"in e)}class Et{constructor(t,n,s){var i;s===void 0&&(s=$r(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:l}=o;this.props=t,this.events=n,this.document=Ne(l),this.documentListeners=new $e(this.document),this.listeners=new $e(s),this.windowListeners=new $e(F(l)),this.initialCoordinates=(i=yt(o))!=null?i:Q,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(W.Resize,this.handleCancel),this.windowListeners.add(W.DragStart,Jt),this.windowListeners.add(W.VisibilityChange,this.handleCancel),this.windowListeners.add(W.ContextMenu,Jt),this.documentListeners.add(W.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(qt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Zt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:i}=this.props;i(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(W.Click,Pr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(W.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:i,props:o}=this,{onMove:l,options:{activationConstraint:c}}=o;if(!i)return;const u=(n=yt(t))!=null?n:Q,p=Be(i,u);if(!s&&c){if(Zt(c)){if(c.tolerance!=null&&mt(p,c.tolerance))return this.handleCancel();if(mt(p,c.distance))return this.handleStart()}if(qt(c)&&mt(p,c.tolerance))return this.handleCancel();this.handlePending(c,p);return}t.cancelable&&t.preventDefault(),l(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===A.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Fr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class kt extends Et{constructor(t){const{event:n}=t,s=Ne(n.target);super(t,Fr,s)}}kt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Br={move:{name:"mousemove"},end:{name:"mouseup"}};var jt;(function(e){e[e.RightClick=2]="RightClick"})(jt||(jt={}));class _r extends Et{constructor(t){super(t,Br,Ne(t.event.target))}}_r.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===jt.RightClick?!1:(s==null||s({event:n}),!0)}}];const xt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Gr extends Et{constructor(t){super(t,xt)}static setup(){return window.addEventListener(xt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(xt.move.name,t)};function t(){}}}Gr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:i}=n;return i.length>1?!1:(s==null||s({event:n}),!0)}}];var Pe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Pe||(Pe={}));var st;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(st||(st={}));function zr(e){let{acceleration:t,activator:n=Pe.Pointer,canScroll:s,draggingRect:i,enabled:o,interval:l=5,order:c=st.TreeOrder,pointerCoordinates:u,scrollableAncestors:p,scrollableAncestorRects:g,delta:a,threshold:h}=e;const f=Vr({delta:a,disabled:!o}),[y,m]=tr(),x=d.useRef({x:0,y:0}),v=d.useRef({x:0,y:0}),w=d.useMemo(()=>{switch(n){case Pe.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Pe.DraggableRect:return i}},[n,i,u]),j=d.useRef(null),R=d.useCallback(()=>{const I=j.current;if(!I)return;const D=x.current.x*v.current.x,b=x.current.y*v.current.y;I.scrollBy(D,b)},[]),S=d.useMemo(()=>c===st.TreeOrder?[...p].reverse():p,[c,p]);d.useEffect(()=>{if(!o||!p.length||!w){m();return}for(const I of S){if((s==null?void 0:s(I))===!1)continue;const D=p.indexOf(I),b=g[D];if(!b)continue;const{direction:C,speed:E}=Er(I,b,w,t,h);for(const N of["x","y"])f[N][C[N]]||(E[N]=0,C[N]=0);if(E.x>0||E.y>0){m(),j.current=I,y(R,l),x.current=E,v.current=C;return}}x.current={x:0,y:0},v.current={x:0,y:0},m()},[t,R,s,m,o,l,JSON.stringify(w),JSON.stringify(f),y,p,S,g,JSON.stringify(h)])}const Xr={x:{[M.Backward]:!1,[M.Forward]:!1},y:{[M.Backward]:!1,[M.Forward]:!1}};function Vr(e){let{delta:t,disabled:n}=e;const s=vt(t);return Xe(i=>{if(n||!s||!i)return Xr;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[M.Backward]:i.x[M.Backward]||o.x===-1,[M.Forward]:i.x[M.Forward]||o.x===1},y:{[M.Backward]:i.y[M.Backward]||o.y===-1,[M.Forward]:i.y[M.Forward]||o.y===1}}},[n,t,s])}function Kr(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Xe(i=>{var o;return t==null?null:(o=s??i)!=null?o:null},[s,t])}function Hr(e,t){return d.useMemo(()=>e.reduce((n,s)=>{const{sensor:i}=s,o=i.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,s)}));return[...n,...o]},[]),[e,t])}var Ge;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ge||(Ge={}));var Ct;(function(e){e.Optimized="optimized"})(Ct||(Ct={}));const en=new Map;function Yr(e,t){let{dragging:n,dependencies:s,config:i}=t;const[o,l]=d.useState(null),{frequency:c,measure:u,strategy:p}=i,g=d.useRef(e),a=x(),h=Fe(a),f=d.useCallback(function(v){v===void 0&&(v=[]),!h.current&&l(w=>w===null?v:w.concat(v.filter(j=>!w.includes(j))))},[h]),y=d.useRef(null),m=Xe(v=>{if(a&&!n)return en;if(!v||v===en||g.current!==e||o!=null){const w=new Map;for(let j of e){if(!j)continue;if(o&&o.length>0&&!o.includes(j.id)&&j.rect.current){w.set(j.id,j.rect.current);continue}const R=j.node.current,S=R?new At(u(R),R):null;j.rect.current=S,S&&w.set(j.id,S)}return w}return v},[e,o,n,a,u]);return d.useEffect(()=>{g.current=e},[e]),d.useEffect(()=>{a||f()},[n,a]),d.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),d.useEffect(()=>{a||typeof c!="number"||y.current!==null||(y.current=setTimeout(()=>{f(),y.current=null},c))},[c,a,f,...s]),{droppableRects:m,measureDroppableContainers:f,measuringScheduled:o!=null};function x(){switch(p){case Ge.Always:return!1;case Ge.BeforeDragging:return n;default:return!n}}}function Cn(e,t){return Xe(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Wr(e,t){return Cn(e,t)}function Qr(e){let{callback:t,disabled:n}=e;const s=Dt(t),i=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,n]);return d.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function lt(e){let{callback:t,disabled:n}=e;const s=Dt(t),i=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[n]);return d.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Jr(e){return new At(Se(e),e)}function tn(e,t,n){t===void 0&&(t=Jr);const[s,i]=d.useState(null);function o(){i(u=>{if(!e)return null;if(e.isConnected===!1){var p;return(p=u??n)!=null?p:null}const g=t(e);return JSON.stringify(u)===JSON.stringify(g)?u:g})}const l=Qr({callback(u){if(e)for(const p of u){const{type:g,target:a}=p;if(g==="childList"&&a instanceof HTMLElement&&a.contains(e)){o();break}}}}),c=lt({callback:o});return te(()=>{o(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),s}function Zr(e){const t=Cn(e);return pn(e,t)}const nn=[];function qr(e){const t=d.useRef(e),n=Xe(s=>e?s&&s!==nn&&e&&t.current&&e.parentNode===t.current.parentNode?s:at(e):nn,[e]);return d.useEffect(()=>{t.current=e},[e]),n}function es(e){const[t,n]=d.useState(null),s=d.useRef(e),i=d.useCallback(o=>{const l=pt(o.target);l&&n(c=>c?(c.set(l,wt(l)),new Map(c)):null)},[]);return d.useEffect(()=>{const o=s.current;if(e!==o){l(o);const c=e.map(u=>{const p=pt(u);return p?(p.addEventListener("scroll",i,{passive:!0}),[p,wt(p)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(o)};function l(c){c.forEach(u=>{const p=pt(u);p==null||p.removeEventListener("scroll",i)})}},[i,e]),d.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,l)=>je(o,l),Q):wn(e):Q,[e,t])}function rn(e,t){t===void 0&&(t=[]);const n=d.useRef(null);return d.useEffect(()=>{n.current=null},t),d.useEffect(()=>{const s=e!==Q;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Be(e,n.current):Q}function ts(e){d.useEffect(()=>{if(!ot)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function ns(e,t){return d.useMemo(()=>e.reduce((n,s)=>{let{eventName:i,handler:o}=s;return n[i]=l=>{o(l,t)},n},{}),[e,t])}function Nn(e){return d.useMemo(()=>e?Dr(e):null,[e])}const sn=[];function rs(e,t){t===void 0&&(t=Se);const[n]=e,s=Nn(n?F(n):null),[i,o]=d.useState(sn);function l(){o(()=>e.length?e.map(u=>vn(u)?s:new At(t(u),u)):sn)}const c=lt({callback:l});return te(()=>{c==null||c.disconnect(),l(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),i}function ss(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ze(t)?t:e}function is(e){let{measure:t}=e;const[n,s]=d.useState(null),i=d.useCallback(p=>{for(const{target:g}of p)if(ze(g)){s(a=>{const h=t(g);return a?{...a,width:h.width,height:h.height}:h});break}},[t]),o=lt({callback:i}),l=d.useCallback(p=>{const g=ss(p);o==null||o.disconnect(),g&&(o==null||o.observe(g)),s(g?t(g):null)},[t,o]),[c,u]=nt(l);return d.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const os=[{sensor:kt,options:{}},{sensor:It,options:{}}],as={current:{}},tt={draggable:{measure:Qt},droppable:{measure:Qt,strategy:Ge.WhileDragging,frequency:Ct.Optimized},dragOverlay:{measure:Se}};class Ue extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const ls={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ue,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:rt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:tt,measureDroppableContainers:rt,windowRect:null,measuringScheduled:!1},cs={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:rt,draggableNodes:new Map,over:null,measureDroppableContainers:rt},ct=d.createContext(cs),Sn=d.createContext(ls);function ds(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ue}}}function us(e,t){switch(t.type){case T.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case T.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case T.DragEnd:case T.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case T.RegisterDroppable:{const{element:n}=t,{id:s}=n,i=new Ue(e.droppable.containers);return i.set(s,n),{...e,droppable:{...e.droppable,containers:i}}}case T.SetDroppableDisabled:{const{id:n,key:s,disabled:i}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const l=new Ue(e.droppable.containers);return l.set(n,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:l}}}case T.UnregisterDroppable:{const{id:n,key:s}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const o=new Ue(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function hs(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:i}=d.useContext(ct),o=vt(s),l=vt(n==null?void 0:n.id);return d.useEffect(()=>{if(!t&&!s&&o&&l!=null){if(!Rt(o)||document.activeElement===o.target)return;const c=i.get(l);if(!c)return;const{activatorNode:u,node:p}=c;if(!u.current&&!p.current)return;requestAnimationFrame(()=>{for(const g of[u.current,p.current]){if(!g)continue;const a=sr(g);if(a){a.focus();break}}})}},[s,t,i,l,o]),null}function fs(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((i,o)=>o({transform:i,...s}),n):n}function gs(e){return d.useMemo(()=>({draggable:{...tt.draggable,...e==null?void 0:e.draggable},droppable:{...tt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...tt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ps(e){let{activeNode:t,measure:n,initialRect:s,config:i=!0}=e;const o=d.useRef(!1),{x:l,y:c}=typeof i=="boolean"?{x:i,y:i}:i;te(()=>{if(!l&&!c||!t){o.current=!1;return}if(o.current||!s)return;const p=t==null?void 0:t.node.current;if(!p||p.isConnected===!1)return;const g=n(p),a=pn(g,s);if(l||(a.x=0),c||(a.y=0),o.current=!0,Math.abs(a.x)>0||Math.abs(a.y)>0){const h=mn(p);h&&h.scrollBy({top:a.y,left:a.x})}},[t,l,c,s,n])}const Dn=d.createContext({...Q,scaleX:1,scaleY:1});var ge;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ge||(ge={}));const ms=d.memo(function(t){var n,s,i,o;let{id:l,accessibility:c,autoScroll:u=!0,children:p,sensors:g=os,collisionDetection:a=vr,measuring:h,modifiers:f,...y}=t;const m=d.useReducer(us,void 0,ds),[x,v]=m,[w,j]=dr(),[R,S]=d.useState(ge.Uninitialized),I=R===ge.Initialized,{draggable:{active:D,nodes:b,translate:C},droppable:{containers:E}}=x,N=D!=null?b.get(D):null,L=d.useRef({initial:null,translated:null}),B=d.useMemo(()=>{var $;return D!=null?{id:D,data:($=N==null?void 0:N.data)!=null?$:as,rect:L}:null},[D,N]),_=d.useRef(null),[De,Ke]=d.useState(null),[G,He]=d.useState(null),ne=Fe(y,Object.values(y)),Re=Ve("DndDescribedBy",l),Ye=d.useMemo(()=>E.getEnabled(),[E]),P=gs(h),{droppableRects:re,measureDroppableContainers:pe,measuringScheduled:Ae}=Yr(Ye,{dragging:I,dependencies:[C.x,C.y],config:P.droppable}),K=Kr(b,D),We=d.useMemo(()=>G?yt(G):null,[G]),le=Fn(),se=Wr(K,P.draggable.measure);ps({activeNode:D!=null?b.get(D):null,config:le.layoutShiftCompensation,initialRect:se,measure:P.draggable.measure});const k=tn(K,P.draggable.measure,se),Ie=tn(K?K.parentElement:null),J=d.useRef({activatorEvent:null,active:null,activeNode:K,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:b,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),me=E.getNodeFor((n=J.current.over)==null?void 0:n.id),ie=is({measure:P.dragOverlay.measure}),xe=(s=ie.nodeRef.current)!=null?s:K,be=I?(i=ie.rect)!=null?i:k:null,Ot=!!(ie.nodeRef.current&&ie.rect),Lt=Zr(Ot?null:k),dt=Nn(xe?F(xe):null),ce=qr(I?me??K:null),Qe=rs(ce),Je=fs(f,{transform:{x:C.x-Lt.x,y:C.y-Lt.y,scaleX:1,scaleY:1},activatorEvent:G,active:B,activeNodeRect:k,containerNodeRect:Ie,draggingNodeRect:be,over:J.current.over,overlayNodeRect:ie.rect,scrollableAncestors:ce,scrollableAncestorRects:Qe,windowRect:dt}),$t=We?je(We,C):null,Pt=es(ce),Tn=rn(Pt),Mn=rn(Pt,[k]),ve=je(Je,Tn),ye=be?jr(be,Je):null,Ee=B&&ye?a({active:B,collisionRect:ye,droppableRects:re,droppableContainers:Ye,pointerCoordinates:$t}):null,Ut=gn(Ee,"id"),[de,Ft]=d.useState(null),On=Ot?Je:je(Je,Mn),Ln=yr(On,(o=de==null?void 0:de.rect)!=null?o:null,k),ut=d.useRef(null),Bt=d.useCallback(($,z)=>{let{sensor:X,options:ue}=z;if(_.current==null)return;const H=b.get(_.current);if(!H)return;const V=$.nativeEvent,Z=new X({active:_.current,activeNode:H,event:V,options:ue,context:J,onAbort(O){if(!b.get(O))return;const{onDragAbort:q}=ne.current,oe={id:O};q==null||q(oe),w({type:"onDragAbort",event:oe})},onPending(O,he,q,oe){if(!b.get(O))return;const{onDragPending:Te}=ne.current,fe={id:O,constraint:he,initialCoordinates:q,offset:oe};Te==null||Te(fe),w({type:"onDragPending",event:fe})},onStart(O){const he=_.current;if(he==null)return;const q=b.get(he);if(!q)return;const{onDragStart:oe}=ne.current,ke={activatorEvent:V,active:{id:he,data:q.data,rect:L}};Oe.unstable_batchedUpdates(()=>{oe==null||oe(ke),S(ge.Initializing),v({type:T.DragStart,initialCoordinates:O,active:he}),w({type:"onDragStart",event:ke}),Ke(ut.current),He(V)})},onMove(O){v({type:T.DragMove,coordinates:O})},onEnd:we(T.DragEnd),onCancel:we(T.DragCancel)});ut.current=Z;function we(O){return async function(){const{active:q,collisions:oe,over:ke,scrollAdjustedTranslate:Te}=J.current;let fe=null;if(q&&Te){const{cancelDrop:Me}=ne.current;fe={activatorEvent:V,active:q,collisions:oe,delta:Te,over:ke},O===T.DragEnd&&typeof Me=="function"&&await Promise.resolve(Me(fe))&&(O=T.DragCancel)}_.current=null,Oe.unstable_batchedUpdates(()=>{v({type:O}),S(ge.Uninitialized),Ft(null),Ke(null),He(null),ut.current=null;const Me=O===T.DragEnd?"onDragEnd":"onDragCancel";if(fe){const ht=ne.current[Me];ht==null||ht(fe),w({type:Me,event:fe})}})}}},[b]),$n=d.useCallback(($,z)=>(X,ue)=>{const H=X.nativeEvent,V=b.get(ue);if(_.current!==null||!V||H.dndKit||H.defaultPrevented)return;const Z={active:V};$(X,z.options,Z)===!0&&(H.dndKit={capturedBy:z.sensor},_.current=ue,Bt(X,z))},[b,Bt]),_t=Hr(g,$n);ts(g),te(()=>{k&&R===ge.Initializing&&S(ge.Initialized)},[k,R]),d.useEffect(()=>{const{onDragMove:$}=ne.current,{active:z,activatorEvent:X,collisions:ue,over:H}=J.current;if(!z||!X)return;const V={active:z,activatorEvent:X,collisions:ue,delta:{x:ve.x,y:ve.y},over:H};Oe.unstable_batchedUpdates(()=>{$==null||$(V),w({type:"onDragMove",event:V})})},[ve.x,ve.y]),d.useEffect(()=>{const{active:$,activatorEvent:z,collisions:X,droppableContainers:ue,scrollAdjustedTranslate:H}=J.current;if(!$||_.current==null||!z||!H)return;const{onDragOver:V}=ne.current,Z=ue.get(Ut),we=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,O={active:$,activatorEvent:z,collisions:X,delta:{x:H.x,y:H.y},over:we};Oe.unstable_batchedUpdates(()=>{Ft(we),V==null||V(O),w({type:"onDragOver",event:O})})},[Ut]),te(()=>{J.current={activatorEvent:G,active:B,activeNode:K,collisionRect:ye,collisions:Ee,droppableRects:re,draggableNodes:b,draggingNode:xe,draggingNodeRect:be,droppableContainers:E,over:de,scrollableAncestors:ce,scrollAdjustedTranslate:ve},L.current={initial:be,translated:ye}},[B,K,Ee,ye,b,xe,be,re,E,de,ce,ve]),zr({...le,delta:C,draggingRect:ye,pointerCoordinates:$t,scrollableAncestors:ce,scrollableAncestorRects:Qe});const Pn=d.useMemo(()=>({active:B,activeNode:K,activeNodeRect:k,activatorEvent:G,collisions:Ee,containerNodeRect:Ie,dragOverlay:ie,draggableNodes:b,droppableContainers:E,droppableRects:re,over:de,measureDroppableContainers:pe,scrollableAncestors:ce,scrollableAncestorRects:Qe,measuringConfiguration:P,measuringScheduled:Ae,windowRect:dt}),[B,K,k,G,Ee,Ie,ie,b,E,re,de,pe,ce,Qe,P,Ae,dt]),Un=d.useMemo(()=>({activatorEvent:G,activators:_t,active:B,activeNodeRect:k,ariaDescribedById:{draggable:Re},dispatch:v,draggableNodes:b,over:de,measureDroppableContainers:pe}),[G,_t,B,k,v,Re,b,de,pe]);return U.createElement(un.Provider,{value:j},U.createElement(ct.Provider,{value:Un},U.createElement(Sn.Provider,{value:Pn},U.createElement(Dn.Provider,{value:Ln},p)),U.createElement(hs,{disabled:(c==null?void 0:c.restoreFocus)===!1})),U.createElement(fr,{...c,hiddenTextDescribedById:Re}));function Fn(){const $=(De==null?void 0:De.autoScrollEnabled)===!1,z=typeof u=="object"?u.enabled===!1:u===!1,X=I&&!$&&!z;return typeof u=="object"?{...u,enabled:X}:{enabled:X}}}),xs=d.createContext(null),on="button",bs="Draggable";function vs(e){let{id:t,data:n,disabled:s=!1,attributes:i}=e;const o=Ve(bs),{activators:l,activatorEvent:c,active:u,activeNodeRect:p,ariaDescribedById:g,draggableNodes:a,over:h}=d.useContext(ct),{role:f=on,roleDescription:y="draggable",tabIndex:m=0}=i??{},x=(u==null?void 0:u.id)===t,v=d.useContext(x?Dn:xs),[w,j]=nt(),[R,S]=nt(),I=ns(l,t),D=Fe(n);te(()=>(a.set(t,{id:t,key:o,node:w,activatorNode:R,data:D}),()=>{const C=a.get(t);C&&C.key===o&&a.delete(t)}),[a,t]);const b=d.useMemo(()=>({role:f,tabIndex:m,"aria-disabled":s,"aria-pressed":x&&f===on?!0:void 0,"aria-roledescription":y,"aria-describedby":g.draggable}),[s,f,m,x,y,g.draggable]);return{active:u,activatorEvent:c,activeNodeRect:p,attributes:b,isDragging:x,listeners:s?void 0:I,node:w,over:h,setNodeRef:j,setActivatorNodeRef:S,transform:v}}function ys(){return d.useContext(Sn)}const ws="Droppable",js={timeout:25};function Cs(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:i}=e;const o=Ve(ws),{active:l,dispatch:c,over:u,measureDroppableContainers:p}=d.useContext(ct),g=d.useRef({disabled:n}),a=d.useRef(!1),h=d.useRef(null),f=d.useRef(null),{disabled:y,updateMeasurementsFor:m,timeout:x}={...js,...i},v=Fe(m??s),w=d.useCallback(()=>{if(!a.current){a.current=!0;return}f.current!=null&&clearTimeout(f.current),f.current=setTimeout(()=>{p(Array.isArray(v.current)?v.current:[v.current]),f.current=null},x)},[x]),j=lt({callback:w,disabled:y||!l}),R=d.useCallback((b,C)=>{j&&(C&&(j.unobserve(C),a.current=!1),b&&j.observe(b))},[j]),[S,I]=nt(R),D=Fe(t);return d.useEffect(()=>{!j||!S.current||(j.disconnect(),a.current=!1,j.observe(S.current))},[S,j]),d.useEffect(()=>(c({type:T.RegisterDroppable,element:{id:s,key:o,disabled:n,node:S,rect:h,data:D}}),()=>c({type:T.UnregisterDroppable,key:o,id:s})),[s]),d.useEffect(()=>{n!==g.current.disabled&&(c({type:T.SetDroppableDisabled,id:s,key:o,disabled:n}),g.current.disabled=n)},[s,o,n,c]),{active:l,rect:h,isOver:(u==null?void 0:u.id)===s,node:S,over:u,setNodeRef:I}}function Tt(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Ns(e,t){return e.reduce((n,s,i)=>{const o=t.get(s);return o&&(n[i]=o),n},Array(e.length))}function qe(e){return e!==null&&e>=0}function Ss(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ds(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rn=e=>{let{rects:t,activeIndex:n,overIndex:s,index:i}=e;const o=Tt(t,s,n),l=t[i],c=o[i];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},et={scaleX:1,scaleY:1},Rs=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:i,rects:o,overIndex:l}=e;const c=(t=o[n])!=null?t:s;if(!c)return null;if(i===n){const p=o[l];return p?{x:0,y:n<l?p.top+p.height-(c.top+c.height):p.top-c.top,...et}:null}const u=As(o,i,n);return i>n&&i<=l?{x:0,y:-c.height-u,...et}:i<n&&i>=l?{x:0,y:c.height+u,...et}:{x:0,y:0,...et}};function As(e,t,n){const s=e[t],i=e[t-1],o=e[t+1];return s?n<t?i?s.top-(i.top+i.height):o?o.top-(s.top+s.height):0:o?o.top-(s.top+s.height):i?s.top-(i.top+i.height):0:0}const An="Sortable",In=U.createContext({activeIndex:-1,containerId:An,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rn,disabled:{draggable:!1,droppable:!1}});function Is(e){let{children:t,id:n,items:s,strategy:i=Rn,disabled:o=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:p,measureDroppableContainers:g}=ys(),a=Ve(An,n),h=c.rect!==null,f=d.useMemo(()=>s.map(I=>typeof I=="object"&&"id"in I?I.id:I),[s]),y=l!=null,m=l?f.indexOf(l.id):-1,x=p?f.indexOf(p.id):-1,v=d.useRef(f),w=!Ss(f,v.current),j=x!==-1&&m===-1||w,R=Ds(o);te(()=>{w&&y&&g(f)},[w,f,y,g]),d.useEffect(()=>{v.current=f},[f]);const S=d.useMemo(()=>({activeIndex:m,containerId:a,disabled:R,disableTransforms:j,items:f,overIndex:x,useDragOverlay:h,sortedRects:Ns(f,u),strategy:i}),[m,a,R.draggable,R.droppable,j,f,x,u,h,i]);return U.createElement(In.Provider,{value:S},t)}const Es=e=>{let{id:t,items:n,activeIndex:s,overIndex:i}=e;return Tt(n,s,i).indexOf(t)},ks=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:i,items:o,newIndex:l,previousItems:c,previousContainerId:u,transition:p}=e;return!p||!s||c!==o&&i===l?!1:n?!0:l!==i&&t===u},Ts={duration:200,easing:"ease"},En="transform",Ms=_e.Transition.toString({property:En,duration:0,easing:"linear"}),Os={roleDescription:"sortable"};function Ls(e){let{disabled:t,index:n,node:s,rect:i}=e;const[o,l]=d.useState(null),c=d.useRef(n);return te(()=>{if(!t&&n!==c.current&&s.current){const u=i.current;if(u){const p=Se(s.current,{ignoreTransform:!0}),g={x:u.left-p.left,y:u.top-p.top,scaleX:u.width/p.width,scaleY:u.height/p.height};(g.x||g.y)&&l(g)}}n!==c.current&&(c.current=n)},[t,n,s,i]),d.useEffect(()=>{o&&l(null)},[o]),o}function $s(e){let{animateLayoutChanges:t=ks,attributes:n,disabled:s,data:i,getNewIndex:o=Es,id:l,strategy:c,resizeObserverConfig:u,transition:p=Ts}=e;const{items:g,containerId:a,activeIndex:h,disabled:f,disableTransforms:y,sortedRects:m,overIndex:x,useDragOverlay:v,strategy:w}=d.useContext(In),j=Ps(s,f),R=g.indexOf(l),S=d.useMemo(()=>({sortable:{containerId:a,index:R,items:g},...i}),[a,i,R,g]),I=d.useMemo(()=>g.slice(g.indexOf(l)),[g,l]),{rect:D,node:b,isOver:C,setNodeRef:E}=Cs({id:l,data:S,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...u}}),{active:N,activatorEvent:L,activeNodeRect:B,attributes:_,setNodeRef:De,listeners:Ke,isDragging:G,over:He,setActivatorNodeRef:ne,transform:Re}=vs({id:l,data:S,attributes:{...Os,...n},disabled:j.draggable}),Ye=er(E,De),P=!!N,re=P&&!y&&qe(h)&&qe(x),pe=!v&&G,Ae=pe&&re?Re:null,We=re?Ae??(c??w)({rects:m,activeNodeRect:B,activeIndex:h,overIndex:x,index:R}):null,le=qe(h)&&qe(x)?o({id:l,items:g,activeIndex:h,overIndex:x}):R,se=N==null?void 0:N.id,k=d.useRef({activeId:se,items:g,newIndex:le,containerId:a}),Ie=g!==k.current.items,J=t({active:N,containerId:a,isDragging:G,isSorting:P,id:l,index:R,items:g,newIndex:k.current.newIndex,previousItems:k.current.items,previousContainerId:k.current.containerId,transition:p,wasDragging:k.current.activeId!=null}),me=Ls({disabled:!J,index:R,node:b,rect:D});return d.useEffect(()=>{P&&k.current.newIndex!==le&&(k.current.newIndex=le),a!==k.current.containerId&&(k.current.containerId=a),g!==k.current.items&&(k.current.items=g)},[P,le,a,g]),d.useEffect(()=>{if(se===k.current.activeId)return;if(se!=null&&k.current.activeId==null){k.current.activeId=se;return}const xe=setTimeout(()=>{k.current.activeId=se},50);return()=>clearTimeout(xe)},[se]),{active:N,activeIndex:h,attributes:_,data:S,rect:D,index:R,newIndex:le,items:g,isOver:C,isSorting:P,isDragging:G,listeners:Ke,node:b,overIndex:x,over:He,setNodeRef:Ye,setActivatorNodeRef:ne,setDroppableNodeRef:E,setDraggableNodeRef:De,transform:me??We,transition:ie()};function ie(){if(me||Ie&&k.current.newIndex===R)return Ms;if(!(pe&&!Rt(L)||!p)&&(P||J))return _e.Transition.toString({...p,property:En})}}function Ps(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}function it(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Us=[A.Down,A.Right,A.Up,A.Left],Fs=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:i,droppableContainers:o,over:l,scrollableAncestors:c}}=t;if(Us.includes(e.code)){if(e.preventDefault(),!n||!s)return;const u=[];o.getEnabled().forEach(a=>{if(!a||a!=null&&a.disabled)return;const h=i.get(a.id);if(h)switch(e.code){case A.Down:s.top<h.top&&u.push(a);break;case A.Up:s.top>h.top&&u.push(a);break;case A.Left:s.left>h.left&&u.push(a);break;case A.Right:s.left<h.left&&u.push(a);break}});const p=xr({collisionRect:s,droppableRects:i,droppableContainers:u});let g=gn(p,"id");if(g===(l==null?void 0:l.id)&&p.length>1&&(g=p[1].id),g!=null){const a=o.get(n.id),h=o.get(g),f=h?i.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&f&&a&&h){const x=at(y).some((I,D)=>c[D]!==I),v=kn(a,h),w=Bs(a,h),j=x||!v?{x:0,y:0}:{x:w?s.width-f.width:0,y:w?s.height-f.height:0},R={x:f.left,y:f.top};return j.x&&j.y?R:Be(R,j)}}}};function kn(e,t){return!it(e)||!it(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Bs(e,t){return!it(e)||!it(t)||!kn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const _s=({question:e,onChange:t,onDelete:n})=>{const s=a=>{let h=[],f={...e,type:a};switch(a){case"multiple":h=Array.from({length:4},(y,m)=>({id:ee(),text:"",isCorrect:m===0}));break;case"boolean":h=[{id:ee(),text:"Đúng",isCorrect:!0},{id:ee(),text:"Sai",isCorrect:!1}];break;case"short_answer":h=[],f.correctAnswer="",f.acceptedAnswers=[];break;case"image":h=Array.from({length:4},(y,m)=>({id:ee(),text:`Ảnh ${m+1}`,isCorrect:m===0,imageUrl:""}));break}t({...f,answers:h})},i=(a,h,f)=>{const y=e.answers.map((m,x)=>x===a?{...m,[h]:f}:m);t({...e,answers:y})},o=()=>{if(e.type==="multiple"||e.type==="image"){const a={id:ee(),text:e.type==="image"?`Ảnh ${e.answers.length+1}`:"",isCorrect:!1,...e.type==="image"&&{imageUrl:""}};t({...e,answers:[...e.answers,a]})}},l=a=>{e.type!=="boolean"&&((e.type==="multiple"||e.type==="image")&&e.answers.length<=2||t({...e,answers:e.answers.filter((h,f)=>f!==a)}))},c=a=>{e.type==="boolean"?t({...e,answers:e.answers.map((h,f)=>({...h,isCorrect:f===0?a===0:a===1}))}):t({...e,answers:e.answers.map((h,f)=>({...h,isCorrect:f===a}))})},u=a=>{const h=[a,a.toLowerCase(),a.toUpperCase(),a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()].filter((f,y,m)=>m.indexOf(f)===y&&f.trim()!=="");t({...e,correctAnswer:a,acceptedAnswers:h})},p=()=>{const a=prompt("Nhập từ đồng nghĩa hoặc cách viết khác:");a&&a.trim()&&t({...e,acceptedAnswers:[...e.acceptedAnswers||[],a.trim()]})},g=a=>{var h;t({...e,acceptedAnswers:((h=e.acceptedAnswers)==null?void 0:h.filter((f,y)=>y!==a))||[]})};return r.jsxs("div",{className:"border rounded-lg p-4 mb-4 bg-gray-50",children:[r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:"Nội dung câu hỏi",value:e.text,onChange:a=>t({...e,text:a.target.value})}),r.jsxs("select",{className:"border p-2 rounded min-w-[120px]",value:e.type,onChange:a=>s(a.target.value),children:[r.jsx("option",{value:"multiple",children:"Trắc nghiệm"}),r.jsx("option",{value:"boolean",children:"Đúng/Sai"}),r.jsx("option",{value:"short_answer",children:"Điền từ"}),r.jsx("option",{value:"image",children:"Chọn ảnh"})]}),r.jsx("input",{type:"number",className:"w-20 border p-2 rounded",min:1,max:100,value:e.points,onChange:a=>t({...e,points:parseInt(a.target.value)||1}),placeholder:"Điểm"}),r.jsx(Y,{variant:"outline",onClick:n,className:"text-red-600 border-red-300",children:"Xóa"})]}),e.type==="multiple"&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-medium text-gray-700",children:"Đáp án trắc nghiệm"}),r.jsx(Y,{onClick:o,variant:"outline",size:"sm",children:"+ Thêm đáp án"})]}),e.answers.map((a,h)=>r.jsxs("div",{className:"flex gap-2 items-center bg-white p-2 rounded border",children:[r.jsx("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:String.fromCharCode(65+h)}),r.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:`Đáp án ${String.fromCharCode(65+h)}`,value:a.text,onChange:f=>i(h,"text",f.target.value)}),r.jsxs("label",{className:"flex items-center gap-1",children:[r.jsx("input",{type:"radio",name:`correct-${e.id}`,checked:a.isCorrect,onChange:()=>c(h)}),r.jsx("span",{className:"text-sm",children:"Đúng"})]}),e.answers.length>2&&r.jsx(Y,{variant:"outline",onClick:()=>l(h),className:"text-red-600 border-red-300 px-2",children:"X"})]},a.id))]}),e.type==="boolean"&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"font-medium text-gray-700",children:"Câu hỏi Đúng/Sai"}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Chọn đáp án đúng cho câu hỏi này:"}),r.jsx("div",{className:"space-y-2",children:e.answers.map((a,h)=>r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[r.jsx("input",{type:"radio",name:`boolean-${e.id}`,checked:a.isCorrect,onChange:()=>c(h),className:"w-4 h-4"}),r.jsxs("span",{className:`font-medium ${a.text==="Đúng"?"text-green-600":"text-red-600"}`,children:[a.text==="Đúng"?"✓":"✗"," ",a.text]})]},a.id))})]})]}),e.type==="short_answer"&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"font-medium text-gray-700",children:"Câu hỏi điền từ"}),r.jsxs("div",{className:"bg-white p-3 rounded border space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Đáp án chính xác:"}),r.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Nhập đáp án chính xác...",value:e.correctAnswer||"",onChange:a=>u(a.target.value)})]}),e.acceptedAnswers&&e.acceptedAnswers.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Các cách viết được chấp nhận:"}),r.jsx("div",{className:"space-y-1",children:e.acceptedAnswers.map((a,h)=>r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("span",{className:"flex-1 bg-gray-50 p-2 rounded text-sm",children:a}),r.jsx(Y,{variant:"outline",onClick:()=>g(h),className:"text-red-600 border-red-300 px-2 text-xs",children:"X"})]},h))})]}),r.jsx(Y,{onClick:p,variant:"outline",size:"sm",children:"+ Thêm cách viết khác"})]})]}),e.type==="image"&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-medium text-gray-700",children:"Chọn ảnh đáp án"}),r.jsx(Y,{onClick:o,variant:"outline",size:"sm",children:"+ Thêm ảnh"})]}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.answers.map((a,h)=>r.jsxs("div",{className:"bg-white p-3 rounded border space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:String.fromCharCode(65+h)}),e.answers.length>2&&r.jsx(Y,{variant:"outline",onClick:()=>l(h),className:"text-red-600 border-red-300 px-2 text-xs",children:"X"})]}),r.jsx("input",{className:"w-full border p-2 rounded text-sm",placeholder:"Mô tả ảnh (tùy chọn)",value:a.text,onChange:f=>i(h,"text",f.target.value)}),r.jsx("input",{className:"w-full border p-2 rounded text-sm",placeholder:"URL ảnh",value:a.imageUrl||"",onChange:f=>i(h,"imageUrl",f.target.value)}),a.imageUrl&&r.jsx("div",{className:"relative",children:r.jsx("img",{src:a.imageUrl,alt:a.text,className:"w-full h-20 object-cover rounded border",onError:f=>{f.target.style.display="none"}})}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:`correct-${e.id}`,checked:a.isCorrect,onChange:()=>c(h)}),r.jsx("span",{className:"text-sm font-medium text-green-600",children:"Đáp án đúng"})]})]},a.id))})]}),r.jsx("div",{className:"mt-4",children:r.jsx("textarea",{className:"w-full border p-2 rounded",placeholder:"Giải thích đáp án (tùy chọn)",rows:2,value:e.explanation||"",onChange:a=>t({...e,explanation:a.target.value})})})]})},Gs=({id:e,index:t,question:n,onUpdate:s,onDelete:i,moveQuestion:o,totalQuestions:l})=>{const{attributes:c,listeners:u,setNodeRef:p,transform:g,transition:a,isDragging:h}=$s({id:e}),f={transform:_e.Transform.toString(g),transition:a};return r.jsxs("div",{ref:p,style:f,className:`relative ${h?"opacity-50":""}`,children:[r.jsxs("div",{className:"absolute -left-16 top-4 flex flex-col gap-1",children:[r.jsx("div",{...c,...u,className:"p-2 cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600 bg-gray-100 rounded hover:bg-gray-200 transition-colors",title:"Kéo để sắp xếp",children:"⋮⋮"}),r.jsx("button",{type:"button",onClick:()=>o(t,t-1),disabled:t===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Di chuyển lên",children:"⬆️"}),r.jsx("button",{type:"button",onClick:()=>o(t,t+1),disabled:t===l-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Di chuyển xuống",children:"⬇️"})]}),r.jsx(_s,{question:n,onChange:s,onDelete:i})]})},zs=({onQuestionsImported:e})=>{const[t,n]=d.useState(!1),[s,i]=d.useState(!1),o=async(g,a)=>{var f;const h=(f=g.target.files)==null?void 0:f[0];if(h){i(!0);try{if(!(a==="csv"?["text/csv","application/csv"]:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]).some(x=>h.type.includes(x)||h.name.toLowerCase().endsWith(a==="csv"?".csv":".xlsx"))){ae.error(`Vui lòng chọn file ${a.toUpperCase()} hợp lệ`),i(!1);return}const m=await l(h,a);if(m.length===0){ae.error("Không tìm thấy câu hỏi hợp lệ trong file"),i(!1);return}e(m),ae.success(`Đã import thành công ${m.length} câu hỏi!`),n(!1)}catch(y){console.error("Error parsing file:",y),ae.error("Có lỗi xảy ra khi đọc file. Vui lòng kiểm tra định dạng file.")}finally{i(!1),g.target.value=""}}},l=async(g,a)=>{const h=await g.text();return c(h)},c=g=>{const a=g.split(`
`).filter(f=>f.trim()),h=[];for(let f=1;f<a.length;f++){const y=a[f].trim();if(!y)continue;const m=u(y);if(m.length<6){console.warn(`Skipping line ${f+1}: insufficient columns`);continue}const[x,v,w,j,R,S,I="",D="10"]=m;if(!x||!v||!w||!S){console.warn(`Skipping line ${f+1}: missing required fields`);continue}const b=[{id:"a",text:v,isCorrect:S.toLowerCase()==="a"},{id:"b",text:w,isCorrect:S.toLowerCase()==="b"},{id:"c",text:j||"",isCorrect:S.toLowerCase()==="c"},{id:"d",text:R||"",isCorrect:S.toLowerCase()==="d"}].filter(E=>E.text),C={id:`imported-${Date.now()}-${f}`,text:x,type:"multiple",answers:b,explanation:I||void 0,points:parseInt(D)||10};h.push(C)}return h},u=g=>{const a=[];let h="",f=!1;for(let y=0;y<g.length;y++){const m=g[y];m==='"'?f=!f:m===","&&!f?(a.push(h.trim()),h=""):h+=m}return a.push(h.trim()),a.map(y=>y.replace(/^"(.*)"$/,"$1"))},p=g=>{const f=[["Câu hỏi","Đáp án A","Đáp án B","Đáp án C","Đáp án D","Đáp án đúng (A/B/C/D)","Giải thích (tùy chọn)","Điểm (mặc định 10)"],["JavaScript là ngôn ngữ gì?","Ngôn ngữ lập trình","Ngôn ngữ đánh dấu","Hệ quản trị cơ sở dữ liệu","Hệ điều hành","A","JavaScript là ngôn ngữ lập trình phổ biến","10"]].map(x=>x.map(v=>`"${v}"`).join(",")).join(`
`),y=new Blob([f],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");m.href=URL.createObjectURL(y),m.download=`quiz_template.${g==="csv"?"csv":"xlsx"}`,m.click(),URL.revokeObjectURL(m.href)};return r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center space-x-2",children:[r.jsx("span",{children:"📁"}),r.jsx("span",{children:"Tải File"})]}),t&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"📁 Tải file câu hỏi"}),r.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"📋 Định dạng file:"}),r.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[r.jsx("li",{children:"• Cột 1: Câu hỏi"}),r.jsx("li",{children:"• Cột 2-5: Đáp án A, B, C, D"}),r.jsx("li",{children:"• Cột 6: Đáp án đúng (A/B/C/D)"}),r.jsx("li",{children:"• Cột 7: Giải thích (tùy chọn)"}),r.jsx("li",{children:"• Cột 8: Điểm (mặc định 10)"})]})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>p("csv"),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"📄 Tải mẫu CSV"}),r.jsx("button",{onClick:()=>p("excel"),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"📊 Tải mẫu Excel"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"📄 Chọn file CSV:"}),r.jsx("input",{type:"file",accept:".csv",onChange:g=>o(g,"csv"),disabled:s,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"📊 Chọn file Excel:"}),r.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:g=>o(g,"excel"),disabled:s,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s&&r.jsxs("div",{className:"flex items-center justify-center py-4",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-2 text-blue-600",children:"Đang xử lý file..."})]}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:["💡 ",r.jsx("strong",{children:"Mẹo:"})," Sử dụng template để đảm bảo định dạng đúng. File có thể chứa nhiều câu hỏi, mỗi câu hỏi trên một dòng."]})})]})]})})]})},Mt={API_KEY:"AIzaSyB6bUM5UFLNcwPYDFPkdW2i6uy-QH7ldsA",API_URL:"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent",VISION_API_URL:"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro-vision:generateContent"},Xs=Mt.API_KEY,Vs=Mt.API_URL,Ks=Mt.VISION_API_URL;class Hs{async callGeminiAPI(t,n=!1,s){var i;try{const o=n?Ks:Vs;let l={generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:2048}};n&&s?l.contents=[{parts:[{text:t},{inlineData:{mimeType:"image/jpeg",data:s.split(",")[1]}}]}]:l.contents=[{parts:[{text:t}]}];const c=await fetch(`${o}?key=${Xs}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok){const p=await c.json().catch(()=>({}));throw new Error(`Gemini API error: ${c.status} - ${((i=p.error)==null?void 0:i.message)||"Unknown error"}`)}const u=await c.json();if(!u.candidates||!u.candidates[0]||!u.candidates[0].content)throw new Error("Invalid response from Gemini API");return u.candidates[0].content.parts[0].text}catch(o){throw console.error("Gemini API call failed:",o),o instanceof Error?o:new Error("Không thể kết nối với Gemini AI")}}createPrompt(t){const{topic:n,count:s,difficulty:i,questionTypes:o,language:l}=t,c={easy:l==="vi"?"dễ":"easy",medium:l==="vi"?"trung bình":"medium",hard:l==="vi"?"khó":"hard"},u=o.map(p=>{switch(p){case"multiple":return l==="vi"?"trắc nghiệm":"multiple choice";case"boolean":return l==="vi"?"đúng/sai":"true/false";case"short_answer":return l==="vi"?"điền chỗ trống":"fill in the blank";default:return p}}).join(", ");return l==="vi"?`Tạo ${s} câu hỏi ${u} về chủ đề "${n}" với độ khó ${c[i]} bằng tiếng Việt.

Yêu cầu format JSON chính xác:
{
  "questions": [
    {
      "question": "Câu hỏi?",
      "answers": ["Đáp án A", "Đáp án B", "Đáp án C", "Đáp án D"],
      "correctAnswer": 0,
      "type": "multiple",
      "difficulty": "${i}",
      "explanation": "Giải thích ngắn gọn"
    }
  ]
}

Lưu ý:
- Với câu hỏi trắc nghiệm: cung cấp 4 đáp án, type = "multiple"
- Với câu hỏi đúng/sai: cung cấp 2 đáp án ["Đúng", "Sai"], type = "boolean"
- Với câu điền chỗ trống: câu hỏi có dấu _____ và đáp án là từ cần điền, type = "short_answer"
- correctAnswer là chỉ số của đáp án đúng (bắt đầu từ 0)
- Tất cả nội dung phải bằng tiếng Việt
- Chỉ trả về JSON, không có text khác`:`Create ${s} ${u} questions about "${n}" with ${i} difficulty in English.

Required JSON format:
{
  "questions": [
    {
      "question": "Question text?",
      "answers": ["Answer A", "Answer B", "Answer C", "Answer D"],
      "correctAnswer": 0,
      "type": "multiple", 
      "difficulty": "${i}",
      "explanation": "Brief explanation"
    }
  ]
}

Notes:
- For multiple choice: provide 4 answers, type = "multiple"
- For true/false: provide 2 answers ["True", "False"], type = "boolean"
- For fill-in-blank: question has _____ and answer is the word to fill, type = "short_answer"
- correctAnswer is the index of correct answer (starting from 0)
- All content must be in English
- Return only JSON, no other text`}async generateQuestions(t){try{const n=this.createPrompt(t),i=(await this.callGeminiAPI(n)).replace(/```json\n?/g,"").replace(/```\n?/g,"").trim(),o=JSON.parse(i);if(!o.questions||!Array.isArray(o.questions))throw new Error("Invalid questions format from AI");return o.questions.map(l=>({question:l.question,answers:l.answers||[],correctAnswer:l.correctAnswer||0,type:l.type||"multiple",difficulty:l.difficulty||t.difficulty,explanation:l.explanation||""}))}catch(n){throw console.error("Error generating questions:",n),new Error("Không thể tạo câu hỏi từ AI")}}async generateQuestionsFromImage(t,n){try{const i=`Hãy phân tích hình ảnh này và tạo câu hỏi dựa trên nội dung trong ảnh. ${this.createPrompt(t)}`,l=(await this.callGeminiAPI(i,!0,n)).replace(/```json\n?/g,"").replace(/```\n?/g,"").trim(),c=JSON.parse(l);if(!c.questions||!Array.isArray(c.questions))throw new Error("Invalid questions format from AI");return c.questions.map(u=>({question:u.question,answers:u.answers||[],correctAnswer:u.correctAnswer||0,type:u.type||"multiple",difficulty:u.difficulty||t.difficulty,explanation:u.explanation||""}))}catch(s){throw console.error("Error generating questions from image:",s),new Error("Không thể tạo câu hỏi từ hình ảnh")}}async testConnection(){try{return{success:!0,message:`Kết nối thành công với Firebase Gemini API: ${(await this.callGeminiAPI('Hello, this is a test. Please respond with "Test successful"')).substring(0,100)}...`}}catch(t){return{success:!1,message:`Lỗi kết nối Firebase API: ${t instanceof Error?t.message:"Unknown error"}`}}}}const an=new Hs,Ys=({onQuestionsGenerated:e})=>{const[t,n]=d.useState("text"),[s,i]=d.useState(""),[o,l]=d.useState(!1),[c,u]=d.useState(null),[p,g]=d.useState(null),[a,h]=d.useState(null),[f,y]=d.useState(null),m=d.useRef(null),x=d.useRef(null),[v,w]=d.useState({topic:"",count:10,difficulty:"medium",questionTypes:["multiple"],language:"vi"}),j=(b,C)=>{const E=b.answers.map((N,L)=>({id:`${C}-${L}`,text:N,isCorrect:L===b.correctAnswer}));return{id:`gemini-${C}-${Date.now()}`,text:b.question,type:b.type==="multiple"?"multiple":b.type==="boolean"?"boolean":"short_answer",answers:E,explanation:b.explanation,points:b.difficulty==="easy"?1:b.difficulty==="medium"?2:3}},R=b=>new Promise((C,E)=>{const N=new FileReader;N.onload=L=>{var _;const B=(_=L.target)==null?void 0:_.result;b.type.includes("pdf")?C(`[PDF Content] ${b.name} - Vui lòng nhập nội dung thủ công hoặc sử dụng OCR`):C(B)},N.onerror=()=>E(new Error("Không thể đọc file")),b.type.includes("text")||b.type.includes("json")?N.readAsText(b):N.readAsDataURL(b)}),S=async b=>{var E;const C=(E=b.target.files)==null?void 0:E[0];if(C){h(C),u(null);try{if(C.type.startsWith("image/")){const N=URL.createObjectURL(C);y(N),i(`[Hình ảnh được tải lên: ${C.name}] - AI sẽ phân tích và tạo câu hỏi dựa trên nội dung hình ảnh này.`)}else{const N=await R(C);i(N)}g(`✅ Đã tải lên: ${C.name}`)}catch(N){u(`Lỗi đọc file: ${N instanceof Error?N.message:"Unknown error"}`)}}},I=async()=>{if(!s.trim()&&!a){u("Vui lòng nhập nội dung hoặc tải lên file");return}l(!0),u(null),g(null);try{let b;if(a!=null&&a.type.startsWith("image/")&&f){const E={...v,topic:s||"Nội dung từ hình ảnh"};b=await an.generateQuestionsFromImage(E,f)}else{let E=s;a&&!a.type.startsWith("image/")&&(E=`Dựa trên nội dung file "${a.name}":

${s}`);const N={...v,topic:E||"Nội dung được cung cấp"};b=await an.generateQuestions(N)}const C=b.map(j);e(C),g(`🎉 Đã tạo thành công ${C.length} câu hỏi từ ${a?`file "${a.name}"`:"nội dung văn bản"}!`),i(""),h(null),y(null),m.current&&(m.current.value=""),x.current&&(x.current.value="")}catch(b){const C=b instanceof Error?b.message:"Có lỗi xảy ra";u(C)}l(!1)},D=()=>{h(null),y(null),i(""),g(null),m.current&&(m.current.value=""),x.current&&(x.current.value="")};return r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-8 rounded-2xl shadow-xl",children:[r.jsx("div",{className:"flex items-center justify-center mb-8",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full",children:r.jsx(bt,{className:"w-8 h-8 text-white"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Gemini AI Generator"}),r.jsx("p",{className:"text-gray-600",children:"Tạo câu hỏi thông minh từ văn bản, file và hình ảnh"})]})]})}),r.jsx("div",{className:"flex justify-center mb-8",children:r.jsxs("div",{className:"flex bg-white rounded-xl p-2 shadow-lg",children:[r.jsxs("button",{onClick:()=>n("text"),className:`flex items-center space-x-2 px-6 py-3 rounded-lg transition-all ${t==="text"?"bg-purple-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx(Le,{className:"w-5 h-5"}),r.jsx("span",{children:"Văn bản"})]}),r.jsxs("button",{onClick:()=>n("file"),className:`flex items-center space-x-2 px-6 py-3 rounded-lg transition-all ${t==="file"?"bg-purple-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx(Xt,{className:"w-5 h-5"}),r.jsx("span",{children:"File"})]}),r.jsxs("button",{onClick:()=>n("image"),className:`flex items-center space-x-2 px-6 py-3 rounded-lg transition-all ${t==="image"?"bg-purple-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx(ft,{className:"w-5 h-5"}),r.jsx("span",{children:"Hình ảnh"})]})]})}),r.jsxs("div",{className:"mb-8",children:[t==="text"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"📝 Nhập nội dung để tạo câu hỏi"}),r.jsx("textarea",{value:s,onChange:b=>i(b.target.value),placeholder:"Ví dụ: Lịch sử Việt Nam từ năm 1945 đến 1975, các sự kiện quan trọng...",className:"w-full h-40 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none resize-none"})]}),t==="file"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"📄 Tải lên file (PDF, DOCX, TXT)"}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 transition-colors cursor-pointer",onClick:()=>{var b;return(b=m.current)==null?void 0:b.click()},children:[r.jsx(Xt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Click để chọn file hoặc kéo thả vào đây"}),r.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Hỗ trợ: PDF, DOCX, TXT (Tối đa 10MB)"})]}),r.jsx("input",{ref:m,type:"file",accept:".pdf,.docx,.doc,.txt",onChange:S,className:"hidden"})]}),t==="image"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"🖼️ Tải lên hình ảnh"}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 transition-colors cursor-pointer",onClick:()=>{var b;return(b=x.current)==null?void 0:b.click()},children:[r.jsx(ft,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Click để chọn ảnh hoặc kéo thả vào đây"}),r.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Hỗ trợ: JPG, PNG, GIF (Tối đa 5MB)"})]}),r.jsx("input",{ref:x,type:"file",accept:"image/*",onChange:S,className:"hidden"})]}),a&&r.jsxs("div",{className:"mt-4 p-4 bg-white rounded-xl border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[a.type.startsWith("image/")?r.jsx(ft,{className:"w-6 h-6 text-purple-600"}):r.jsx(Le,{className:"w-6 h-6 text-purple-600"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:a.name}),r.jsxs("p",{className:"text-sm text-gray-500",children:[(a.size/1024/1024).toFixed(2)," MB"]})]})]}),r.jsx("button",{onClick:D,className:"p-2 text-gray-400 hover:text-red-500 transition-colors",children:r.jsx(zn,{className:"w-5 h-5"})})]}),f&&r.jsx("div",{className:"mt-3",children:r.jsx("img",{src:f,alt:"Preview",className:"max-w-full h-32 object-cover rounded-lg"})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Số lượng câu hỏi"}),r.jsxs("select",{value:v.count,onChange:b=>w({...v,count:parseInt(b.target.value)}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none",children:[r.jsx("option",{value:5,children:"5 câu"}),r.jsx("option",{value:10,children:"10 câu"}),r.jsx("option",{value:15,children:"15 câu"}),r.jsx("option",{value:20,children:"20 câu"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Độ khó"}),r.jsxs("select",{value:v.difficulty,onChange:b=>w({...v,difficulty:b.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none",children:[r.jsx("option",{value:"easy",children:"Dễ"}),r.jsx("option",{value:"medium",children:"Trung bình"}),r.jsx("option",{value:"hard",children:"Khó"})]})]})]}),r.jsxs("div",{className:"mb-8",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Loại câu hỏi"}),r.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{value:"multiple",label:"📝 Trắc nghiệm",icon:"🔘"},{value:"boolean",label:"✅ Đúng/Sai",icon:"☑️"},{value:"short_answer",label:"✍️ Điền chỗ trống",icon:"📝"}].map(b=>r.jsxs("label",{className:"flex items-center p-4 bg-white rounded-xl border-2 border-gray-200 hover:border-purple-300 transition-colors cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:v.questionTypes.includes(b.value),onChange:C=>{const E=C.target.checked?[...v.questionTypes,b.value]:v.questionTypes.filter(N=>N!==b.value);w({...v,questionTypes:E})},className:"sr-only"}),r.jsx("div",{className:`w-5 h-5 rounded border-2 mr-3 flex items-center justify-center ${v.questionTypes.includes(b.value)?"bg-purple-600 border-purple-600 text-white":"border-gray-300"}`,children:v.questionTypes.includes(b.value)&&"✓"}),r.jsx("span",{className:"text-sm font-medium",children:b.label})]},b.value))})]}),c&&r.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700",children:["❌ ",c]}),p&&r.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-xl text-green-700",children:p}),r.jsx("button",{onClick:I,disabled:o||v.questionTypes.length===0||!s.trim()&&!a,className:`w-full py-4 px-6 rounded-xl font-bold text-lg transition-all ${o||v.questionTypes.length===0||!s.trim()&&!a?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700 shadow-lg hover:shadow-xl transform hover:scale-105"}`,children:o?r.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[r.jsx(Yn,{className:"w-6 h-6 animate-spin"}),r.jsx("span",{children:"🤖 AI đang tạo câu hỏi..."})]}):r.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r.jsx(bt,{className:"w-6 h-6"}),r.jsxs("span",{children:["🚀 Tạo ",v.count," câu hỏi với AI"]})]})}),r.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:r.jsx("p",{children:"🤖 Powered by Google Gemini AI • ⚡ Thông minh • 🎯 Chính xác"})})]})},Ws=({quiz:e,setQuiz:t,addQuestion:n,updateQuestion:s,deleteQuestion:i,moveQuestion:o})=>{const[l,c]=d.useState(!1),u=gr(Ht(kt),Ht(It,{coordinateGetter:Fs})),p=h=>{const{active:f,over:y}=h;if(f.id!==(y==null?void 0:y.id)){const m=e.questions.findIndex((v,w)=>w.toString()===f.id),x=e.questions.findIndex((v,w)=>w.toString()===(y==null?void 0:y.id));t(v=>({...v,questions:Tt(v.questions,m,x)}))}},g=h=>{t(f=>({...f,questions:[...f.questions,...h]}))},a=h=>{t(f=>({...f,questions:[...f.questions,...h]})),c(!1)};return r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Danh sách câu hỏi"}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsx(Y,{onClick:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"+ Thêm câu hỏi"}),r.jsx(zs,{onQuestionsImported:g}),r.jsxs(Y,{onClick:()=>c(!0),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white flex items-center space-x-2",children:[r.jsx(bt,{className:"w-4 h-4"}),r.jsx("span",{children:"🤖 Gemini AI"})]})]})]}),e.questions.length===0&&r.jsx("div",{className:"text-gray-500",children:"Chưa có câu hỏi nào."}),r.jsx(ms,{sensors:u,collisionDetection:mr,onDragEnd:p,children:r.jsx(Is,{items:e.questions.map((h,f)=>f.toString()),strategy:Rs,children:r.jsx("div",{className:"space-y-4",children:e.questions.map((h,f)=>r.jsx(Gs,{id:f.toString(),index:f,question:h,onUpdate:y=>s(f,y),onDelete:()=>i(f),moveQuestion:o,totalQuestions:e.questions.length},h.id))})})}),l&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[r.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"🤖 Gemini AI Generator"}),r.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 text-3xl font-bold transition-colors",children:"×"})]}),r.jsx("div",{className:"p-6",children:r.jsx(Ys,{onQuestionsGenerated:a})})]})})]})},Qs=({quiz:e})=>{const t=e.questions.reduce((n,s)=>n+s.points,0);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"Thông tin Quiz"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Tiêu đề:"})," ",e.title]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Danh mục:"})," ",e.category]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Độ khó:"})," ",e.difficulty]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Thời gian:"})," ",e.duration," phút"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Số câu hỏi:"})," ",e.questions.length]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Tổng điểm:"})," ",t]})]}),e.description&&r.jsxs("div",{className:"mt-2",children:[r.jsx("strong",{children:"Mô tả:"})," ",e.description]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"font-bold text-gray-800",children:"Danh sách câu hỏi"}),e.questions.map((n,s)=>r.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("h4",{className:"font-medium",children:["Câu ",s+1,": ",n.text]}),r.jsxs("div",{className:"text-sm text-gray-500",children:[n.type," • ",n.points," điểm"]})]}),n.type==="short_answer"?r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Đáp án:"})," ",n.correctAnswer,n.acceptedAnswers&&n.acceptedAnswers.length>1&&r.jsxs("div",{children:[r.jsx("strong",{children:"Các cách viết khác:"})," ",n.acceptedAnswers.slice(1).join(", ")]})]}):r.jsx("div",{className:"space-y-1",children:n.answers.map((i,o)=>r.jsxs("div",{className:`text-sm p-2 rounded ${i.isCorrect?"bg-green-100 text-green-700":"bg-gray-100"}`,children:[String.fromCharCode(65+o),". ",i.text,i.isCorrect&&" ✓",n.type==="image"&&i.imageUrl&&r.jsx("img",{src:i.imageUrl,alt:i.text,className:"w-16 h-16 object-cover rounded ml-2 inline-block"})]},i.id))}),n.explanation&&r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("strong",{children:"Giải thích:"})," ",n.explanation]})]},n.id))]})]})},ei=()=>{const{user:e}=Xn(m=>m.auth),[t,n]=d.useState(Vt),[s,i]=d.useState(0),[o,l]=d.useState(!1),c=()=>{n(m=>({...m,questions:[...m.questions,{id:ee(),text:"",type:"multiple",answers:[{id:ee(),text:"",isCorrect:!0},{id:ee(),text:"",isCorrect:!1},{id:ee(),text:"",isCorrect:!1},{id:ee(),text:"",isCorrect:!1}],points:1,correctAnswer:"",acceptedAnswers:[]}]}))},u=(m,x)=>{n(v=>({...v,questions:v.questions.map((w,j)=>j===m?x:w)}))},p=m=>{n(x=>({...x,questions:x.questions.filter((v,w)=>w!==m)}))},g=(m,x)=>{x<0||x>=t.questions.length||n(v=>{const w=[...v.questions],[j]=w.splice(m,1);return w.splice(x,0,j),{...v,questions:w}})},a=m=>{switch(m){case 0:return!!(t.title&&t.description&&t.category&&t.difficulty);case 1:return t.questions.length>0&&t.questions.every(x=>{if(!x.text)return!1;switch(x.type){case"short_answer":return!!x.correctAnswer;case"boolean":case"multiple":case"image":return x.answers.some(v=>v.isCorrect)&&x.answers.every(v=>v.text);default:return!1}});case 2:return!0;default:return!1}},h=async()=>{if(!e){ae.error("Bạn cần đăng nhập để tạo quiz");return}if(!a(1)){ae.error("Vui lòng hoàn thành tất cả thông tin quiz");return}l(!0);try{await Vn(Kn(Hn,"quizzes"),{...t,createdBy:e.uid,createdAt:Gt(),updatedAt:Gt(),isPublished:!0,tags:[],status:"pending"}),ae.success("Tạo quiz thành công! Quiz đang chờ admin duyệt."),n(Vt),i(0)}catch(m){console.error("Error creating quiz:",m),ae.error("Có lỗi xảy ra khi tạo quiz")}finally{l(!1)}},f=()=>{a(s)?i(m=>Math.min(m+1,Ze.length-1)):ae.error("Vui lòng hoàn thành thông tin trước khi tiếp tục")},y=()=>{i(m=>Math.max(m-1,0))};return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Tạo Quiz Mới"}),r.jsx("div",{className:"flex items-center justify-between mb-6",children:Ze.map((m,x)=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${x<=s?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:x+1}),r.jsx("span",{className:`ml-2 text-sm ${x<=s?"text-blue-600 font-medium":"text-gray-500"}`,children:m}),x<Ze.length-1&&r.jsx("div",{className:`w-16 h-0.5 mx-4 ${x<s?"bg-blue-500":"bg-gray-200"}`})]},x))})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s===0&&r.jsx(qn,{quiz:t,setQuiz:n}),s===1&&r.jsx(Ws,{quiz:t,setQuiz:n,addQuestion:c,updateQuestion:u,deleteQuestion:p,moveQuestion:g}),s===2&&r.jsx(Qs,{quiz:t}),r.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-200",children:[r.jsx(Y,{onClick:y,disabled:s===0,variant:"outline",children:"← Quay lại"}),r.jsx("div",{className:"flex gap-3",children:s===Ze.length-1?r.jsx(Y,{onClick:h,disabled:o||!a(s),loading:o,className:"bg-green-600 hover:bg-green-700",children:"🚀 Xuất bản Quiz"}):r.jsx(Y,{onClick:f,disabled:!a(s),children:"Tiếp tục →"})})]})]})]})})};export{ei as default};
