import{u as y,r as c,j as e,X as j,S as f,y as a,b as d}from"./index-CNQy308a.js";import{S as N}from"./send-jCzz2FPG.js";const w=({quizId:m,onReviewSubmitted:u,onClose:o,existingReview:s})=>{const{user:n}=y(r=>r.auth),[t,x]=c.useState((s==null?void 0:s.rating)||0),[l,g]=c.useState((s==null?void 0:s.comment)||""),[i,h]=c.useState(!1),b=async r=>{if(r.preventDefault(),!n){a.error("Bạn cần đăng nhập để đánh giá");return}if(t===0){a.error("Vui lòng chọn số sao");return}h(!0);try{s?(await d.updateReview(s.id,{rating:t,comment:l}),a.success("Cập nhật đánh giá thành công!")):(await d.createReview({quizId:m,rating:t,comment:l},n.uid,n.displayName||n.email||""),a.success("Gửi đánh giá thành công!")),u()}catch(p){console.error("Error submitting review:",p),a.error("Có lỗi khi gửi đánh giá")}finally{h(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s?"Chỉnh sửa đánh giá":"Viết đánh giá"}),e.jsx("button",{onClick:o,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(j,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Đánh giá của bạn"}),e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(r=>e.jsx("button",{type:"button",onClick:()=>x(r),className:`p-1 transition-colors ${r<=t?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"}`,children:e.jsx(f,{className:`w-8 h-8 ${r<=t?"fill-current":""}`})},r))}),t>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[t===1&&"Rất không hài lòng",t===2&&"Không hài lòng",t===3&&"Bình thường",t===4&&"Hài lòng",t===5&&"Rất hài lòng"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhận xét (tùy chọn)"}),e.jsx("textarea",{value:l,onChange:r=>g(r.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Chia sẻ trải nghiệm của bạn về quiz này...",maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.length,"/500 ký tự"]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Hủy"}),e.jsx("button",{type:"submit",disabled:i||t===0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Đang gửi..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:s?"Cập nhật":"Gửi đánh giá"})]})})]})]})]})})})};export{w as R};
