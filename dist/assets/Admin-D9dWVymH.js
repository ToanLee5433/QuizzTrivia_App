import{r as e,u as s,j as t,L as a,m as l,l as r,h as d,p as n,y as i,g as o,o as c}from"./index-0teFe5Sq.js";import{A as m}from"./AdminLayout-DR5EOYqR.js";const x=()=>{const[x,h]=e.useState({totalQuizzes:0,totalUsers:0,completedQuizzes:0,totalCreators:0});e.useEffect(()=>{(async()=>{try{const e=await l(r(d,"quizzes")),s=e.docs.map(e=>e.data()).filter(e=>"approved"===e.status),t=s.length,a=s.filter(e=>!0===e.completed||"completed"===e.status).length,n=s.map(e=>e.creatorId).filter((e,s,t)=>e&&t.indexOf(e)===s).length,i=await l(r(d,"users")),o=i.docs.map(e=>e.data()).length;h({totalQuizzes:t,totalUsers:o,completedQuizzes:a,totalCreators:n})}catch(e){}})()},[]);const{user:g}=s(e=>e.auth),[u,b]=e.useState(!1),[p,f]=e.useState(!1),[j,v]=e.useState({message:"",type:"info",targetRole:"all"});return"admin"!==(null==g?void 0:g.role)?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-600",children:"B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang n√†y."})}):t.jsxs(m,{title:"Dashboard",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg shadow-lg p-6 mb-8 text-white",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Ch√†o m·ª´ng ƒë·∫øn v·ªõi Admin Dashboard"}),t.jsx("p",{className:"text-blue-100",children:"Qu·∫£n l√Ω to√†n b·ªô h·ªá th·ªëng Quiz m·ªôt c√°ch hi·ªáu qu·∫£"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:t.jsx("span",{className:"text-2xl",children:"üìö"})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:"T·ªïng s·ªë Quiz"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-blue-600",children:x.totalQuizzes})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:t.jsx("span",{className:"text-2xl",children:"üë•"})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:"Ng∆∞·ªùi d√πng"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-green-600",children:x.totalUsers})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:t.jsx("span",{className:"text-2xl",children:"‚úÖ"})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:"Quiz ho√†n th√†nh"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-purple-600",children:x.completedQuizzes})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:t.jsx("span",{className:"text-2xl",children:"‚úèÔ∏è"})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:"Ng∆∞·ªùi t·∫°o"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-orange-600",children:x.totalCreators})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[t.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:"Qu·∫£n l√Ω Quiz"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(a,{to:"/admin/quiz-management",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:"‚óÜ Qu·∫£n l√Ω Quiz"}),t.jsx(a,{to:"/admin/categories",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:"üìÇ Qu·∫£n l√Ω danh m·ª•c"}),t.jsx(a,{to:"/admin/quiz-stats",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:"üìä Th·ªëng k√™ Quiz"})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[t.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:"Qu·∫£n l√Ω ng∆∞·ªùi d√πng"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(a,{to:"/admin/users",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:"üë• Danh s√°ch ng∆∞·ªùi d√πng"}),t.jsx(a,{to:"/admin/roles",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:"üîê Ph√¢n quy·ªÅn ng∆∞·ªùi d√πng"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-900 flex items-center",children:[t.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:"‚ö°"}),"Thao t√°c nhanh"]}),t.jsx("span",{className:"text-sm text-gray-500",children:"C√°c ch·ª©c nƒÉng quan tr·ªçng"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[t.jsx("button",{onClick:()=>b(!0),className:"group bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:p,children:t.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[t.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"üì¢"}),t.jsx("span",{className:"text-sm font-medium",children:"G·ª≠i th√¥ng b√°o"})]})}),t.jsx("button",{onClick:async()=>{if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ th√¥ng b√°o ƒëang hi·ªÉn th·ªã?")){f(!0);try{const e=(await l(r(d,"system_notifications"))).docs.map(e=>n(e.ref,{isActive:!1}));await Promise.all(e),i.success("ƒê√£ t·∫Øt t·∫•t c·∫£ th√¥ng b√°o!")}catch(e){i.error("L·ªói khi x√≥a th√¥ng b√°o!")}finally{f(!1)}}},className:"group bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:p,children:t.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[t.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"‚ùå"}),t.jsx("span",{className:"text-sm font-medium",children:"X√≥a th√¥ng b√°o"})]})}),t.jsx("button",{onClick:async()=>{f(!0);try{const e=["users","quizzes","categories","quiz_results"],s={};for(const i of e){const e=await l(r(d,i));s[i]=e.docs.map(e=>({id:e.id,...e.data()}))}const t=JSON.stringify(s,null,2),a=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(a),o=document.createElement("a");o.href=n,o.download=`quiz-app-backup-${(new Date).toISOString().split("T")[0]}.json`,o.click(),i.success("Backup d·ªØ li·ªáu th√†nh c√¥ng!")}catch(e){i.error("L·ªói khi backup d·ªØ li·ªáu!")}finally{f(!1)}},className:"group bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:p,children:t.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[t.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"üíæ"}),t.jsx("span",{className:"text-sm font-medium",children:"Backup d·ªØ li·ªáu"})]})}),t.jsx("button",{onClick:async()=>{if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën d·ªçn d·∫πp d·ªØ li·ªáu ƒë√£ xo√° (quiz, user)?")){f(!0);try{const e=await l(r(d,"quizzes")),s=e.docs.filter(e=>!0===e.data().deleted).map(e=>n(o(d,"quizzes",e.id),{isPurged:!0})),t=await l(r(d,"users")),a=t.docs.filter(e=>!0===e.data().deleted).map(e=>n(o(d,"users",e.id),{isPurged:!0}));await Promise.all([...s,...a]),i.success("ƒê√£ d·ªçn d·∫πp d·ªØ li·ªáu xo√°!")}catch(e){i.error("L·ªói khi d·ªçn d·∫πp d·ªØ li·ªáu xo√°!")}finally{f(!1)}}},className:"group bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:p,children:t.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[t.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"üóëÔ∏è"}),t.jsx("span",{className:"text-sm font-medium",children:"D·ªçn d·∫πp d·ªØ li·ªáu"})]})})]})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4",children:[t.jsx("h2",{className:"text-lg md:text-xl font-semibold mb-4",children:"G·ª≠i th√¥ng b√°o h·ªá th·ªëng"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N·ªôi dung th√¥ng b√°o"}),t.jsx("textarea",{value:j.message,onChange:e=>v(s=>({...s,message:e.target.value})),placeholder:"Nh·∫≠p n·ªôi dung th√¥ng b√°o...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",rows:4})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lo·∫°i th√¥ng b√°o"}),t.jsxs("select",{value:j.type,onChange:e=>v(s=>({...s,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[t.jsx("option",{value:"info",children:"Th√¥ng tin (Xanh)"}),t.jsx("option",{value:"warning",children:"C·∫£nh b√°o (V√†ng)"}),t.jsx("option",{value:"success",children:"Th√†nh c√¥ng (Xanh l√°)"}),t.jsx("option",{value:"error",children:"L·ªói (ƒê·ªè)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ƒê·ªëi t∆∞·ª£ng nh·∫≠n"}),t.jsxs("select",{value:j.targetRole,onChange:e=>v(s=>({...s,targetRole:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[t.jsx("option",{value:"all",children:"T·∫•t c·∫£ ng∆∞·ªùi d√πng"}),t.jsx("option",{value:"user",children:"Ch·ªâ User"}),t.jsx("option",{value:"creator",children:"Ch·ªâ Creator"})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 pt-4",children:[t.jsx("button",{onClick:()=>b(!1),className:"w-full sm:w-auto px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm md:text-base",disabled:p,children:"H·ªßy"}),t.jsx("button",{onClick:async()=>{if(j.message.trim()){f(!0);try{await c(r(d,"system_notifications"),{message:j.message,type:j.type,createdAt:new Date,isActive:!0,targetRole:j.targetRole}),v({message:"",type:"info",targetRole:"all"}),b(!1),i.success("ƒê√£ g·ª≠i th√¥ng b√°o h·ªá th·ªëng!")}catch(e){i.error("L·ªói khi g·ª≠i th√¥ng b√°o!")}finally{f(!1)}}else i.error("Vui l√≤ng nh·∫≠p n·ªôi dung th√¥ng b√°o!")},disabled:p||!j.message.trim(),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:p?"ƒêang g·ª≠i...":"G·ª≠i th√¥ng b√°o"})]})]})]})})]})};export{x as default};
