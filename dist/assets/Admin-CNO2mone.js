import{a as e,r as s,u as t,j as a,L as i,m as l,l as r,h as d,p as n,y as o,g as c,o as m}from"./index-BcvsJ6SD.js";import{A as u}from"./AdminLayout-C9BITLMG.js";const x=()=>{const{t:x}=e(),[g,h]=s.useState({totalQuizzes:0,totalUsers:0,completedQuizzes:0,totalCreators:0});s.useEffect(()=>{(async()=>{try{const e=await l(r(d,"quizzes")),s=e.docs.map(e=>e.data()).filter(e=>"approved"===e.status),t=s.length,a=s.filter(e=>!0===e.completed||"completed"===e.status).length,i=s.map(e=>e.creatorId).filter((e,s,t)=>e&&t.indexOf(e)===s).length,n=await l(r(d,"users")),o=n.docs.map(e=>e.data()).length;h({totalQuizzes:t,totalUsers:o,completedQuizzes:a,totalCreators:i})}catch(e){}})()},[]);const{user:b}=t(e=>e.auth),[p,f]=s.useState(!1),[j,y]=s.useState(!1),[v,N]=s.useState({message:"",type:"info",targetRole:"all"});return"admin"!==(null==b?void 0:b.role)?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:x("admin.loginAsAdmin","You need admin rights to access this page.")})}):a.jsxs(u,{title:x("admin.sidebar.nav.dashboard"),children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg shadow-lg p-6 mb-8 text-white",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:x("admin.greeting","Welcome to Admin Panel")}),a.jsx("p",{className:"text-blue-100",children:x("admin.dashboardSubtitle","Manage the entire Quiz system efficiently")})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"ðŸ“š"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:x("dashboard.totalQuizzes","Total Quizzes")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-blue-600",children:g.totalQuizzes})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"ðŸ‘¥"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:x("dashboard.totalUsers","Users")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-green-600",children:g.totalUsers})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"âœ…"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:x("dashboard.completedQuizzes","Completed Quizzes")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-purple-600",children:g.completedQuizzes})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"âœï¸"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:x("dashboard.totalCreators","Creators")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-orange-600",children:g.totalCreators})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:x("admin.tabs.quizManagement","Quiz Management")}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(i,{to:"/admin/quiz-management",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["â—† ",x("admin.tabs.quizManagement","Quiz Management")]}),a.jsxs(i,{to:"/admin/categories",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["ðŸ“‚ ",x("admin.tabs.categoryManagement","Category Management")]}),a.jsxs(i,{to:"/admin/quiz-stats",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["ðŸ“Š ",x("admin.stats.quizActivity","Quiz activity")]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:x("admin.tabs.userManagement","User Management")}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(i,{to:"/admin/users",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["ðŸ‘¥ ",x("admin.tabs.users","Users")]}),a.jsxs(i,{to:"/admin/roles",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["ðŸ” ",x("admin.roles","Roles")]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-900 flex items-center",children:[a.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:"âš¡"}),x("admin.quickActions.title","Quick actions")]}),a.jsx("span",{className:"text-sm text-gray-500",children:x("admin.quickActions.important","Important functions")})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[a.jsx("button",{onClick:()=>f(!0),className:"group bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"ðŸ“¢"}),a.jsx("span",{className:"text-sm font-medium",children:x("admin.quickActions.items.notify.title","Send notification")})]})}),a.jsx("button",{onClick:async()=>{if(confirm(x("admin.quickActions.toasts.confirmDeleteAll","Are you sure you want to disable all visible notifications?"))){y(!0);try{const e=(await l(r(d,"system_notifications"))).docs.map(e=>n(e.ref,{isActive:!1}));await Promise.all(e),o.success(x("admin.quickActions.toasts.deleteSuccess","All notifications disabled!"))}catch(e){o.error(x("admin.quickActions.toasts.deleteError","Error disabling notifications!"))}finally{y(!1)}}},className:"group bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"âŒ"}),a.jsx("span",{className:"text-sm font-medium",children:x("admin.quickActions.items.deleteNotifications.title","Clear notifications")})]})}),a.jsx("button",{onClick:async()=>{y(!0);try{const e=["users","quizzes","categories","quiz_results"],s={};for(const o of e){const e=await l(r(d,o));s[o]=e.docs.map(e=>({id:e.id,...e.data()}))}const t=JSON.stringify(s,null,2),a=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=`quiz-app-backup-${(new Date).toISOString().split("T")[0]}.json`,n.click(),o.success(x("admin.quickActions.toasts.backupSuccess","Data backup successful!"))}catch(e){o.error(x("admin.quickActions.toasts.backupError","Error during data backup!"))}finally{y(!1)}},className:"group bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"ðŸ’¾"}),a.jsx("span",{className:"text-sm font-medium",children:x("admin.quickActions.items.backup.title","Backup data")})]})}),a.jsx("button",{onClick:async()=>{if(confirm(x("admin.quickActions.toasts.confirmCleanup","Are you sure you want to cleanup deleted data (quizzes, users)?"))){y(!0);try{const e=await l(r(d,"quizzes")),s=e.docs.filter(e=>!0===e.data().deleted).map(e=>n(c(d,"quizzes",e.id),{isPurged:!0})),t=await l(r(d,"users")),a=t.docs.filter(e=>!0===e.data().deleted).map(e=>n(c(d,"users",e.id),{isPurged:!0}));await Promise.all([...s,...a]),o.success(x("admin.quickActions.toasts.cleanupSuccess","Deleted data cleaned up!"))}catch(e){o.error(x("admin.quickActions.toasts.cleanupError","Error during cleanup!"))}finally{y(!1)}}},className:"group bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"ðŸ—‘ï¸"}),a.jsx("span",{className:"text-sm font-medium",children:x("admin.quickActions.items.cleanup.title","Cleanup deleted data")})]})})]})]}),p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4",children:[a.jsx("h2",{className:"text-lg md:text-xl font-semibold mb-4",children:x("admin.quickActions.modal.title","Send system notification")}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("admin.quickActions.modal.contentLabel","Notification content")}),a.jsx("textarea",{value:v.message,onChange:e=>N(s=>({...s,message:e.target.value})),placeholder:x("admin.quickActions.modal.contentPlaceholder","Enter notification content..."),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",rows:4})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("admin.quickActions.modal.typeLabel","Notification type")}),a.jsxs("select",{value:v.type,onChange:e=>N(s=>({...s,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[a.jsx("option",{value:"info",children:x("admin.quickActions.modal.type.info","Info (Blue)}")}),a.jsx("option",{value:"warning",children:x("admin.quickActions.modal.type.warning","Warning (Yellow)}")}),a.jsx("option",{value:"success",children:x("admin.quickActions.modal.type.success","Success (Green)}")}),a.jsx("option",{value:"error",children:x("admin.quickActions.modal.type.error","Error (Red)}")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("admin.quickActions.modal.targetLabel","Target audience")}),a.jsxs("select",{value:v.targetRole,onChange:e=>N(s=>({...s,targetRole:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[a.jsx("option",{value:"all",children:x("admin.quickActions.modal.target.all","All users")}),a.jsx("option",{value:"user",children:x("admin.quickActions.modal.target.user","Users only")}),a.jsx("option",{value:"creator",children:x("admin.quickActions.modal.target.creator","Creators only")})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 pt-4",children:[a.jsx("button",{onClick:()=>f(!1),className:"w-full sm:w-auto px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm md:text-base",disabled:j,children:x("cancel","Cancel")}),a.jsx("button",{onClick:async()=>{if(v.message.trim()){y(!0);try{await m(r(d,"system_notifications"),{message:v.message,type:v.type,createdAt:new Date,isActive:!0,targetRole:v.targetRole}),N({message:"",type:"info",targetRole:"all"}),f(!1),o.success(x("admin.quickActions.toasts.createSuccess","Notification created successfully!"))}catch(e){o.error(x("admin.quickActions.toasts.createError","Error creating notification!"))}finally{y(!1)}}else o.error(x("admin.quickActions.toasts.enterMessage","Please enter notification content!"))},disabled:j||!v.message.trim(),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:j?x("admin.quickActions.modal.sending","Sending..."):x("admin.quickActions.modal.send","Send notification")})]})]})]})})]})};export{x as default};
