import{a as e,u as s,r as t,j as a,S as i,L as l,E as n,B as r,l as c,D as d,F as x,o as m,G as o,i as h,g as u,h as j,b as g}from"./index-D8X0wEz4.js";import{R as p}from"./ReviewForm-DfmhZ9Na.js";import{M as f}from"./message-square-CMtOZkta.js";import{P as b,G as N}from"./GameModeSelector-koXSbonl.js";import{B as y}from"./book-open-DvnZlz1q.js";import"./x-DH6wYMdX.js";import"./send-CAwxfUY-.js";import"./trophy-BdpQ7BI1.js";import"./circle-alert-B42OMoZ3.js";const v=({quizId:r,quizTitle:c})=>{const{t:d}=e(),x=s(e=>e.auth.user),[m,o]=t.useState(!1);return a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mt-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"bg-white rounded-full p-3 shadow-lg",children:a.jsx(i,{className:"w-8 h-8 text-yellow-500"})})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Bạn thấy quiz này như thế nào?"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Chia sẻ cảm nhận của bạn để giúp những người khác có trải nghiệm tốt hơn"}),a.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:x?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[a.jsx(f,{className:"w-5 h-5 mr-2"}),"Viết đánh giá"]}),a.jsxs(l,{to:`/quiz/${r}/reviews`,className:"inline-flex items-center px-6 py-3 bg-white text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors border border-gray-300 shadow-sm",children:[a.jsx(n,{className:"w-5 h-5 mr-2"}),"Xem tất cả đánh giá"]})]}):a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"Đăng nhập để đánh giá và xem các đánh giá khác"}),a.jsx(l,{to:"/login",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:d("auth.login")})]})})]}),m&&x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-auto m-4",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Đánh giá: ",c]}),a.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"×"})]}),a.jsx("div",{className:"p-6",children:a.jsx(p,{quizId:r,onReviewSubmitted:()=>{o(!1)},onClose:()=>o(!1)})})]})})]})},w=()=>{var p;const{t:f}=e(),{id:w}=r(),q=c(),z=d(),S=s(e=>e.auth.user),[R,C]=t.useState(null),[L,k]=t.useState(!0),[F,T]=t.useState(null),[$,A]=t.useState(!1);if(t.useEffect(()=>{(async()=>{if(w)try{const s=await h(u(j,"quizzes",w));if(s.exists()){const t={id:s.id,...s.data()};C(t);try{const e=await g.getQuizReviewStats(w);T(e)}catch(e){}}else q("/quizzes")}catch(e){q("/quizzes")}finally{k(!1)}})()},[w,q]),t.useEffect(()=>{const e=z.state;(null==e?void 0:e.openGameModeSelector)&&A(!0)},[z.state]),L)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:f("quiz.loading")})]})});if(!R)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:f("quiz.notFound")}),a.jsx(l,{to:"/quizzes",className:"text-blue-600 hover:underline",children:f("quiz.backToQuizList")})]})});const B=e=>{switch(e){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},M=e=>{switch(e){case"easy":return"Dễ";case"medium":return"Trung bình";case"hard":return"Khó";default:return e}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[a.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white mb-8",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-3xl font-bold mb-4",children:R.title}),a.jsx(x,{content:R.description||"",className:"text-blue-100 text-lg mb-6"}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(y,{className:"w-5 h-5"}),a.jsx("span",{children:f("quiz.questionsCount",{count:R.questions.length})})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(m,{className:"w-5 h-5"}),a.jsx("span",{children:R.timeLimit?f("quiz.timeLimit",{time:R.timeLimit/60}):f("quiz.noTimeLimit")})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(o,{className:"w-5 h-5"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${B(R.difficulty)}`,children:M(R.difficulty)})]})]}),F&&F.totalReviews>0&&a.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[a.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>a.jsx(i,{className:"w-5 h-5 "+(e<=Math.round(F.averageRating)?"text-yellow-400 fill-current":"text-gray-300")},e))}),a.jsx("span",{className:"font-semibold",children:F.averageRating.toFixed(1)}),a.jsxs("span",{className:"text-blue-200",children:["(",f("quiz.ratingCount",{count:F.totalReviews}),")"]})]}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("button",{onClick:()=>A(!0),className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all transform hover:scale-105 shadow-lg",children:[a.jsx(b,{className:"w-6 h-6 mr-2"}),f("quiz.startQuizButton")]}),a.jsxs(l,{to:`/quiz/${R.id}/reviews`,className:"inline-flex items-center px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-400 transition-colors border border-blue-400",children:[a.jsx(n,{className:"w-5 h-5 mr-2"}),f("quiz.viewReviews")]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:f("quiz.detailedInfo")}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(y,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-semibold text-gray-900",children:f("quiz.questions")})]}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:R.questions.length})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(m,{className:"w-5 h-5 text-purple-600"}),a.jsx("span",{className:"font-semibold text-gray-900",children:f("quiz.duration")})]}),a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:R.timeLimit?R.timeLimit/60+"'":"∞"})]})]}),R.tags&&R.tags.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:f("quiz.topics")}),a.jsx("div",{className:"flex flex-wrap gap-2",children:R.tags.map((e,s)=>a.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:["#",e]},s))})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:f("quiz.questionType")}),a.jsxs("div",{className:"space-y-3",children:[R.questions.slice(0,3).map((e,s)=>a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-sm font-semibold rounded-full",children:s+1}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-gray-800 font-medium",children:e.text}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-600",children:[a.jsx("span",{children:f("quiz.type",{type:f(`quiz.questionTypes.${e.type}`)})}),a.jsx("span",{children:f("quiz.points",{points:e.points})})]})]})]})},e.id)),R.questions.length>3&&a.jsx("p",{className:"text-center text-gray-600 py-4",children:f("quiz.moreQuestions",{count:R.questions.length-3})})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:f("quiz.stats")}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:f("quiz.category")}),a.jsx("span",{className:"font-semibold text-gray-900",children:R.category})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:f("quiz.difficulty")}),a.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${B(R.difficulty)}`,children:M(R.difficulty)})]}),F&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:f("quiz.rating")}),a.jsxs("span",{className:"font-semibold text-gray-900",children:[F.averageRating.toFixed(1),"/5 ⭐"]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:f("quiz.reviewCount")}),a.jsx("span",{className:"font-semibold text-gray-900",children:F.totalReviews})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:f("quiz.author")}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold",children:(null==(p=R.createdBy)?void 0:p.charAt(0).toUpperCase())||"A"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:f("quiz.author")}),a.jsx("p",{className:"text-sm text-gray-600",children:R.createdAt&&new Date(1e3*R.createdAt.seconds).toLocaleDateString("vi-VN")})]})]})]})]})]}),S&&a.jsx(v,{quizId:R.id,quizTitle:R.title})]}),a.jsx(N,{isOpen:$,onClose:()=>A(!1),onSelectSinglePlayer:()=>{A(!1),q(`/quiz/${R.id}`)},onSelectMultiplayer:()=>{A(!1),q("/multiplayer",{state:{selectedQuiz:R}})},connectionStatus:"connected"})]})};export{w as default};
