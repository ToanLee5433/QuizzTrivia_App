import{a as e,u as s,r as t,j as n,S as a,y as i,b as l}from"./index-BcvsJ6SD.js";import{X as r}from"./x-Dr67ee2A.js";import{S as c}from"./send-apfZnrca.js";const o=({quizId:o,onReviewSubmitted:d,onClose:h,existingReview:m})=>{const{t:x}=e(),{user:g}=s(e=>e.auth),[u,b]=t.useState((null==m?void 0:m.rating)||0),[p,y]=t.useState((null==m?void 0:m.comment)||""),[j,f]=t.useState(!1);return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:m?"Chỉnh sửa đánh giá":"Viết đánh giá"}),n.jsx("button",{onClick:h,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:n.jsx(r,{className:"w-5 h-5"})})]}),n.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g)if(0!==u){f(!0);try{m?(await l.updateReview(m.id,{rating:u,comment:p}),i.success("Cập nhật đánh giá thành công!")):(await l.createReview({quizId:o,rating:u,comment:p},g.uid,g.displayName||g.email||""),i.success("Gửi đánh giá thành công!")),d()}catch(s){i.error("Có lỗi khi gửi đánh giá")}finally{f(!1)}}else i.error("Vui lòng chọn số sao");else i.error("Bạn cần đăng nhập để đánh giá")},className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Đánh giá của bạn"}),n.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>n.jsx("button",{type:"button",onClick:()=>b(e),className:"p-1 transition-colors "+(e<=u?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"),children:n.jsx(a,{className:"w-8 h-8 "+(e<=u?"fill-current":"")})},e))}),u>0&&n.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[1===u&&"Rất không hài lòng",2===u&&"Không hài lòng",3===u&&"Bình thường",4===u&&"Hài lòng",5===u&&"Rất hài lòng"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhận xét (tùy chọn)"}),n.jsx("textarea",{value:p,onChange:e=>y(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Chia sẻ trải nghiệm của bạn về quiz này...",maxLength:500}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[p.length,"/500 ký tự"]})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[n.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:x("common.cancel")}),n.jsx("button",{type:"submit",disabled:j||0===u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:j?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n.jsx("span",{children:x("admin.quickActions.modal.sending")})]}):n.jsxs(n.Fragment,{children:[n.jsx(c,{className:"w-4 h-4"}),n.jsx("span",{children:m?"Cập nhật":"Gửi đánh giá"})]})})]})]})]})})})};export{o as R};
