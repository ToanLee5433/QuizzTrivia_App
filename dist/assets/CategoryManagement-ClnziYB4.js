import{d as e,m as s,h as r,n as t,p as a,u as l,a as i,r as c,j as o,q as n,w as d,y as m,U as x,E as g,x as u,g as p,t as h}from"./index-D6N84099.js";import{X as b}from"./x-DWlRL9Pr.js";import{P as j}from"./plus-BDXwuvZc.js";import{B as f}from"./book-open-CyI4O6Bn.js";import{C as y}from"./chart-column-f-ONK4uw.js";import{S as N}from"./search-d3_OfeLc.js";import{S as v}from"./square-pen-iNSv9imU.js";import{T as w}from"./trash-2-0dBRKsJC.js";import{S as k}from"./save-ChV9AajC.js";
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=e("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),z=[{name:"Programming",description:"Lập trình và phát triển phần mềm",icon:"💻",color:"blue"},{name:"Web Development",description:"Phát triển web frontend và backend",icon:"🌐",color:"green"},{name:"Science",description:"Khoa học tự nhiên và công nghệ",icon:"🔬",color:"purple"},{name:"Mathematics",description:"Toán học và thống kê",icon:"🧮",color:"indigo"},{name:"General Knowledge",description:"Kiến thức tổng hợp",icon:"📚",color:"gray"},{name:"History",description:"Lịch sử thế giới và Việt Nam",icon:"📜",color:"yellow"},{name:"Sports",description:"Thể thao và sức khỏe",icon:"🏃‍♂️",color:"red"},{name:"Entertainment",description:"Giải trí và văn hóa",icon:"🎭",color:"pink"}],S=()=>{const{user:e}=l(e=>e.auth),{t:S}=i(),[A,q]=c.useState([]),[D,L]=c.useState(!0),[T,E]=c.useState(!1),[P,H]=c.useState(null),[$,K]=c.useState(""),[M,V]=c.useState({name:"",description:"",icon:"📚",color:"blue"}),G=[{value:"blue",label:S("categories.colors.blue"),class:"bg-blue-500"},{value:"green",label:S("categories.colors.green"),class:"bg-green-500"},{value:"purple",label:S("categories.colors.purple"),class:"bg-purple-500"},{value:"red",label:S("categories.colors.red"),class:"bg-red-500"},{value:"yellow",label:S("categories.colors.yellow"),class:"bg-yellow-500"},{value:"pink",label:S("categories.colors.pink"),class:"bg-pink-500"},{value:"indigo",label:S("categories.colors.indigo"),class:"bg-indigo-500"},{value:"gray",label:S("categories.colors.gray"),class:"bg-gray-500"}];if(!e||"admin"!==e.role)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(b,{className:"w-8 h-8 text-red-600"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:S("errors.unauthorized")}),o.jsx("p",{className:"text-gray-600",children:S("admin.loginAsAdmin")})]})});c.useEffect(()=>{Q()},[]);const Q=async()=>{var e;try{L(!0),await(async()=>{try{const e=s(r,"categories");if((await t(e)).empty){for(const s of z)await a(e,{...s,createdAt:new Date,updatedAt:new Date});return!0}return!1}catch(e){throw e}})();const l=s(r,"categories"),i=await t(l),c=[];for(const a of i.docs){const l=a.data(),i=s(r,"quizzes"),o=await t(n(i,d("category","==",l.name)));c.push({id:a.id,name:l.name,description:l.description,icon:l.icon,color:l.color,createdAt:(null==(e=l.createdAt)?void 0:e.toDate())||new Date,quizCount:o.size})}q(c.sort((e,s)=>s.createdAt.getTime()-e.createdAt.getTime()))}catch(l){m.error(S("categories.loadError"))}finally{L(!1)}},B=A.filter(e=>e.name.toLowerCase().includes($.toLowerCase())||e.description.toLowerCase().includes($.toLowerCase())),F=e=>({blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",red:"bg-red-500",yellow:"bg-yellow-500",pink:"bg-pink-500",indigo:"bg-indigo-500",gray:"bg-gray-500"}[e]||"bg-blue-500");return D?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:S("loadingData")})]})}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center",children:o.jsx(C,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:S("admin.categoryManagement")}),o.jsx("p",{className:"text-gray-600",children:S("admin.categories.headerDesc")})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("button",{onClick:()=>{E(!0),H(null),V({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[o.jsx(j,{className:"w-5 h-5"}),S("categories.add")]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[o.jsx(x,{className:"w-4 h-4"}),o.jsx("span",{children:null==e?void 0:e.email}),o.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:S("ui.admin")})]})]})]})})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.total")}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.length})]}),o.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:o.jsx(C,{className:"w-6 h-6 text-purple-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.withQuizzes")}),o.jsx("p",{className:"text-2xl font-bold text-green-600",children:A.filter(e=>e.quizCount&&e.quizCount>0).length})]}),o.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:o.jsx(f,{className:"w-6 h-6 text-green-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.totalQuizzes")}),o.jsx("p",{className:"text-2xl font-bold text-blue-600",children:A.reduce((e,s)=>e+(s.quizCount||0),0)})]}),o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(y,{className:"w-6 h-6 text-blue-600"})})]})}),o.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.empty")}),o.jsx("p",{className:"text-2xl font-bold text-orange-600",children:A.filter(e=>!e.quizCount||0===e.quizCount).length})]}),o.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:o.jsx(g,{className:"w-6 h-6 text-orange-600"})})]})})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8",children:o.jsxs("div",{className:"relative",children:[o.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:S("categories.searchPlaceholder"),value:$,onChange:e=>K(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})}),0===B.length?o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[o.jsx(C,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:S("categories.noCategories")}),o.jsx("p",{className:"text-gray-600 mb-4",children:S($?"categories.noSearchMatch":"categories.noneCreated")}),o.jsxs("button",{onClick:()=>{E(!0),H(null),V({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto",children:[o.jsx(j,{className:"w-5 h-5"}),S("categories.createFirst")]})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map(e=>o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-12 h-12 ${F(e.color)} rounded-xl flex items-center justify-center text-2xl`,children:e.icon}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e.name}),o.jsxs("p",{className:"text-sm text-gray-600",children:[e.quizCount||0," ",S("categories.quizSuffix")]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>(e=>{H(e),V({name:e.name,description:e.description,icon:e.icon,color:e.color}),E(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:S("edit"),children:o.jsx(v,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>(async(e,s)=>{if(confirm(S("categories.confirmDeleteName",{name:s,defaultValue:`Are you sure you want to delete category "${s}"?`})))try{await u(p(r,"categories",e)),q(s=>s.filter(s=>s.id!==e)),m.success(S("categories.deleteSuccess"))}catch(t){m.error(S("categories.deleteError"))}})(e.id,e.name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:S("delete"),children:o.jsx(w,{className:"w-4 h-4"})})]})]}),o.jsx("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[o.jsxs("span",{children:[S("categories.createdAtLabel"),": ",e.createdAt.toLocaleDateString()]}),o.jsx("span",{className:`px-2 py-1 rounded-full text-white ${F(e.color)}`,children:e.color})]})]},e.id))})]}),T&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-bold",children:S(P?"categories.editTitle":"categories.addTitle")}),o.jsx("button",{onClick:()=>{E(!1),H(null),V({name:"",description:"",icon:"📚",color:"blue"})},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:o.jsx(b,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),M.name.trim())try{if(P){const e=p(r,"categories",P.id);await h(e,{name:M.name.trim(),description:M.description.trim(),icon:M.icon,color:M.color,updatedAt:new Date}),q(e=>e.map(e=>e.id===P.id?{...e,...M,name:M.name.trim(),description:M.description.trim()}:e)),m.success(S("categories.updateSuccess"))}else{const e={id:(await a(s(r,"categories"),{name:M.name.trim(),description:M.description.trim(),icon:M.icon,color:M.color,createdAt:new Date})).id,name:M.name.trim(),description:M.description.trim(),icon:M.icon,color:M.color,createdAt:new Date,quizCount:0};q(s=>[e,...s]),m.success(S("categories.addSuccess"))}V({name:"",description:"",icon:"📚",color:"blue"}),E(!1),H(null)}catch(t){m.error(S("categories.saveError"))}else m.error(S("categories.enterName"))},className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[S("categories.name")," *"]}),o.jsx("input",{type:"text",value:M.name,onChange:e=>V({...M,name:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:S("categories.namePlaceholder"),required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:S("categories.description")}),o.jsx("textarea",{value:M.description,onChange:e=>V({...M,description:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,placeholder:S("categories.descriptionPlaceholder")})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),o.jsx("div",{className:"grid grid-cols-6 gap-2",children:["📚","🔬","💻","🎨","📊","🌍","🏃‍♂️","🎵","🍳","📈","🧮","📝"].map(e=>o.jsx("button",{type:"button",onClick:()=>V({...M,icon:e}),className:"p-3 text-2xl border-2 rounded-lg hover:bg-gray-50 transition-colors "+(M.icon===e?"border-purple-500 bg-purple-50":"border-gray-200"),children:e},e))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:S("categories.color")}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:G.map(e=>o.jsxs("button",{type:"button",onClick:()=>V({...M,color:e.value}),className:"p-3 border-2 rounded-lg hover:bg-gray-50 transition-colors "+(M.color===e.value?"border-purple-500 bg-purple-50":"border-gray-200"),children:[o.jsx("div",{className:`w-6 h-6 ${e.class} rounded-full mx-auto mb-1`}),o.jsx("span",{className:"text-xs",children:e.label})]},e.value))})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>{E(!1),H(null),V({name:"",description:"",icon:"📚",color:"blue"})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:S("cancel")}),o.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[o.jsx(k,{className:"w-4 h-4"}),S(P?"update":"categories.create")]})]})]})]})})]})};export{S as default};
