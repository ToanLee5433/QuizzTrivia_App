import{u as e,r as s,j as t,S as i,L as a,E as l,a as n,z as r,k as c,n as d,B as x,i as m,g as o,h,b as u}from"./index-CeTcW6hP.js";import{R as g}from"./ReviewForm-N6ViKE_S.js";import{M as j}from"./message-square-UsiMlzJW.js";import{B as p}from"./book-open-BqizXrGp.js";import{P as f}from"./play-C6uYQUZ8.js";import"./x-5Om-_F14.js";import"./send-yYi2b5Jh.js";const b=({quizId:n,quizTitle:r})=>{const c=e(e=>e.auth.user),[d,x]=s.useState(!1);return t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mt-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-white rounded-full p-3 shadow-lg",children:t.jsx(i,{className:"w-8 h-8 text-yellow-500"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Bạn thấy quiz này như thế nào?"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Chia sẻ cảm nhận của bạn để giúp những người khác có trải nghiệm tốt hơn"}),t.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:c?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[t.jsx(j,{className:"w-5 h-5 mr-2"}),"Viết đánh giá"]}),t.jsxs(a,{to:`/quiz/${n}/reviews`,className:"inline-flex items-center px-6 py-3 bg-white text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors border border-gray-300 shadow-sm",children:[t.jsx(l,{className:"w-5 h-5 mr-2"}),"Xem tất cả đánh giá"]})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600 mb-4",children:"Đăng nhập để đánh giá và xem các đánh giá khác"}),t.jsx(a,{to:"/login",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Đăng nhập"})]})})]}),d&&c&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-auto m-4",children:[t.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Đánh giá: ",r]}),t.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"×"})]}),t.jsx("div",{className:"p-6",children:t.jsx(g,{quizId:n,onReviewSubmitted:()=>{x(!1)},onClose:()=>x(!1)})})]})})]})},N=()=>{var g;const{t:j}=n(),{id:N}=r(),y=c(),v=e(e=>e.auth.user),[w,z]=s.useState(null),[q,k]=s.useState(!0),[L,R]=s.useState(null);if(s.useEffect(()=>{(async()=>{if(N)try{const s=await m(o(h,"quizzes",N));if(s.exists()){const t={id:s.id,...s.data()};z(t);try{const e=await u.getQuizReviewStats(N);R(e)}catch(e){}}else y("/quizzes")}catch(e){y("/quizzes")}finally{k(!1)}})()},[N,y]),q)return t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:j("quiz.loading")})]})});if(!w)return t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),t.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:j("quiz.notFound")}),t.jsx(a,{to:"/quizzes",className:"text-blue-600 hover:underline",children:j("quiz.backToQuizList")})]})});const C=e=>{switch(e){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=e=>{switch(e){case"easy":return"Dễ";case"medium":return"Trung bình";case"hard":return"Khó";default:return e}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:t.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[t.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white mb-8",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4",children:w.title}),t.jsx("p",{className:"text-blue-100 text-lg mb-6",children:w.description}),t.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(p,{className:"w-5 h-5"}),t.jsx("span",{children:j("quiz.questionsCount",{count:w.questions.length})})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(d,{className:"w-5 h-5"}),t.jsx("span",{children:w.timeLimit?j("quiz.timeLimit",{time:w.timeLimit/60}):j("quiz.noTimeLimit")})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(x,{className:"w-5 h-5"}),t.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${C(w.difficulty)}`,children:S(w.difficulty)})]})]}),L&&L.totalReviews>0&&t.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[t.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>t.jsx(i,{className:"w-5 h-5 "+(e<=Math.round(L.averageRating)?"text-yellow-400 fill-current":"text-gray-300")},e))}),t.jsx("span",{className:"font-semibold",children:L.averageRating.toFixed(1)}),t.jsxs("span",{className:"text-blue-200",children:["(",j("quiz.ratingCount",{count:L.totalReviews}),")"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs(a,{to:`/quiz/${w.id}`,className:"inline-flex items-center px-6 py-3 bg-white text-blue-600 font-semibold rounded-lg hover:bg-blue-50 transition-colors shadow-md",children:[t.jsx(f,{className:"w-5 h-5 mr-2"}),j("quiz.startQuizButton")]}),t.jsxs(a,{to:"/multiplayer",state:{selectedQuiz:w},className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-colors shadow-md",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.196-2.121M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.196-2.121M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),"Chơi cùng bạn bè"]}),t.jsxs(a,{to:`/quiz/${w.id}/reviews`,className:"inline-flex items-center px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-400 transition-colors border border-blue-400",children:[t.jsx(l,{className:"w-5 h-5 mr-2"}),j("quiz.viewReviews")]})]})]})})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:j("quiz.detailedInfo")}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(p,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-semibold text-gray-900",children:j("quiz.questions")})]}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w.questions.length})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(d,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-semibold text-gray-900",children:j("quiz.duration")})]}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:w.timeLimit?w.timeLimit/60+"'":"∞"})]})]}),w.tags&&w.tags.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:j("quiz.topics")}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.tags.map((e,s)=>t.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:["#",e]},s))})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:j("quiz.questionType")}),t.jsxs("div",{className:"space-y-3",children:[w.questions.slice(0,3).map((e,s)=>t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-sm font-semibold rounded-full",children:s+1}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-gray-800 font-medium",children:e.text}),t.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-600",children:[t.jsx("span",{children:j("quiz.type",{type:j(`quiz.questionTypes.${e.type}`)})}),t.jsx("span",{children:j("quiz.points",{points:e.points})})]})]})]})},e.id)),w.questions.length>3&&t.jsx("p",{className:"text-center text-gray-600 py-4",children:j("quiz.moreQuestions",{count:w.questions.length-3})})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:j("quiz.stats")}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:j("quiz.category")}),t.jsx("span",{className:"font-semibold text-gray-900",children:w.category})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:j("quiz.difficulty")}),t.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${C(w.difficulty)}`,children:S(w.difficulty)})]}),L&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:j("quiz.rating")}),t.jsxs("span",{className:"font-semibold text-gray-900",children:[L.averageRating.toFixed(1),"/5 ⭐"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gray-600",children:j("quiz.reviewCount")}),t.jsx("span",{className:"font-semibold text-gray-900",children:L.totalReviews})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:j("quiz.author")}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold",children:(null==(g=w.createdBy)?void 0:g.charAt(0).toUpperCase())||"A"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-gray-900",children:j("quiz.author")}),t.jsx("p",{className:"text-sm text-gray-600",children:w.createdAt&&new Date(1e3*w.createdAt.seconds).toLocaleDateString("vi-VN")})]})]})]})]})]}),v&&t.jsx(b,{quizId:w.id,quizTitle:w.title})]})})};export{N as default};
