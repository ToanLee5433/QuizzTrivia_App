import{d as e,l as s,h as r,m as t,o as a,u as l,r as n,j as i,q as c,w as o,y as d,U as m,E as x,v as h,g as u,p}from"./index-BslwS0KI.js";import{X as g}from"./x-D2adGNFK.js";import{P as b}from"./plus-CIVFR-H2.js";import{B as j}from"./book-open-DEqop4oY.js";import{C as f}from"./chart-column-DUiXl71E.js";import{S as y}from"./search-CAWEQXvr.js";import{S as N}from"./square-pen-COiHJA2L.js";import{T as v}from"./trash-2-D7e9lx7W.js";import{S as w}from"./save-Ck-B112e.js";
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=e("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),C=[{name:"Programming",description:"Lập trình và phát triển phần mềm",icon:"💻",color:"blue"},{name:"Web Development",description:"Phát triển web frontend và backend",icon:"🌐",color:"green"},{name:"Science",description:"Khoa học tự nhiên và công nghệ",icon:"🔬",color:"purple"},{name:"Mathematics",description:"Toán học và thống kê",icon:"🧮",color:"indigo"},{name:"General Knowledge",description:"Kiến thức tổng hợp",icon:"📚",color:"gray"},{name:"History",description:"Lịch sử thế giới và Việt Nam",icon:"📜",color:"yellow"},{name:"Sports",description:"Thể thao và sức khỏe",icon:"🏃‍♂️",color:"red"},{name:"Entertainment",description:"Giải trí và văn hóa",icon:"🎭",color:"pink"}],T=()=>{const{user:e}=l(e=>e.auth),[T,z]=n.useState([]),[D,q]=n.useState(!0),[S,A]=n.useState(!1),[K,L]=n.useState(null),[H,V]=n.useState(""),[X,$]=n.useState({name:"",description:"",icon:"📚",color:"blue"});if(!e||"admin"!==e.role)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(g,{className:"w-8 h-8 text-red-600"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Truy cập bị từ chối"}),i.jsx("p",{className:"text-gray-600",children:"Bạn không có quyền truy cập trang này."})]})});n.useEffect(()=>{B()},[]);const B=async()=>{var e;try{q(!0),await(async()=>{try{const e=s(r,"categories");if((await t(e)).empty){for(const s of C)await a(e,{...s,createdAt:new Date,updatedAt:new Date});return!0}return!1}catch(e){throw e}})();const l=s(r,"categories"),n=await t(l),i=[];for(const a of n.docs){const l=a.data(),n=s(r,"quizzes"),d=await t(c(n,o("category","==",l.name)));i.push({id:a.id,name:l.name,description:l.description,icon:l.icon,color:l.color,createdAt:(null==(e=l.createdAt)?void 0:e.toDate())||new Date,quizCount:d.size})}z(i.sort((e,s)=>s.createdAt.getTime()-e.createdAt.getTime()))}catch(l){d.error("Không thể tải danh sách danh mục")}finally{q(!1)}},E=T.filter(e=>e.name.toLowerCase().includes(H.toLowerCase())||e.description.toLowerCase().includes(H.toLowerCase())),M=e=>({blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",red:"bg-red-500",yellow:"bg-yellow-500",pink:"bg-pink-500",indigo:"bg-indigo-500",gray:"bg-gray-500"}[e]||"bg-blue-500");return D?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải dữ liệu..."})]})}):i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center",children:i.jsx(k,{className:"w-6 h-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý Danh mục"}),i.jsx("p",{className:"text-gray-600",children:"Tạo và quản lý các danh mục quiz"})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("button",{onClick:()=>{A(!0),L(null),$({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[i.jsx(b,{className:"w-5 h-5"}),"Thêm danh mục"]}),i.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[i.jsx(m,{className:"w-4 h-4"}),i.jsx("span",{children:null==e?void 0:e.email}),i.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:"Admin"})]})]})]})})}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[i.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Danh mục"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:T.length})]}),i.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:i.jsx(k,{className:"w-6 h-6 text-purple-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Danh mục có Quiz"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.filter(e=>e.quizCount&&e.quizCount>0).length})]}),i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:i.jsx(j,{className:"w-6 h-6 text-green-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Quiz"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.reduce((e,s)=>e+(s.quizCount||0),0)})]}),i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(f,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Danh mục Trống"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:T.filter(e=>!e.quizCount||0===e.quizCount).length})]}),i.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:i.jsx(x,{className:"w-6 h-6 text-orange-600"})})]})})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8",children:i.jsxs("div",{className:"relative",children:[i.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Tìm kiếm danh mục...",value:H,onChange:e=>V(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})}),0===E.length?i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[i.jsx(k,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Không có danh mục nào"}),i.jsx("p",{className:"text-gray-600 mb-4",children:H?"Không tìm thấy danh mục nào phù hợp với từ khóa tìm kiếm.":"Chưa có danh mục nào được tạo."}),i.jsxs("button",{onClick:()=>{A(!0),L(null),$({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto",children:[i.jsx(b,{className:"w-5 h-5"}),"Tạo danh mục đầu tiên"]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(e=>i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:`w-12 h-12 ${M(e.color)} rounded-xl flex items-center justify-center text-2xl`,children:e.icon}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e.name}),i.jsxs("p",{className:"text-sm text-gray-600",children:[e.quizCount||0," quiz"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>(e=>{L(e),$({name:e.name,description:e.description,icon:e.icon,color:e.color}),A(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Chỉnh sửa",children:i.jsx(N,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>(async(e,s)=>{if(confirm(`Bạn có chắc chắn muốn xóa danh mục "${s}"?`))try{await h(u(r,"categories",e)),z(s=>s.filter(s=>s.id!==e)),d.success("Danh mục đã được xóa")}catch(t){d.error("Không thể xóa danh mục")}})(e.id,e.name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xóa",children:i.jsx(v,{className:"w-4 h-4"})})]})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[i.jsxs("span",{children:["Tạo: ",e.createdAt.toLocaleDateString("vi-VN")]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-white ${M(e.color)}`,children:e.color})]})]},e.id))})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-bold",children:K?"Chỉnh sửa danh mục":"Thêm danh mục mới"}),i.jsx("button",{onClick:()=>{A(!1),L(null),$({name:"",description:"",icon:"📚",color:"blue"})},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:i.jsx(g,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),X.name.trim())try{if(K){const e=u(r,"categories",K.id);await p(e,{name:X.name.trim(),description:X.description.trim(),icon:X.icon,color:X.color,updatedAt:new Date}),z(e=>e.map(e=>e.id===K.id?{...e,...X,name:X.name.trim(),description:X.description.trim()}:e)),d.success("Danh mục đã được cập nhật")}else{const e={id:(await a(s(r,"categories"),{name:X.name.trim(),description:X.description.trim(),icon:X.icon,color:X.color,createdAt:new Date})).id,name:X.name.trim(),description:X.description.trim(),icon:X.icon,color:X.color,createdAt:new Date,quizCount:0};z(s=>[e,...s]),d.success("Danh mục mới đã được tạo")}$({name:"",description:"",icon:"📚",color:"blue"}),A(!1),L(null)}catch(t){d.error("Không thể lưu danh mục")}else d.error("Vui lòng nhập tên danh mục")},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên danh mục *"}),i.jsx("input",{type:"text",value:X.name,onChange:e=>$({...X,name:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Nhập tên danh mục...",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),i.jsx("textarea",{value:X.description,onChange:e=>$({...X,description:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,placeholder:"Nhập mô tả danh mục..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),i.jsx("div",{className:"grid grid-cols-6 gap-2",children:["📚","🔬","💻","🎨","📊","🌍","🏃‍♂️","🎵","🍳","📈","🧮","📝"].map(e=>i.jsx("button",{type:"button",onClick:()=>$({...X,icon:e}),className:"p-3 text-2xl border-2 rounded-lg hover:bg-gray-50 transition-colors "+(X.icon===e?"border-purple-500 bg-purple-50":"border-gray-200"),children:e},e))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Màu sắc"}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{value:"blue",label:"Xanh dương",class:"bg-blue-500"},{value:"green",label:"Xanh lá",class:"bg-green-500"},{value:"purple",label:"Tím",class:"bg-purple-500"},{value:"red",label:"Đỏ",class:"bg-red-500"},{value:"yellow",label:"Vàng",class:"bg-yellow-500"},{value:"pink",label:"Hồng",class:"bg-pink-500"},{value:"indigo",label:"Chàm",class:"bg-indigo-500"},{value:"gray",label:"Xám",class:"bg-gray-500"}].map(e=>i.jsxs("button",{type:"button",onClick:()=>$({...X,color:e.value}),className:"p-3 border-2 rounded-lg hover:bg-gray-50 transition-colors "+(X.color===e.value?"border-purple-500 bg-purple-50":"border-gray-200"),children:[i.jsx("div",{className:`w-6 h-6 ${e.class} rounded-full mx-auto mb-1`}),i.jsx("span",{className:"text-xs",children:e.label})]},e.value))})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{A(!1),L(null),$({name:"",description:"",icon:"📚",color:"blue"})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),i.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[i.jsx(w,{className:"w-4 h-4"}),K?"Cập nhật":"Tạo danh mục"]})]})]})]})})]})};export{T as default};
