import{a as e,u as s,r as t,j as i,S as a,L as l,E as n,z as r,k as c,n as d,B as x,i as m,g as o,h,b as u}from"./index-BcvsJ6SD.js";import{R as g}from"./ReviewForm-DE5Tj1m5.js";import{M as j}from"./message-square-Ca0ii0op.js";import{B as p}from"./book-open-Cm84JLOK.js";import{P as f}from"./play-U3peXlZN.js";import"./x-Dr67ee2A.js";import"./send-apfZnrca.js";const b=({quizId:r,quizTitle:c})=>{const{t:d}=e(),x=s(e=>e.auth.user),[m,o]=t.useState(!1);return i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mt-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx("div",{className:"bg-white rounded-full p-3 shadow-lg",children:i.jsx(a,{className:"w-8 h-8 text-yellow-500"})})}),i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Bạn thấy quiz này như thế nào?"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Chia sẻ cảm nhận của bạn để giúp những người khác có trải nghiệm tốt hơn"}),i.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:x?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[i.jsx(j,{className:"w-5 h-5 mr-2"}),"Viết đánh giá"]}),i.jsxs(l,{to:`/quiz/${r}/reviews`,className:"inline-flex items-center px-6 py-3 bg-white text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors border border-gray-300 shadow-sm",children:[i.jsx(n,{className:"w-5 h-5 mr-2"}),"Xem tất cả đánh giá"]})]}):i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-gray-600 mb-4",children:"Đăng nhập để đánh giá và xem các đánh giá khác"}),i.jsx(l,{to:"/login",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:d("auth.login")})]})})]}),m&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-auto m-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Đánh giá: ",c]}),i.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"×"})]}),i.jsx("div",{className:"p-6",children:i.jsx(g,{quizId:r,onReviewSubmitted:()=>{o(!1)},onClose:()=>o(!1)})})]})})]})},N=()=>{var g;const{t:j}=e(),{id:N}=r(),y=c(),v=s(e=>e.auth.user),[w,z]=t.useState(null),[q,k]=t.useState(!0),[L,R]=t.useState(null);if(t.useEffect(()=>{(async()=>{if(N)try{const s=await m(o(h,"quizzes",N));if(s.exists()){const t={id:s.id,...s.data()};z(t);try{const e=await u.getQuizReviewStats(N);R(e)}catch(e){}}else y("/quizzes")}catch(e){y("/quizzes")}finally{k(!1)}})()},[N,y]),q)return i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:j("quiz.loading")})]})});if(!w)return i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:j("quiz.notFound")}),i.jsx(l,{to:"/quizzes",className:"text-blue-600 hover:underline",children:j("quiz.backToQuizList")})]})});const C=e=>{switch(e){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=e=>{switch(e){case"easy":return"Dễ";case"medium":return"Trung bình";case"hard":return"Khó";default:return e}};return i.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white mb-8",children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("h1",{className:"text-3xl font-bold mb-4",children:w.title}),i.jsx("p",{className:"text-blue-100 text-lg mb-6",children:w.description}),i.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(p,{className:"w-5 h-5"}),i.jsx("span",{children:j("quiz.questionsCount",{count:w.questions.length})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(d,{className:"w-5 h-5"}),i.jsx("span",{children:w.timeLimit?j("quiz.timeLimit",{time:w.timeLimit/60}):j("quiz.noTimeLimit")})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(x,{className:"w-5 h-5"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${C(w.difficulty)}`,children:S(w.difficulty)})]})]}),L&&L.totalReviews>0&&i.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[i.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>i.jsx(a,{className:"w-5 h-5 "+(e<=Math.round(L.averageRating)?"text-yellow-400 fill-current":"text-gray-300")},e))}),i.jsx("span",{className:"font-semibold",children:L.averageRating.toFixed(1)}),i.jsxs("span",{className:"text-blue-200",children:["(",j("quiz.ratingCount",{count:L.totalReviews}),")"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsxs(l,{to:`/quiz/${w.id}`,className:"inline-flex items-center px-6 py-3 bg-white text-blue-600 font-semibold rounded-lg hover:bg-blue-50 transition-colors shadow-md",children:[i.jsx(f,{className:"w-5 h-5 mr-2"}),j("quiz.startQuizButton")]}),i.jsxs(l,{to:"/multiplayer",state:{selectedQuiz:w},className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-colors shadow-md",children:[i.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.196-2.121M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.196-2.121M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),"Chơi cùng bạn bè"]}),i.jsxs(l,{to:`/quiz/${w.id}/reviews`,className:"inline-flex items-center px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-400 transition-colors border border-blue-400",children:[i.jsx(n,{className:"w-5 h-5 mr-2"}),j("quiz.viewReviews")]})]})]})})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:j("quiz.detailedInfo")}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsx(p,{className:"w-5 h-5 text-blue-600"}),i.jsx("span",{className:"font-semibold text-gray-900",children:j("quiz.questions")})]}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w.questions.length})]}),i.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsx(d,{className:"w-5 h-5 text-purple-600"}),i.jsx("span",{className:"font-semibold text-gray-900",children:j("quiz.duration")})]}),i.jsx("p",{className:"text-2xl font-bold text-purple-600",children:w.timeLimit?w.timeLimit/60+"'":"∞"})]})]}),w.tags&&w.tags.length>0&&i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:j("quiz.topics")}),i.jsx("div",{className:"flex flex-wrap gap-2",children:w.tags.map((e,s)=>i.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:["#",e]},s))})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:j("quiz.questionType")}),i.jsxs("div",{className:"space-y-3",children:[w.questions.slice(0,3).map((e,s)=>i.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-sm font-semibold rounded-full",children:s+1}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-gray-800 font-medium",children:e.text}),i.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-600",children:[i.jsx("span",{children:j("quiz.type",{type:j(`quiz.questionTypes.${e.type}`)})}),i.jsx("span",{children:j("quiz.points",{points:e.points})})]})]})]})},e.id)),w.questions.length>3&&i.jsx("p",{className:"text-center text-gray-600 py-4",children:j("quiz.moreQuestions",{count:w.questions.length-3})})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:j("quiz.stats")}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:j("quiz.category")}),i.jsx("span",{className:"font-semibold text-gray-900",children:w.category})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:j("quiz.difficulty")}),i.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${C(w.difficulty)}`,children:S(w.difficulty)})]}),L&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:j("quiz.rating")}),i.jsxs("span",{className:"font-semibold text-gray-900",children:[L.averageRating.toFixed(1),"/5 ⭐"]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:j("quiz.reviewCount")}),i.jsx("span",{className:"font-semibold text-gray-900",children:L.totalReviews})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:j("quiz.author")}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold",children:(null==(g=w.createdBy)?void 0:g.charAt(0).toUpperCase())||"A"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900",children:j("quiz.author")}),i.jsx("p",{className:"text-sm text-gray-600",children:w.createdAt&&new Date(1e3*w.createdAt.seconds).toLocaleDateString("vi-VN")})]})]})]})]})]}),v&&i.jsx(b,{quizId:w.id,quizTitle:w.title})]})})};export{N as default};
