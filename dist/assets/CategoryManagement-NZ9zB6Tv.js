import{d as e,l as s,h as r,m as t,o as a,u as l,a as i,r as o,j as c,q as n,w as d,y as m,U as g,E as x,v as u,g as p,p as h}from"./index-BcvsJ6SD.js";import{X as b}from"./x-Dr67ee2A.js";import{P as j}from"./plus-BxFmMDV3.js";import{B as y}from"./book-open-Cm84JLOK.js";import{C as f}from"./chart-column-B5QpRKzR.js";import{S as N}from"./search-DpGcZwSd.js";import{S as v}from"./square-pen-DDmOEp0c.js";import{T as w}from"./trash-2-DSFyVg_H.js";import{S as C}from"./save-Xyp5Ztsw.js";
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=e("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),z=[{name:"Programming",description:"Lập trình và phát triển phần mềm",icon:"💻",color:"blue"},{name:"Web Development",description:"Phát triển web frontend và backend",icon:"🌐",color:"green"},{name:"Science",description:"Khoa học tự nhiên và công nghệ",icon:"🔬",color:"purple"},{name:"Mathematics",description:"Toán học và thống kê",icon:"🧮",color:"indigo"},{name:"General Knowledge",description:"Kiến thức tổng hợp",icon:"📚",color:"gray"},{name:"History",description:"Lịch sử thế giới và Việt Nam",icon:"📜",color:"yellow"},{name:"Sports",description:"Thể thao và sức khỏe",icon:"🏃‍♂️",color:"red"},{name:"Entertainment",description:"Giải trí và văn hóa",icon:"🎭",color:"pink"}],S=()=>{const{user:e}=l(e=>e.auth),{t:S}=i(),[A,q]=o.useState([]),[D,E]=o.useState(!0),[L,P]=o.useState(!1),[T,G]=o.useState(null),[H,M]=o.useState(""),[$,K]=o.useState({name:"",description:"",icon:"📚",color:"blue"}),Q=[{value:"blue",label:S("categories.colors.blue","Blue"),class:"bg-blue-500"},{value:"green",label:S("categories.colors.green","Green"),class:"bg-green-500"},{value:"purple",label:S("categories.colors.purple","Purple"),class:"bg-purple-500"},{value:"red",label:S("categories.colors.red","Red"),class:"bg-red-500"},{value:"yellow",label:S("categories.colors.yellow","Yellow"),class:"bg-yellow-500"},{value:"pink",label:S("categories.colors.pink","Pink"),class:"bg-pink-500"},{value:"indigo",label:S("categories.colors.indigo","Indigo"),class:"bg-indigo-500"},{value:"gray",label:S("categories.colors.gray","Gray"),class:"bg-gray-500"}];if(!e||"admin"!==e.role)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(b,{className:"w-8 h-8 text-red-600"})}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:S("errors.unauthorized","Unauthorized access")}),c.jsx("p",{className:"text-gray-600",children:S("admin.loginAsAdmin","You need admin rights to access this page.")})]})});o.useEffect(()=>{U()},[]);const U=async()=>{var e;try{E(!0),await(async()=>{try{const e=s(r,"categories");if((await t(e)).empty){for(const s of z)await a(e,{...s,createdAt:new Date,updatedAt:new Date});return!0}return!1}catch(e){throw e}})();const l=s(r,"categories"),i=await t(l),o=[];for(const a of i.docs){const l=a.data(),i=s(r,"quizzes"),c=await t(n(i,d("category","==",l.name)));o.push({id:a.id,name:l.name,description:l.description,icon:l.icon,color:l.color,createdAt:(null==(e=l.createdAt)?void 0:e.toDate())||new Date,quizCount:c.size})}q(o.sort((e,s)=>s.createdAt.getTime()-e.createdAt.getTime()))}catch(l){m.error(S("categories.loadError","Cannot load categories"))}finally{E(!1)}},V=A.filter(e=>e.name.toLowerCase().includes(H.toLowerCase())||e.description.toLowerCase().includes(H.toLowerCase())),B=e=>({blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",red:"bg-red-500",yellow:"bg-yellow-500",pink:"bg-pink-500",indigo:"bg-indigo-500",gray:"bg-gray-500"}[e]||"bg-blue-500");return D?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:S("loadingData","Loading data...")})]})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center",children:c.jsx(k,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:S("admin.categoryManagement","Category Management")}),c.jsx("p",{className:"text-gray-600",children:S("admin.categories.headerDesc","Create and manage quiz categories")})]})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("button",{onClick:()=>{P(!0),G(null),K({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[c.jsx(j,{className:"w-5 h-5"}),S("categories.add","Add category")]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[c.jsx(g,{className:"w-4 h-4"}),c.jsx("span",{children:null==e?void 0:e.email}),c.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:S("ui.admin","Admin")})]})]})]})})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[c.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.total","Total Categories")}),c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.length})]}),c.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:c.jsx(k,{className:"w-6 h-6 text-purple-600"})})]})}),c.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.withQuizzes","Categories with quizzes")}),c.jsx("p",{className:"text-2xl font-bold text-green-600",children:A.filter(e=>e.quizCount&&e.quizCount>0).length})]}),c.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:c.jsx(y,{className:"w-6 h-6 text-green-600"})})]})}),c.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.totalQuizzes","Total Quizzes")}),c.jsx("p",{className:"text-2xl font-bold text-blue-600",children:A.reduce((e,s)=>e+(s.quizCount||0),0)})]}),c.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:c.jsx(f,{className:"w-6 h-6 text-blue-600"})})]})}),c.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600",children:S("categories.empty","Empty Categories")}),c.jsx("p",{className:"text-2xl font-bold text-orange-600",children:A.filter(e=>!e.quizCount||0===e.quizCount).length})]}),c.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:c.jsx(x,{className:"w-6 h-6 text-orange-600"})})]})})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8",children:c.jsxs("div",{className:"relative",children:[c.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),c.jsx("input",{type:"text",placeholder:S("categories.searchPlaceholder","Search categories..."),value:H,onChange:e=>M(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})}),0===V.length?c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[c.jsx(k,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:S("categories.noCategories","No categories")}),c.jsx("p",{className:"text-gray-600 mb-4",children:H?S("categories.noSearchMatch","No categories match your search."):S("categories.noneCreated","No categories created yet.")}),c.jsxs("button",{onClick:()=>{P(!0),G(null),K({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto",children:[c.jsx(j,{className:"w-5 h-5"}),S("categories.createFirst","Create the first category")]})]}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:V.map(e=>c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-12 h-12 ${B(e.color)} rounded-xl flex items-center justify-center text-2xl`,children:e.icon}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e.name}),c.jsxs("p",{className:"text-sm text-gray-600",children:[e.quizCount||0," ",S("categories.quizSuffix","quizzes")]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>(e=>{G(e),K({name:e.name,description:e.description,icon:e.icon,color:e.color}),P(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:S("edit","Edit"),children:c.jsx(v,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>(async(e,s)=>{if(confirm(S("categories.confirmDeleteName",{name:s,defaultValue:`Are you sure you want to delete category "${s}"?`})))try{await u(p(r,"categories",e)),q(s=>s.filter(s=>s.id!==e)),m.success(S("categories.deleteSuccess","Category deleted successfully!"))}catch(t){m.error(S("categories.deleteError","Error deleting category!"))}})(e.id,e.name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:S("delete","Delete"),children:c.jsx(w,{className:"w-4 h-4"})})]})]}),c.jsx("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[c.jsxs("span",{children:[S("categories.createdAtLabel","Created"),": ",e.createdAt.toLocaleDateString()]}),c.jsx("span",{className:`px-2 py-1 rounded-full text-white ${B(e.color)}`,children:e.color})]})]},e.id))})]}),L&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-bold",children:T?S("categories.editTitle","Edit category"):S("categories.addTitle","Add new category")}),c.jsx("button",{onClick:()=>{P(!1),G(null),K({name:"",description:"",icon:"📚",color:"blue"})},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:c.jsx(b,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),$.name.trim())try{if(T){const e=p(r,"categories",T.id);await h(e,{name:$.name.trim(),description:$.description.trim(),icon:$.icon,color:$.color,updatedAt:new Date}),q(e=>e.map(e=>e.id===T.id?{...e,...$,name:$.name.trim(),description:$.description.trim()}:e)),m.success(S("categories.updateSuccess","Category updated successfully"))}else{const e={id:(await a(s(r,"categories"),{name:$.name.trim(),description:$.description.trim(),icon:$.icon,color:$.color,createdAt:new Date})).id,name:$.name.trim(),description:$.description.trim(),icon:$.icon,color:$.color,createdAt:new Date,quizCount:0};q(s=>[e,...s]),m.success(S("categories.addSuccess","Category added successfully!"))}K({name:"",description:"",icon:"📚",color:"blue"}),P(!1),G(null)}catch(t){m.error(S("categories.saveError","Cannot save category"))}else m.error(S("categories.enterName","Please enter category name!"))},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[S("categories.name","Category name")," *"]}),c.jsx("input",{type:"text",value:$.name,onChange:e=>K({...$,name:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:S("categories.namePlaceholder","Enter category name..."),required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:S("categories.description","Description")}),c.jsx("textarea",{value:$.description,onChange:e=>K({...$,description:e.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,placeholder:S("categories.descriptionPlaceholder","Enter category description...")})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),c.jsx("div",{className:"grid grid-cols-6 gap-2",children:["📚","🔬","💻","🎨","📊","🌍","🏃‍♂️","🎵","🍳","📈","🧮","📝"].map(e=>c.jsx("button",{type:"button",onClick:()=>K({...$,icon:e}),className:"p-3 text-2xl border-2 rounded-lg hover:bg-gray-50 transition-colors "+($.icon===e?"border-purple-500 bg-purple-50":"border-gray-200"),children:e},e))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:S("categories.color","Color")}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:Q.map(e=>c.jsxs("button",{type:"button",onClick:()=>K({...$,color:e.value}),className:"p-3 border-2 rounded-lg hover:bg-gray-50 transition-colors "+($.color===e.value?"border-purple-500 bg-purple-50":"border-gray-200"),children:[c.jsx("div",{className:`w-6 h-6 ${e.class} rounded-full mx-auto mb-1`}),c.jsx("span",{className:"text-xs",children:e.label})]},e.value))})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:()=>{P(!1),G(null),K({name:"",description:"",icon:"📚",color:"blue"})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:S("cancel","Cancel")}),c.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[c.jsx(C,{className:"w-4 h-4"}),T?S("update","Update"):S("categories.create","Create category")]})]})]})]})})]})};export{S as default};
