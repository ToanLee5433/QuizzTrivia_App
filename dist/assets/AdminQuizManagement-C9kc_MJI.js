import{u as e,k as s,a as t,r as a,q as r,l as i,h as n,t as d,m as l,y as c,w as o,j as h,U as x,n as m,E as u,g,p,v as j,o as b,s as y}from"./index-Cq0ntLoY.js";import{B as f}from"./book-open-0qpmLNdm.js";import{R as N}from"./rotate-ccw-QW7Xclc3.js";import{C as w}from"./chart-column-B_uVnzRm.js";import{C as v}from"./check-DEr4ht5J.js";import{X as q}from"./x-LZGdLuKF.js";import{C as z}from"./circle-alert-BKqW2XSs.js";import{S as C}from"./search-Bj7zEPpL.js";import{P as k}from"./pen-line-BobXnVsD.js";import{T as A}from"./trash-2-d6d4WhxN.js";const D=()=>{const{user:D}=e(e=>e.auth),T=s(),{t:B}=t(),[S,K]=a.useState([]),[P,E]=a.useState([]),[R,L]=a.useState(!0),[Q,I]=a.useState(null),[Y,$]=a.useState("all"),[_,F]=a.useState("quizzes"),[M,V]=a.useState(!1),[X,U]=a.useState(null),[H,G]=a.useState(""),J=e=>{if(!e)return new Date;if(e&&"function"==typeof e.toDate)return e.toDate();if(e instanceof Date)return e;if("string"==typeof e||"number"==typeof e){const s=new Date(e);return isNaN(s.getTime())?new Date:s}return e&&"object"==typeof e&&e.seconds?new Date(1e3*e.seconds):new Date};a.useEffect(()=>{O(),W()},[]);const O=async()=>{try{L(!0),I(null);const e=r(i(n,"quizzes"),d("createdAt","desc")),s=await l(e),t=[];s.forEach(e=>{const s=e.data();try{t.push({id:e.id,title:s.title||"Untitled Quiz",description:s.description||"",status:s.status||"pending",createdBy:s.createdBy||"unknown",createdAt:J(s.createdAt),questions:s.questions||[],difficulty:s.difficulty||"easy",category:s.category||"general",isPublic:s.isPublic||!1,isPublished:s.isPublished||!1})}catch(a){}}),K(t),0===t.length&&c.info("Chưa có quiz nào trong hệ thống")}catch(e){I("Không thể tải danh sách quiz"),c.error("Không thể tải danh sách quiz: "+e)}finally{L(!1)}},W=async()=>{try{const e=r(i(n,"editRequests"),o("status","==","pending")),s=await l(e),t=[];s.forEach(e=>{const s=e.data();t.push({id:e.id,...s,requestedAt:J(s.requestedAt)})}),t.sort((e,s)=>{const t=e.requestedAt?new Date(e.requestedAt).getTime():0;return(s.requestedAt?new Date(s.requestedAt).getTime():0)-t}),E(t)}catch(e){try{const e=r(i(n,"editRequests")),s=await l(e),t=[];s.forEach(e=>{const s=e.data();"pending"===s.status&&t.push({id:e.id,...s,requestedAt:J(s.requestedAt)})}),t.sort((e,s)=>{const t=e.requestedAt?new Date(e.requestedAt).getTime():0;return(s.requestedAt?new Date(s.requestedAt).getTime():0)-t}),E(t)}catch(s){E([])}}},Z=S.filter(e=>{const s="all"===Y||e.status===Y,t=e.title.toLowerCase().includes(H.toLowerCase())||e.description.toLowerCase().includes(H.toLowerCase());return s&&t}),ee={all:S.length,pending:S.filter(e=>"pending"===e.status).length,approved:S.filter(e=>"approved"===e.status).length,rejected:S.filter(e=>"rejected"===e.status).length},se=e=>{switch(e){case"approved":return h.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:"✅ Đã duyệt"});case"rejected":return h.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:"❌ Từ chối"});default:return h.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-medium",children:"⏳ Chờ duyệt"})}},te=e=>{switch(e){case"easy":return h.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"🟢 Dễ"});case"hard":return h.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"🔴 Khó"});default:return h.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"🟡 Trung bình"})}};return D&&"admin"===D.role?R?h.jsx("div",{className:"min-h-screen flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),h.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải danh sách quiz..."})]})}):Q?h.jsx("div",{className:"min-h-screen flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"❌ Lỗi"}),h.jsx("p",{className:"text-gray-600 mb-4",children:Q}),h.jsx("button",{onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thử lại"})]})}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50",children:h.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 shadow-xl",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:h.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"w-12 h-12 lg:w-14 lg:h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center ring-2 ring-white/30 shadow-lg",children:h.jsx(f,{className:"w-6 h-6 lg:w-7 lg:h-7 text-white drop-shadow-sm"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-white drop-shadow-sm",children:B("admin.quizManagement")}),h.jsx("p",{className:"text-blue-100 text-sm lg:text-base mt-1",children:"Duyệt và quản lý tất cả quiz trong hệ thống"})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 lg:gap-4",children:[h.jsxs("button",{onClick:()=>{O(),W()},className:"w-full sm:w-auto px-4 py-2.5 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white rounded-xl transition-all duration-200 flex items-center justify-center gap-2 border border-white/20 hover:border-white/40 shadow-lg hover:shadow-xl",title:"Làm mới danh sách",children:[h.jsx(N,{className:"w-4 h-4"}),h.jsx("span",{className:"font-medium",children:"Làm mới"})]}),h.jsx("div",{className:"flex items-center space-x-3 bg-white/10 backdrop-blur-sm rounded-xl px-4 py-2.5 border border-white/20 shadow-lg",children:h.jsx(x,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[h.jsx("span",{className:"text-white text-sm font-medium truncate max-w-32 lg:max-w-none",children:null==D?void 0:D.email}),h.jsx("span",{className:"px-2 py-1 bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900 rounded-full text-xs font-bold shadow-sm",children:"Admin"})]})]})]})})})}),h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[h.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Quiz"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.all})]}),h.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:h.jsx(w,{className:"w-6 h-6 text-blue-600"})})]})}),h.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Chờ duyệt"}),h.jsx("p",{className:"text-2xl font-bold text-orange-600",children:ee.pending})]}),h.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:h.jsx(m,{className:"w-6 h-6 text-orange-600"})})]})}),h.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Đã duyệt"}),h.jsx("p",{className:"text-2xl font-bold text-green-600",children:ee.approved})]}),h.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:h.jsx(v,{className:"w-6 h-6 text-green-600"})})]})}),h.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Đã từ chối"}),h.jsx("p",{className:"text-2xl font-bold text-red-600",children:ee.rejected})]}),h.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:h.jsx(q,{className:"w-6 h-6 text-red-600"})})]})})]}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-8",children:h.jsxs("div",{className:"flex border-b border-gray-200",children:[h.jsx("button",{onClick:()=>F("quizzes"),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors "+("quizzes"===_?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(f,{className:"w-4 h-4"}),"Quản lý Quiz",h.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs",children:S.length})]})}),h.jsx("button",{onClick:()=>F("editRequests"),className:"px-6 py-4 text-sm font-medium border-b-2 transition-colors "+("editRequests"===_?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(z,{className:"w-4 h-4"}),"Yêu cầu chỉnh sửa",h.jsx("span",{className:"bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs",children:P.length})]})})]})}),"quizzes"===_&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8",children:h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{className:"relative",children:[h.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsx("input",{type:"text",placeholder:"Tìm kiếm quiz theo tiêu đề, mô tả...",value:H,onChange:e=>G(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),h.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[h.jsx("button",{onClick:()=>$("all"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("all"===Y?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Tất cả"}),h.jsx("button",{onClick:()=>$("pending"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("pending"===Y?"bg-orange-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Chờ duyệt"}),h.jsx("button",{onClick:()=>$("approved"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("approved"===Y?"bg-green-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Đã duyệt"}),h.jsx("button",{onClick:()=>$("rejected"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("rejected"===Y?"bg-red-600 text-white shadow-sm":"text-gray-700 hover:text-gray-900"),children:"Từ chối"})]})]})}),0===Z.length?h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[h.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:h.jsx(f,{className:"w-10 h-10 text-gray-400"})}),h.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:H?"Không tìm thấy quiz phù hợp":"Chưa có quiz nào"}),h.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:H?"Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc để xem thêm quiz.":"Hiện tại chưa có quiz nào trong hệ thống. Người tạo có thể tạo quiz từ trang Creator."}),!H&&h.jsx("div",{className:"flex justify-center",children:h.jsxs("button",{onClick:()=>window.open("/creator","_blank"),className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[h.jsx(f,{className:"w-5 h-5"}),"Đi đến trang Creator"]})})]}):h.jsx("div",{className:"grid gap-6",children:Z.map(e=>h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.title}),se(e.status),te(e.difficulty)]}),h.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:e.description}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-medium",children:"Danh mục:"})," ",e.category]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium",children:"Số câu hỏi:"})," ",e.questions.length]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium",children:"Tạo lúc:"})," ",e.createdAt.toLocaleDateString("vi-VN")]})]})]}),h.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[h.jsx("button",{onClick:()=>(e=>{U(e),V(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem trước chi tiết",children:h.jsx(u,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>{return s=e.id,void T(`/admin/edit-quiz/${s}`);var s},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"Chỉnh sửa quiz",children:h.jsx(k,{className:"w-5 h-5"})}),"pending"===e.status&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>(async e=>{try{const s=g(n,"quizzes",e);await p(s,{status:"approved",isPublished:!0,approvedAt:new Date,approvedBy:null==D?void 0:D.uid}),K(s=>s.map(s=>s.id===e?{...s,status:"approved",isPublished:!0}:s)),c.success("Đã phê duyệt quiz thành công!")}catch(s){c.error("Không thể duyệt quiz")}})(e.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Phê duyệt quiz",children:h.jsx(v,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>(async e=>{try{const s=g(n,"quizzes",e);await p(s,{status:"rejected",isPublished:!1,rejectedAt:new Date,rejectedBy:null==D?void 0:D.uid}),K(s=>s.map(s=>s.id===e?{...s,status:"rejected",isPublished:!1}:s)),c.success("Đã từ chối quiz!")}catch(s){c.error("Không thể từ chối quiz")}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Từ chối quiz",children:h.jsx(q,{className:"w-5 h-5"})})]}),("approved"===e.status||"rejected"===e.status)&&h.jsx("button",{onClick:()=>(async e=>{try{const s=g(n,"quizzes",e);await p(s,{status:"pending",isPublished:!1,reopenedAt:new Date,reopenedBy:null==D?void 0:D.uid}),K(s=>s.map(s=>s.id===e?{...s,status:"pending",isPublished:!1}:s)),c.success("Đã mở lại quiz để xem xét!")}catch(s){c.error("Không thể mở lại quiz")}})(e.id),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",title:"Mở lại để xem xét",children:h.jsx(N,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Bạn có chắc chắn muốn xóa quiz này không?"))try{await j(g(n,"quizzes",e)),K(s=>s.filter(s=>s.id!==e)),c.success("Quiz đã được xóa khỏi database")}catch(s){c.error("Không thể xóa quiz: "+s)}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xóa quiz vĩnh viễn",children:h.jsx(A,{className:"w-5 h-5"})})]})]})},e.id))})]}),"editRequests"===_&&h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[h.jsx(z,{className:"w-5 h-5 text-orange-500"}),"Yêu cầu chỉnh sửa Quiz (",P.length,")"]})}),0===P.length?h.jsxs("div",{className:"text-center py-12",children:[h.jsx(z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),h.jsx("p",{className:"text-gray-500 mb-4",children:"Không có yêu cầu chỉnh sửa nào"}),h.jsx("p",{className:"text-sm text-gray-400",children:"Các yêu cầu chỉnh sửa sẽ hiển thị ở đây khi có quiz creator gửi yêu cầu"})]}):h.jsx("div",{className:"space-y-4",children:P.map(e=>{var s;return h.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-white shadow-sm",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:h.jsx(x,{className:"w-5 h-5 text-blue-600"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-900",children:e.requestedByName||e.requestedByEmail||"Người dùng không xác định"}),h.jsx("p",{className:"text-sm text-gray-500",children:e.requestedByEmail||e.requestedBy||"Email không xác định"})]})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-3",children:[h.jsxs("h5",{className:"font-medium text-gray-900 mb-2",children:["📝 Quiz: ",e.quizTitle||"Tên quiz không xác định"]}),h.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[h.jsx("strong",{children:"Lý do yêu cầu:"})," ",e.reason||"Không có lý do cụ thể"]}),e.description&&h.jsxs("p",{className:"text-sm text-gray-600",children:[h.jsx("strong",{children:"Chi tiết:"})," ",e.description]})]}),h.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(m,{className:"w-4 h-4"}),(null==(s=e.requestedAt)?void 0:s.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))||"Thời gian không xác định"]}),h.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:"Chờ xử lý"})]})]}),h.jsxs("div",{className:"flex gap-2 ml-6",children:[h.jsxs("button",{onClick:()=>(async(e,s)=>{try{const t=P.find(s=>s.id===e);if(!t)return void c.error("Không tìm thấy yêu cầu chỉnh sửa");const a=g(n,"editRequests",e);await p(a,{status:"approved",reviewedBy:null==D?void 0:D.uid,reviewedByName:(null==D?void 0:D.displayName)||"Admin",reviewedAt:new Date});const r=g(n,"quizzes",s);await p(r,{status:"draft",isApproved:!1,canEdit:!0,editRequestApproved:!0,lastEditRequestApproved:new Date,approvedBy:null==D?void 0:D.uid,needsReApproval:!0}),await b(i(n,"notifications"),{userId:t.requestedBy,type:"edit_request_approved",title:"Yêu cầu chỉnh sửa đã được phê duyệt",message:`Yêu cầu chỉnh sửa quiz "${t.quizTitle}" của bạn đã được admin phê duyệt. Quiz đã được gỡ xuống để bạn chỉnh sửa. Sau khi sửa xong, vui lòng nộp lại để admin duyệt.`,quizId:s,createdAt:y(),read:!1}),E(s=>s.filter(s=>s.id!==e)),c.success(`Đã phê duyệt yêu cầu chỉnh sửa của ${t.requestedByName||t.requestedByEmail}!`)}catch(t){c.error("Không thể phê duyệt yêu cầu chỉnh sửa")}})(e.id,e.quizId),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 shadow-sm",title:"Phê duyệt yêu cầu",children:[h.jsx(v,{className:"w-4 h-4"}),"Duyệt"]}),h.jsxs("button",{onClick:()=>(async e=>{try{const s=P.find(s=>s.id===e);if(!s)return void c.error("Không tìm thấy yêu cầu chỉnh sửa");const t=g(n,"editRequests",e);await p(t,{status:"rejected",reviewedBy:null==D?void 0:D.uid,reviewedByName:(null==D?void 0:D.displayName)||"Admin",reviewedAt:new Date}),await b(i(n,"notifications"),{userId:s.requestedBy,type:"edit_request_rejected",title:"Yêu cầu chỉnh sửa đã bị từ chối",message:`Yêu cầu chỉnh sửa quiz "${s.quizTitle}" của bạn đã bị admin từ chối. Vui lòng liên hệ admin để biết thêm chi tiết.`,quizId:s.quizId,createdAt:y(),read:!1}),E(s=>s.filter(s=>s.id!==e)),c.success(`Đã từ chối yêu cầu chỉnh sửa của ${s.requestedByName||s.requestedByEmail}!`)}catch(s){c.error("Không thể từ chối yêu cầu chỉnh sửa")}})(e.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2 shadow-sm",title:"Từ chối yêu cầu",children:[h.jsx(q,{className:"w-4 h-4"}),"Từ chối"]})]})]})},e.id)})})]}),M&&X&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[h.jsx("div",{className:"p-6 border-b border-gray-200",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("h2",{className:"text-xl font-bold",children:["Xem trước Quiz: ",X.title]}),h.jsx("button",{onClick:()=>V(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:h.jsx(q,{className:"w-5 h-5"})})]})}),h.jsx("div",{className:"p-6",children:h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold mb-2",children:"Mô tả:"}),h.jsx("p",{className:"text-gray-600",children:X.description})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-semibold",children:"Danh mục:"})," ",X.category]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-semibold",children:"Độ khó:"})," ",X.difficulty]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-semibold",children:"Số câu hỏi:"})," ",X.questions.length]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-semibold",children:"Trạng thái:"})," ",se(X.status||"pending")]})]}),X.questions.length>0&&h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold mb-4",children:"Câu hỏi:"}),h.jsx("div",{className:"space-y-4",children:X.questions.map((e,s)=>h.jsxs("div",{className:"border rounded-lg p-4",children:[h.jsxs("h4",{className:"font-medium mb-2",children:[s+1,". ",e.text]}),e.answers&&h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:e.answers.map((e,s)=>h.jsxs("div",{className:"p-2 rounded "+(e.isCorrect?"bg-green-100 text-green-800":"bg-gray-100"),children:[String.fromCharCode(65+s),". ",e.text,e.isCorrect&&" ✓"]},s))})]},s))})]})]})})]})})]})]}):h.jsx("div",{className:"min-h-screen flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"⛔ Không có quyền truy cập"}),h.jsx("p",{className:"text-gray-600",children:"Bạn cần quyền admin để truy cập trang này."})]})})};export{D as default};
