import{v as P,t as j,l as g,F as N,q as T,u as V,r as m,j as e,X as k,A as X,D as B,y as x,Y as G,z as Q,C as O,E as _,G as I,J,K as U,a4 as W,k as z,m as Y}from"./index-CNQy308a.js";import{P as D}from"./plus-Bz0Kn-zX.js";import{S as Z}from"./save-D3JrD3t3.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],y=P("folder-open",ee),se=[{name:"Programming",description:"Lập trình và phát triển phần mềm",icon:"💻",color:"blue"},{name:"Web Development",description:"Phát triển web frontend và backend",icon:"🌐",color:"green"},{name:"Science",description:"Khoa học tự nhiên và công nghệ",icon:"🔬",color:"purple"},{name:"Mathematics",description:"Toán học và thống kê",icon:"🧮",color:"indigo"},{name:"General Knowledge",description:"Kiến thức tổng hợp",icon:"📚",color:"gray"},{name:"History",description:"Lịch sử thế giới và Việt Nam",icon:"📜",color:"yellow"},{name:"Sports",description:"Thể thao và sức khỏe",icon:"🏃‍♂️",color:"red"},{name:"Entertainment",description:"Giải trí và văn hóa",icon:"🎭",color:"pink"}],te=async()=>{try{console.log("🔍 Checking if categories exist...");const a=j(g,"categories"),o=await N(a);if(o.empty){console.log("📝 No categories found, creating default categories...");for(const d of se)await T(a,{...d,createdAt:new Date,updatedAt:new Date}),console.log(`✅ Created category: ${d.name}`);return console.log("🎉 Default categories initialized successfully!"),!0}else return console.log(`📊 Found ${o.size} existing categories`),!1}catch(a){throw console.error("❌ Error initializing categories:",a),a}},le=()=>{const{user:a}=V(s=>s.auth),[o,d]=m.useState([]),[q,v]=m.useState(!0),[S,h]=m.useState(!1),[p,u]=m.useState(null),[f,A]=m.useState(""),[t,l]=m.useState({name:"",description:"",icon:"📚",color:"blue"}),E=[{value:"blue",label:"Xanh dương",class:"bg-blue-500"},{value:"green",label:"Xanh lá",class:"bg-green-500"},{value:"purple",label:"Tím",class:"bg-purple-500"},{value:"red",label:"Đỏ",class:"bg-red-500"},{value:"yellow",label:"Vàng",class:"bg-yellow-500"},{value:"pink",label:"Hồng",class:"bg-pink-500"},{value:"indigo",label:"Chàm",class:"bg-indigo-500"},{value:"gray",label:"Xám",class:"bg-gray-500"}],L=["📚","🔬","💻","🎨","📊","🌍","🏃‍♂️","🎵","🍳","📈","🧮","📝"];if(!a||a.role!=="admin")return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(k,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Truy cập bị từ chối"}),e.jsx("p",{className:"text-gray-600",children:"Bạn không có quyền truy cập trang này."})]})});m.useEffect(()=>{K()},[]);const K=async()=>{var s;try{v(!0),console.log("🔍 Loading categories from Firebase..."),await te();const r=j(g,"categories"),i=await N(r);console.log("📊 Found categories in DB:",i.size);const n=[];for(const b of i.docs){const c=b.data();console.log("📝 Category data:",{id:b.id,...c});const H=j(g,"quizzes"),M=await N(X(H,B("category","==",c.name)));n.push({id:b.id,name:c.name,description:c.description,icon:c.icon,color:c.color,createdAt:((s=c.createdAt)==null?void 0:s.toDate())||new Date,quizCount:M.size})}console.log("✅ Loaded categories:",n),d(n.sort((b,c)=>c.createdAt.getTime()-b.createdAt.getTime()))}catch(r){console.error("❌ Error loading categories:",r),x.error("Không thể tải danh sách danh mục")}finally{v(!1)}},F=async s=>{if(s.preventDefault(),!t.name.trim()){x.error("Vui lòng nhập tên danh mục");return}try{if(p){const r=z(g,"categories",p.id);await Y(r,{name:t.name.trim(),description:t.description.trim(),icon:t.icon,color:t.color,updatedAt:new Date}),d(i=>i.map(n=>n.id===p.id?{...n,...t,name:t.name.trim(),description:t.description.trim()}:n)),x.success("Danh mục đã được cập nhật")}else{const i={id:(await T(j(g,"categories"),{name:t.name.trim(),description:t.description.trim(),icon:t.icon,color:t.color,createdAt:new Date})).id,name:t.name.trim(),description:t.description.trim(),icon:t.icon,color:t.color,createdAt:new Date,quizCount:0};d(n=>[i,...n]),x.success("Danh mục mới đã được tạo")}l({name:"",description:"",icon:"📚",color:"blue"}),h(!1),u(null)}catch(r){console.error("Error saving category:",r),x.error("Không thể lưu danh mục")}},$=s=>{u(s),l({name:s.name,description:s.description,icon:s.icon,color:s.color}),h(!0)},R=async(s,r)=>{if(confirm(`Bạn có chắc chắn muốn xóa danh mục "${r}"?`))try{await W(z(g,"categories",s)),d(i=>i.filter(n=>n.id!==s)),x.success("Danh mục đã được xóa")}catch(i){console.error("Error deleting category:",i),x.error("Không thể xóa danh mục")}},w=o.filter(s=>s.name.toLowerCase().includes(f.toLowerCase())||s.description.toLowerCase().includes(f.toLowerCase())),C=s=>({blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",red:"bg-red-500",yellow:"bg-yellow-500",pink:"bg-pink-500",indigo:"bg-indigo-500",gray:"bg-gray-500"})[s]||"bg-blue-500";return q?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải dữ liệu..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center",children:e.jsx(y,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý Danh mục"}),e.jsx("p",{className:"text-gray-600",children:"Tạo và quản lý các danh mục quiz"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>{h(!0),u(null),l({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(D,{className:"w-5 h-5"}),"Thêm danh mục"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:a==null?void 0:a.email}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:"Admin"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Danh mục"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Danh mục có Quiz"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.filter(s=>s.quizCount&&s.quizCount>0).length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Quiz"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.reduce((s,r)=>s+(r.quizCount||0),0)})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(O,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Danh mục Trống"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.filter(s=>!s.quizCount||s.quizCount===0).length})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(_,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Tìm kiếm danh mục...",value:f,onChange:s=>A(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})}),w.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[e.jsx(y,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Không có danh mục nào"}),e.jsx("p",{className:"text-gray-600 mb-4",children:f?"Không tìm thấy danh mục nào phù hợp với từ khóa tìm kiếm.":"Chưa có danh mục nào được tạo."}),e.jsxs("button",{onClick:()=>{h(!0),u(null),l({name:"",description:"",icon:"📚",color:"blue"})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto",children:[e.jsx(D,{className:"w-5 h-5"}),"Tạo danh mục đầu tiên"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 ${C(s.color)} rounded-xl flex items-center justify-center text-2xl`,children:s.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.quizCount||0," quiz"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>$(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Chỉnh sửa",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>R(s.id,s.name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xóa",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Tạo: ",s.createdAt.toLocaleDateString("vi-VN")]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-white ${C(s.color)}`,children:s.color})]})]},s.id))})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:p?"Chỉnh sửa danh mục":"Thêm danh mục mới"}),e.jsx("button",{onClick:()=>{h(!1),u(null),l({name:"",description:"",icon:"📚",color:"blue"})},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:e.jsx(k,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên danh mục *"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>l({...t,name:s.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Nhập tên danh mục...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),e.jsx("textarea",{value:t.description,onChange:s=>l({...t,description:s.target.value}),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,placeholder:"Nhập mô tả danh mục..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:L.map(s=>e.jsx("button",{type:"button",onClick:()=>l({...t,icon:s}),className:`p-3 text-2xl border-2 rounded-lg hover:bg-gray-50 transition-colors ${t.icon===s?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Màu sắc"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:E.map(s=>e.jsxs("button",{type:"button",onClick:()=>l({...t,color:s.value}),className:`p-3 border-2 rounded-lg hover:bg-gray-50 transition-colors ${t.color===s.value?"border-purple-500 bg-purple-50":"border-gray-200"}`,children:[e.jsx("div",{className:`w-6 h-6 ${s.class} rounded-full mx-auto mb-1`}),e.jsx("span",{className:"text-xs",children:s.label})]},s.value))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),u(null),l({name:"",description:"",icon:"📚",color:"blue"})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),e.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Z,{className:"w-4 h-4"}),p?"Cập nhật":"Tạo danh mục"]})]})]})]})})]})};export{le as default};
