import{a as e,r as s,u as t,j as a,L as l,n as d,m as i,h as r,t as o,y as n,g as c,p as m}from"./index-D6N84099.js";import{A as x}from"./AdminLayout-Cez7A1c4.js";const u=()=>{const{t:u}=e(),[g,h]=s.useState({totalQuizzes:0,totalUsers:0,completedQuizzes:0,totalCreators:0});s.useEffect(()=>{(async()=>{try{const e=await d(i(r,"quizzes")),s=e.docs.map(e=>e.data()).filter(e=>"approved"===e.status),t=s.length,a=s.filter(e=>!0===e.completed||"completed"===e.status).length,l=s.map(e=>e.creatorId).filter((e,s,t)=>e&&t.indexOf(e)===s).length,o=await d(i(r,"users")),n=o.docs.map(e=>e.data()).length;h({totalQuizzes:t,totalUsers:n,completedQuizzes:a,totalCreators:l})}catch(e){}})()},[]);const{user:b}=t(e=>e.auth),[p,f]=s.useState(!1),[j,v]=s.useState(!1),[N,y]=s.useState({message:"",type:"info",targetRole:"all"});return"admin"!==(null==b?void 0:b.role)?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-600",children:u("admin.loginAsAdmin")})}):a.jsxs(x,{title:u("admin.sidebar.nav.dashboard"),children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg shadow-lg p-6 mb-8 text-white",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:u("admin.greeting")}),a.jsx("p",{className:"text-blue-100",children:u("admin.dashboardSubtitle")})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"📚"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:u("dashboard.totalQuizzes")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-blue-600",children:g.totalQuizzes})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"👥"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:u("dashboard.totalUsers")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-green-600",children:g.totalUsers})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"✅"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:u("dashboard.completedQuizzes")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-purple-600",children:g.completedQuizzes})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx("span",{className:"text-2xl",children:"✏️"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-900",children:u("dashboard.totalCreators")}),a.jsx("div",{className:"text-xl md:text-3xl font-bold text-orange-600",children:g.totalCreators})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:u("admin.tabs.quizManagement")}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(l,{to:"/admin/quiz-management",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["◆ ",u("admin.tabs.quizManagement")]}),a.jsxs(l,{to:"/admin/categories",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["📂 ",u("admin.tabs.categoryManagement")]}),a.jsxs(l,{to:"/admin/quiz-stats",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["📊 ",u("admin.stats.quizActivity")]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:u("admin.tabs.userManagement")}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(l,{to:"/admin/users",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["👥 ",u("admin.tabs.users")]}),a.jsxs(l,{to:"/admin/roles",className:"w-full text-left p-2 md:p-3 hover:bg-gray-50 rounded border block text-sm md:text-base",children:["🔐 ",u("admin.roles")]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-900 flex items-center",children:[a.jsx("span",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:"⚡"}),u("admin.quickActions.title")]}),a.jsx("span",{className:"text-sm text-gray-500",children:u("admin.quickActions.important")})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[a.jsx("button",{onClick:()=>f(!0),className:"group bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"📢"}),a.jsx("span",{className:"text-sm font-medium",children:u("admin.quickActions.items.notify.title")})]})}),a.jsx("button",{onClick:async()=>{if(confirm(u("admin.quickActions.toasts.confirmDeleteAll"))){v(!0);try{const e=(await d(i(r,"system_notifications"))).docs.map(e=>o(e.ref,{isActive:!1}));await Promise.all(e),n.success(u("admin.quickActions.toasts.deleteSuccess"))}catch(e){n.error(u("admin.quickActions.toasts.deleteError"))}finally{v(!1)}}},className:"group bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"❌"}),a.jsx("span",{className:"text-sm font-medium",children:u("admin.quickActions.items.deleteNotifications.title")})]})}),a.jsx("button",{onClick:async()=>{v(!0);try{const e=["users","quizzes","categories","quiz_results"],s={};for(const n of e){const e=await d(i(r,n));s[n]=e.docs.map(e=>({id:e.id,...e.data()}))}const t=JSON.stringify(s,null,2),a=new Blob([t],{type:"application/json"}),l=URL.createObjectURL(a),o=document.createElement("a");o.href=l,o.download=`quiz-app-backup-${(new Date).toISOString().split("T")[0]}.json`,o.click(),n.success(u("admin.quickActions.toasts.backupSuccess"))}catch(e){n.error(u("admin.quickActions.toasts.backupError"))}finally{v(!1)}},className:"group bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"💾"}),a.jsx("span",{className:"text-sm font-medium",children:u("admin.quickActions.items.backup.title")})]})}),a.jsx("button",{onClick:async()=>{if(confirm(u("admin.quickActions.toasts.confirmCleanup"))){v(!0);try{const e=await d(i(r,"quizzes")),s=e.docs.filter(e=>!0===e.data().deleted).map(e=>o(c(r,"quizzes",e.id),{isPurged:!0})),t=await d(i(r,"users")),a=t.docs.filter(e=>!0===e.data().deleted).map(e=>o(c(r,"users",e.id),{isPurged:!0}));await Promise.all([...s,...a]),n.success(u("admin.quickActions.toasts.cleanupSuccess"))}catch(e){n.error(u("admin.quickActions.toasts.cleanupError"))}finally{v(!1)}}},className:"group bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-4 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg",disabled:j,children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"🗑️"}),a.jsx("span",{className:"text-sm font-medium",children:u("admin.quickActions.items.cleanup.title")})]})})]})]}),p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4",children:[a.jsx("h2",{className:"text-lg md:text-xl font-semibold mb-4",children:u("admin.quickActions.modal.title")}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:u("admin.quickActions.modal.contentLabel")}),a.jsx("textarea",{value:N.message,onChange:e=>y(s=>({...s,message:e.target.value})),placeholder:u("admin.quickActions.modal.contentPlaceholder"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",rows:4})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:u("admin.quickActions.modal.typeLabel")}),a.jsxs("select",{value:N.type,onChange:e=>y(s=>({...s,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[a.jsx("option",{value:"info",children:u("admin.quickActions.modal.type.info")}),a.jsx("option",{value:"warning",children:u("admin.quickActions.modal.type.warning")}),a.jsx("option",{value:"success",children:u("admin.quickActions.modal.type.success")}),a.jsx("option",{value:"error",children:u("admin.quickActions.modal.type.error")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:u("admin.quickActions.modal.targetLabel")}),a.jsxs("select",{value:N.targetRole,onChange:e=>y(s=>({...s,targetRole:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",children:[a.jsx("option",{value:"all",children:u("admin.quickActions.modal.target.all")}),a.jsx("option",{value:"user",children:u("admin.quickActions.modal.target.user")}),a.jsx("option",{value:"creator",children:u("admin.quickActions.modal.target.creator")})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 pt-4",children:[a.jsx("button",{onClick:()=>f(!1),className:"w-full sm:w-auto px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm md:text-base",disabled:j,children:u("cancel")}),a.jsx("button",{onClick:async()=>{if(N.message.trim()){v(!0);try{await m(i(r,"system_notifications"),{message:N.message,type:N.type,createdAt:new Date,isActive:!0,targetRole:N.targetRole}),y({message:"",type:"info",targetRole:"all"}),f(!1),n.success(u("admin.quickActions.toasts.createSuccess"))}catch(e){n.error(u("admin.quickActions.toasts.createError"))}finally{v(!1)}}else n.error(u("admin.quickActions.toasts.enterMessage"))},disabled:j||!N.message.trim(),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:u(j?"admin.quickActions.modal.sending":"admin.quickActions.modal.send")})]})]})]})})]})};export{u as default};
