import{a as e,j as s,e as l,l as r,u as t,r as a,Q as i,f as d,P as n,y as c}from"./index-D6N84099.js";const o=({quizzes:l})=>{const{t:r}=e(),t=l.length,a=l.filter(e=>e.isCompleted).length,i=l.reduce((e,s)=>e+s.questions.length,0),d=t>0?Math.round(i/t):0,n={easy:l.filter(e=>"easy"===e.difficulty).length,medium:l.filter(e=>"medium"===e.difficulty).length,hard:l.filter(e=>"hard"===e.difficulty).length},c=l.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{}),o=Object.entries(c).sort(([,e],[,s])=>s-e).slice(0,5),x=l.reduce((e,s)=>e+(s.totalPlayers||0),0),m=l.filter(e=>e.averageScore).reduce((e,s)=>e+(s.averageScore||0),0)/l.filter(e=>e.averageScore).length||0,u=t>0?Math.round(a/t*100):0;return s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-100 text-sm font-medium",children:r("admin.quizManagement.cards.totalQuizzes")}),s.jsx("p",{className:"text-3xl font-bold",children:t})]}),s.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:s.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),s.jsx("div",{className:"mt-4 flex items-center text-blue-100 text-sm",children:s.jsxs("span",{children:[d," câu hỏi trung bình"]})})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-green-100 text-sm font-medium",children:r("admin.quickActions.stats.completions")}),s.jsx("p",{className:"text-3xl font-bold",children:a})]}),s.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:s.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"flex items-center justify-between text-green-100 text-sm mb-1",children:[s.jsx("span",{children:"Tiến độ"}),s.jsxs("span",{children:[u,"%"]})]}),s.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:s.jsx("div",{className:"bg-white rounded-full h-2 transition-all duration-300",style:{width:`${u}%`}})})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-purple-100 text-sm font-medium",children:r("leaderboard.plays")}),s.jsx("p",{className:"text-3xl font-bold",children:x.toLocaleString()})]}),s.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:s.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"})})})]}),s.jsx("div",{className:"mt-4 flex items-center text-purple-100 text-sm",children:s.jsxs("span",{children:[t>0?Math.round(x/t):0," trung bình/quiz"]})})]}),s.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-orange-100 text-sm font-medium",children:r("leaderboard.avgScore")}),s.jsxs("p",{className:"text-3xl font-bold",children:[Math.round(m),"%"]})]}),s.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:s.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})})]}),s.jsx("div",{className:"mt-4 flex items-center text-orange-100 text-sm",children:s.jsx("span",{children:"Chất lượng tốt"})})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 md:col-span-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Phân bố độ khó"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),s.jsx("span",{className:"text-sm text-gray-600",children:r("difficulty.easy")})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm font-medium",children:n.easy}),s.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:(t>0?n.easy/t*100:0)+"%"}})})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),s.jsx("span",{className:"text-sm text-gray-600",children:r("difficulty.medium")})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm font-medium",children:n.medium}),s.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:(t>0?n.medium/t*100:0)+"%"}})})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),s.jsx("span",{className:"text-sm text-gray-600",children:r("difficulty.hard")})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm font-medium",children:n.hard}),s.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:(t>0?n.hard/t*100:0)+"%"}})})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 md:col-span-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Danh mục phổ biến"}),s.jsxs("div",{className:"space-y-3",children:[o.map(([e,l],r)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs font-medium",children:r+1}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:e})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[l," quiz"]}),s.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:(t>0?l/t*100:0)+"%"}})})]})]},e)),0===o.length&&s.jsx("div",{className:"text-center text-gray-500 py-4",children:"Chưa có dữ liệu danh mục"})]})]})]})},x=({quizzes:x,title:m})=>{const{t:u}=e(),h=l(),g=r(),j=x||t(e=>e.quiz.quizzes),b=t(e=>e.quiz.loading||e.quiz.isLoading),f=t(e=>e.quiz.error),p=t(e=>e.auth.user),v=f&&(f.includes("ad blocker")||f.includes("ERR_BLOCKED_BY_CLIENT")||f.includes(u("errors.firestoreConnection"))),[N,y]=a.useState(0);a.useEffect(()=>{(async()=>{if(!x&&0===j.length&&!b)try{await h(d({user:p})).unwrap()}catch(e){if(e instanceof Error&&e.code,N<3){const e=Math.min(1e3*Math.pow(2,N),1e4);c.info(u("messages.retrying")),setTimeout(()=>{y(e=>e+1)},e)}else c.error(u("messages.serverError"))}})()},[h,x,j.length,p,b,N]);const[w,z]=a.useState(""),[C,k]=a.useState("all"),[M,q]=a.useState("all"),[L,S]=a.useState("newest"),[B,H]=a.useState("grid"),[D,A]=a.useState(!0),[R,P]=a.useState(!1),Q=Array.from(new Set(j.map(e=>e.category))),T=Array.from(new Set(j.map(e=>e.difficulty)));let E=j.filter(e=>"approved"===e.status&&("all"===C||e.category===C)&&("all"===M||e.difficulty===M)&&(D||!e.isCompleted)&&e.title.toLowerCase().includes(w.toLowerCase()));E=E.sort((e,s)=>{switch(L){case"newest":return new Date(s.createdAt||0).getTime()-new Date(e.createdAt||0).getTime();case"oldest":return new Date(e.createdAt||0).getTime()-new Date(s.createdAt||0).getTime();case"popular":return(s.totalPlayers||0)-(e.totalPlayers||0);case"difficulty":const l={easy:1,medium:2,hard:3};return(l[e.difficulty]||2)-(l[s.difficulty]||2);default:return 0}});const V=()=>{y(0),h(d({user:p}))};return f?s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsx("div",{className:"max-w-5xl mx-auto px-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-600 text-xl mb-4",children:f}),s.jsx("button",{onClick:V,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors",children:u("common.retry")})]})})}):b?s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsx("div",{className:"max-w-5xl mx-auto px-4",children:s.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),s.jsx("span",{className:"text-gray-600",children:u("common.loadingData")})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:m||u("quiz.exploreQuizzes")}),s.jsx("p",{className:"text-gray-600 text-lg",children:u("quiz.exploreDescription")})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:()=>P(!R),className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors "+(R?"bg-blue-50 border-blue-200 text-blue-700":"border-gray-300 text-gray-600 hover:bg-gray-50"),children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})}),u(R?"ui.hideStats":"ui.showStats")]}),("creator"===(null==p?void 0:p.role)||"admin"===(null==p?void 0:p.role))&&s.jsxs("button",{onClick:()=>g("/creator"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),u("creator.createNewQuiz")]})]})]})}),R&&j.length>0&&s.jsx(o,{quizzes:j}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[s.jsx("div",{className:"lg:col-span-2 relative",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:u("quiz.searchPlaceholder"),value:w,onChange:e=>z(e.target.value),className:"w-full border border-gray-300 rounded-lg p-3 pl-10 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),w&&s.jsx("button",{onClick:()=>z(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 hover:text-gray-600",children:s.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),s.jsxs("select",{className:"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:C,onChange:e=>k(e.target.value),children:[s.jsxs("option",{value:"all",children:["🏷️ ",u("categories.all")]}),Q.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("select",{className:"border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:M,onChange:e=>q(e.target.value),children:[s.jsxs("option",{value:"all",children:["📊 ",u("difficulty.all")]}),T.map(e=>s.jsx("option",{value:e,children:"easy"===e?`😊 ${u("difficulty.easy")}`:"medium"===e?`😐 ${u("difficulty.medium")}`:`😤 ${u("difficulty.hard")}`},e))]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pt-4 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("select",{className:"border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:L,onChange:e=>S(e.target.value),children:[s.jsxs("option",{value:"newest",children:["🆕 ",u("ui.sort.newest")]}),s.jsxs("option",{value:"oldest",children:["📅 ",u("ui.sort.oldest")]}),s.jsxs("option",{value:"popular",children:["🔥 ",u("ui.sort.popular")]}),s.jsxs("option",{value:"difficulty",children:["📈 ",u("ui.sort.byDifficulty")]})]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx("input",{type:"checkbox",checked:D,onChange:e=>A(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),u("quiz.completed")]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:u("ui.display")}),s.jsxs("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:[s.jsx("button",{onClick:()=>H("grid"),className:"p-2 "+("grid"===B?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"),title:u("ui.grid"),children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),s.jsx("button",{onClick:()=>H("list"),className:"p-2 "+("list"===B?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"),title:u("ui.list"),children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[u("ui.searchResultPrefix")," ",s.jsx("span",{className:"font-semibold text-blue-600",children:E.length})," ",u("ui.searchResultSuffix"),w&&s.jsxs("span",{children:[" ",u("ui.for"),' "',w,'"']}),"all"!==C&&s.jsxs("span",{children:[" ",u("ui.inCategory"),' "',C,'"']}),"all"!==M&&s.jsxs("span",{children:[" ",u("ui.withDifficulty"),' "',M,'"']})]})]}),s.jsx("div",{className:"grid"===B?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4",children:b?Array.from({length:8}).map((e,l)=>s.jsx(i,{},l)):v?s.jsxs("div",{className:"col-span-full bg-red-50 border border-red-200 rounded-xl p-8 text-center",children:[s.jsx("div",{className:"text-red-600 text-xl font-semibold mb-3",children:u("quizList.errors.connectionBlocked")}),s.jsx("div",{className:"text-red-700 mb-6",children:f}),s.jsxs("div",{className:"text-sm text-gray-600 mb-6 max-w-md mx-auto",children:[s.jsx("div",{className:"mb-3",children:s.jsx("strong",{children:u("quizList.errors.troubleshooting")})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{children:u("ui.firestoreHelp.1")}),s.jsx("div",{children:u("ui.firestoreHelp.2")}),s.jsx("div",{children:u("ui.firestoreHelp.3")}),s.jsx("div",{children:u("ui.firestoreHelp.4")})]})]}),s.jsxs("button",{className:"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",onClick:()=>h(d({user:p})),children:["🔄 ",u("ui.retryConnection")]})]}):f?s.jsx("div",{className:"col-span-full text-center",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-8",children:[s.jsxs("div",{className:"text-red-600 text-lg font-medium mb-4",children:["❌ ",u("messages.error")]}),s.jsx("div",{className:"text-red-700 mb-6",children:f}),s.jsxs("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",onClick:()=>h(d({user:p})),children:["🔄 ",u("common.retry")]})]})}):0===E.length?s.jsx("div",{className:"col-span-full text-center",children:s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-12",children:[s.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 21m6-4l.75 4M4 4v16c0 1.104.896 2 2 2h12a2 2 0 002-2V4M4 4l8 8m0 0l8-8"})}),s.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:u("ui.noQuizFound")}),s.jsx("p",{className:"text-gray-600 mb-6",children:u("ui.noQuizMatch")}),s.jsxs("div",{className:"flex justify-center gap-4",children:[s.jsxs("button",{onClick:()=>{z(""),k("all"),q("all")},className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:["🔄 ",u("ui.clearFilters")]}),("creator"===(null==p?void 0:p.role)||"admin"===(null==p?void 0:p.role))&&s.jsxs("button",{className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",onClick:()=>g("/creator"),children:["➕ ",u("creator.createNewQuiz")]})]})]})}):E.map(e=>s.jsx(n,{quiz:e,viewMode:B},e.id))})]})})};export{x as default};
